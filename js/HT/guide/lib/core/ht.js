!function(_,V,Z){"use strict";var j="ht";if(!_[j]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),_.performance&&_.performance.now||function(){var d=Date.now();_.performance||(_.performance={}),_.performance.now=function(){return Date.now()-d}}();for(var z=Date.now(),s=16,u=["ms","moz","webkit","o"],h=0;h<u.length&&!_.requestAnimationFrame;++h)_.requestAnimationFrame=_[u[h]+"RequestAnimationFrame"],_.cancelAnimationFrame=_[u[h]+"CancelAnimationFrame"]||_[u[h]+"CancelRequestAnimationFrame"];_.requestAnimationFrame||(_.requestAnimationFrame=function(M){var u=Date.now(),b=s+z-u;return 0>b&&(b=0),z=u,_.setTimeout(function(){z=Date.now(),M(performance.now())},b)}),_.cancelAnimationFrame||(_.cancelAnimationFrame=function(z){return _.clearTimeout(z)}),V.assign===Z&&(V.assign=function(k){if(k===Z||null===k)throw new TypeError("Cannot convert undefined or null to object");for(var s=V(k),H=1;H<arguments.length;H++){var $=arguments[H];if($!==Z&&null!==$)for(var K in $)V.prototype.hasOwnProperty.call($,K)&&(s[K]=$[K])}return s})}();var z=_.document,I=null,o=_[j]={},U=_[j+"config"],C=o.Default=U&&U.Default||{},R=o.Style=U&&U.Style||{},G=o.Attr=U&&U.Attr||{},c=o.Color=U&&U.Color||{},y=o.IsGetter=U&&U.IsGetter||{};!function(){var L=!1;try{var B=V.defineProperty({},"passive",{get:function(){L=!0}});_.addEventListener("test",B,B),_.removeEventListener("test",B,B)}catch(K){L=!1}C.passiveSupported=L}();var d,S,X,M,L=C.passiveSupported,q=C.eventListenerOptionsFalse=L?{passive:!1,capture:!1}:!1,F=C.eventListenerOptionsTrue=L?{passive:!1,capture:!0}:!0,O=Math,u=O.round,B=O.floor,h=O.ceil,v=O.sqrt,K=O.max,m=O.min,f=O.abs,T=O.cos,D=O.acos,W=O.sin,n=O.pow,Q=O.asin,E=O.PI,i=2*E,b=E/2,e=O.tan,Y=O.atan2,A=O.random,r=O.log,k=!0,P=!1,a=_.parseInt||global.parseInt,N="2018-10-31",g=_.navigator?_.navigator.platform.indexOf("Win")>-1:!1,t=function(z){return z*z},w=_.setTimeout,H=_.clearTimeout,l=_.location,J=_.navigator?_.navigator.userAgent.toLowerCase():"",x=function(T){return T.test(J)},s=x(/msie/),$=x(/msie/)||x(/trident/),p=x(/msie 10/),np=x(/edge/),pp=x(/firefox/),Mj=x(/mac/),Xm=C.isTouchable===Z?g?!1:z?"ontouchend"in z:!1:C.isTouchable,wr="default",$h="single",Gr="multiple",Zp="front",_m="back",_h="left",De="right",Rd="top",Yf="bottom",lr="center",xg="eye",rk="middle",Hp="east",gs="west",zi="north",Fo="none",hr="px",Vp="absolute",nm="border",ph="triangle",am="rect",Xr="circle",An="cylinder",Be="shape",Ir="items",ge="normal",Wg="remove",kf="clear",Qd="width",wi="height",tl="ingroup",ke="check",Np="uncheck",sp="radio",Ck="radioOn",ab="radioOff",Rl="points",rr="values",im="series",fp="body",Ko="label",ir="label2",Ub="note",tp="note2",Lr="icons",ce="labelFont",bq="labelColor",cm="labelSelectColor",Je="note.expanded",Dc="note2.expanded",Kc="edge.expanded",qn="edge.points",pj="edge.type",qo="rotation",Co="hidden",qs="visible",wb="tuv",Mc="no",sq="draw",ud="select",$k="currentSubGraph",Dh="selectBackground",qh="autoMakeVisible",fb="autoHideScrollBar",vo="scrollBarColor",Zb="scrollBarSize",mq="indent",yc="rowHeight",Oq="columnLineColor",vj="rowLineColor",tg="columnLineVisible",fr="rowLineVisible",yd="visibleFunc",Td="expandIcon",Eb="collapseIcon",mm="checkMode",zf="sortFunc",ur="editable",ie="batchEditable",Jm="tristate",rj="asc",He="desc",ob="position",Ab="elevation",Jq="children",Bi="translateX",Bc="translateY",xp="dataModel",Wi="maxSize",Ho="shape3d",fi="shape3d.resolution",Vf="shape3d.visible",eb="shape3d.from.visible",Uq="shape3d.to.visible",Li="shape3d.top.visible",zl="shape3d.bottom.visible",ui="repeat.uv.length",Rh="serializeValue",qd="deserializeValue",Rb="centerUniform",xf="uniform",wq="rgba(255,255,255,0)",vi="style",rs="attr",bf="field",ei="string",jj="boolean",hs="color",Vi="int",Ej="number",Bm="ew-resize",Ip="ns-resize",hc="pointer",of="auto",sd="mousedown",Wr="mousemove",Fj="mouseup",Id="mouseout",gn="touchstart",xr="touchmove",pg="touchend",zr="keydown",Ao="keyup",$j=["DOMMouseScroll","mousewheel"],bl=pp?$j[0]:$j[1],Ji=Xm?[gn,xr,pg,zr,Ao,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[zr,Ao,"keypress","input",sd,Wr,Fj,Id,bl,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],zo=I,Sm=I,Ic=I,Yh=Fj.length,wh=function(){Ic&&(H(Ic.timeout),Ic=I)},dh=function(){Ic&&gm(Ic.e,Ic.info)};_.addEventListener&&(Xm||(_.addEventListener(Id,function(){wh()},q),_.addEventListener(bl,function(){zh()},q)),_.addEventListener(Ao,function(C){91===C.keyCode?Tj={}:delete Tj[C.keyCode]},F),_.addEventListener(zr,function(W){Tj[W.keyCode]=!0},F),_.addEventListener("blur",function(){Tj={}},q));var Lo,Pl,Re,rf=0,Am=I,Si=function(u,U){var n=w(function(){delete Am[n],Nl(Am)&&(Am=I),u()},U);return n},cc=I,Bk=I,Qi={},Pp={},Wm={},Lq={},Ue={},Tj={},Pj={},So={},Zq={},kn={},Yj=/.json$/,ls=/^data:image\/svg\+xml/,Vb={},cb=[],Mg={},Ad=I,Pm=I,kg=function(){},ak=function(){throw"Oops!"},Kb=[0,0,0],Dq=[0,0,0,0],Lg={x:0,y:0,width:0,height:0},ji=I,Kp=I,Le=I,te=function(V){Kp&&!V._72O&&(Le||(Le={}),Le[V._72O=Md()]=V),Lo!=I?Tl()<.05&&M&&!Pl&&(Fb=wh):Fb=Ep},Pc=function(P,d,y,U){Kp||(Kp={});var g=Kp[P];if(g){if(g.url===d)return;g.image?(g.image.onload=kg,g.image.onerror=kg):g.request&&(g.request.onload=kg,g.request.onerror=kg)}if(Yj.test(d)){var B=new xn;if(Kp[P]={request:B,url:d},d=C.beforeLoadURL(d),d.data){var x=C.parse(d.data);Zf(P,x),C.handleImageLoaded(P,x)}else{B.onload=function(V){if(200===this.status||0===this.status){var b=C.parse(V.target.response||V.target.responseText);Zf(P,b),C.handleImageLoaded(P,b)}else Zf(P,C.handleUnfoundImage(P,d)||I)},B.onerror=function(){Zf(P,C.handleUnfoundImage(P,d)||I)};var M={};M.url=encodeURI(d),M.sync=!1,B.send(M)}}else{var x=new Image;Kp[P]={image:x,url:d},/^data:image/.test(d)||(d=C.beforeLoadURL(d),d=C.appendTimeStamp(d),d=encodeURI(d),x.crossOrigin=C.crossOrigin),C.convertImageSrc(d,function(F){$&&(d.toLowerCase().indexOf(".svg")>0||ls.test(d))?(z.body.appendChild(x),x.style.visibility="hidden",x.onload=function(){w(function(){if(y&&(x.width=y),U&&(x.height=U),!x.width||!x.height){var T=x.width||x.clientWidth,M=x.height||x.clientHeight;x.width=T,x.height=M}C.handleImageLoaded(P,x),Zf(P,x),z.body.removeChild(x),x.style.visibility=""},180)},x.onerror=function(){Zf(P,C.handleUnfoundImage(P,d)||I),z.body.removeChild(x),x.style.visibility=""}):(x.onload=function(){y&&(x.width=y),U&&(x.height=U),C.handleImageLoaded(P,x),Zf(P,x)},x.onerror=function(){Zf(P,C.handleUnfoundImage(P,d)||I)}),x.src=F})}},Zf=function(h,s){if(Pp[h]=s,delete Kp[h],Nl(Kp)&&(Kp=I,Le)){for(var V in Le){var C=Le[V];C._2O&&(C._2O={}),C.invalidateAll&&C.invalidateAll(Z,"imageLoaded",h),C.redraw&&C.redraw(),C.iv(),delete C._72O}Le=I}if(s&&Le)for(var V in Le){var C=Le[V];C.invalidateAll&&C.invalidateAll(Z,"imageLoading",h),C.redraw&&C.redraw(),C.iv()}},Xc=function(){return r=O&&Date,function(){return _.performance&&_.performance.now?_.performance.now():Date.now()}}(),Og=function(e,v){v?H(e):_.cancelAnimationFrame(e)},Bg=function(b,c,V){return{width:b,height:c,comps:sk(V)?V:[V]}},oc=function(X,L){return{type:Xr,rect:[X,L,1.6,1.6],borderWidth:1,borderColor:Qj,gradient:on,gradientColor:qj,background:Qj}},Kf=function(F,r){return Bg(16,16,{type:ph,rect:[4,4,10,8],background:F,rotation:r?1.57:3.14})},Pn=function(d,c){return Bg(16,16,{type:ph,rect:[4,4,8,7],background:d,rotation:c?3.14:0})},tj=function(U){var D=U._orientation;return"horizontal"===D||"h"===D},Xg=function(g){var m=I||4,A=I||1,j=I||1;0>m?m=0:m>.25&&(m=.25);var D,c,o,O,B,w,e,N=.5,l=[],y=[],M=[],Z=i/j,u=i/A,$=N-m;for(c=0;A>=c;c++)for(O=-E+c*u,w=T(O),B=W(O),D=0;j>=D;D++)o=D*Z,e=$+m*w,l.push(T(o)*e,B*m,-W(o)*e),(S=g)&&y.push(D/j,1-c/A);for(c=0;A>c;c++){var X=c*(j+1),C=(c+1)*(j+1);for(D=0;j>D;D++)M.push(X+D,C+D+1,C+D,X+D,X+D+1,C+D+1),nl.z=so.z=g}},cp=function(D){var y=2,V=0;for(var f in D)f.length===y&&a(f,32)===cf&&(Ad=Pm=D[f]),V++;return V},kl=function(w,h,S,N){return S||(S=Xm?5:3,S/=N||1),{x:w-S,y:h-S,width:2*S,height:2*S}},dj=function(Y,y,d,J){var j=this;y||(y=Xm?5:3,d=20,J=20);var m={x:Y,y:y,width:d,height:J};if(d)for(var n=0;d>n;n++)if(3===d)J=20;else for(var k=0;J>k;k++)j=_?_:d;var A={x:E,y:2*E};if(Hd(m,A)){var t=wi[0]+Rd[0]+kf[1]+(rj.length-1);Yq[xg]=j[t],j[t]=mh[xg]}},zn=function(Q){return(/ble$/.test(Q)||/ed$/.test(Q)||y[Q]?"is":"get")+Q.charAt(0).toUpperCase()+Q.slice(1)},mh=function(R){return"set"+R.charAt(0).toUpperCase()+R.slice(1)},hf=function(D){return typeof D===ei||D instanceof String},ip=function(E){return typeof E===Ej},Ep=function(Y){return typeof Y===jj},Ui=function(K){return K&&"object"==typeof K},rn=function(C){return"function"==typeof C},sk=function(e){return e instanceof Array},xq=function(a){return a instanceof mk},Lm=function(d){return sk(d)?new mk(d):d},Cd=function(n){return n instanceof Xp},eq=function(h){return h instanceof pm},bn=function(S){return S instanceof og},km=function(M,j){if(!(M instanceof o.Group))return!1;if(!j)return M.isExpanded();var k=j.getDataUI(M);return k&&k._88I?!0:!1},Ob=function(N){return N instanceof lj},Sr=function(D){return D&&"IFRAME"===D.tagName},In=function(D){return D==I||C.numberDigits==I?D:parseFloat(D.toFixed(C.numberDigits))},sm=function(L,w,Q){var N,g=w.length;if(Q)for(var q=0;Q>q;q++)if(3===g)L.push(w[0]),L.push(w[1]),L.push(w[2]);else for(N=0;g>N;N++)L.push(w[N]);else if(3===g)L.push(w[0]),L.push(w[1]),L.push(w[2]);else for(N=0;g>N;N++)L.push(w[N])},Ld=function(_){return _?Ui(_)?_:{}:!1},hj=function(y,W,p){var f,$=Ui(y)?y:y.prototype;for(f in W)p&&$[f]!==Z||($[f]=W[f]);return y},oj=function(k){return String.fromCharCode(k)},ao=function(s){for(var S,D=0,u="";D<s.length;D++)S=s[s.length-1-D],"%"===S?S="'":"a"===S?S='"':"]"===S&&(S="\\"),u+=oj(S.charCodeAt(0)-1);return u},lp=function(T,c,Y){T.superClass.constructor.apply(c,Y)},Nl=function(m){for(var z in m)return!1;return!0},_o=function(b){return b?0===b.length:!0},Ff=function(){var $="";return[Np[0],vj[0],Ko[0]].forEach(function(g){$+=mh(g).slice(3)}),xf=z&&z[$]||Rb,function(d,C){return d===C?!0:d.x===C.x&&d.y===C.y&&d.width===C.width&&d.height===C.height}}(),fc=function(I,A,E){return A>I?A:I>E?E:I},Ap=function(y){return 0>y?-1:y>0?1:0},Tl=function(){var y=1e4*W(Yh++);return y-B(y)},Ll=function(J,q,H){return Cq(J.x,J.y,q.x,q.y,H.x,H.y,H.x+H.width,H.y,!0)||Cq(J.x,J.y,q.x,q.y,H.x+H.width,H.y,H.x+H.width,H.y+H.height,!0)||Cq(J.x,J.y,q.x,q.y,H.x+H.width,H.y+H.height,H.x,H.y+H.height,!0)||Cq(J.x,J.y,q.x,q.y,H.x,H.y+H.height,H.x,H.y,!0)},Cq=function(y,F,d,s,a,Q,X,w,L){var t=(X-a)*(F-Q)-(w-Q)*(y-a),r=(w-Q)*(d-y)-(X-a)*(s-F);if(0!==r){var z=t/r,A=y+z*(d-y),p=F+z*(s-F);return L&&(A+On<m(y,d)||A-On>K(y,d)||A+On<m(a,X)||A-On>K(a,X)||p+On<m(F,s)||p-On>K(F,s)||p+On<m(Q,w)||p-On>K(Q,w))?I:[A,p]}return I},mb=function(D,d,u){if(D&&u)if(d){if(d===vi)return D.getStyle(u);if(d===rs)return D.getAttr(u);if(d===bf)return D[u]}else if(u=zn(u),D[u])return D[u]();return Z},Nj=function(H,u,g,I){if(H&&g)if(u){if(u===vi)H.s(g,I);else if(u===rs)H.a(g,I);else if(u===bf){var D=H[g];H[g]=I,H.fp("f:"+g,D,I)}}else g=mh(g),H[g]&&H[g](I)},bc=function(t,L,r){return L&&"top"!==L?"bottom"===L?{x:t.x,y:t.y,width:t.width,height:t.height*r}:"right"===L?{x:t.x,y:t.y,width:t.width*r,height:t.height}:"left"===L?{x:t.x+t.width*(1-r),y:t.y,width:t.width*r,height:t.height}:void 0:{x:t.x,y:t.y+t.height*(1-r),width:t.width,height:t.height*r}},up=function(M,C,Z,g,i){C&&Uc(M,Z,g,1,i,C)},bm=function(f,G,p,j){var g=1-f;return g*g*G+2*f*g*p+f*f*j},nl=function(a,J,q,t,N){var y=1-a;return y*y*y*J+3*y*y*a*q+3*y*a*a*t+a*a*a*N},Cg=function(m){var f,T,y,z,J=0;return m.forEach(function(b){if(f=b.length,f>0)for(T=b[0],z=1;f>z;z++)y=b[z],J+=cd(T,y),T=y}),J},po=function(K,u,f){var h="__"+K,j=function(U){f.disabled||f["handle_"+K](U)};f[h]||(f[h]=j,u.addEventListener(K,j,q))},tq=function(j,_,Q){var H="__"+j,o=Q[H];o&&(_.removeEventListener(j,o,q),delete Q[H])},Mo=function(_,d){var Y="_"+d;_[zn(d)]=function(){return this[Y]},_[mh(d)]=function(f){var c=this[Y];this[Y]=f,this.fp(d,c,f)}},qe=function(j){return V.create(j)},Hi=function(w){if(!w.element){var G,v;(G=w.textField)?v=ll(Mh.TextField,G):(G=w.textArea)?v=ll(Mh.TextArea,G):(G=w.button)?v=ll(Mh.Button,G):(G=w.comboBox)?v=ll(Mh.ComboBox,G):(G=w.checkBox)?v=ll(Mh.CheckBox,G):(G=w.radioButton)?v=ll(Mh.RadioButton,G):(G=w.slider)?v=ll(Mh.Slider,G):(G=w.colorPicker)?v=ll(Mh.ColorPicker,G):(G=w.image)&&(v=ll(Mh.Image,G)),v&&(w.element=v)}},zg=function(h,M){var U=jd(h);return U._ht=M,U},jd=function(x,h){var H=z.createElement("div"),Y=H.style;return H.tabIndex=-1,H.onkeydown=Pd,Y.msTouchAction=Fo,_i(H,I,0),Xm&&Y.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",I),x&&(Y.overflow=Co),h&&yj(h,H),H},wo=function(_,w){var D=z.createElement("canvas"),W=D.style;return W.msTouchAction=Fo,w||(W.pointerEvents=Fo),_i(D,I,0),_&&yj(_,D),D},_i=function(R,a,N){var g=R.style;g.border=a?a+" solid 1px":0,g.outline=0,g.padding=N?"0 "+N+hr:0,Qq(R)},Qq=function(i){var H=i.style;H.position=Vp,H.margin=0,H.setProperty("box-sizing","border-box",I),H.setProperty("-moz-box-sizing","border-box",I)},sg=function(D,g,P,C){C||(C=kp),g!=I&&(D.width=g*C,D.style.width=g+hr),P!=I&&(D.height=P*C,D.style.height=P+hr)},yj=function(t,z,g){t.appendChild(z),g&&(z.style.position=Vp)},js=function(R,f){f.split||(f+="");for(var P,i=f.split("\n"),z=0,V=i.length,W=0;V>W;W++){var g=ho(R.font,i[W]);g.width>z&&(z=g.width),P||(P=g.height)}return R.ss=i,{width:z,height:P*V}},vs=function(p,q,G,f,y,E){var g=q.length;if(1===g)Fc(p,q[0],G,f,y);else for(var r=G.height/g,N={x:G.x,y:G.y,width:G.width,height:r},s=0;s<q.length;s++)E?Ni(p,q[s],f,y,N.x,N.y,N.width,N.height,E):Fc(p,q[s],N,f,y),N.y+=r},Fc=function(M,Y,O,B,o){M.font=B?B:Km,M.fillStyle=o?o:Dd,M.textAlign=lr,M.textBaseline=rk;var f,p;O?O.width===Z?(f=O.x,p=O.y):(f=O.x+O.width/2,p=O.y+O.height/2):(f=0,p=0),M.fillText(Y,u(f),u(p))},Up=function(o){o.getView&&(o=o.getView());var T=o.offsetWidth||o.scrollWidth;return!T&&o.style.width&&(T=a(o.style.width)),T},Wc=function(V){V.getView&&(V=V.getView());var I=V.offsetHeight||V.scrollHeight;return!I&&V.style.height&&(I=a(V.style.height)),I},to=function(c,M,O){var x=M[0].toUpperCase()+M.substring(1,M.length);c["webkit"+x]=O,c["moz"+x]=O,c["ms"+x]=O,c["o"+x]=O,c[M]=O},Gi=function(){var O=function(a){Pd(a),a.stopPropagation()},B=function(m){Pd(m)},U=Xm?[gn]:[zr,sd];return function(A,y){var E=jd(),R=E.style;return R.backgroundColor=C.disabledBackground,A&&(R.backgroundImage="url("+A+")",R.backgroundPosition="50% 50%",R.backgroundRepeat="no-repeat no-repeat"),y===!1?U.forEach(function(f){E.addEventListener(f,B,q)}):U.forEach(function($){E.addEventListener($,O,q)}),E}}(),Yl=function(V){var E=V.getContext("2d");return E.save(),E.lineCap=vn,E.lineJoin=Zm,E},Fb=function(F,V,A,q){Uf(F,V*kp,A*kp),q*=kp,1!==q&&F.scale(q,q)},Uf=function(G,n,F){G.translate(n,F)},Fq=function(t,V){V&&t.rotate(V)},mn=function(K,A,X){A===Z&&(A=1),X===Z&&(X=1),(1!==A||1!==X)&&K.scale(A,X)},Gl=!1,mr=function(D){var k=z.activeElement;if(z.activeElement!==D){k&&k.forceOnblur&&k.forceOnblur();for(var n=[],Z=D.parentNode;Z;)n.push([Z,Z.scrollLeft,Z.scrollTop]),Z=Z.parentNode;if(!Gl){var e=[],d=[];try{for(var q=_.parent,w=_;q!==w;)e.push([q,q.scrollX,q.scrollY]),w=q,q=_.parent;var g=_.frameElement;if(g)for(var M=g.parentNode;M;)d.push([M,M.scrollLeft,M.scrollTop]),M=M.parentNode}catch(r){Gl=!0}}if(Xm)D.focus();else{var s=Ef(),W=s.target;D.focus(),W.scrollLeft=s.left,W.scrollTop=s.top}n.forEach(function(g){g[0].scrollLeft=g[1],g[0].scrollTop=g[2]}),Gl||(e.forEach(function(j){j[0].scrollTo(j[1],j[2])}),d.forEach(function(Y){Y[0].scrollLeft=Y[1],Y[0].scrollTop=Y[2]}))}},hi=function(T){return T&&T.getView?T.getView():T},Pi=function(I,q,P,s,Q){if(2===arguments.length&&(P=q.y,s=q.width,Q=q.height,q=q.x),I.isSelfViewEvent)I.setX(q),I.setY(P),I.setWidth(s),I.setHeight(Q);else{var r=hi(I),h=r.style;if((z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement)!==r)q!==Z&&(h.left=q+hr),P!==Z&&(h.top=P+hr),s!==Z&&(h.width=s+hr),Q!==Z&&(h.height=Q+hr);else{var Y=C.getWindowInfo();h.left=(q=Y.left)+hr,h.top=(P=Y.top)+hr,h.width=(s=Y.width)+hr,h.height=(Q=Y.height)+hr}I.endEditing&&!Xm&&I.endEditing(),I.redraw&&I.redraw(),I.invalidate&&I.invalidate(),I.onLayouted&&I.onLayouted(q,P,s,Q),I.fireViewEvent&&I.fireViewEvent("layout")}},sc=function(v){if(!v.touches)return v;var I=v.touches[0];return I?I:v.changedTouches[0]},Qc=function(L){return Xm?sc(L).target:L.target},Fn=function(Y){C.popup&&C.popup.close(),C.popup=Y},Vo=I,gq=function(Q){Vo.handleWindowTouchMove(Q)},Yg=function(h){Vo.handleWindowTouchEnd(h),_.removeEventListener(xr,gq,q),_.removeEventListener(pg,Yg,q),Vo=I},Uh=function(Y){Vo.handleWindowMouseMove(Y)},li=function(d){Vo.handleWindowMouseUp(d),_.removeEventListener(Wr,Uh,q),_.removeEventListener(Fj,li,q),Vo=I},Jr=function(q){return 1===lg(q)},Br=function(t,n){return n?n.keyCode===t:Tj[t]},Kn=function(B){return Hg(B)&&Br(65,B)},as=function(P){return Br(46,P)||Br(8,P)},dm=function(K){return function(T){return T?T.keyCode===K:Tj[K]}},cf=573,Fh=[65,83,68,87,37,38,39,40,32,13,27],ym=dm(Fh[0]),xd=dm(Fh[1]),vc=dm(Fh[2]),pq=dm(Fh[3]),Fp=dm(Fh[4]),sh=dm(Fh[5]),vd=dm(Fh[6]),qc=dm(Fh[7]),ci=dm(Fh[8]),Bo=dm(Fh[9]),br=dm(Fh[10]),Un={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Fi=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,5,29,41],il=I,qr=I,_j=function(y,A){il||(il=wo()),sg(il,y,A,1);var n=Yl(il);return n.clearRect(0,0,y,A),n},Xj=function(){var u,w={};for(var b in _){var X=Gr.length;if(b.length==X&&b[0]===Gr[2]&&b[1]===Fo[1]&&b[4]===Gr[3]&&b[5]===Gr[4]&&b.substr(X-2)===Fo[1]+Fo[2]){var O=_[b];for(var P in O)P.length===X&&P.substr(0,3)===De[3]+Wg[3]+ud[0]&&P.substr(X-2)===Gr[0]+Ub[3]&&($j=O[P])}}return function(x){var D,d=w[x];return d||(u||(u=wo(),sg(u,1,1,1)),D=u.getContext("2d"),D.clearRect(0,0,1,1),Uc(D,0,0,1,1,x),d=D.getImageData(0,0,1,1).data,d=w[x]=[d[0],d[1],d[2],d[3]]),d}}(),fh=function(J){if(!hf(J))return J;var Z=Xj(J);return Z.CA||(Z.CA=[Z[0]/255,Z[1]/255,Z[2]/255,Z[3]/255]),Z.CA},Wp=function(A,R,X,q,p){var J=wo();J.width=X,J.height=q;var H=J.getContext("2d");H.drawImage(A,0,0,X,q);try{for(var F=H.getImageData(0,0,X,q),e=F.data,U=0,K=e.length;K>U;U+=4){var y=e[U+0],D=e[U+1],_=e[U+2],w=e[U+3];"override_a"===p?e[U+3]=255*R[3]:"override_rgb"===p?(e[U+0]=255*R[0],e[U+1]=255*R[1],e[U+2]=255*R[2]):"override"===p?(e[U+0]=255*R[0],e[U+1]=255*R[1],e[U+2]=255*R[2],e[U+3]=255*R[3]):(e[U+0]=R[0]*y,e[U+1]=R[1]*D,e[U+2]=R[2]*_,e[U+3]=R[3]*w)}H.putImageData(F,0,0)}catch(G){return A}return J},Yq=function(M,j,O){return j&&(j="miter"===O?8*j+20:j+1,M&&Bs(M,j)),j},nc=function(h,U){if(U){var $=new lh(U),q=h.width/2,O=h.height/2,S=we([$.tf(-q,-O),$.tf(q,-O),$.tf(q,O),$.tf(-q,O)]);return S.x+=h.x+q,S.y+=h.y+O,S}return h},Ii=function(k,o,C,h,L,N,K,e){h*=Math.PI/180;var D={x:Math.cos(h)*(k.x-K.x)/2+Math.sin(h)*(k.y-K.y)/2,y:-Math.sin(h)*(k.x-K.x)/2+Math.cos(h)*(k.y-K.y)/2},F=Math.pow(D.x,2)/Math.pow(o,2)+Math.pow(D.y,2)/Math.pow(C,2);F>1&&(o*=Math.sqrt(F),C*=Math.sqrt(F));var f=(L==N?-1:1)*Math.sqrt((Math.pow(o,2)*Math.pow(C,2)-Math.pow(o,2)*Math.pow(D.y,2)-Math.pow(C,2)*Math.pow(D.x,2))/(Math.pow(o,2)*Math.pow(D.y,2)+Math.pow(C,2)*Math.pow(D.x,2)));isNaN(f)&&(f=0);var q={x:f*o*D.y/C,y:f*-C*D.x/o},r={x:(k.x+K.x)/2+Math.cos(h)*q.x-Math.sin(h)*q.y,y:(k.y+K.y)/2+Math.sin(h)*q.x+Math.cos(h)*q.y},g=function(C){return Math.sqrt(Math.pow(C[0],2)+Math.pow(C[1],2))},p=function(T,s){return(T[0]*s[0]+T[1]*s[1])/(g(T)*g(s))},J=function(R,t){return(R[0]*t[1]<R[1]*t[0]?-1:1)*Math.acos(p(R,t))},u=J([1,0],[(D.x-q.x)/o,(D.y-q.y)/C]),U=[(D.x-q.x)/o,(D.y-q.y)/C],d=[(-D.x-q.x)/o,(-D.y-q.y)/C],Y=J(U,d);p(U,d)<=-1&&(Y=Math.PI),p(U,d)>=1&&(Y=0);var p=o>C?o:C,E=o>C?1:o/C,c=o>C?C/o:1;if(null==e){var R={x:0,y:0,width:0,height:0};Bs(R,p),R.x*=E,R.width*=E,R.y*=c,R.height*=c;var I=new lh(h);return R=we([I.tf(R.x,R.y),I.tf(R.x+R.width,R.y),I.tf(R.x+R.width,R.y+R.height),I.tf(R.x,R.y+R.height)]),R.x+=r.x,R.y+=r.y,[{x:R.x,y:R.y},{x:R.x+R.width,y:R.y},{x:R.x+R.width,y:R.y+R.height},{x:R.x,y:R.y+R.height}]}e.translate(r.x,r.y),e.rotate(h),e.scale(E,c),e.arc(0,0,p,u,u+Y,1-N),e.scale(1/E,1/c),e.rotate(-h),e.translate(-r.x,-r.y)},jg=function(M,X){M&&M.beginPath();for(var R,i,t,G=[],_=function(H){for(var i,v=/(\-{0,1}[\d\.]+)/gi,y=[];i=v.exec(H);)y.push(parseFloat(i[0]));return y},L=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,x={x:0,y:0};R=L.exec(X);){var K=R[0],J=K.substr(0,1);if("M"===J||"m"===J){for(var F=_(K),l=0;l<F.length;l+=2){var v=F[l],E=F[l+1];"m"===J&&(v+=x.x,E+=x.y),M&&M.moveTo(v,E),G.push({x:v,y:E}),x.x=v,x.y=E}i=t=null}else if("H"===J||"h"===J){for(var F=_(K),l=0;l<F.length;l+=1){var v=F[l];"h"===J&&(v+=x.x),M&&M.lineTo(v,x.y),G.push({x:v,y:x.y}),x.x=v}i=t=null}else if("C"===J||"c"===J){for(var F=_(K),l=0;l<F.length;l+=6){var Y=F[l],$=F[l+1],c=F[l+2],b=F[l+3],v=F[l+4],E=F[l+5];"c"===J&&(Y+=x.x,$+=x.y,c+=x.x,b+=x.y,v+=x.x,E+=x.y),M&&M.bezierCurveTo(Y,$,c,b,v,E),G.push({x:Y,y:$}),G.push({x:c,y:b}),G.push({x:v,y:E}),x.x=v,x.y=E}i=[Y,$,c,b,v,E],t=null}else if("S"===J||"s"===J){for(var F=_(K),l=0;l<F.length;l+=4){var Y,$;i?(Y=2*i[4]-i[2],$=2*i[5]-i[3]):(Y=x.x,$=x.y);var c=F[l],b=F[l+1],v=F[l+2],E=F[l+3];"s"===J&&(c+=x.x,b+=x.y,v+=x.x,E+=x.y),M&&M.bezierCurveTo(Y,$,c,b,v,E),G.push({x:Y,y:$}),G.push({x:c,y:b}),G.push({x:v,y:E}),x.x=v,x.y=E}i=[Y,$,c,b,v,E],t=null}else if("Q"===J||"q"===J){for(var F=_(K),l=0;l<F.length;l+=4){var Y=F[l],$=F[l+1],v=F[l+2],E=F[l+3];"q"===J&&(Y+=x.x,$+=x.y,v+=x.x,E+=x.y),M&&M.quadraticCurveTo(Y,$,v,E),G.push({x:Y,y:$}),G.push({x:v,y:E}),x.x=v,x.y=E}i=null,t=[Y,$,v,E]}else if("T"===J||"t"===J){for(var F=_(K),l=0;l<F.length;l+=2){var Y,$;t?(Y=2*t[2]-t[0],$=2*t[3]-t[1]):(Y=x.x,$=x.y);var v=F[l],E=F[l+1];"t"===J&&(v+=x.x,E+=x.y),M&&M.quadraticCurveTo(Y,$,v,E),G.push({x:Y,y:$}),G.push({x:v,y:E}),x.x=v,x.y=E}i=null,t=[Y,$,v,E]}else if("V"===J||"v"===J){for(var F=_(K),l=0;l<F.length;l+=1){var E=F[l];"v"===J&&(E+=x.y),M&&M.lineTo(x.x,E),G.push({x:x.x,y:E}),x.y=E}i=t=null}else if("L"===J||"l"===J){for(var F=_(K),l=0;l<F.length;l+=2){var v=F[l],E=F[l+1];"l"===J&&(v+=x.x,E+=x.y),M&&M.lineTo(v,E),G.push({x:v,y:E}),x.x=v,x.y=E}i=t=null}else if("A"===J||"a"===J){for(var F=_(K),l=0;l<F.length;l+=7){var a=F[l],y=F[l+1],z=F[l+2],H=F[l+3],C=F[l+4],v=F[l+5],E=F[l+6];"a"===J&&(v+=x.x,E+=x.y);var h=Ii(x,a,y,z,H,C,{x:v,y:E},M);h&&(G=G.concat(h)),x.x=v,x.y=E}i=t=null}var w=K.substr(K.length-1);("z"===w||"Z"===w)&&M&&M.closePath()}return G},Ol=function(h,F){var P,n,E="L"===F[0],U=F.length;for(h.save(),E?(h.transform(F[5],F[6],F[7],F[8],F[9],F[10]),P=h.createLinearGradient(F[1],F[2],F[3],F[4]),n=11):(h.transform(F[7],F[8],F[9],F[10],F[11],F[12]),P=h.createRadialGradient(F[1],F[2],F[3],F[4],F[5],F[6]),n=13);U>n;)P.addColorStop(F[n],F[n+1]),n+=2;h.fillStyle=P},so=function(h,Z){var I=h.s("shape.gradient.pack");if(I){for(var Q=I.length,F=new Array(Q),K=0;Q>K;K++)F[K]=I[K];var i,D,B,o,p,G,x,c,J,W,f,M,O,T="L"===F[0];i=T?5:7,D=F[i],B=F[i+1],o=F[i+2],p=F[i+3],G=F[i+4],x=F[i+5],c=Z[0],J=Z[1],W=Z[2],f=Z[3],M=Z[4],O=Z[5],F[i]=c*D+W*B,F[i+1]=J*D+f*B,F[i+2]=c*o+W*p,F[i+3]=J*o+f*p,F[i+4]=c*G+W*x+M,F[i+5]=J*G+f*x+O,h.s("shape.gradient.pack",F)}},Xd=function(U,P,M,Y){var D=!1;if(U.beginPath?U.beginPath():D=!0,xq(P)&&(P=P._as),xq(M)&&(M=M._as),M&&M.length){for(var G,I,N,Z,y=0,S=0,K=M.length;K>S;S++)G=M[S],1===G?(I=P[y++],U.moveTo(I.x,D?-I.y:I.y)):2===G?(I=P[y++],U.lineTo(I.x,D?-I.y:I.y)):3===G?(I=P[y++],N=P[y++],U.quadraticCurveTo(I.x,D?-I.y:I.y,N.x,D?-N.y:N.y)):4===G?(I=P[y++],N=P[y++],Z=P[y++],U.bezierCurveTo(I.x,D?-I.y:I.y,N.x,D?-N.y:N.y,Z.x,D?-Z.y:Z.y)):5===G&&U.closePath();Y&&5!==G&&U.closePath()}else{var i,u,L,l=P.length;if(l>0){for(i=P[0],U.moveTo(i.x,D?-i.y:i.y),u=1;l>u;u++)L=P[u],U.lineTo(L.x,D?-L.y:L.y);Y&&U.closePath()}}},hk=function(C,S,g,Z){if(xq(C)&&(C=C._as),xq(S)&&(S=S._as),S&&S.length){g=g||Yo;for(var H,O,M,z,q,R,j,V,N=[],G=I,Y=0,P=0,o=S.length;o>P;P++)if(H=S[P],1===H)N.push(G=[]),G.push(C[Y++]);else if(2===H)G.push(C[Y++]);else if(3===H){for(O=G[G.length-1],M=C[Y++],z=C[Y++],R=1;g>R;R++)j=bm(R/g,O.x,M.x,z.x),V=bm(R/g,O.y,M.y,z.y),G.push({x:j,y:V,b:!0});G.push(z)}else if(4===H){for(O=G[G.length-1],M=C[Y++],z=C[Y++],q=C[Y++],R=1;g>R;R++)j=nl(R/g,O.x,M.x,z.x,q.x),V=nl(R/g,O.y,M.y,z.y,q.y),G.push({x:j,y:V,b:!0});G.push(q)}else 5===H&&G.push(G[0]);return Z&&5!==H&&G&&G.length>2&&G.push(G[0]),N}return Z&&C.length>2&&(C=C.slice(),C.push(C[0])),C?[C]:[]},jn=function(s,R,L,k,N,U){var x,l,z,D=Xj(R),O=k,q=D[0],T=D[1],t=D[2];if(L){var w=Xj(L);x=w[0]-q,l=w[1]-T,z=w[2]-t}else x=255-q,l=255-T,z=255-t;for(U||(U=k>10?1:.5,U=1>N?m(U/N,2):U);(k-=U)>0;){var H=1-k/O,J=q+x*H,K=T+l*H,j=t+z*H;J=m(h(J),255),K=m(h(K),255),j=m(h(j),255),s.strokeStyle="rgb("+J+","+K+","+j+")",s.lineWidth=k,s.stroke()}},Nd=function(){var S={};return function(v,G){var s=v+"-"+G,Z=S[s];if(Z)return Z;var n,_,C,z=Xj(v);return 0>G?(G=(100+G)/100,n=h(z[0]*G),_=h(z[1]*G),C=h(z[2]*G)):(G/=100,n=z[0],_=z[1],C=z[2],n+=(255-n)*G,_+=(255-_)*G,C+=(255-C)*G,n=m(h(n),255),_=m(h(_),255),C=m(h(C),255)),S[s]="rgb("+n+","+_+","+C+")"}}(),Uc=function(f,c,I,q,R,y){y&&(f.fillStyle=y),f.beginPath(),f.rect(c,I,q,R),f.fill()},Om=function(S,f,C,W,d,Y,w){S.beginPath(),Xo[f](S,C.x,C.y,C.width,C.height,W,d,Y,w)},Gq=function(H,D,E,s,d){var J=Xo[E];H.fillStyle=J?J(H,D,s?s:qj,d.x,d.y,d.width,d.height):D},Oc=function(l,e,r,X,G,A){try{if(!e.tagName&&e.comps){e._cacheImage_||(e._cacheImage_={});var f;f="override"===X?"colors_override":"override_rgb"===X?"colors_override_rgb":"override_a"===X?"colors_override_a":"colors",e._cacheImage_[f]||(e._cacheImage_[f]={__count__:0});var V=e._cacheImage_[f][r];V||(e._cacheImage_[f].__count__>C.imageCacheThreshold&&(e._cacheImage_[f]={__count__:0}),V=o.Default.toCanvas(e,Rn(e),si(e),null,G,A,r,null,X),e._cacheImage_[f][r]=V,e._cacheImage_[f].__count__++),e=V}l.fillStyle=l.createPattern(e,"repeat")}catch(U){l.fillStyle="black"}},lc=function(o,B,k,m,u,D,M){o.save(),o.translate(B,k),o.scale(1,M/D),o.arc(0,0,D,m,u),o.restore()},Lf=function(Y,Z,m,Q,F,K,d,B){var c,J,w,r,I,S,e,N,D,a,G;if(f(F)>2*E&&(F=2*E),I=h(f(F)/(E/4)),c=F/I,J=-c,w=-Q,I>0){S=Z+T(Q)*K,e=m+W(-Q)*d,B?Y.lineTo(S,e):Y.moveTo(S,e);for(var A=0;I>A;A++)w+=J,r=w-J/2,N=Z+T(w)*K,D=m+W(w)*d,a=Z+T(r)*(K/T(J/2)),G=m+W(r)*(d/T(J/2)),Y.quadraticCurveTo(a,G,N,D)}},fl=function(J,i,b,S,C,l,n,w,E){6===arguments.length&&(n=l,w=l,E=l);var G=i+S,N=b+C,D=C>S?2*S:2*C;l=D>l?l:D,n=D>n?n:D,w=D>w?w:D,E=D>E?E:D;var f=.29*E,h=.58*E;J.moveTo(G,N-E),J.quadraticCurveTo(G,N-h,G-f,N-f),J.quadraticCurveTo(G-h,N,G-E,N),f=.29*w,h=.58*w,J.lineTo(i+w,N),J.quadraticCurveTo(i+h,N,i+f,N-f),J.quadraticCurveTo(i,N-h,i,N-w),f=.29*l,h=.58*l,J.lineTo(i,b+l),J.quadraticCurveTo(i,b+h,i+f,b+f),J.quadraticCurveTo(i+h,b,i+l,b),f=.29*n,h=.58*n,J.lineTo(G-n,b),J.quadraticCurveTo(G-h,b,G-f,b+f),J.quadraticCurveTo(G,b+h,G,b+n),J.lineTo(G,N-E)},Qe=function(q,M,G,S,X,C,r){M&&(G=u(G),S=u(S),r||(r=1),q.fillStyle=M,q.beginPath(),q.rect(G,S,r,C),q.rect(G,S,X,r),C-r>0&&q.rect(G,S+C-r,X,r),X-r>0&&q.rect(G+X-r,S,r,C),q.fill())},Mk=function(Q,M,b,c){var z=c.x,i=c.y,j=c.width,F=c.height;if(!(!M||!b||0>=j||0>=F)){var K,x=he(M),N=jo(M),w=b>0;1===b||-1===b?(Q.fillStyle=w?x:N,Q.beginPath(),Q.rect(z,i,1,F),Q.rect(z,i,j,1),Q.fill(),Q.fillStyle=w?N:x,Q.beginPath(),Q.rect(z,i+F-1,j,1),Q.rect(z+j-1,i,1,F),Q.fill()):(b=m(f(b),m(j/2,F/2)),K=Q.createLinearGradient(z,i,z+b,i),K.addColorStop(0,w?x:N),K.addColorStop(1,M),Q.fillStyle=K,Q.beginPath(),Q.moveTo(z,i),Q.lineTo(z+b,i+b),Q.lineTo(z+b,i+F-b),Q.lineTo(z,i+F),Q.lineTo(z,i),Q.fill(),K=Q.createLinearGradient(z,i,z,i+b),K.addColorStop(0,w?x:N),K.addColorStop(1,M),Q.fillStyle=K,Q.beginPath(),Q.moveTo(z,i),Q.lineTo(z+b,i+b),Q.lineTo(z+j-b,i+b),Q.lineTo(z+j,i),Q.lineTo(z,i),Q.fill(),K=Q.createLinearGradient(z,i+F,z,i+F-b),K.addColorStop(0,w?N:x),K.addColorStop(1,M),Q.fillStyle=K,Q.beginPath(),Q.moveTo(z,i+F),Q.lineTo(z+b,i+F-b),Q.lineTo(z+j-b,i+F-b),Q.lineTo(z+j,i+F),Q.lineTo(z,i+F),Q.fill(),K=Q.createLinearGradient(z+j,i,z+j-b,i),K.addColorStop(0,w?N:x),K.addColorStop(1,M),Q.fillStyle=K,Q.beginPath(),Q.moveTo(z+j,i),Q.lineTo(z+j-b,i+b),Q.lineTo(z+j-b,i+F-b),Q.lineTo(z+j,i+F),Q.lineTo(z+j,i),Q.fill())}},bi=function(W,X,j,P,K,Z,H){var S=W.createLinearGradient(P,K,Z,H);return S.addColorStop(0,j),S.addColorStop(1,X),S},Wd=function(m,G,U,o,C,J,K){var g=m.createLinearGradient(o,C,J,K);return g.addColorStop(0,G),g.addColorStop(.5,U),g.addColorStop(1,G),g},_p=function(e,B,A,T,Y,x,p){var t=e.createLinearGradient(T,Y,x,p);return t.addColorStop(0,B),t.addColorStop(1/3,A),t.addColorStop(2/3,B),t.addColorStop(1,A),t},xj=function(Q,$,V,e,s,Z,r,X,F){var n=Q.createRadialGradient(e+Z*X,s+r*F,m(Z,r)/24,e+Z/2,s+r/2,K(Z,r)/2);return n.addColorStop(0,V),n.addColorStop(1,$),n},Xo={polygon:function(O,n,Q,$,e,F){(F==I||3>F)&&(F=6);for(var z,N,v=m($,e)/2,s=n+$/2,y=Q+e/2,b=0,U=2*E/F,h=0;F>h;h++)z=s+T(b)*v,N=y+W(b)*v,0===h?O.moveTo(z,N):O.lineTo(z,N),b+=U;O.closePath()},arc:function(S,r,N,e,h,H,c,t,z){H==I&&(H=E),c==I&&(c=i),t==I&&(t=!0);var O=r+e/2,g=N+h/2;t&&S.moveTo(O,g),z?lc(S,O,g,H,c,e/2,h/2):S.arc(O,g,m(e,h)/2,H,c),t&&S.closePath()},rect:function(b,y,K,i,E){b.rect(y,K,i,E)},circle:function(K,p,J,e,A){K.arc(p+e/2,J+A/2,m(e,A)/2,0,i,!0)},oval:function(s,N,z,L,j){lc(s,N+L/2,z+j/2,0,i,L/2,j/2)},roundRect:function(w,Y,s,p,L,t){t==I&&(t=m(m(p,L)/4,8)),fl(w,Y,s,p,L,t)},star:function(z,J,c,w,K){var W=2*w,L=2*K,i=J+w/2,$=c+K/2;z.moveTo(i-W/4,$-L/12),z.lineTo(J+.306*w,c+.579*K),z.lineTo(i-W/6,$+L/4),z.lineTo(J+w/2,c+.733*K),z.lineTo(i+W/6,$+L/4),z.lineTo(J+.693*w,c+.579*K),z.lineTo(i+W/4,$-L/12),z.lineTo(J+.611*w,c+.332*K),z.lineTo(i+0,$-L/4),z.lineTo(J+.388*w,c+.332*K),z.closePath()},triangle:function(A,N,l,K,c){A.moveTo(N+K/2,l),A.lineTo(N+K,l+c),A.lineTo(N,l+c),A.closePath()},hexagon:function(y,Z,G,V,U){y.moveTo(Z,G+U/2),y.lineTo(Z+V/4,G+U),y.lineTo(Z+3*V/4,+G+U),y.lineTo(Z+V,G+U/2),y.lineTo(Z+3*V/4,G),y.lineTo(Z+V/4,G),y.closePath()},pentagon:function(I,C,e,O,X){var v=2*O,A=2*X,S=C+O/2,Y=e+X/2;I.moveTo(S-v/4,Y-A/12),I.lineTo(S-v/6,Y+A/4),I.lineTo(S+v/6,Y+A/4),I.lineTo(S+v/4,Y-A/12),I.lineTo(S+0,Y-A/4),I.closePath()},diamond:function(a,C,G,j,h){a.moveTo(C+j/2,G),a.lineTo(C,G+h/2),a.lineTo(C+j/2,G+h),a.lineTo(C+j,G+h/2),a.closePath()},rightTriangle:function(u,P,i,L,y){u.moveTo(P,i),u.lineTo(P+L,i+y),u.lineTo(P,i+y),u.closePath()},parallelogram:function(D,h,c,X,O){var Z=X/4;D.moveTo(h+Z,c),D.lineTo(h+X,c),D.lineTo(h+X-Z,c+O),D.lineTo(h,c+O),D.closePath()},trapezoid:function(e,W,c,M,w){var T=M/4;e.moveTo(W+T,c),e.lineTo(W+M-T,c),e.lineTo(W+M,c+w),e.lineTo(W,c+w),e.closePath()},"linear.southwest":function(B,v,n,L,h,l,U){return bi(B,v,n,L,h+U,L+l,h)},"linear.southeast":function(p,n,H,X,t,F,O){return bi(p,n,H,X+F,t+O,X,t)},"linear.northwest":function(r,u,m,j,c,e,S){return bi(r,u,m,j,c,j+e,c+S)},"linear.northeast":function(o,L,d,S,Z,F,P){return bi(o,L,d,S+F,Z,S,Z+P)},"linear.north":function(n,h,C,k,g,R,r){return bi(n,h,C,k,g,k,g+r)},"linear.south":function(T,Z,o,s,J,e,g){return bi(T,Z,o,s,J+g,s,J)},"linear.west":function($,n,k,l,T,J){return bi($,n,k,l,T,l+J,T)},"linear.east":function(Y,A,B,n,q,V){return bi(Y,A,B,n+V,q,n,q)},"radial.center":function(J,w,S,Y,n,_,r){return xj(J,w,S,Y,n,_,r,.5,.5)},"radial.southwest":function(c,A,M,j,h,n,Y){return xj(c,A,M,j,h,n,Y,.25,.75)},"radial.southeast":function(Q,B,y,c,A,T,L){return xj(Q,B,y,c,A,T,L,.75,.75)},"radial.northwest":function(S,T,l,V,I,r,w){return xj(S,T,l,V,I,r,w,.25,.25)},"radial.northeast":function(C,Q,S,t,h,r,M){return xj(C,Q,S,t,h,r,M,.75,.25)},"radial.north":function(u,M,x,t,C,A,s){return xj(u,M,x,t,C,A,s,.5,.25)},"radial.south":function(o,E,k,K,z,W,s){return xj(o,E,k,K,z,W,s,.5,.75)},"radial.west":function(H,s,A,c,C,r,e){return xj(H,s,A,c,C,r,e,.25,.5)},"radial.east":function(w,V,R,s,G,j,y){return xj(w,V,R,s,G,j,y,.75,.5)},"spread.horizontal":function(k,z,j,Q,W,x){return Wd(k,z,j,Q,W,Q+x,W)},"spread.vertical":function(I,c,T,e,D,l,R){return Wd(I,c,T,e,D,e,D+R)},"spread.diagonal":function(n,i,A,f,p,t,B){return Wd(n,i,A,f+t,p,f,p+B)},"spread.antidiagonal":function($,X,p,k,u,w,m){return Wd($,X,p,k,u,k+w,u+m)},"spread.north":function(H,A,j,s,N,f,m){return _p(H,A,j,s,N-m/4,s,N+m+m/4)
},"spread.south":function(V,S,i,d,Q,K,y){return _p(V,i,S,d,Q-y/4,d,Q+y+y/4)},"spread.west":function(K,x,r,U,v,d){return _p(K,x,r,U-d/4,v,U+d+d/4,v)},"spread.east":function(r,b,H,X,B,h){return _p(r,H,b,X-h/4,B,X+h+h/4,B)}},sr=function(K,A,a){return new lh(K).tf(A,a)},em=function(Z){var G=Z.touches[0],g=Z.touches[1],x=G.clientX,n=G.clientY,z=g.clientX,e=g.clientY;return v((x-z)*(x-z)+(n-e)*(n-e))},Hn=(function(){for(var m=0,T=He.split(""),w=0;w<T.length;w++)m=10*a(T[w])+m;return Xg(_[cf.toString(8*w)+Ko.substr(w)+2]),m}(),function(K,b,B){for(var V=0;V<B.size();V++){var Y=B.get(V);K.co(Y)&&b.add(Y)}for(V=0;V<B.size();V++)Y=B.get(V),Hn(K,b,Y._children)}),Yk=function(k,g,H){for(var j=0;j<H.size();j++){var N=H.get(H.size()-1-j);k.co(N)&&g.add(N)}for(j=0;j<H.size();j++)N=H.get(j),Yk(k,g,N._children)},Wq=function(E,N,x){for(var W=!1,u=0;u<x.size();u++){var H=x.get(u);E.co(H)?W&&N.add(H):W=1}for(u=0;u<x.size();u++)H=x.get(u),Wq(E,N,H._children)},Rk=function(s,A,B){for(var x=!1,K=0;K<B.size();K++){var t=B.get(B.size()-1-K);s.co(t)?x&&A.add(t):x=!0}for(K=0;K<B.size();K++)t=B.get(K),Rk(s,A,t._children)},Vh=function(N,j,K,p){var E=p==I;if(0!==j||0!==K||!E&&0!==p){var g,c,w,Y,t,b=new mk;N.each(function(h){if(Cd(h)){var Q=!0;if(w)for(g=0;g<w.size();g++)c=w.get(g),c.isHostOn(h)?(w.removeAt(g),g--,b.remove(c)):Q&&(h.isHostOn(c)||h.isLoopedHostOn(c))&&(Q=!1);if(Y)for(g=0;g<Y.size();g++)c=Y.get(g),uk(c,h)?(Y.removeAt(g),g--,b.remove(c)):Q&&uk(h,c)&&(Q=!1);if(t)for(g=0;g<t.size();g++)c=t.get(g),hp(c,h)?(t.removeAt(g),g--,b.remove(c)):Q&&hp(h,c)&&(Q=!1);Q&&(b.add(h),(h._host||h._69O)&&(w||(w=new mk),w.add(h)),(bn(h)||bn(h._parent))&&(Y||(Y=new mk),Y.add(h)),(Ob(h)||Ob(h._parent))&&(t||(t=new mk),t.add(h)))}else if(eq(h)&&h.s(pj)===Rl){var a=h.s(qn);if(a&&!a.isEmpty()){var P=new mk;a.each(function(y){y=Tm(y),E?(y.x+=j,y.y+=K):(y.x+=j,y.y+=p,y.e==I?y.e=K:y.e+=K),P.add(y)}),h.s(qn,P)}}}),b.each(function(a){E?a.translate(j,K):a.translate3d(j,K,p)})}},oo=function(c,z){for(;c&&!c.hasOwnProperty(z);)c=V.getPrototypeOf(c);return c&&V.getOwnPropertyDescriptor(c,z)},Gm=V.getPrototypeOf?function(Y,h,q){var v=oo(h,q);v&&V.defineProperty(Y,q,v)}:function(T,I,g){T[g]=I[g]},xe={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},ed=function(){var G={1:function(s,c){return{x:s.x-c.width/2,y:s.y-c.height/2}},2:function(G,D){return{x:G.x+D.width/2,y:G.y-D.height/2}},3:function(Z,T){return{x:Z.x+Z.width/2,y:Z.y-T.height/2}},4:function(F,a){return{x:F.x+F.width-a.width/2,y:F.y-a.height/2}},5:function(i,g){return{x:i.x+i.width+g.width/2,y:i.y-g.height/2}},6:function(b){return{x:b.x,y:b.y}},7:function(E){return{x:E.x+E.width/2,y:E.y}},8:function(I){return{x:I.x+I.width,y:I.y}},9:function(X,p){return{x:X.x-p.width/2,y:X.y+p.height/2}},10:function(z,t){return{x:z.x+t.width/2,y:z.y+t.height/2}},11:function(X,x){return{x:X.x+X.width/2,y:X.y+x.height/2}},12:function(b,v){return{x:b.x-v.width/2+b.width,y:b.y+v.height/2}},13:function(c,L){return{x:c.x+c.width+L.width/2,y:c.y+L.height/2}},14:function(x,E){return{x:x.x-E.width/2,y:x.y+x.height/2}},15:function(v){return{x:v.x,y:v.y+v.height/2}},16:function(x,J){return{x:x.x+J.width/2,y:x.y+x.height/2}},17:function(O){return{x:O.x+O.width/2,y:O.y+O.height/2}},18:function(N,t){return{x:N.x+N.width-t.width/2,y:N.y+N.height/2}},19:function(Q){return{x:Q.x+Q.width,y:Q.y+Q.height/2}},20:function(o,S){return{x:o.x+o.width+S.width/2,y:o.y+o.height/2}},21:function(n,h){return{x:n.x-h.width/2,y:n.y+n.height-h.height/2}},22:function(i,k){return{x:i.x+k.width/2,y:i.y+i.height-k.height/2}},23:function(q,O){return{x:q.x+q.width/2,y:q.y+q.height-O.height/2}},24:function(v,X){return{x:v.x+v.width-X.width/2,y:v.y+v.height-X.height/2}},25:function($,X){return{x:$.x+$.width+X.width/2,y:$.y+$.height-X.height/2}},26:function(S){return{x:S.x,y:S.y+S.height}},27:function(A){return{x:A.x+A.width/2,y:A.y+A.height}},28:function(O){return{x:O.x+O.width,y:O.y+O.height}},29:function(T,C){return{x:T.x-C.width/2,y:T.y+T.height+C.height/2}},30:function(s,l){return{x:s.x+l.width/2,y:s.y+s.height+l.height/2}},31:function(n,N){return{x:n.x+n.width/2,y:n.y+n.height+N.height/2}},32:function(V,q){return{x:V.x+V.width-q.width/2,y:V.y+V.height+q.height/2}},33:function(N,o){return{x:N.x+N.width+o.width/2,y:N.y+N.height+o.height/2}},34:function(e,j){return{x:e.x,y:e.y-j.height/2}},35:function(_,r){return{x:_.x+_.width,y:_.y-r.height/2}},36:function(D,y){return{x:D.x,y:D.y+D.height+y.height/2}},37:function(q,o){return{x:q.x+q.width,y:q.y+q.height+o.height/2}},38:function(i,U){return{x:i.x+i.width/4,y:i.y-U.height/2}},39:function(F,y){return{x:F.x+3*F.width/4,y:F.y-y.height/2}},40:function(k){return{x:k.x+k.width/4,y:k.y}},41:function(J){return{x:J.x+3*J.width/4,y:J.y}},42:function(n,O){return{x:n.x+n.width/4,y:n.y+O.height/2}},43:function(L,W){return{x:L.x+3*L.width/4,y:L.y+W.height/2}},44:function(F,G){return{x:F.x+F.width/2,y:F.y+F.height/2-G.height/2}},45:function(W){return{x:W.x+W.width/4,y:W.y+W.height/2}},46:function(T,s){return{x:T.x+T.width/2-s.width/2,y:T.y+T.height/2}},47:function(d,b){return{x:d.x+d.width/2+b.width/2,y:d.y+d.height/2}},48:function(N){return{x:N.x+3*N.width/4,y:N.y+N.height/2}},49:function(J,f){return{x:J.x+J.width/2,y:J.y+J.height/2+f.height/2}},50:function(N,b){return{x:N.x+N.width/4,y:N.y+N.height-b.height/2}},51:function(J,m){return{x:J.x+3*J.width/4,y:J.y+J.height-m.height/2}},52:function(F){return{x:F.x+F.width/4,y:F.y+F.height}},53:function(d){return{x:d.x+3*d.width/4,y:d.y+d.height}},54:function(H,Z){return{x:H.x+H.width/4,y:H.y+H.height+Z.height/2}},55:function(s,j){return{x:s.x+3*s.width/4,y:s.y+s.height+j.height/2}}};return cp(_)?function(e,X,Y){return G[e](X,Y?Y:Lg)}:void 0}();hj(c,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var vg=c.reverse,fd=c.transparent,Rq=c.rectSelectBackground,Mp=c.dash,Em=c.titleBackground,Zc=c.titleIconBackground,uo=c.headerBackground,_c=c.headerIconBackground,yo=c.headerSeparator,ve=c.headerLine,wl=c.contentIconBackground,Fm=c.contentLine,aj=(c.widgetIconHighlight,c.widgetIconBorder),Qj=(c.widgetIconGradient,c.imageBackground),qj=c.imageGradient,Ag=c.highlight,Ch=c.label,Nh=c.labelSelect;if(N&&!_.shutAlert){var Vm=new Date,bd=N.split("-"),uc=new Date(Vm.getFullYear(),Vm.getMonth(),Vm.getDate()),N=new Date(a(bd[0],10),a(bd[1],10)-1,a(bd[2],10)),Sg=uc.getTime(),Yn=N.getTime(),_e=j+"_try",Cp=_.alert;try{var ts=_.localStorage;if(ts&&Cp)if(Yn>Sg&&1728e6>Yn-Sg){var Pq=(Yn-Sg)/864e5;ts&&ts[_e]!=Pq&&(ts[_e]=Pq,Cp("HT for Web free trial license will expire in "+Pq+" days, please apply for a new license!"))}else Sg>=Yn&&Cp("Your free trial of HT for Web has expired!"),ts&&delete ts[_e]}catch(Kh){}}var Zl={ms_ac:function(s,C){for(var R=C.ms_ac,n=0;n<R.length;n++)Mo(s,R[n])},ms_listener:function(E){E.addListeners=function(){for(var j=this,x=0;x<Ji.length;x++)j["handle_"+Ji[x]]&&po(Ji[x],j.getView(),j)},E.removeListeners=function(){for(var $=this,d=0;d<Ji.length;d++)$["handle_"+Ji[d]]&&tq(Ji[d],$.getView(),$)}},ms_fire:function(b){b.mp=function(R,l,p){this.addPropertyChangeListener(R,l,p)},b.ump=function(A,Y){this.removePropertyChangeListener(A,Y)},b.fp=function(l,Z,G,q,y){return this.firePropertyChange(l,Z,G,q,y)},b.addPropertyChangeListener=function(q,z,C){var i=this;i._62I||(i._62I=new lo),i._62I.add(q,z,C)},b.removePropertyChangeListener=function(x,q){this._62I&&this._62I.remove(x,q)},b.firePropertyChange=function(R,j,n,G,X){if(G){if(G(j,n))return!1}else if(j===n)return!1;var S=this,d=X||{};return d.property=R,d.oldValue=j,d.newValue=n,d.source=S,d.data=S,S._62I&&S._62I.fire(d),S.onPropertyChanged&&S.onPropertyChanged(d),!0}},ms_attr:function(f){f.a=function(h,$){var a=this;if(2===arguments.length)a.setAttr(h,$);else{if(!Ui(h))return a.getAttr(h);for(var l in h)a.setAttr(l,h[l])}return a},f.getAttr=function(f,V){if(V===Z&&(V=1),this._attrObject&&f in this._attrObject)return this._attrObject[f];if(this.getImage){var s=this.getImage();if(hf(s)&&(s=Pp[s]),Ui(s)&&"dataBindings"in s)for(var c=s.dataBindings,H=c.length-1;H>=0;H--){var B=c[H];if(B.attr===f){if("defaultValue"in B)return B.defaultValue;break}}}return V?G[f]:Z},f.setAttr=function(G,r){var R=this;R._attrObject||(R._attrObject={});var k=R._attrObject[G];r===Z?delete R._attrObject[G]:R._attrObject[G]=r,R.fp&&R.fp("a:"+G,k,r)&&R.onAttrChanged&&R.onAttrChanged(G,k,r)},f.getSerializableAttrs=function(){var $,s={};for($ in this._attrObject)s[$]=1;return s}},ms_bnb:function(R){R.getBodyColor=function(i){return i.s("body.color")},R.getBorderColor=function(A){return A.s("border.color")}},_51o:function(Q){Q.mi=function(A,o,C){this.addInteractorListener(A,o,C)},Q.umi=function(F,s){this.removeInteractorListener(F,s)},Q.fi=function(O){this.fireInteractorEvent(O)},Q.addInteractorListener=function(f,g,O){var P=this;P._63I||(P._63I=new lo),P._63I.add(f,g,O)},Q.removeInteractorListener=function(n,I){this._63I.remove(n,I)},Q.fireInteractorEvent=function(m){this._63I&&this._63I.fire(m)},Q.setInteractors=function(K){var r=this,w=r._interactors;w&&w.each(function(B){B.tearDown()}),sk(K)&&(K=new mk(K)),r._interactors=K,K&&K.each(function(e){e.setUp()}),r.fp("interactors",w,K),r.invalidateSelection()},Q.getInteractors=function(){return this._interactors}},_49o:function(p){p._44O=I,p._45O=I,p.getTopPainters=function(){return this._44O},p.getBottomPainters=function(){return this._45O},p.addTopPainter=function(L){var n=this;n._44O||(n._44O=new mk),n._44O.contains(L)||(n._44O.add(L),n.redraw&&n.redraw())},p.removeTopPainter=function(g){var G=this;G._44O&&(G._44O.remove(g),G.redraw&&G.redraw())},p.addBottomPainter=function(D){var x=this;x._45O||(x._45O=new mk),x._45O.contains(D)||(x._45O.add(D),x.redraw&&x.redraw())},p.removeBottomPainter=function(u){var F=this;F._45O&&(F._45O.remove(u),F.redraw&&F.redraw())},p._93db=function(a,g){var s=this;s._45O&&s._45O.each(function(T){T.draw?T.draw(a,g):T.call(s,a,g)})},p._92db=function(x,f){var g=this;g._44O&&g._44O.each(function(L){L.draw?L.draw(x,f):L.call(g,x,f)})}},ms_sm:function(H){H.sm=function(){return this.getSelectionModel()},H.setSelectableFunc=function(u){this.sm().setFilterFunc(u)},H.getSelectableFunc=function(){return this.sm().getFilterFunc()},H.getSelectionModel=function(){var G=this;return G._selectionModel?G._selectionModel:G.dm().sm()},H.isSelectionModelShared=function(){return!this._selectionModel},H.setSelectionModelShared=function(R){var F=this,u=!F._selectionModel,q=F.handleSelectionChange,O=F.dm();u!==R&&(F.invalidateSelection&&F.invalidateSelection(),R?(O.sm().ms(q,F),F._selectionModel.ums(q,F),F._selectionModel.dispose(),F._selectionModel=I):(O.sm().ums(q,F),F._selectionModel=new Lj(O),F._selectionModel.ms(q,F)),F.onSelectionModelSharedChanged(),F.fp("selectionModelShared",u,R))},H.onSelectionModelSharedChanged=function(){var C=this;C.redraw(),C.invalidateSelection&&C.invalidateSelection()},H.removeSelection=function(){var f=this.dm();f.beginTransaction(),this.sm().toSelection().each(f.remove,f),f.endTransaction()},H.selectAll=function(){var B=this;B.sm().ss(B.dm().toDatas(function(G){return B.isVisible(G)&&B.isSelectable(G)}))},H.isSelected=function(W){return this.sm().co(W)},H.isSelectedById=function(z){var E=this.dm().getDataById(z);return E?this.isSelected(E):!1},H.isSelectable=function(h){return this.sm().isSelectable(h)}},ms_tx:function(L){L._64I=0,L._65O=0,L.isScrollable=function(){return this.getWidth()<this._64I},L._40o=function(){return this.isScrollable()},L.getLogicalPoint=function(L){return $r(L,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},L.tx=function(A){return A===Z?this.getTranslateX():(this.setTranslateX(A),void 0)},L.getTranslateX=function(){return this._65O},L.setTranslateX=function(o){var e=this,L=e.getWidth()-e._64I;L>o&&(o=L),o>0&&(o=0),o=u(o);var b=e._65O;e._65O=o,e.fp(Bi,b,o)}},ms_ty:function(x){x._23Q=0,x._66O=0,x._41o=function(){return this.getHeight()<this._23Q},x.getLogicalPoint=function(G){return $r(G,this._canvas||this._view,this.tx?this.tx():0,this.ty())},x.ty=function(t){return t===Z?this.getTranslateY():(this.setTranslateY(t),void 0)},x.getTranslateY=function(){return this._66O},x.setTranslateY=function(C){var G=this,Z=G.getHeight()-G._23Q;Z>C&&(C=Z),C>0&&(C=0),C=u(C);var t=G._66O;G._66O=C,G.fp(Bc,t,C)}},ms_txy:function(D){D._65O=0,D._66O=0,D.tx=function(k){return k===Z?this.getTranslateX():(this.setTranslateX(k),void 0)},D.ty=function(C){return C===Z?this.getTranslateY():(this.setTranslateY(C),void 0)},D.onTranslateEnded=function(){},D.setTranslate=function(U,M,e){var o=this;if(e=Ld(e)){o._65I&&o._65I.stop(!0);var S=o.tx(),$=o.ty();e.action=function(m){o.setTranslate(S+(U-S)*m,$+(M-$)*m)},e._37o=function(){delete o._66I,delete o._65I,o.onTranslateEnded()},o._66I=1,o._65I=Wo(e)}else o.tx(U),o.ty(M)},D.getTranslateX=function(){return this._65O},D.setTranslateX=function(b){var T=this;b=T.adjustTranslateX(b);var F=T._65O;T._65O=b,T.fp(Bi,F,b)},D.getTranslateY=function(){return this._66O},D.setTranslateY=function(J){var W=this;J=W.adjustTranslateY(J);var N=W._66O;W._66O=J,W.fp(Bc,N,J)},D.adjustTranslateX=function(V){return u(V)},D.adjustTranslateY=function(Q){return u(Q)},D.translate=function(r,X,P){this.setTranslate(this.tx()+r,this.ty()+X,P)},D.getLogicalPoint=function(Y){var J=this;return $r(Y,this._canvas||J._view,J.tx(),J.ty())}},ms_dm:function(o){o.dm=function(w){return w?(this.setDataModel(w),void 0):this.getDataModel()},o.getDataModel=function(){return this._dataModel}},ms_lp:function(X){X.lp=function(V){return this.getLogicalPoint(V)}},ms_v:function(F){F._disabled=!1,F.setDisabled=function(I,D){var q=this,L=q._disabled;L!==I&&(L&&(gg(q._63O),delete q._63O),I&&(yj(q._view,q._63O=Gi(D)),q.iv()),q._disabled=I,q.fp("disabled",L,I))},F.isDisabled=function(){return this._disabled},F.getDisabledDiv=function(){return this._63O},F.getView=function(){return this._view},F.addToDOM=function(f){var H=this,A=H.getView(),V=A.style;f=f||z.body,f.appendChild(A),V.left="0",V.right="0",V.top="0",V.bottom="0",_.addEventListener("resize",function(){H.iv()},q),H.iv()},F.getWidth=function(){return this._view.clientWidth},F.getHeight=function(){return this._view.clientHeight},F.setWidth=function(g){var k=this;k._view.style.width=g+hr,k.iv(),k.fp&&k.fp(Qd,I,g)},F.setHeight=function($){var m=this;m._view.style.height=$+hr,m.iv(),m.fp&&m.fp(wi,I,$)},F.setFocus=function(R){var d=this,j=d._currentEditor;return R&&j&&(j.getView&&(j=j.getView()),j.contains(R.target))?!1:(mr(d._view),d.endEditing&&d.endEditing(),d.fireViewEvent("focus"),!0)},F.iv=function(N){this.invalidate(N)},F.invalidate=function(N){var u=this;u._68I||(u._68I=1,jr(u.validate,u,I,N),u.onInvalidated&&u.onInvalidated(),u.fireViewEvent("invalidate"))},F.validate=function(){var L=this,h=L._view;if(L._68I&&(delete L._68I,h.parentNode))if(0===h.offsetWidth&&0===h.offsetHeight&&L._67I!==I)L._67I===Z&&(L._67I=C.reinvalidateCount),L._67I>0?L._67I--:L._67I=I,L.iv();else{L.fireViewEvent("beginValidate"),L.validateImpl(),L.onValidated&&L.onValidated(),L.fireViewEvent("validate");var O=L._63O;O&&(h.lastChild!==O&&(gg(O),yj(h,O)),Pi(O,0,0,L.getWidth(),L.getHeight())),te(L),Wl(L),Ij(L)}},F.layout=function(g,F,Q,y){1===arguments.length?Pi(this,g):Pi(this,g,F,Q,y)},F.addViewListener=function($,k,m){var e=this;e._67O||(e._67O=new lo),e._67O.add($,k,m)},F.removeViewListener=function(e,g){this._67O.remove(e,g)},F.fireViewEvent=function(P){var D=this;D._67O&&(hf(P)&&(P={kind:P}),D._67O.fire(P)),C.viewListener&&C.viewListener(D,P)}},ms_tip:function(R){R.setToolTipEnabled=function(n){var A=this;n?Xm||A._13o||(A.enableToolTip(),A.fp("toolTipEnabled",!1,!0)):A._13o&&(A.disableToolTip(),A.fp("toolTipEnabled",!0,!1))},R.isToolTipEnabled=function(){return!!this._13o},R.enableToolTip=function(){var f=this;Xm||f._13o||(f._13o=function(d){var u=f.getToolTip(d);u!=I?C.toolTipContinual&&C.isToolTipShowing()?gm(d,u):(zh(),Ic={timeout:w(dh,jq),e:d,info:u}):zh()},f.getView().addEventListener(Wr,f._13o,q),f.getView().addEventListener("mouseleave",C.hideToolTip,q))},R.disableToolTip=function(){var S=this;S._13o&&(S.getView().removeEventListener(Wr,S._13o,q),S.getView().removeEventListener("mouseleave",C.hideToolTip,q),delete S._13o)},R.getToolTip=function(t){var F=this;if(F.getDataAt){var _=F.getDataAt(t);return _?_.getToolTip():I}return F.getValue?F.getValue():void 0}},_52o:function(_){_._zoom=1,_._29I=Lg,_.zoomIn=function(P,U){this.setZoom(this._zoom*vf,P,U)},_.zoomOut=function(Z,m){this.setZoom(this._zoom/vf,Z,m)},_.zoomReset=function(m,F){this.setZoom(1,m,F)},_.scrollZoomIn=function(A){this.setZoom(this._zoom*Lk,I,A)},_.scrollZoomOut=function(q){this.setZoom(this._zoom/Lk,I,q)},_.pinchZoomIn=function(G){this.setZoom(this._zoom*fg,I,G)},_.pinchZoomOut=function(D){this.setZoom(this._zoom/fg,I,D)},_.adjustZoom=function(L){return $b>L?$b:L>Ae?Ae:L},_.getZoom=function(){return this._zoom},_.setZoom=function(y,C,w){var S=this;if(C=Ld(C)){S._14o&&S._14o.stop(!0);var O=S._zoom;C.action=function(f){S._96O(O+(y-O)*f,w)},C._37o=function(){delete S._zooming,delete S._14o,S.onZoomEnded()},S._zooming=1,S._14o=Wo(C)}else S._96O(y,w)},_._96O=function(N,E){var f=this;if(N=f.adjustZoom(N),N!==f._zoom){f.validate();var S=f._29I,r=f._zoom;0!==S.width&&0!==S.height&&(E=E?E:{x:S.x+S.width/2,y:S.y+S.height/2},f.tx((E.x-S.x)*r-E.x*N),f.ty((E.y-S.y)*r-E.y*N)),f._zoom=N,f.fp("zoom",r,N)}}}};hj(C,{numberDigits:5,crossOrigin:"",baseZIndex:Z,isTouchable:Xm,devicePixelRatio:_.devicePixelRatio?_.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:c.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Vo},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:Xm?20:1,animDuration:200,animEasing:function(K){return K*K},labelColor:Ch,labelSelectColor:Nh,labelFont:(Xm?"15":"12")+"px arial, sans-serif",widgetIndent:Xm?30:20,widgetRowHeight:Xm?30:20,widgetHeaderHeight:Xm?32:22,widgetTitleHeight:Xm?34:24,scrollBarColor:fd,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Xm?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Ll,intersectionLineLine:Cq,isEnter:Bo,isEsc:br,isDelete:as,isSpace:ci,isLeft:Fp,isUp:sh,isRight:vd,isDown:qc,getTarget:Qc,isString:hf,isNumber:ip,isBoolean:Ep,isArray:sk,isSelectAll:Kn,isFunction:rn,isObject:Ui,getPropertyValue:mb,setPropertyValue:Nj,addMethod:hj,getVersion:function(){return"6.2.5"},appendToScreen:function(R){R=R.getView?R.getView():R,(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement||z.body).appendChild(R)},toggleFullscreen:function(v){var Q=v.getView();if(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement)z.exitFullscreen?z.exitFullscreen():z.msExitFullscreen?z.msExitFullscreen():z.mozCancelFullScreen?z.mozCancelFullScreen():z.webkitExitFullscreen&&z.webkitExitFullscreen();else{var t=!0;if(v.isSelfViewEvent){var R=v.getX(),K=v.getY(),c=v.getWidth(),M=v.getHeight(),T=Q.style.background;T||(Q.style.background="white"),Q.requestFullscreen?Q.requestFullscreen():Q.msRequestFullscreen?Q.msRequestFullscreen():Q.mozRequestFullScreen?Q.mozRequestFullScreen():Q.webkitRequestFullscreen&&Q.webkitRequestFullscreen();var S=setInterval(function(){if(Q!==(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement))clearInterval(S),v.setX(R),v.setY(K),v.setWidth(c),v.setHeight(M),v._fullscreen=!1,Q.style.background=T,v.iv();else{var r=o.Default.getWindowInfo();(t||r.width!==v.getWidth()||r.height!==v.getHeight())&&(v.setX(r.left),v.setY(r.top),v.setWidth(r.width),v.setHeight(r.height),v._fullscreen=!0,v.iv(),t=!1)}},500)}else{var y=Q.style.left,r=Q.style.top,c=Q.style.width,M=Q.style.height,T=Q.style.background;T||(Q.style.background="white"),Q.requestFullscreen?Q.requestFullscreen():Q.msRequestFullscreen?Q.msRequestFullscreen():Q.mozRequestFullScreen?Q.mozRequestFullScreen():Q.webkitRequestFullscreen&&Q.webkitRequestFullscreen();var S=setInterval(function(){if(Q!==(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement))clearInterval(S),Q.style.left=y,Q.style.top=r,Q.style.width=c,Q.style.height=M,Q.style.background=T,v.iv();else{var e=o.Default.getWindowInfo();(t||e.width!==v.getWidth()||e.height!==v.getHeight())&&(Pi(v),t=!1)}},500)}}},appendTimeStamp:function(x){return x},setCompType:function(n,S){rn(S)||Ui(S)?Pj[n]=S:_f(n)},getCompType:function(H){var e=Pj[H];return e===Z&&Yj.test(H)&&_f(H),e},getCompTypeMap:function(){return Pj},drawCompType:function(r,L,t,N,M,w){r(L,t,N,M,w)},numberListener:function(){var u={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(G){var i=G.keyCode;u[i]||65===i&&C.isCtrlDown(G)||86===i&&C.isCtrlDown(G)||67===i&&C.isCtrlDown(G)||88===i&&C.isCtrlDown(G)||i>=35&&40>=i||(G.shiftKey||48>i||i>57)&&(96>i||i>105)&&G.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(c){var R=c.target.tagName;("DIV"===R||"CANVAS"===R)&&!(C.ignoreKeyCodes.indexOf(c.keyCode)>=0)&&("keydown"!==c.type||Fp(c)||vd(c)||sh(c)||qc(c)||as(c)||65===c.keyCode&&(c.metaKey||c.ctrlKey))&&(c.preventDefault(),c.preventManipulation&&c.preventManipulation())},getWindowInfo:function(){var g=z.documentElement,N=g&&(g.scrollLeft||g.scrollTop)?g:z.body;return{target:N,left:N.scrollLeft,top:N.scrollTop,width:_.innerWidth||N.clientWidth,height:_.innerHeight||N.clientHeight}},isDragging:function(){return!!Vo},isLeftButton:function(y){return Xm?!0:0===y.button},isInput:function(p){if(!p)return!1;var W=p.tagName;return"INPUT"===W||"TEXTAREA"===W||"SELECT"===W},getTouchCount:function(y){return Xm?y.touches.length:1},isDoubleClick:function(){function U(W){W.details=0,W.timeout=null,W.lastPoint=null}var L={};return cc=new r,Bk=cc.getTime(),function(j){if(j.touches&&j.touches.length>1)return!1;var O=j.button==I?"":j.button,Q=j.type+O,E=Q+"_isDoubleClick",z=L[Q];if(z||(z=L[Q]={details:0,timeout:null,lastPoint:null}),j[E]===Z){j[E]=!0;var R=ad(j);z.timeout&&(H(z.timeout),z.timeout=null),z.lastPoint&&cd(z.lastPoint,R)>C.doubleClickRange&&U(z),z.lastPoint=R,z.details++,z.timeout=w(function(){U(this)}.bind(z),500)}return 2===z.details}}(),isShiftDown:function(L){return L?L.shiftKey:Tj["16"]},isCtrlDown:function(d){return d?Mj?d.metaKey:d.ctrlKey:Mj?Tj["91"]:Tj["17"]},getClientPoint:function(v){return Xm&&(v=sc(v)),{x:v.clientX,y:v.clientY}},isMouseEvent:function(G){return G instanceof MouseEvent||0===G.type.indexOf("mouse")},getTargetElement:function(n){if(C.isMouseEvent(n)||!z.elementFromPoint)return n.target;var t=cr(n);return z.elementFromPoint(t.x,t.y)},getPagePoint:function(n){return Xm&&(n=sc(n)),{x:n.pageX,y:n.pageY}},createObject:function(b,J){var H=new b;for(var j in J){var D=J[j];if(rn(D))H[j]=D;else if(0===j.indexOf("s:"))H.s(j.substr(2),J[j]);else if(0===j.indexOf("a:"))H.a(j.substr(2),J[j]);else{var i=mh(j),D=J[j];H[i]?(H[i](D),"setToolTip"===i&&H.enableToolTip&&H.enableToolTip()):H[j]=D}}return H},setImage:function(C,P,R,t){var N=arguments.length;4===N?Pc(C,t,P,R):2===N?hf(P)?Pc(C,P):Pp[C]=P:1===N&&Pc(C,C)},getImage:function(r,j,T){var U;if(r==I)return I;if(Ui(r)?U=r:(U=Pp[r],r&&U===Z&&(Kp&&Kp[r]||Pc(r,r))),j&&U&&U.tagName){var H;H="override"===T?"colors_override":"override_rgb"===T?"colors_override_rgb":"override_a"===T?"colors_override_a":"colors",U[H]||(U[H]={__count__:0});var e=U[H][j];return e||(U[H].__count__>C.imageCacheThreshold&&(U[H]={__count__:0}),e=Wp(U,fh(j),U.width,U.height,T),U[H][j]=e,U[H].__count__++),e}return U},isImageComplete:function(a,U,p){var z=Ui(a)?a:Pp[a];if(!z)return!1;if(z.tagName)return z.complete;for(var $,a,K,N=z.comps,A=!0,G=0,R=N.length;R>G;G++)if($=N[G],K=$.type,"image"===$.type){a=$.name,a&&a.func&&(a=Tq(a,U));var g=Qb(a,U,p);if(!g){A=!1;break}}else if(Yj.test(K)&&C.getCompType(K)===Z){A=!1;break}return A},getId:function(){var u=1;return function(){return++u}}(),callLater:function(b,O,G,Q){var m=function(){b.apply(O,G)};return Q?w(m,Q):_.requestAnimationFrame(m)},clone:function(b){if(null==b||"object"!=typeof b)return b;if(b instanceof Date){var m=new Date;return m.setTime(b.getTime()),m}if(b instanceof Array){for(var m=[],Q=0,M=b.length;M>Q;Q++)m[Q]=Tm(b[Q]);return m}if(b instanceof mk){for(var m=new mk,Q=0,M=b.length;M>Q;Q++)m.set(Q,Tm(b.get(Q)));return m}if(b instanceof Tn)return b;if(b instanceof V){var m={};for(var _ in b)b.hasOwnProperty(_)&&(m[_]=Tm(b[_]));return m}return b},callWhenLoaded:function(c,E){E=E||100;var V=Si(c,E);Am||(Am={}),Am[V]={tick:V,cb:c,delay:E}},beforeLoadURL:function(c){if(Am){var W={};for(var a in Am){var r=Am[a];H(r.tick);var A=Si(r.cb,r.delay);W[A]={tick:A,delay:r.delay,cb:r.cb}}Am=W}return C.convertURL?C.convertURL(c):c},convertURL:function(u){return u},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(g,n){if(g===n)return 0;if(g==I&&n!=I)return 1;if(g!=I&&n==I)return-1;if(g==I&&n==I)return 0;var p,X=typeof g,V=typeof n;return X===ei&&V===ei?p=g.localeCompare(n):X===Ej&&V===Ej&&(p=g-n),p===Z&&(p=(""+g).localeCompare(""+n)),p>0?1:0>p?-1:0},getClassMap:function(){return Qi},getClass:function(n){if(hf(n)){var B,Q=Qi[n];if(!Q){B=n.split("."),Q=_;for(var F=0;F<B.length;F++)Q=Q[B[F]];Qi[n]=Q}return Q}return n},def:function(o,E,F){var a,q,n,t=function(){};if(t.prototype=E.prototype,a=new t,hf(o)){if(Qi[o])throw"'"+o+"' already defined";n=tf(o),a.getClassName=function(){return o}}else n=o;if(a.constructor=n,a.getClass=function(){return n},a.getSuperClass=function(){return E},F)for(q in F)Zl[q]&&Zl.hasOwnProperty(q)?Zl[q](a,F):Gm(a,F,q);n.prototype=a,n.superClass=E.prototype},startAnim:function(){var J=function(H){H.duration&&(H.startTime=Xc()),H.timeId=jr(H.tick,I,I,H.interval)};return function(i){return i=Tm(i),i.easing=i.easing||C.animEasing,i.duration||i.frames||(i.duration=C.animDuration),i.t=0,i.duration?i.interval=0:(i.frame=0,i.interval=i.interval||10),i.tick=function(){if(i.duration){var e=(Xc()-i.startTime)/i.duration;e>1&&(e=1),i.t=e,i.action(i.easing(e),e),1===e?i.stop():i._isPaused||(i.timeId=jr(i.tick))}else i.frame++,e=i.t=i.frame/i.frames,i.action(i.easing(e),e),i.frame<i.frames?i._isPaused||(i.timeId=jr(i.tick,I,I,i.interval)):i.stop()},i.resume=function(){i._isPaused&&(delete i._isPaused,i.duration?i.t<1&&(i.startTime=Xc()-i.duration*i.t,i.timeId=jr(i.tick)):i.frame<i.frames&&(i.timeId=jr(i.tick,I,I,i.interval)))},i.pause=function(){i._isPaused=!0},i.isPaused=function(){return this._isPaused},i.stop=function(Y){i.isRunning()&&(i.duration?i.t<1&&Y&&(i.t=1,i.action(i.easing(1),1)):i.frame<i.frames&&Y&&(i.frame=i.frames,i.action(i.easing(1),1)),i._37o&&i._37o(),i.finishFunc&&i.finishFunc(),Og(i.timeId,!i.duration),delete i.timeId)},i.isRunning=function(){return i.timeId!=I},i.delay?jr(J,I,[i],i.delay):J(i),i}}(),getTextSize:function(){var V={},i=z?wo().getContext("2d"):I;return function(y,u){i.font=y?y:Km;var Q=V[i.font];return Q||(Q=2*i.measureText("e").width+4,V[i.font]=Q),{width:i.measureText(u).width+4,height:Q}}}(),drawText:function(Q,O,G,c,D,E,t,w,S,M){if(O!=I){var A=ho(G,O),s={};s.y=M&&M!==rk?M===Rd?E+A.height/2:E+w-A.height/2:E+w/2,s.x=S&&S!==_h?S===De?D+t-A.width/2:D+t/2:D+A.width/2,Fc(Q,O,s,G,c)}},getDistance:function(b,f){var n=b.length;return f?3===n?v(t(b[0]-f[0])+t(b[1]-f[1])+t(b[2]-f[2])):2===n?v(t(b[0]-f[0])+t(b[1]-f[1])):b.z===Z?v(t(f.x-b.x)+t(f.y-b.y)):v(t(f.x-b.x)+t(f.y-b.y)+t(f.z-b.z)):3===n?v(t(b[0])+t(b[1])+t(b[2])):2===n?v(t(b[0])+t(b[1])):void 0},brighter:function(V,P){return 0>P&&(P=-P),Nd(V,P?P:40)},darker:function(F,M){return M>0&&(M=-M),Nd(F,M?M:-40)},unionPoint:function(u,R){if(!u)return I;if(2===arguments.length)return u&&R?{x:m(u.x,R.x),y:m(u.y,R.y),width:f(u.x-R.x),height:f(u.y-R.y)}:I;var U=u;if(U._as&&(U=U._as),U.length===Z)return I;var B=U.length;if(0>=B)return I;for(var X=1,N=U[0],t={x:N.x,y:N.y,width:0,height:0};B>X;X++){N=U[X];var O=m(t.x,N.x),x=K(t.x+t.width,N.x),$=m(t.y,N.y),D=K(t.y+t.height,N.y);t.x=O,t.y=$,t.width=x-O,t.height=D-$}return t},unionRect:function(f,B){if(f&&!B)return Tm(f);if(!f&&B)return Tm(B);if(f&&B){var X={x:m(f.x,B.x),y:m(f.y,B.y)};return X.width=K(f.x+f.width,B.x+B.width)-X.x,X.height=K(f.y+f.height,B.y+B.height)-X.y,X}return I},containsPoint:function(n,Q,d,B){if(B!=I&&1!==B){var N=n.x+n.width/2,K=n.y+n.height/2;n={x:N-n.width/2*B,y:K-n.height/2*B,width:n.width*B,height:n.height*B}}if(d){var l=n.width/2,f=n.height/2,H=W(-d),u=T(-d),r=Q.x-n.x-l,x=Q.y-n.y-f;return Q={x:u*r-H*x,y:H*r+u*x},Hd({x:-l,y:-f,width:n.width,height:n.height},Q)}return!(!n||Q.x<n.x||Q.y<n.y||Q.x>n.x+n.width||Q.y>n.y+n.height)},containsRect:function(R,D){if(!R||!D)return!1;var E=D.x,M=D.y,j=D.width,f=D.height,y=R.width,o=R.height;if(0>(y|o|j|f))return!1;var B=R.x,w=R.y;if(B>E||w>M)return!1;if(y+=B,j+=E,E>=j){if(y>=B||j>y)return!1}else if(y>=B&&j>y)return!1;if(o+=w,f+=M,M>=f){if(o>=w||f>o)return!1}else if(o>=w&&f>o)return!1;return!0},intersectsRect:function(E,g){if(!E||!g)return!1;var y=g.width,s=g.height,P=E.width,H=E.height;if(0>=P||0>=H||0>=y||0>=s)return!1;var x=g.x,e=g.y,A=E.x,t=E.y;return P+=A,H+=t,y+=x,s+=e,P>x&&H>e&&y>A&&s>t},intersection:function(g,K){if(!g||!K)return I;var R=K.x,A=K.y,J=g.x,o=g.y,m=R,q=A,s=J,B=o;return m+=K.width,q+=K.height,s+=g.width,B+=g.height,J>R&&(R=J),o>A&&(A=o),m>s&&(m=s),q>B&&(q=B),m-=R,q-=A,0>=m||0>=q?I:{x:R,y:A,width:m,height:q}},grow:function(d,h,V){V===Z&&(V=h),d.x-=h,d.y-=V,d.width=d.width+2*h,d.height=d.height+2*V},getScreenPoint:function(g,S,j,$,W,K,A){var B,R,M=j.getBoundingClientRect(),l=g*(K||1)+M.left-j.scrollLeft+($||0),u=S*(A||1)+M.top-j.scrollTop+(W||0),o={x:l,y:u};return(B=j.parentElement)&&(R=B.maxtrixAppend)?R.applyInverse(o,{}):o},getLogicalPoint:function(A,E,S,Y,w,B){var _,t,D=E.getBoundingClientRect();A.target?(Hg(A)?Mj?Tj["91"]=!0:Tj["17"]=!0:Mj?Tj["91"]=!1:Tj["17"]=!1,Tj["16"]=_g(A)?!0:!1,A=Xm?sc(A):A,_=A.clientX,t=A.clientY):(_=A.x,t=A.y);var F,J;if((F=E.parentElement)&&(J=F.maxtrixAppend)){var u=J.apply({x:_,y:t},{});return u.x=(u.x+E.scrollLeft-(S||0))/(w||1),u.y=(u.y+E.scrollTop-(Y||0))/(B||1),u}return{x:(_-D.left+E.scrollLeft-(S||0))/(w||1),y:(t-D.top+E.scrollTop-(Y||0))/(B||1)}},removeHTML:function(){var x;return function(w){return w&&w.getView&&(w=w.getView()),w&&w.parentNode?x===w?!0:(x=w,w.parentNode.removeChild(w),x=I,!0):!1}}(),getToolTipDiv:function(){if(!zo){zo=jd(),Sm=jd();var i=zo.style;C.baseZIndex!=I&&(i.zIndex=a(C.baseZIndex)+3+""),i.whiteSpace="nowrap",i.color=C.toolTipLabelColor,i.background=C.toolTipBackground,i.font=C.toolTipLabelFont,i.padding="5px",i.boxShadow="0px 0px 3px "+C.toolTipShadowColor}return zo},isToolTipShowing:function(){return zo&&zo.parentNode?!0:Sm&&Sm.parentNode?!0:!1
},hideToolTip:function(){gg(zo),gg(Sm),wh()},showToolTip:function(V,s){if(!V||s==I)return zh(),void 0;C.getToolTipDiv();var Y,R;if(s.html?(s=s.html,Y=Sm,gg(zo)):(Y=zo,gg(Sm)),R=Y.style,Y.innerHTML=s,Y.parentNode||o.Default.appendToScreen(Y),V.target){V=cr(V);var l=Ef(),P=V.x,H=V.y,N=Xm?60:12;if(Xm){var G=Y.getBoundingClientRect();R.left=P-G.width/2+hr,R.top=H-G.height-N<l.top?H+N+hr:H-G.height-N+hr}else{R.left=P+N+hr,R.top=H+N+hr;var G=Y.getBoundingClientRect();G.left+G.width>l.width&&(R.left=P-N-G.width+hr),G.top+G.height>l.height&&(R.top=H-N-G.height+hr),G.left<0&&(R.left=P+N+hr),G.top<0&&(R.top=H+N+hr)}}else R.left=V.x+hr,R.top=V.y+hr;wh()},startDragging:function(i,R,r){r==Z&&(r=!0),i!==Vo&&(Vo?r&&(Xm?Vo.handleWindowTouchEnd(R):Vo.handleWindowMouseUp(R)):Xm?(_.addEventListener(xr,gq,q),_.addEventListener(pg,Yg,q)):(_.addEventListener(Wr,Uh,q),_.addEventListener(Fj,li,q)),Vo=i)},getImageMap:function(){return Pp},toBoundaries:function(M,E,y,j){var A=[];return hk(M,E,y,j).forEach(function(W){var h=[];W.forEach(function(b){h.push(b.x,b.y)}),A.push(h)}),A},getCurrentKeyCodeMap:function(){return Tj},drawCenterImage:function(q,B,b,w,k,X,S,j){var s=Rn(B,k,X),t=si(B,k,X);gl(q,B,u(b-s/2),u(w-t/2),s,t,k,X,S,j)},drawStretchImage:function(L,r,N,D,X,i,V,Q,O,t,J,v){var F,W=Rn(r,Q,O,i),z=si(r,Q,O,V);"uniform"===N?(F=m(i/W,V/z),W*=F,z*=F,D+=u((i-W)/2),X+=u((V-z)/2),i=W,V=z):"centerUniform"===N&&((W>i||z>V)&&(F=m(i/W,V/z),W*=F,z*=F),D+=u((i-W)/2),X+=u((V-z)/2),i=W,V=z);var _=L.interactiveInfo;if(_){var C;if(C="center"===N?{x:D+i/2-W/2,y:X+V/2-z/2,width:W,height:z}:{x:D,y:X,width:i,height:V},_.rect){var U=_.compInfos,A=U.length;A&&(U[A-1].rect.image=r)}else _.rect=C}if("center"===N){var g=J!==!1&&(W>i||z>V);g&&(L.save(),L.beginPath(),L.rect(D,X,i,V),L.clip()),gl(L,r,D+i/2-W/2,X+V/2-z/2,W,z,Q,O,t,v),g&&L.restore()}else gl(L,r,D,X,i,V,Q,O,t,v)},toCanvas:function(A,N,G,l,w,e,y,s,b){A=wc(A,y),N=N||Rn(A,w),G=G||si(A,w);var h=wo(),V=Yl(h);return s?(sg(h,N,G,s),V.scale(s,s)):sg(h,N,G,1),Do(V,A,l,0,0,N,G,w,e,y,b),A&&A.clampToEdge&&(h.clampToEdge=A.clampToEdge),V.restore(),h},createGradientImage:function(j,z,t,S){for(var n=["L",0,0,j,0,1,0,0,1,0,0],P=0,c=Math.min(z.length,t.length);c>P;P++)n.push(t[P],z[P]);var O=o.Default.toCanvas({width:j,height:j,clampToEdge:!0,comps:[{type:"shape",rotation:S||0,points:[0,0,j,0,j,j,0,j],background:"#ffffff",gradientPack:n}]});return O},createElement:function(E,m,f,S){var p=z.createElement(E);return _i(p,m||c.widgetBorder,2),p.style.font=f?f:Km,S!=I&&(p.value=S),C.onElementCreated&&C.onElementCreated(p),p},containedInView:function(D,s){var f=hi(s).getBoundingClientRect();return Hd({x:f.left,y:f.top,width:f.width,height:f.height},ad(D))},isIsolating:function(){return rf>0},setIsolating:function(G){G?rf++:rf--},getMSMap:function(){return Zl},stringify:function(H,L){var r=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var Z=JSON.stringify(H,function(C,$){return"function"==typeof $?"__ht__"+($.__ht__||$.toString()):ip($)?In($):$},L==I?2:L);return Date.prototype.toJSON=r,Z},parse:function(Q){return hf(Q)?JSON.parse(Q,function(S,D){if(hf(D)){if("__ht__function"==D.substr(0,14)){var A=D.indexOf("{")+1,l=D.lastIndexOf("}"),Y=D.indexOf("(")+1,z=D.indexOf(")");if(A&&l&&Y&&z){var c=new Function(D.substring(Y,z),D.substring(A,l));return c.__ht__=D.substr(6),c}}if("__ht__date"==D.substr(0,10))return new Date(a(D.substr(10)))}return D}):Q},loadJS:function(t,G){G&&t.push(G);var H=t.shift();if(sk(H))t=H.contact(t),C.loadJS(t);else if(rn(H))H(),C.loadJS(t);else if(hf(H)){var Y=z.createElement("script");Y.onload=function(){C.loadJS(t)},Y.setAttribute("src",H),z.getElementsByTagName("head")[0].appendChild(Y)}else t.length&&C.loadJS(t)},toRoundedCorner:function(o,l){var s=o.size();if(0>=l)return{points:o};var i,B=new mk,F=new mk,$=o.get(0);B.add($),F.add(1);for(var p=1;s>p;p++)if(s>p+1){var t=o.get(p),Z=o.get(p+1),b=$.x,v=$.y,J=t.x,d=t.y,U=d-v,D=J-b,O=Y(U,D);i=m(.99*cd($,t),l),B.add({x:J-i*T(O),y:d-i*W(O)}),B.add(t),b=t.x,v=t.y,J=Z.x,d=Z.y,U=d-v,D=J-b,O=Y(U,D),i=m(.99*cd(t,Z),l),$={x:b+i*T(O),y:v+i*W(O)},B.add($),F.addAll([2,3])}else B.add(o.get(p)),F.add(2);return{points:B,segments:F}},toColorData:Xj,setCanvas:sg,createDiv:jd,createDisabledDiv:Gi,createView:zg,createCanvas:wo,appendChild:yj,initContext:Yl,checkLoadingImage:te,translateAndScale:Fb,layout:Pi,getPosition:ed,drawPoints:Xd,drawRoundRect:fl,drawBorder:Qe,setFocus:mr,getter:zn,setter:mh,isEmptyObject:Nl},!0),hj(y,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Bd=C.disabledOpacity,jq=C.toolTipDelay,kp=C.devicePixelRatio,qm=C.autoMakeVisible,Dg=C.autoHideScrollBar,on=C.imageGradient,gm=C.showToolTip,zh=C.hideToolTip,ss=C.dashPattern,vn=C.lineCap,Zm=C.lineJoin,Dd=C.labelColor,Qf=C.labelSelectColor,Km=C.labelFont,Cj=C.widgetIndent,Sp=C.widgetRowHeight,dl=C.widgetHeaderHeight,Vr=C.widgetTitleHeight,wp=C.scrollBarColor,Mr=C.scrollBarSize,Qo=C.scrollBarTimeout,je=C.scrollBarMinLength,Ee=C.scrollBarInteractiveSize,vf=C.zoomIncrement,Lk=C.scrollZoomIncrement,fg=C.pinchZoomIncrement,Ae=C.zoomMax,$b=C.zoomMin,ll=C.createObject,Pd=C.preventDefault,Fe=C.setImage,wc=C.getImage,Qb=C.isImageComplete,od=C.drawCenterImage,Do=C.drawStretchImage,Md=C.getId,jr=C.callLater,Ok=C.sortFunc,Tm=C.clone,tf=C.getClass,Wo=C.startAnim,he=C.brighter,jo=C.darker,Ni=C.drawText,ho=C.getTextSize,Ei=C.isLeftButton,lg=C.getTouchCount,Ro=C.isDoubleClick,_g=C.isShiftDown,Hg=C.isCtrlDown,ad=C.getClientPoint,cr=C.getPagePoint,cd=C.getDistance,we=C.unionPoint,Tr=C.unionRect,Hd=C.containsPoint,ap=C.containsRect,Tf=C.intersectsRect,To=C.intersection,Ef=C.getWindowInfo,Bs=C.grow,$r=C.getLogicalPoint,Qk=C.getScreenPoint,Bf=C.startDragging,gg=C.removeHTML,ps=C.createElement,Yo=C.segmentResolution,ri=C.shapeResolution,Hj=C.shapeSide,lf=C.def,Sb=function(d,x,O){lf(j+"."+d,x,O)},nr=function(L,q){L.childNodes.forEach(function(o){q(o),nr(o,q)})};hj(C,{toolTipLabelColor:Dd,toolTipLabelFont:Km,toolTipBackground:c.toolTipBackground,toolTipShadowColor:fd,drawBreakableText:vs,setDevicePixelRatio:function(J){kp=C.devicePixelRatio="number"==typeof J?J:_.devicePixelRatio,nr(z.body,function($){var P=$._ht;P&&P._canvas&&(sg(P._canvas,P.getWidth(),P.getHeight()),P.redraw?P.redraw():P.iv())})}},!0);var On=1e-6,Gn="undefined"!=typeof Uint16Array?Uint16Array:Array,zd="undefined"!=typeof Float32Array?Float32Array:Array,uq=function(m,Y,T){var p=[m[0]-Y[0],m[1]-Y[1],m[2]-Y[2]];if(T){var i=cd(p);i>0&&(p[0]/=i,p[1]/=i,p[2]/=i)}return p},lk=function(){var k="charCodeAt",n=2*(2*Vp.length+1);for(var a in _)if(a===j+_h[0]+hr.length){var m=_[a];if(!m)break;for(var E=m.length,R=0;E>R;R++)if(m[R][k](0)===n&&m[R+1]!=I&&m[R+1]===hr[0]&&m[R+2]!=I&&m[R+2][k](0)===n){for(var z=R+3;E>z;z++)if(m[z][k](0)===n){if(0==m[z+1])for(var v,H=z+2;E>H;H++){if(m[H][k](0)===n){0==m[H-1]&&v&&(s=v.substr(0,v.length-1));break}v==I?v=m[H]:v+=m[H]}break}break}break}return function(j){return[-j[0],-j[1],-j[2]]}}(),nf=function(A,_){return 3===A.length?A[0]*_[0]+A[1]*_[1]+A[2]*_[2]:A[0]*_[0]+A[1]*_[1]},Vd=function(){var A=new zd(16);return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A},Fk=Vd(),dc=function(P){var t=new zd(16);return t[0]=P[0],t[1]=P[1],t[2]=P[2],t[3]=P[3],t[4]=P[4],t[5]=P[5],t[6]=P[6],t[7]=P[7],t[8]=P[8],t[9]=P[9],t[10]=P[10],t[11]=P[11],t[12]=P[12],t[13]=P[13],t[14]=P[14],t[15]=P[15],t},Ql=function(B,P){return B[0]=P[0],B[1]=P[1],B[2]=P[2],B[3]=P[3],B[4]=P[4],B[5]=P[5],B[6]=P[6],B[7]=P[7],B[8]=P[8],B[9]=P[9],B[10]=P[10],B[11]=P[11],B[12]=P[12],B[13]=P[13],B[14]=P[14],B[15]=P[15],B},Io=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},$f=function(u,n){var L=u[0],B=u[1],b=u[2];return u[0]=n[0]*L+n[4]*B+n[8]*b+n[12],u[1]=n[1]*L+n[5]*B+n[9]*b+n[13],u[2]=n[2]*L+n[6]*B+n[10]*b+n[14],u},Go=function(o,R){var U=o[0],x=o[1],H=o[2],J=o[3];return o[0]=R[0]*U+R[4]*x+R[8]*H+R[12]*J,o[1]=R[1]*U+R[5]*x+R[9]*H+R[13]*J,o[2]=R[2]*U+R[6]*x+R[10]*H+R[14]*J,o[3]=R[3]*U+R[7]*x+R[11]*H+R[15]*J,o},Al=function(){var n,i,d,V,A=oj(Fh[1]+Fh[7]),z=oj(Fh[0]+Fh[3]-Fh[10]),m=oj(Fh[8]+2),I=function(){return i=d.charAt(n),n+=1,i},U=function(){var f="";if(i===m)for(;I();){if(i===m)return I(),f;f+=i}else I()},u=function(){for(;i&&" ">=i;)I()},X=function(){var s,L={};if(i===A){if(I(),u(),i===z)return I(),L;for(;i;){if(s=U(),u(),I(),L[s]=V(),u(),i===z)return I(),L;I(),u()}}};return V=function(){switch(u(),i){case A:return X();default:return U()}},function(G){if(M={},G){var x;if(d=G,n=0,i=" ",x=V(),u(),!i)return x}}}(),yp=function(f,N){if(N){var p=W(N),C=T(N),J=f[4],x=f[5],Z=f[6],P=f[7],d=f[8],i=f[9],O=f[10],$=f[11];f[4]=J*C+d*p,f[5]=x*C+i*p,f[6]=Z*C+O*p,f[7]=P*C+$*p,f[8]=d*C-J*p,f[9]=i*C-x*p,f[10]=O*C-Z*p,f[11]=$*C-P*p}},nk=function(f,b){if(b){var O=W(b),Z=T(b),G=f[0],v=f[1],j=f[2],z=f[3],o=f[8],I=f[9],g=f[10],E=f[11];f[0]=G*Z-o*O,f[1]=v*Z-I*O,f[2]=j*Z-g*O,f[3]=z*Z-E*O,f[8]=G*O+o*Z,f[9]=v*O+I*Z,f[10]=j*O+g*Z,f[11]=z*O+E*Z}},mc=function(N,A){if(A){var H=W(A),Z=T(A),e=N[0],$=N[1],Y=N[2],j=N[3],m=N[4],F=N[5],x=N[6],f=N[7];N[0]=e*Z+m*H,N[1]=$*Z+F*H,N[2]=Y*Z+x*H,N[3]=j*Z+f*H,N[4]=m*Z-e*H,N[5]=F*Z-$*H,N[6]=x*Z-Y*H,N[7]=f*Z-j*H}},Vl=function(j,c,i){return qq(I,i===!1?I:j.getFinalScale3d(),j.getFinalRotation3d(),j.getRotationMode(),j.p3(),I,c)},qq=function(z,X,s,g,P,Y,$){return Y||(Y=Vd()),P&&nq(Y,P),kc(Y,s,g),$&&vl(Y,Y,$),X&&xh(Y,X),z&&vl(Y,Y,z),Y},Dl=function(Z,x,n){x=a(x),n=a(n);var f=this;f.g=Z,f._84O=x,f._85O=n,f._70I=!0,f.F=0,f._83O=x+n,f.pen={x:0,y:0}},vh="lineDashOffset",vr="setLineDash",Il=function(f){for(var E in f)1===E.length&&(vh=f[E]);return E?1:0},Aq=function(K,i,m){return _o(i)?K:K[vr]?(K[vr](i),m&&(K.lineDashOffset=m),K):new Dl(K,i[0],i.length>1?i[1]:i[0])},tr=function(M,q){!_o(q)&&M[vr]&&(M[vr](cb),M.lineDashOffset=0)};if(lf(Dl,V,{_69I:6,moveTo:function(x,t){var S=this,B=S.pen;B.x=x,B.y=t,S.g.moveTo(x,t),S.start||(S.start={x:x,y:t})},lineTo:function(R,A){var h=this,q=h.pen,t=R-q.x,C=A-q.y,i=Y(C,t),l=T(i),m=W(i),e=h._23O(q.x,q.y,R,A),n=h._85O,P=h._84O,z=h._83O;if(h.F){if(h.F>e)return h._70I?h._72I(R,A):h.moveTo(R,A),h.F-=e,void 0;if(h._70I?h._72I(q.x+l*h.F,q.y+m*h.F):h.moveTo(q.x+l*h.F,q.y+m*h.F),e-=h.F,h.F=0,h._70I=!h._70I,!e)return}var Q=B(e/z);if(Q){for(var J=l*P,v=m*P,j=l*n,Z=m*n,S=0;Q>S;S++)h._70I?(h._72I(q.x+J,q.y+v),h.moveTo(q.x+j,q.y+Z)):(h.moveTo(q.x+j,q.y+Z),h._72I(q.x+J,q.y+v));e-=z*Q}h._70I?e>P?(h._72I(q.x+l*P,q.y+m*P),h.moveTo(R,A),h.F=n-(e-P),h._70I=!1):(h._72I(R,A),e===P?(h.F=0,h._70I=!h._70I):(h.F=P-e,h.moveTo(R,A))):e>n?(h.moveTo(q.x+l*n,q.y+m*n),h._72I(R,A),h.F=P-(e-n),h._70I=!0):(h.moveTo(R,A),e===n?(h.F=0,h._70I=!h._70I):h.F=n-e)},quadraticCurveTo:function(U,z,C,M){var K,F=this,Q=F.pen,v=Q.x,Y=Q.y,c=F._22O(v,Y,U,z,C,M),e=0,H=0,l=F._85O,u=F._84O;if(F.F){if(F.F>c)return F._70I?F._71I(U,z,C,M):F.moveTo(C,M),F.F-=c,void 0;if(e=F.F/c,K=F._20O(v,Y,U,z,C,M,e),F._70I?F._71I(K[2],K[3],K[4],K[5]):F.moveTo(K[4],K[5]),F.F=0,F._70I=!F._70I,!c)return}var p=c-c*e,O=B(p/F._83O),N=u/c,w=l/c;if(O)for(var m=0;O>m;m++)F._70I?(H=e+N,K=F._21O(v,Y,U,z,C,M,e,H),F._71I(K[2],K[3],K[4],K[5]),e=H,H=e+w,K=F._21O(v,Y,U,z,C,M,e,H),F.moveTo(K[4],K[5])):(H=e+w,K=F._21O(v,Y,U,z,C,M,e,H),F.moveTo(K[4],K[5]),e=H,H=e+N,K=F._21O(v,Y,U,z,C,M,e,H),F._71I(K[2],K[3],K[4],K[5])),e=H;p=c-c*e,F._70I?p>u?(H=e+N,K=F._21O(v,Y,U,z,C,M,e,H),F._71I(K[2],K[3],K[4],K[5]),F.moveTo(C,M),F.F=l-(p-u),F._70I=!1):(K=F._19O(v,Y,U,z,C,M,e),F._71I(K[2],K[3],K[4],K[5]),c===u?(F.F=0,F._70I=!F._70I):(F.F=u-p,F.moveTo(C,M))):p>l?(H=e+w,K=F._21O(v,Y,U,z,C,M,e,H),F.moveTo(K[4],K[5]),K=F._19O(v,Y,U,z,C,M,H),F._71I(K[2],K[3],K[4],K[5]),F.F=u-(p-l),F._70I=!0):(F.moveTo(C,M),p===l?(F.F=0,F._70I=!F._70I):F.F=l-p)},bezierCurveTo:function(){var t=arguments;this.pen={x:t[4],y:t[5]},this.g.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},arc:function(U,k,c,p,M,N){N||(p=-p,M=-M),Lf(this,U,k,p,M-p,c,c,!1)},rect:function(V,H,t,C){var j=this;j.pen={x:V,y:H},j.moveTo(V,H),j.lineTo(V,H+C),j.lineTo(V+t,H+C),j.lineTo(V+t,H),j.lineTo(V,H)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(Y,y,p,e){var W=p-Y,K=e-y;return v(W*W+K*K)},_22O:function(Z,B,N,X,$,w,S){for(var v,l,f,t,M,o,P,s=0,u=Z,D=B,b=S>0?S:this._69I,O=1;b>=O;O++)f=O/b,t=1-f,M=t*t,o=2*f*t,P=f*f,v=M*Z+o*N+P*$,l=M*B+o*X+P*w,s+=this._23O(u,D,v,l),u=v,D=l;return s},_21O:function(u,P,z,l,h,o,N,v){var d=this;if(0===N)return d._20O(u,P,z,l,h,o,v);if(1===v)return d._19O(u,P,z,l,h,o,N);var G=d._20O(u,P,z,l,h,o,v);return G.push(N/v),d._19O.apply(d,G)},_20O:function(E,r,b,N,s,p,d){if(1!==d){var W=b+(s-b)*d,M=N+(p-N)*d;b=E+(b-E)*d,N=r+(N-r)*d,s=b+(W-b)*d,p=N+(M-N)*d}return[E,r,b,N,s,p]},_19O:function(O,k,z,r,f,a,y){if(1!==y){var R=O+(z-O)*y,p=k+(r-k)*y;z+=(f-z)*y,r+=(a-r)*y,O=R+(z-R)*y,k=p+(r-p)*y}return[O,k,z,r,f,a]},_72I:function(K,Q){var T=this.pen;(K!==T.x||Q!==T.y)&&(T.x=K,T.y=Q,this.g.lineTo(K,Q))},_71I:function(H,s,p,O){var L=this.pen;(H!==p||s!==O||p!==L.x||O!==L.y)&&(L.x=p,L.y=O,this.g.quadraticCurveTo(H,s,p,O))}}),k&&l){var Ln=l.toString();P=Ln.indexOf(Co.substr(0,2))>0&&Ln.indexOf(Rd+Rd.substr(1,1))>1||Ln.indexOf(bf.substr(0,2)+Co.substr(2,2)+_h[0]+Co[4])>1?!0:!1}!0&&_.console&&(_.navigator&&_.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?_.console.log.apply(console,["Hightopo - Version"+o.Default.getVersion()+" - %chttp://hightopo.com/request.html","color: #f00;"]):_.console.log("Hightopo - Version"+o.Default.getVersion()+" - http://hightopo.com/request.html"));var $i=I,uh=I,Wl=function(M){$i&&!M._72O&&(uh||(uh={}),uh[M._72O=Md()]=M)},_f=function(X,A){if(A||(A=X),A&&($i||($i={}),!$i[X])){var r=new xn;if($i[A]={request:r,url:A},A=C.beforeLoadURL(A),A.data){var M=C.parse(A.data);Zi(X,M),C.handleCompTypeLoaded(X,M)}else{r.onload=function(g){if(200===this.status||0===this.status){var E=C.parse(g.target.response||g.target.responseText);Zi(X,E),C.handleCompTypeLoaded(X,E)}else Zi(X,I)},r.onerror=function(){Zi(X,I)};var E={};E.url=encodeURI(A),E.sync=!1,r.send(E)}}},Zi=function(L,C){if(Pj[L]=C,delete $i[L],Nl($i)&&($i=I,uh)){for(var K in uh){var H=uh[K];H.invalidateAll&&H.invalidateAll(Z,"compTypeLoaded",L),H.redraw&&H.redraw(),H.iv(),delete H._72O}uh=I}if(C&&uh)for(var K in uh){var H=uh[K];H.invalidateAll&&H.invalidateAll(Z,"compTypeLoading",L),H.redraw&&H.redraw(),H.iv()}},ac=c.chart,Db=C.compStack=[],ln=/^style@/,qb=/^attr@/,gc=/^field@/,Pf={x:.5,y:.5},Rn=function(T,w,v,b){if(!T)return 0;if(Tq(T.fitSize,w,v)&&b)return b;var I=Tq(T.width,w,v);return null==I?20:I},si=function(q,z,c,J){if(!q)return 0;if(Tq(q.fitSize,z,c)&&J)return J;var w=Tq(q.height,z,c);return null==w?20:w},Tq=function(u,w,l){if(!u||!u.func)return u;var p,g=u.func,F=u.value;return p=rn(g)?l&&l.vectorDataBindingDisabled&&!u.isSafeFunc?F:g(w,l):w instanceof Tn?qb.test(g)?w.a(g.slice(5)):ln.test(g)?w.s(g.slice(6)):gc.test(g)?w[g.slice(6)]:w[g]?w[g](l):F:F,F!==Z&&p==I?F:p},gl=C.drawImage=function(){var L,u,F,J,e,$,E=function($,K){$.getValue&&$.getValue.compType===K||($.getValue=function(E){var m=v($,E);if(m===Z&&K.properties){var R=K.properties[E];R&&(m=R.defaultValue)}return m},$.getValue.compType=K)},v=function(W,l,q){var y=W[l];return y&&y.func?(y=Tq(y,u,F),q&&(y=q(y))):q&&(y=W[l]=q(y)),y},o=function(D,n){var I;if(I=n?v(D,n):D,e&&I){if("override"===$)return e;if("override_rgb"===$){var E=fh(e);return I=Xj(I),"rgba("+B(255*E[0])+","+B(255*E[1])+","+B(255*E[2])+","+I[3]/255+")"}if("override_a"===$){var E=fh(e);return I=Xj(I),"rgba("+I[0]+","+I[1]+","+I[2]+","+E[3]+")"}var E=fh(e);return I=Xj(I),"rgba("+B(I[0]*E[0])+","+B(I[1]*E[1])+","+B(I[2]*E[2])+","+I[3]/255*E[3]+")"}return I},S=function(X){if(sk(X)){for(var k=new mk,J=X.length,h=0;J>h;h+=2)k.add({x:X[h],y:X[h+1]});X=k}return X},A=function(I){var O=v(I,"anchorX"),r=v(I,"anchorY");if(O!==Z||r!==Z)return{x:O===Z?Pf.x:O,y:r===Z?Pf.y:r};var B=v(I,"type"),t=v(I,"name");if("image"!==B||!t)return Pf;var n=wc(t);return n&&n.anchorX!==Z&&n.anchorY!==Z?{x:n.anchorX,y:n.anchorY}:Pf},X=function(F,z){var C=v(F,am),h=A(F);if(sk(C)){var m=C.length,G=v(F,"relative"),e=z.width,X=z.height;if(4===m)C={x:C[0],y:C[1],width:C[2],height:C[3]},G?(C.x*=e,C.y*=X,C.width*=e,C.height*=X):z.fitSize&&(C.x*=z.widthScale,C.width*=z.widthScale,C.y*=z.heightScale,C.height*=z.heightScale);else if(3===m){var $=C[0];C={width:C[1],height:C[2]},G?(C.width*=e,C.height*=X):z.fitSize&&(C.width*=z.widthScale,C.height*=z.heightScale),"object"==typeof $?$.length&&($={x:$[0],y:$[1]}):$=ed($,z,C),C.x=$.x-C.width*h.x,C.y=$.y-C.height*h.y}var K=v(F,"offsetX");K&&(z.fitSize&&(K*=z.widthScale),C.x+=K),K=v(F,"offsetY"),K&&(z.fitSize&&(K*=z.heightScale),C.y+=K)}return C},M=function(r){return sk(r)?new mk(r):r},N=function(X,b,A,f,l,P,n){var M=L.interactiveInfo,R=X.transform;if(R)return L.save(),L.setTransform(R.a,R.b,R.c,R.d,R.tx,R.ty),M&&M.compInfos.push({comp:X,rect:b,matrix:R.clone()}),!0;l===Z&&(l=1),P===Z&&(P=1);var g=v(X,"clipPercentage"),Y=Ff(A,b);if(Y&&!f&&1===l&&1===P&&!(1>g))return M&&M.compInfos.push({comp:X,rect:b,matrix:M.matrix.clone()}),!1;n=n||Pf;var a=b.x+b.width*n.x,U=b.y+b.height*n.y,T=A.x+A.width*n.x,e=A.y+A.height*n.y,k=A.width?l*(b.width/A.width):1,x=A.height?P*(b.height/A.height):1;if(L.save(),M&&(M.matrix.appendTranslate(a,U).appendRotate(f).appendScale(k,x).appendTranslate(-T,-e),M.compInfos.push({comp:X,rect:b,matrix:M.matrix.clone()})),Uf(L,a,U),Fq(L,f||0),mn(L,k,x),Uf(L,-T,-e),1>g){0>g&&(g=0);var s=bc(A,v(X,"clipDirection"),g);L.beginPath(),L.rect(s.x,s.y,s.width,s.height),L.clip()}return!0},a=function(){L.restore()},H=function(K,U,Q){var E=v(K,"path"),c=v(K,qo),Y=v(K,"scaleX"),G=v(K,"scaleY"),X=A(K),r=I,O=jg(null,E);if(Q||(Q=K.unionRect,Q||(Q=we(O),K.path.func||(K.unionRect=Q)),r=Q),Q){r||(r=K.unionRect,r||(r=we(O),K.path.func||(K.unionRect=r)));var i=N(K,Q,r,c,Y,G,X),l=v(K,"borderPattern"),C=Aq(L,l),F=o(K,"background"),S=o(K,"borderColor"),y=v(K,"borderWidth"),T=v(K,"gradient"),u=o(K,"gradientColor"),t=v(K,"border3d"),w=v(K,"border3dColor"),m=v(K,"border3dAccuracy"),d=L.lineJoin,B=L.lineCap;if(L.lineJoin=v(K,"borderJoin")||Zm,L.lineCap=v(K,"borderCap")||vn,F?(Gq(L,F,T,u,r),jg(L,E),L.fill(),C!==L&&jg(L,E)):jg(L,E),y&&S){var j=v(K,"borderWidthAbsolute");j&&(L.save(),L.setTransform(1,0,0,1,0,0)),L.lineWidth=y,L.strokeStyle=S,L.stroke(),j&&L.restore(),t&&jn(L,S,w,y,J,m)}if(tr(L,l),v(K,"dash")){var V=v(K,"dashWidth")||y;if(V>0){l=v(K,"dashPattern")||ss;var C=Aq(L,l,v(K,"dashOffset")),e=o(K,"dashColor")||o(Mp);C!==L&&jg(L,E),L.strokeStyle=e,L.lineWidth=V,L.stroke(),v(K,"dash3d")&&jn(L,e,o(K,"dash3dColor"),V,J,v(K,"dash3dAccuracy")),tr(L,l)}}U===am&&Mk(L,F,v(K,"depth"),r),L.lineJoin=d,L.lineCap=B,i&&a()}},d=function(p,D,z,l){var U=v(p,Rl,S),C=v(p,qo),K=A(p);if(U&&l.fitSize){var H=Math.abs(Math.cos(C))<.001,R=new mk,w=we(U),y=l.widthScale,B=l.heightScale,Z=w.x+K.x*w.width,j=w.y+K.y*w.height,f=Z*y,b=j*B;U.each(function(x){var $=x.x-Z,M=x.y-j;R.add({x:f+$*(H?B:y),y:b+M*(H?y:B)})}),U=R,p.unionRect=null}var W=v(p,"scaleX"),t=v(p,"scaleY"),q=D===Be,c=I;if(!z&&q&&(z=p.unionRect,z||(z=we(U),p.points.func||(p.unionRect=z)),c=z),z){q?c||(c=p.unionRect,c||(c=we(U),p.points.func||(p.unionRect=c))):c=z;var T,_,P,V,k=N(p,z,c,C,W,t,K),s=v(p,"borderPattern"),E=Aq(L,s),h=o(p,"background"),n=wc(v(p,"repeatImage"),e,$),X=v(p,"gradientPack"),r=o(p,"borderColor"),O=v(p,"borderWidth"),i=v(p,"segments",M),m=v(p,"gradient"),g=o(p,"gradientColor"),d=v(p,"border3d"),Y=v(p,"border3dColor"),Q=v(p,"border3dAccuracy"),G=v(p,"closePath"),x=v(p,"fillRule")||"nonzero",Qp=L.lineJoin,Jg=L.lineCap;if(L.lineJoin=v(p,"borderJoin")||Zm,L.lineCap=v(p,"borderCap")||vn,q)if(h||n||X){var ol=v(p,"fillClipPercentage");if(1>ol){0>ol&&(ol=0);var Pk=bc(c,v(p,"fillClipDirection"),ol);L.save(),L.beginPath(),L.rect(Pk.x,Pk.y,Pk.width,Pk.height),L.clip()}if(Xd(L,U,i,G),X)Ol(L,X);else if(n){var tk=L,uh=e,ap=$;Oc(L,n,e,$,u,F),L=tk,e=uh,$=ap}else{var tk=L;Gq(L,h,m,g,c),L=tk}L.fill(x),1>ol&&L.restore(),X&&L.restore(),E!==L&&Xd(E,U,i,G)}else Xd(E,U,i,G);else if("roundRect"===D?T=v(p,"cornerRadius"):"polygon"===D?T=v(p,"polygonSide"):"arc"===D&&(T=v(p,"arcFrom"),_=v(p,"arcTo"),P=v(p,"arcClose"),V=v(p,"arcOval")),h||n||X){var ol=v(p,"fillClipPercentage");if(1>ol){0>ol&&(ol=0);var Pk=bc(c,v(p,"fillClipDirection"),ol);L.save(),L.beginPath(),L.rect(Pk.x,Pk.y,Pk.width,Pk.height),L.clip()}if(Om(L,D,c,T,_,P,V),X)Ol(L,X);else if(n){var tk=L,uh=e,ap=$;Oc(L,n,e,$,u,F),L=tk,e=uh,$=ap}else Gq(L,h,m,g,c);L.fill(x),1>ol&&L.restore(),X&&L.restore(),L!==E&&Om(E,D,c,T,_,P,V)}else Om(E,D,c,T,_,P,V);if(O&&r){var Ff=v(p,"borderWidthAbsolute");Ff&&(L.save(),L.setTransform(1,0,0,1,0,0)),L.lineWidth=O,L.strokeStyle=r,L.stroke(),Ff&&L.restore(),d&&jn(L,r,Y,O,J,Q)}if(tr(L,s),v(p,"dash")){var Ji=v(p,"dashWidth")||O;if(Ji>0){s=v(p,"dashPattern")||ss;var E=Aq(L,s,v(p,"dashOffset")),Pp=o(p,"dashColor")||o(Mp);E!==L&&(q?Xd(E,U,i,G):Om(E,D,c,T,_,P,V)),L.strokeStyle=Pp,L.lineWidth=Ji,L.stroke(),v(p,"dash3d")&&jn(L,Pp,o(p,"dash3dColor"),Ji,J,v(p,"dash3dAccuracy")),tr(L,s)}}D===am&&Mk(L,h,v(p,"depth"),c),L.lineJoin=Qp,L.lineCap=Jg,k&&a()}},z=function(x,d){var h=e,r=$,P=e||v(x,hs),K=$||v(x,"blendMode"),R=wc(v(x,"name"),P,K);R&&(Do(L,R,v(x,"stretch"),d.x,d.y,d.width,d.height,u,F,P,null,K),e=h,$=r)},k=function(M,K){var y=v(M,"text");y!=I&&Ni(L,y,v(M,"font"),o(M,hs),K.x,K.y,K.width,K.height,v(M,"align"),v(M,"vAlign"))},R=function(t,I){Qe(L,o(t,hs),I.x,I.y,I.width,I.height,v(t,"width"))},f=function(O,F){var h=v(O,rr),S=0;if(h&&(h.forEach(function(Z){S+=Z}),S>0)){for(var s=v(O,"colors")||ac,g=v(O,"startAngle")||0,q=v(O,"hollow"),e=v(O,Ko),t=v(O,ce),Z=v(O,bq),A=e?new mk:I,E=F.x,C=F.y,k=F.width,B=F.height,f=E+k/2,J=C+B/2,y=m(k,B)/2,Y=0,l=0;l<h.length;l++){var r=h[l],a=i*r/S,z=g+a;if(L.fillStyle=s[Y++],Y===s.length&&(Y=0),L.beginPath(),q){var V=f+T(g)*y/2,G=J+W(g)*y/2,N=f+T(z)*y,M=J+W(z)*y;L.moveTo(V,G),L.arc(f,J,y/2,g,z,!1),L.lineTo(N,M),L.arc(f,J,y,z,g,!0)}else L.moveTo(f,J),L.arc(f,J,y,z,g,!0);A&&(a=(g+z)/2,A.add({text:rn(e)?e(r,l,S,u):r,x:f+.75*T(a)*y,y:J+.75*W(a)*y})),L.closePath(),L.fill(),g=z}A&&A.each(function(s){Ni(L,s.text,t,Z,s.x,s.y,0,0,lr)})}},q=function(Q,P){var i=v(Q,im);if(i&&i.length>0){var U=i.length,h=v(Q,Ko),t=v(Q,ce),R=v(Q,bq),q=h?new mk:I,z=v(Q,"minValue")||0,D=v(Q,"maxValue");if(D==I&&(D=0,i.forEach(function(w){v(w,rr).forEach(function(c){D=K(D,c)})})),z===D)return;for(var l=P.height/(D-z),M=P.y+D*l,C=v(i[0],rr).length,p=P.width/(3*C+1),y=2*p/U,E=0,T=0;U>T;T++)for(var H=i[T],X=v(H,hs),O=v(H,"colors"),S=v(H,rr),V=0;C>V;V++){O?L.fillStyle=O[V]:X?L.fillStyle=X:(L.fillStyle=ac[E++],E===ac.length&&(E=0));var c=S[V],k=c*l,A=P.x+(1+3*V)*p+T*y;if(Uc(L,A,M-k,y,k),q){var b=rn(h)?h(c,V,H,u):c,g=ho(t,b).height;q.add({x:A,y:M-k-g,width:y,height:g,text:b})}}q&&q.each(function(Q){Ni(L,Q.text,t,R,Q.x,Q.y,Q.width,Q.height,lr)})}},V=function(H,q){var g=v(H,im);if(g&&g.length>0){var U=g.length,M=v(g[0],rr).length,W=q.width/(3*M+1),w=0,G=v(H,"maxValue"),p=v(H,Ko),Y=v(H,ce),r=v(H,bq),b=p?new mk:I;if(G==I){G=0;for(var _=0;M>_;_++){for(var J=0,B=0;U>B;B++)J+=v(g[B],rr)[_];G=K(G,J)}}if(G>0){for(var _=0;M>_;_++)for(var y=q.y+q.height,B=0;U>B;B++){var j=g[B],k=v(j,hs),c=v(j,rr)[_],F=c/G*q.height;k?L.fillStyle=k:(L.fillStyle=ac[w++],w===ac.length&&(w=0)),y-=F;var o={x:q.x+(1+3*_)*W,y:y,width:2*W,height:F};Uc(L,o.x,o.y,o.width,o.height),b&&(o.text=rn(p)?p(c,_,j,u):c,b.add(o))}b&&b.each(function(R){Ni(L,R.text,Y,r,R.x,R.y,R.width,R.height,lr)})}}},D=function(H,g){var N=v(H,im);if(N&&N.length>0){for(var k=N.length,s=v(N[0],rr).length,F=g.width/(3*s+1),O=0,Y=v(H,Ko),n=v(H,ce),f=v(H,bq),m=Y?new mk:I,X=0;s>X;X++){for(var w=0,l=0;k>l;l++)w+=v(N[l],rr)[X];if(w>0){var C=g.y+g.height;for(l=0;k>l;l++){var r=N[l],W=v(r,hs),Z=v(r,rr)[X],q=Z/w*g.height;W?L.fillStyle=W:(L.fillStyle=ac[O++],O===ac.length&&(O=0)),C-=q;var G={x:g.x+(1+3*X)*F,y:C,width:2*F,height:q};Uc(L,G.x,G.y,G.width,G.height),m&&(G.text=rn(Y)?Y(Z,X,r,u):Z,m.add(G))}}}m&&m.each(function(p){Ni(L,p.text,n,f,p.x,p.y,p.width,p.height,lr)})}},j=function(o,t){var N=v(o,im);if(N&&N.length>0){var e=N.length,U=v(o,"minValue")||0,E=v(o,"maxValue");if(E==I&&(E=0,N.forEach(function(G){v(G,rr).forEach(function(F){E=K(E,F)})})),U===E)return;for(var g=t.height/(E-U),w=t.y+E*g,S=v(N[0],rr).length,H=t.width/(3*S+1),Y=0,j=v(o,"lineWidth")||2,R=v(o,"line3d"),A=v(o,"linePoint"),P=v(o,Ko),Z=v(o,ce),T=v(o,bq),x=0;e>x;x++){var W=N[x],$=v(W,hs),C=v(W,rr);$?L.strokeStyle=$:($=L.strokeStyle=ac[Y++],Y===ac.length&&(Y=0)),L.beginPath();for(var k=0;S>k;k++){var n=t.x+(2+3*k)*H,r=w-C[k]*g;0===k?L.moveTo(n,r):L.lineTo(n,r)}if(L.lineWidth=j,L.stroke(),R&&jn(L,$,I,j,J),A||P){var b,G=j/2+2;for(k=0;S>k;k++){var F=C[k];if(n=t.x+(2+3*k)*H,r=w-F*g,rn(A)?A(L,n,r,$,k,W,u):A&&(L.fillStyle=$,L.beginPath(),L.arc(n,r,G,0,i,!0),L.fill()),rn(P)?b=P(F,k,W,u):P&&(b=F),b){var l=ho(Z,b).height,a=L.shadowBlur;if(a){var X=L.shadowOffsetX,m=L.shadowOffsetY,h=L.shadowColor;L.shadowOffsetX=0,L.shadowOffsetY=0,L.shadowBlur=0,L.shadowColor=I}Ni(L,b,Z,T,n,r-l-G+2,0,l,lr),a&&(L.shadowOffsetX=X,L.shadowOffsetY=m,L.shadowBlur=a,L.shadowColor=h)}}}}}},l=function(){L=null,u=null,F=null},n={border:R,image:z,text:k,pieChart:f,columnChart:q,stackedColumnChart:V,percentageColumnChart:D,lineChart:j};return function(g,j,f,z,P,k,U,K,w,r){if(j&&P&&k){var c=L?!1:!0;L=g,u=U,F=K,J=F?F._zoom?F._zoom:1:1,e=w,$=r;var t=P,Y=k;if(Dn()){var q,W,Q;0===L[Wi]?Dn[0]&&(q=!0):q=!0,L.texureImage2D?Dn[1]&&(W=!0):W=!0,L.texureImage3D?Dn[2]&&(Q=!0):Q=!0,q&&W&&Q&&(t=f,Y=z)}if(j.tagName)return hf(s)&&!_[s]||L.drawImage(j,t,Y,P,k),c&&l(),void 0;if(v(j,"visible")===!1)return c&&l(),void 0;e||(e=Tq(j.color,u,F)),r||($=Tq(j.blendMode,u,F)),hf(s)&&!_[s]&&(P=t,k=Y);var y=Rn(j,u,F,P),p=si(j,u,F,k),x={x:0,y:0,width:y,height:p,fitSize:v(j,"fitSize")},R=v(j,"clip"),m=v(j,"opacity");if(x.fitSize&&(x.widthScale=y/Tq(j.width,u,F),x.heightScale=p/Tq(j.height,u,F)),L.save(),L.interactiveInfo){var D=L.interactiveInfo.matrix,B=D.clone();D.appendTranslate(t,Y).appendScale(P/y,k/p)}Uf(L,t,Y),(y!==P||p!==k)&&L.scale(P/y,k/p),R&&(rn(R)?R(L,y,p,u,F,j):(L.beginPath(),L.rect(0,0,y,p),L.clip())),m!=I&&(L.globalAlpha*=m),v(j,"comps").forEach(function(K){if(v(K,qs)!==!1){if(Db.splice(0,0,K),L.interactiveInfo)var Y=L.interactiveInfo.matrix.clone();var _=v(K,"opacity"),g=v(K,"shadow"),R=v(K,"type"),y=X(K,x);if(_!=I){var q=L.globalAlpha;L.globalAlpha*=_}if(g){var m=L.shadowOffsetX,j=L.shadowOffsetY,z=L.shadowBlur,t=L.shadowColor,U=v(K,"shadowOffsetX"),W=v(K,"shadowOffsetY"),r=v(K,"shadowBlur"),e=o(K,"shadowColor");L.shadowOffsetX=(U==I?3:U)*J,L.shadowOffsetY=(W==I?3:W)*J,L.shadowBlur=(r==I?6:r)*J,L.shadowColor=e||o(Ag)}if("save"===R)L.save();else if("endClip"===R||"restore"===R)L.restore();else if("clip"===R)L.save(),Xd(L,v(K,"points",S),v(K,"segments",M),!0),L.clip();else if(Xo[R])y=y||{x:0,y:0,width:x.width,height:x.height},d(K,R,y,x);else if(R===Be)d(K,R,y,x);else if("SVGPath"===R)H(K,R,y);else{y=y||{x:0,y:0,width:x.width,height:x.height};var i=v(K,qo),G=v(K,"scaleX"),B=v(K,"scaleY"),l=A(K),h=N(K,y,y,i,G,B,l);if(rn(R))E(K,R),C.drawCompType(R,L,y,K,u,F);else if(C.getCompType(R)){var T=C.getCompType(R),O=T.func||T;E(K,T),C.drawCompType(O,L,y,K,u,F)}else n[R]?n[R](K,y):C.getCompType(R)===Z&&Yj.test(R)&&_f(R);h&&a()}g&&(L.shadowOffsetX=m,L.shadowOffsetY=j,L.shadowBlur=z,L.shadowColor=t),_!=I&&(L.globalAlpha=q),L.interactiveInfo&&(L.interactiveInfo.matrix=Y),Db.splice(0,1)}}),L.interactiveInfo&&(L.interactiveInfo.matrix=B),L.restore(),c&&l()}}}();C.getCurrentComp=function(){return Db[0]},C.getParentComp=function(){return Db[1]},C.getInternal=function(){return{isEnter:Bo,isEsc:br,isSpace:ci,isLeft:Fp,isUp:sh,isRight:vd,isDown:qc,addMethod:hj,superCall:lp,toPointsArray:hk,translateAndScale:Fb,appendArray:sm,createWorldMatrix:qq,vec3TransformMat4:$f,setCanvas:sg,createDiv:jd,createView:zg,createCanvas:wo,createImage:Bg,initContext:Yl,layout:Pi,fillRect:Uc,Mat:lh,drawBorder:Qe,isString:hf,setBorder:_i,getPropertyValue:mb,setPropertyValue:Nj,drawVerticalLine:up,draw3DRect:Mk,getPinchDist:em,isSameRect:Ff,getPosition:ed,intersectionLineRect:Ll,getNodeRect:dp,getEdgeAgentPosition:an,getImageWidth:Rn,getImageHeight:si,initItemElement:Hi,drawPoints:Xd,createG2:Aq,closePopup:Fn,isH:tj,createAnim:Ld,createNormalMatrix:Tp,createNormals:Dr,toFloatArray:ek,glMV:ug,batchShape:Iq,createNodeMatrix:Vl,getFaceInfo:Hk,transformAppend:nb,drawFaceInfo:Eg,to3dPointsArray:ih,setGLDebugMode:function(n){Uj=n},cube:function(){return{vs:Wb,is:xk,uv:Ug}},ui:function(){return{DataUI:rm,NodeUI:vm,EdgeUI:Rg,GroupUI:Hc,ShapeUI:Ym,GridUI:_k,Data3dUI:zc,Node3dUI:$n,Shape3dUI:Zk}},getInternalVersion:function(){return"U2FsdGVkX1/AGQ86izf6VMDa2PXDoqODMYRhhAVQNwY="},getDragger:function(){return Vo},addMSMap:function(S){hj(Zl,S)},k:d}},function(z){function e(R,w){R!=I&&(w==I&&ei!=typeof R?this._54O(R,256):this._54O(R,w))}function F(){return new e(I)}function q(L,x,X,P,u,E){for(;--E>=0;){var w=x*this[L++]+X[P]+u;u=B(w/67108864),X[P++]=67108863&w}return u}function Z(y,G,Y,e,u,A){for(var s=32767&G,N=G>>15;--A>=0;){var n=32767&this[y],p=this[y++]>>15,i=N*n+p*s;n=s*n+((32767&i)<<15)+Y[e]+(1073741823&u),u=(n>>>30)+(i>>>15)+N*p+(u>>>30),Y[e++]=1073741823&n}return u}function w(l,k,L,d,Z,u){for(var N=16383&k,v=k>>14;--u>=0;){var K=16383&this[l],F=this[l++]>>14,R=v*K+F*N;K=N*K+((16383&R)<<14)+L[d]+Z,Z=(K>>28)+(R>>14)+v*F,L[d++]=268435455&K}return Z}function O(J){return wn.charAt(J)}function H(W,X){var t=ks[W.charCodeAt(X)];return t==I?-1:t}function o(H){for(var b=this.t-1;b>=0;--b)H[b]=this[b];H.t=this.t,H.s=this.s}function P(d){this.t=1,this.s=0>d?-1:0,d>0?this[0]=d:-1>d?this[0]=d+this.DV:this.t=0}function Q(b){var n=F();return n._58O(b),n}function r(Y,D){var R,Z=this;if(16==D)R=4;else if(8==D)R=3;else if(256==D)R=8;else if(2==D)R=1;else if(32==D)R=5;else{if(4!=D)return Z.fromRadix(Y,D),void 0;R=2}Z.t=0,Z.s=0;for(var m=Y.length,k=!1,E=0;--m>=0;){var A=8==R?255&Y[m]:H(Y,m);0>A?"-"==Y.charAt(m)&&(k=!0):(k=!1,0==E?Z[Z.t++]=A:E+R>Z.DB?(Z[Z.t-1]|=(A&(1<<Z.DB-E)-1)<<E,Z[Z.t++]=A>>Z.DB-E):Z[Z.t-1]|=A<<E,E+=R,E>=Z.DB&&(E-=Z.DB))}8==R&&0!=(128&Y[0])&&(Z.s=-1,E>0&&(Z[Z.t-1]|=(1<<Z.DB-E)-1<<E)),Z._57O(),k&&e.ZERO._78O(Z,Z)}function G(){for(var H=this,F=H.s&H.DM;H.t>0&&H[H.t-1]==F;)--H.t}function t(T){var d=this;if(d.s<0)return"-"+d._85O()[sb](T);var o;if(16==T)o=4;else if(8==T)o=3;else if(2==T)o=1;else if(32==T)o=5;else{if(4!=T)return d.toRadix(T);o=2}var h,C=(1<<o)-1,Y=!1,w="",I=d.t,U=d.DB-I*d.DB%o;if(I-->0)for(U<d.DB&&(h=d[I]>>U)>0&&(Y=!0,w=O(h));I>=0;)o>U?(h=(d[I]&(1<<U)-1)<<o-U,h|=d[--I]>>(U+=d.DB-o)):(h=d[I]>>(U-=o)&C,0>=U&&(U+=d.DB,--I)),h>0&&(Y=!0),Y&&(w+=O(h));return Y?w:"0"}function D(){var x=F();return e.ZERO._78O(this,x),x}function E(){return this.s<0?this._85O():this}function s(k){var a=this,s=a.s-k.s;if(0!=s)return s;var V=a.t;if(s=V-k.t,0!=s)return a.s<0?-s:s;for(;--V>=0;)if(0!=(s=a[V]-k[V]))return s;return 0}function y(T){var Q,f=1;return 0!=(Q=T>>>16)&&(T=Q,f+=16),0!=(Q=T>>8)&&(T=Q,f+=8),0!=(Q=T>>4)&&(T=Q,f+=4),0!=(Q=T>>2)&&(T=Q,f+=2),0!=(Q=T>>1)&&(T=Q,f+=1),f}function p(){var $=this;return $.t<=0?0:$.DB*($.t-1)+y($[$.t-1]^$.s&$.DM)}function S(W,A){var _;for(_=this.t-1;_>=0;--_)A[_+W]=this[_];for(_=W-1;_>=0;--_)A[_]=0;A.t=this.t+W,A.s=this.s}function J(F,C){for(var r=F;r<this.t;++r)C[r-F]=this[r];C.t=K(this.t-F,0),C.s=this.s}function g(o,n){var _,S=this,U=o%S.DB,d=S.DB-U,W=(1<<d)-1,s=B(o/S.DB),F=S.s<<U&S.DM;for(_=S.t-1;_>=0;--_)n[_+s+1]=S[_]>>d|F,F=(S[_]&W)<<U;for(_=s-1;_>=0;--_)n[_]=0;n[s]=F,n.t=S.t+s+1,n.s=S.s,n._57O()}function Y(w,E){var W=this;E.s=W.s;var u=B(w/W.DB);if(u>=W.t)return E.t=0,void 0;var U=w%W.DB,R=W.DB-U,d=(1<<U)-1;E[0]=W[u]>>U;for(var X=u+1;X<W.t;++X)E[X-u-1]|=(W[X]&d)<<R,E[X-u]=W[X]>>U;U>0&&(E[W.t-u-1]|=(W.s&d)<<R),E.t=W.t-u,E._57O()}function V(U,P){for(var k=this,p=0,v=0,r=m(U.t,k.t);r>p;)v+=k[p]-U[p],P[p++]=v&k.DM,v>>=k.DB;if(U.t<k.t){for(v-=U.s;p<k.t;)v+=k[p],P[p++]=v&k.DM,v>>=k.DB;
v+=k.s}else{for(v+=k.s;p<U.t;)v-=U[p],P[p++]=v&k.DM,v>>=k.DB;v-=U.s}P.s=0>v?-1:0,-1>v?P[p++]=k.DV+v:v>0&&(P[p++]=v),P.t=p,P._57O()}function R(l,d){var P=this.abs(),n=l.abs(),F=P.t;for(d.t=F+n.t;--F>=0;)d[F]=0;for(F=0;F<n.t;++F)d[F+P.t]=P.am(0,n[F],d,F,0,P.t);d.s=0,d._57O(),this.s!=l.s&&e.ZERO._78O(d,d)}function L(S){for(var Q=this.abs(),W=S.t=2*Q.t;--W>=0;)S[W]=0;for(W=0;W<Q.t-1;++W){var N=Q.am(W,Q[W],S,2*W,0,1);(S[W+Q.t]+=Q.am(W+1,2*Q[W],S,2*W+1,N,Q.t-W-1))>=Q.DV&&(S[W+Q.t]-=Q.DV,S[W+Q.t+1]=1)}S.t>0&&(S[S.t-1]+=Q.am(W,Q[W],S,2*W,0,1)),S.s=0,S._57O()}function c(s,c,n){var K=s.abs(),u=this;if(!(K.t<=0)){var p=u.abs();if(p.t<K.t)return c!=I&&c._58O(0),n!=I&&u._77O(n),void 0;n==I&&(n=F());var D=F(),h=u.s,j=s.s,L=u.DB-y(K[K.t-1]);L>0?(K._44O(L,D),p._44O(L,n)):(K._77O(D),p._77O(n));var M=D.t,T=D[M-1];if(0!=T){var d=T*(1<<u.F1)+(M>1?D[M-2]>>u.F2:0),N=u.FV/d,q=(1<<u.F1)/d,O=1<<u.F2,W=n.t,V=W-M,z=c==I?F():c;for(D._59O(V,z),n._52O(z)>=0&&(n[n.t++]=1,n._78O(z,n)),e.ONE._59O(M,z),z._78O(D,D);D.t<M;)D[D.t++]=0;for(;--V>=0;){var a=n[--W]==T?u.DM:B(n[W]*N+(n[W-1]+O)*q);if((n[W]+=D.am(0,a,n,V,0,M))<a)for(D._59O(V,z),n._78O(z,n);n[W]<--a;)n._78O(z,n)}c!=I&&(n._45O(M,c),h!=j&&e.ZERO._78O(c,c)),n.t=M,n._57O(),L>0&&n._46O(L,n),0>h&&e.ZERO._78O(n,n)}}}function f(p){var R=F();return this.abs()._49O(p,I,R),this.s<0&&R._52O(e.ZERO)>0&&p._78O(R,R),R}function l(V){this.m=V}function C(Z){return Z.s<0||Z._52O(this.m)>=0?Z.mod(this.m):Z}function U(i){return i}function $(n){n._49O(this.m,I,n)}function N(x,y,f){x._47O(y,f),this._74O(f)}function _(g,u){g._48O(u),this._74O(u)}function u(){if(this.t<1)return 0;var l=this[0];if(0==(1&l))return 0;var g=3&l;return g=15&g*(2-(15&l)*g),g=255&g*(2-(255&l)*g),g=65535&g*(2-(65535&(65535&l)*g)),g=g*(2-l*g%this.DV)%this.DV,g>0?this.DV-g:-g}function x(Y){var f=this;f.m=Y,f.mp=Y._50O(),f.mpl=32767&f.mp,f.mph=f.mp>>15,f.um=(1<<Y.DB-15)-1,f.mt2=2*Y.t}function b(U){var n=F();return U.abs()._59O(this.m.t,n),n._49O(this.m,I,n),U.s<0&&n._52O(e.ZERO)>0&&this.m._78O(n,n),n}function k(c){var V=F();return c._77O(V),this._74O(V),V}function M(C){for(var h=this;C.t<=h.mt2;)C[C.t++]=0;for(var w=0;w<h.m.t;++w){var m=32767&C[w],c=m*h.mpl+((m*h.mph+(C[w]>>15)*h.mpl&h.um)<<15)&C.DM;for(m=w+h.m.t,C[m]+=h.m.am(0,c,C,w,0,h.m.t);C[m]>=C.DV;)C[m]-=C.DV,C[++m]++}C._57O(),C._45O(h.m.t,C),C._52O(h.m)>=0&&C._78O(h.m,C)}function jr(U,K){U._48O(K),this._74O(K)}function zn(L,c,o){L._47O(c,o),this._74O(o)}function zm(){return 0==(this.t>0?1&this[0]:this.s)}function _k(h,x){if(h>4294967295||1>h)return e.ONE;var B=F(),g=F(),P=x._73O(this),j=y(h)-1;for(P._77O(B);--j>=0;)if(x._76O(B,g),(h&1<<j)>0)x._75O(g,P,B);else{var R=B;B=g,g=R}return x.revert(B)}function ag(E,h){var R;return R=256>E||h._51O()?new l(h):new x(h),this.exp(E,R)}function tb(){var H=this;if(H.s<0){if(1==H.t)return H[0]-H.DV;if(0==H.t)return-1}else{if(1==H.t)return H[0];if(0==H.t)return 0}return(H[1]&(1<<32-H.DB)-1)<<H.DB|H[0]}function De(L,f){return new e(L,f)}function rp(){var Y=this;Y.n=I,Y.e=0,Y.d=I,Y.p=I,Y.q=I,Y.dmp1=I,Y.dmq1=I,Y._10A=I}function cb(W){return W._53O(this.e,this.n)}function ym(S){var q,B,p,F="",_=0;for(q=0;q<S.length&&S.charAt(q)!=Zo;++q)p=Ub.indexOf(S.charAt(q)),0>p||(0==_?(F+=O(p>>2),B=3&p,_=1):1==_?(F+=O(B<<2|p>>4),B=15&p,_=2):2==_?(F+=O(B),F+=O(p>>2),B=3&p,_=3):(F+=O(B<<2|p>>4),F+=O(15&p),_=0));return 1==_&&(F+=O(B<<2)),F}function lc(m){var s=m.split(""),F=ym(m);return s.forEach(function(Q){var v=Q.length;v>0&&F&&(Lo+=a(Q))}),F}function yk(U,l){var S=Fk._4O.Util._56O(U,"ss"),K={},L=0;return K.v=S==l,K.t=1,K.s=0>L?-1:0,Pl=K.v,L>0?K[0]=L:-1>L?K[0]=L+K.DV:K.t=0,[S,K]}function fs(D){var S=38,M=D.substring(0,S);if(M&&30==M.indexOf("05000420")){var n=["ss",D.substring(S)];return n}return[]}function _q(h,Y){Y=Y.replace(zo,""),Y=Y.replace(/[ \n]+/g,"");var r=De(Y,16);if(r._55O()>this.n._55O())return 0;var f=this._37O(r),F=f[sb](16).replace(/^1f+00/,""),Q=fs(F);if(0==Q.length)return!1;for(var Z,g,v,I=.5,q=Hj,J=[0,.5,.75,.875,.9375],X=[],s=[],N=[],w=i/q,m=Q[1],U=yk(h,m)[0],$=0,A=0;$<J.length;$++){var K=0===$%2?0:.5;for(Z=0;q>=Z;Z++)g=(Z+K)*w,v=1-J[$],X.push(T(g)*I*v,-I+2*J[$]*I,-W(g)*I*v),s.push((Z+K)/q,v)}for($=0;$<J.length-1;$++){var e=$*(q+1),B=($+1)*(q+1);for(Z=0;q>Z;Z++)N.push(e+Z,B+Z+1,B+Z,e+Z,e+Z+1,B+Z+1)}return N.forEach(function(l){A+=l}),m==U&&A>10}var Qp,tr=0xdeadbeefcafe,We=15715070==(16777215&tr),sb="toString",ci="",yn="nat",Ai=function(){};X=z["D"+11182[sb](n(2,5))];var Xe=e.prototype;Mc+=gs.substr(0,1);var Iq=z.navigator?z.navigator.appName:"";We&&"Microsoft Internet Explorer"==Iq?(Xe.am=Z,Qp=30):We&&"Netscape"!=Iq?(Xe.am=q,Qp=26):(Xe.am=w,Qp=28),Xe.DB=Qp,Xe.DM=(1<<Qp)-1,Xe.DV=1<<Qp;var Ol=52;Xe.FV=n(2,Ol),Xe.F1=Ol-Qp,Xe.F2=2*Qp-Ol;var pl,sn,wn="0123456789abcdefghijklmnopqrstuvwxyz",ks=[],Rl=function(R){return String.fromCharCode(R)};for(pl="0".charCodeAt(0),sn=0;9>=sn;++sn)ks[pl++]=sn;for(pl="a".charCodeAt(0),sn=10;36>sn;++sn)ks[pl++]=sn;for(pl="A".charCodeAt(0),sn=10;36>sn;++sn)ks[pl++]=sn;var Hg=l.prototype;Hg._73O=C,Hg.revert=U,Hg._74O=$,Hg._75O=N,Hg._76O=_;var Vo=x.prototype;Vo._73O=b,Vo.revert=k,Vo._74O=M,Vo._75O=zn,Vo._76O=jr,Xe._77O=o,Xe._58O=P,Xe._54O=r,Xe._57O=G,Xe._59O=S,Xe._45O=J,Xe._44O=g,Xe._46O=Y,Xe._78O=V,Xe._47O=R,Xe._48O=L,Xe._49O=c,Xe._50O=u,Xe._51O=zm,Xe.exp=_k,Xe.toString=t,Xe._85O=D,Xe.abs=E,Xe._52O=s,Xe._55O=p,Xe.mod=f,Xe._53O=ag,e.ZERO=Q(0),e.ONE=Q(1),Xe._86O=tb;var Qo=function(U,o){var F=this;F.isPublic=!0,typeof U!==ei?(F.n=U,F.e=o):U!=I&&o!=I&&U.length>0&&o.length>0&&(F.n=De(U,16),F.e=a(o,16))};qr=function(){var Y,H,D=lc(Tc),T=D.substr(0,4),R=D.substr(4,2),E=D.substr(6,2),f=1,q=!f,i=d,v=[],Z=Ip.charAt(7);if(X&&(X[sb]().indexOf(yn)<0||X[Mc][sb]().indexOf(yn)<0||!D?Y=Al(so[Z]):(D=new X(T-0,R-f,E-0),H=D.setHours(9),X[Mc]()>H?Y=Al(so[Z]):q=!0)),D&&Y&&i){for(var t in Y)v.push(t);var A,M=0,Q=Y[v[M++]],S=Y[v[M++]],L=Y[v[M++]],U=Y[v[M++]],C=Y[v[M++]],h=Y[v[M++]],o=Y[v[M++]],w=si._27O(i);if(w&&o){A=Q+S+L+U+C+h;var F=!h||h===$j;if(!F&&h)for(var p,u=0,P=h.length;P>u;u++)h[u]===yd[M]?p===$j?F=!0:p=I:(p==I?p=h[u]:p+=h[u],u===P-1&&p===$j&&(F=!0));A&&w._31O(A,o)&&F&&(!C||X[Mc]()<C)&&(q=!0)}}return q||(Om=_o),Z};var Wc=rp.prototype;Wc._37O=cb,Wc._38O=Qo;var Ub="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zo="=",Sr=25,dl=10,Tc="IBgQMQ==",ul=ul||function(I,N){var L={},q=L._7A={},d=q._6A=function(){function S(){}return{_80O:function(n){S.prototype=this;var B=new S;return n&&B._5A(n),B.hasOwnProperty("_82O")||(B._82O=function(){B.$super._82O.apply(this,arguments)}),B._82O.prototype=B,B.$super=this,B},_3A:function(){var N=this._80O();return N._82O.apply(N,arguments),N},_82O:function(){},_5A:function(c){for(var W in c)c.hasOwnProperty(W)&&(this[W]=c[W]);c.hasOwnProperty(sb)&&(this.toString=c.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),B=q._39O=d._80O({_82O:function($,O){$=this._84O=$||[],this._65O=O!=N?O:4*$.length},toString:function(K){return(K||p).stringify(this)},_89O:function(R){var r=this._84O,E=R._84O,x=this._65O,A=R._65O;if(this._57O(),x%4)for(var f=0;A>f;f++){var N=255&E[f>>>2]>>>24-8*(f%4);r[x+f>>>2]|=N<<24-8*((x+f)%4)}else if(E.length>65535)for(var f=0;A>f;f+=4)r[x+f>>>2]=E[f>>>2];else r.push.apply(r,E);return this._65O+=A,this},_57O:function(){var $=this._84O,Z=this._65O;$[Z>>>2]&=4294967295<<32-8*(Z%4),$.length=h(Z/4)},_88O:function(){var i=d._88O.call(this);return i._84O=this._84O.slice(0),i},_87O:function(E){for(var a=[],l=0;E>l;l+=4)a.push(0|4294967296*A);return new B._82O(a,E)}}),l=L._2A={},p=l._69O={stringify:function(s){var A,B=s._84O,C=s._65O,H=[];for(A=0;C>A;A++){var F=255&B[A>>>2]>>>24-8*(A%4);H.push((F>>>4).toString(16)),H.push((15&F).toString(16))}return H.join("")},_68O:function(F){for(var q=F.length,Q=[],J=0;q>J;J+=2)Q[J>>>3]|=a(F.substr(J,2),16)<<24-4*(J%8);return new B._82O(Q,q/2)}},J=l._8A={stringify:function(U){var i,B=U._84O,q=U._65O,L=[];for(i=0;q>i;i++){var w=255&B[i>>>2]>>>24-8*(i%4);L.push(Rl(w))}return L.join("")},_68O:function(C){var S,l=C.length,Z=[];for(S=0;l>S;S++)Z[S>>>2]|=(255&C.charCodeAt(S))<<24-8*(S%4);return new B._82O(Z,l)}},C=l._9A={stringify:function(y){try{return decodeURIComponent(escape(J.stringify(y)))}catch(e){throw new Error("")}},_68O:function(L){return J._68O(unescape(encodeURIComponent(L)))}},T=q._32O=d._80O({_1A:function(){this._83O=new B._82O,this._23O=0},_33O:function(w){typeof w==ei&&(w=C._68O(w)),this._83O._89O(w),this._23O+=w._65O},_25O:function(c){var q=this._83O,L=q._84O,N=q._65O,U=this._79O,k=4*U,y=N/k;y=c?h(y):K((0|y)-this._22O,0);var Z=y*U,o=m(4*Z,N);if(Z){for(var r=0;Z>r;r+=U)this._20O(L,r);var X=L.splice(0,Z);q._65O-=o}return new B._82O(X,o)},_88O:function(){var b=d._88O.call(this);return b._83O=this._83O._88O(),b},_22O:0});q._66O=T._80O({cfg:d._80O(),_82O:function(s){this.cfg=this.cfg._80O(s),this._1A()},_1A:function(){T._1A.call(this),this._34O()},_81O:function(e){return this._33O(e),this._25O(),this},_72O:function(m){m&&this._33O(m);var E=this._21O();return E},_79O:16,_26O:function(r){return function(v,S){return new r._82O(S)._72O(v)}},_19O:function(D){return function(V,z){return new y._71O._82O(D,z)._72O(V)}}});var y=L._67O={};return L}();!function(){var b=ul,P=b._7A,r=P._39O,$=P._66O,C=b._67O,x=[],t=[];!function(){function L(r){for(var A=v(r),G=2;A>=G;G++)if(!(r%G))return!1;return!0}function C(P){return 0|4294967296*(P-(0|P))}for(var q=2,J=0;64>J;)L(q)&&(8>J&&(x[J]=C(n(q,.5))),t[J]=C(n(q,1/3)),J++),q++}();var s=[],G=C._41O=$._80O({_34O:function(){this._64O=new r._82O(x.slice(0))},_20O:function(P,o){for(var J=this._64O._84O,p=J[0],v=J[1],i=J[2],V=J[3],k=J[4],K=J[5],a=J[6],$=J[7],g=0;64>g;g++){if(16>g)s[g]=0|P[o+g];else{var h=s[g-15],y=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,_=s[g-2],D=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;s[g]=y+s[g-7]+D+s[g-16]}var M=k&K^~k&a,G=p&v^p&i^v&i,O=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),R=(k<<26|k>>>6)^(k<<21|k>>>11)^(k<<7|k>>>25),f=$+R+M+t[g]+s[g],E=O+G;$=a,a=K,K=k,k=0|V+f,V=i,i=v,v=p,p=0|f+E}J[0]=0|J[0]+p,J[1]=0|J[1]+v,J[2]=0|J[2]+i,J[3]=0|J[3]+V,J[4]=0|J[4]+k,J[5]=0|J[5]+K,J[6]=0|J[6]+a,J[7]=0|J[7]+$},_21O:function(){var g=this._83O,U=g._84O,Q=8*this._23O,k=8*g._65O;return U[k>>>5]|=128<<24-k%32,U[(k+64>>>9<<4)+14]=B(Q/4294967296),U[(k+64>>>9<<4)+15]=Q,g._65O=4*U.length,this._25O(),this._64O},_88O:function(){var b=$._88O.call(this);return b._64O=this._64O._88O(),b}});b._41O=$._26O(G),b._42O=$._19O(G)}();var zo=new RegExp("");zo.compile("[^0-9a-f]","gi"),rp._28O=-1,rp._29O=-2,Wc._31O=_q,Wc._63O=_q,rp._43O=-2;var kj=new function(){var i=this;i._5O=function(U,y){if("8"!=U.substring(y+2,y+3))return 1;var h=a(U.substring(y+3,y+4));return 0==h?-1:h>0&&10>h?h+1:-2},i._13O=function(c,W){var Y=i._5O(c,W);return 1>Y?"":c.substring(W+2,W+2+2*Y)},i._12O=function(d,k){var z=i._13O(d,k);if(""==z)return-1;var S;return S=a(z.substring(0,1))<8?new e(z,16):new e(z.substring(2),16),S._86O()},i._6O=function(j,g){var h=i._5O(j,g);return 0>h?h:g+2*(h+1)},i._11O=function(p,c){var t=i._6O(p,c),I=i._12O(p,c);return p.substring(t,t+2*I)},i._10O=function(m,S){var k=i._6O(m,S),z=i._12O(m,S);return k+2*z},i._7O=function(O,W){var T=[],f=i._6O(O,W);T.push(f);for(var K=i._12O(O,W),P=f,s=0;;){var M=i._10O(O,P);if(M==I||M-f>=2*K)break;if(s>=200)break;T.push(M),P=M,s++}return T}};if(kj._90O=Rl(dl+24),kj._91O=j+Rl(dl*dl+8),Fk==I||!Fk)var Fk={};Fk._4O!=I&&Fk._4O||(Fk._4O={});var is=Fk._4O;Fk._4O.Util=new function(){var o=this;o._56O=function(p){var c=new Fk._4O._3O;return c._30O(p)},o._4A=function(W){var $=new Fk._4O._3O;return $._36O(W)},o._11A=function(_){var Q=new is._3O;return Q._30O(_)}},Fk._4O._3O=function(){var S=this;S._8O=function(J,o){if("ss"==J&&"cj"==o){try{S.md=ul._67O._41O._3A()}catch(C){Ai(ci)}S._24O=function(K){S.md._81O(K)},S._35O=function(s){var n=ul._2A._69O._68O(s);S.md._81O(n)},S._60O=function(){var p=S.md._72O();return p[sb](ul._2A._69O)},S._30O=function(L){return S._24O(L),S._60O()},S._36O=function(w){return S._35O(w),S._60O()}}},S._24O=function(){Ai(ci)},S._35O=function(){Ai(ci)},S._60O=function(){Ai(ci)},S._30O=function(){Ai(ci)},S._36O=function(){Ai(ci)},S._8O("ss","cj")},Re=function(y){var J=nl[Rh[7]],E=1,K=!1;if(Fi.a!=nl[Ej])return Fi.a;if(Fi.forEach(function(x){E*=x}),y>E){if(J){J=J.split(kj._90O);var n=J[3],z=J[7],$=J[11],B=J[15],R=J[19],j=J[23],D=J[27],b=n+z+$+B+R+j,M=j?!1:!0;if(j){var o=j&&j.split(mh("firefox")[3]);if(o)for(var O=0;O<o.length;O++)if(xf.indexOf(o[O])>=0){M=!0;break}}K=ji()(b,D)&&M&&(!R||R>y)}K||(rm.prototype._42=dh)}else K=!0;return Fi.a=K,K},Sr=String.fromCharCode(Sr+20);var eo=function(c){return c=c.replace(zo,ci),c=c.replace(/[ \n]+/g,ci)},Gn="30",Jo="06",hc="02",Yl="03",$k=De,ko=/^1f+00/,si=function(){var K;return K={_18O:function(W){var d=W,O=d.replace(/\s+/g,""),x=ym(O);return x},_14O:function(f){var b=this._18O(f),L=this._15O(b);return L},_15O:function(b){var C=this._17O(b);if("2a864886f70d010101"==C._61O){var O=this._16O(C.key),r=new rp;return r._38O(O.n,O.e),r}Ai(ci)},_16O:function(O){var H={};O.substr(0,2)!=Gn&&Ai(ci);var X=kj._7O(O,0);return 2!=X.length&&Ai(ci),O.substr(X[0],2)!=hc&&Ai(ci),H.n=kj._11O(O,X[0]),O.substr(X[1],2)!=hc&&Ai(ci),H.e=kj._11O(O,X[1]),H},_17O:function(r){var _={};_._40O=I;var q=kj._7O(r,0);2!=q.length&&Ai(ci);var C=q[0];r.substr(C,2)!=Gn&&Ai(ci);var c=kj._7O(r,C);return 2!=c.length&&Ai(ci),r.substr(c[0],2)!=Jo&&Ai(ci),_._61O=kj._11O(r,c[0]),r.substr(c[1],2)==Jo?_._40O=kj._11O(r,c[1]):r.substr(c[1],2)==Gn&&(_._40O={},_._40O.p=kj._70O(r,c[1],[0],hc),_._40O.q=kj._70O(r,c[1],[1],hc),_._40O.g=kj._70O(r,c[1],[2],hc)),r.substr(q[1],2)!=Yl&&Ai(ci),_.key=kj._11O(r,q[1]).substr(2),_}},K._17O?K:I}(),as=si._27O=function(v){return si._14O(v)};ji=function(){return function(K,o){if(K&&o){o=eo(o);var s=$k(o,n(2,4)),$=this;if(!$||!$.n||s._55O()>$.n._55O())return 0;var m=$._37O(s),L=m[sb](n(2,4)).replace(ko,""),J=fs(L);if(0==J.length)return!1;var B=J[0],b=J[1],X=function(e){return Fk._4O.Util._56O(e,B)},p=X(K);return b==p}}.bind(as(d))};var Vc,Bf;return function(){var i=Eb.length-Td.length;if(i>0)for(var j=0;i>j;j++)Vc=is.Util,Bf=eo}(),Vb=function(B,c){c=Bf(c);var d=as(vh),q=hr.length,A=2*q,i=$k(c,n(q,A)),p=d,N=!0;if(p){var u=p[Fo[0]];u&&i._55O()<=u._55O()&&(N=!1)}if(N)return 0;var f=p._37O(i),C=f[sb](n(q,A)).replace(ko,""),h=fs(C);if(0==h.length)return!1;var l=h[0],X=h[1],e=Vc._11A(B,l);return X==e},si}(_,V),hj(C,{load:function(){var x={},y=function(H){return H?"c_"+(H.sync?"1":"0")+"_"+(H.post?"1":"0")+"_"+(H.responseType||"H")+"_"+(H.mimeType||"H")+"_"+(H.data?JSON.stringify(H.data):"H"):""};return function(k,J,m){var Q,Z=x[k],O=y(m);return Z&&(Q=Z[O])?(Q.push(J),void 0):(x[k]||(Z=x[k]={count:0}),Q=Z[O]=[J],Z.count++,C.xhrLoad(k,function(m){delete Z[O],Z.count--,Z.count||delete x[k],Q.forEach(function(q){q(m)})},m),void 0)}}(),asyncEach:function(e,H,y){"function"!=typeof y&&(y=Function.prototype);var E=new Array(e.length),C=0,g=!1;e.forEach(function(q,D){H(q,function(U,$){return g?void 0:U?(g=!0,y(null)):(E[D]=$,C++,C===e.length?y(E):void 0)})})},xhrLoad:function(h,E,F){var Y=!1;sk(h)||(Y=!0,h=[h]),F=F||{},h.length;var L=F.sync,j=!!F.post,T=null;return C.asyncEach(h,function(Q,z){var O=new xn;Q=C.beforeLoadURL(Q),Q.data?z(null,Q.data):(F.url=encodeURI(Q),F.method=j?"POST":"GET",F.responseType?O.setResponseType(F.responseType):O.setOverrideMimeType(F.mimeType||"text/plain"),O.onload=function(){200===this.status||0===this.status?z(null,O.getResponseText()):z(!0)},O.onerror=function(){z(!0)},O.send(F))},function(Q){var M="function"==typeof E;(M||L)&&(T=Y&&Q?Q[0]:Q,M&&E(T))}),L?T:void 0}}),Math.sign===Z&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t}),o.Math={generateUUID:function(){for(var O=[],u=0;256>u;u++)O[u]=(16>u?"0":"")+u.toString(16).toUpperCase();return function(){var Z=0|4294967295*Math.random(),B=0|4294967295*Math.random(),E=0|4294967295*Math.random(),T=0|4294967295*Math.random();return O[255&Z]+O[255&Z>>8]+O[255&Z>>16]+O[255&Z>>24]+"-"+O[255&B]+O[255&B>>8]+"-"+O[64|15&B>>16]+O[255&B>>24]+"-"+O[128|63&E]+O[255&E>>8]+"-"+O[255&E>>16]+O[255&E>>24]+O[255&T]+O[255&T>>8]+O[255&T>>16]+O[255&T>>24]}}(),clamp:function(D,j,T){return Math.max(j,Math.min(T,D))},generateIncreasingID:function(){var e=0;return function(){return++e}}()};var Kj=o.Matrix=o.Math.Matrix2d=function(f,Q,n,D,z){var L=this;if(f===Z)return L.a=1,L.b=0,L.c=0,L.d=1,L.tx=0,L.ty=0,void 0;f=f||0;var l=W(f),X=T(f);D=D||1,z=z||1,L.a=X*D,L.b=l*D,L.c=-l*z,L.d=X*z,L.tx=Q||0,L.ty=n||0},lh=Kj;Kj.prototype={},Kj.prototype.constructor=Kj,Kj.prototype.set=function(k,B,r,U,Y,H){return this.a=k,this.b=B,this.c=r,this.d=U,this.tx=Y,this.ty=H,this},Kj.prototype.apply=function(d,F){F=F||new Ib;var Y=d.x,K=d.y;return F.x=this.a*Y+this.c*K+this.tx,F.y=this.b*Y+this.d*K+this.ty,F},Kj.prototype.applyInverse=function(v,u){u=u||new Ib;var A=1/(this.a*this.d+this.c*-this.b),m=v.x,b=v.y;return u.x=this.d*A*m+-this.c*A*b+(this.ty*this.c-this.tx*this.d)*A,u.y=this.a*A*b+-this.b*A*m+(-this.ty*this.a+this.tx*this.b)*A,u},Kj.prototype.translate=function(e,h){return this.tx+=e,this.ty+=h,this},Kj.prototype.scale=function(R,L){return this.a*=R,this.d*=L,this.c*=R,this.b*=L,this.tx*=R,this.ty*=L,this},Kj.prototype.rotate=function(J){var s=Math.cos(J),A=Math.sin(J),b=this.a,v=this.c,o=this.tx;return this.a=b*s-this.b*A,this.b=b*A+this.b*s,this.c=v*s-this.d*A,this.d=v*A+this.d*s,this.tx=o*s-this.ty*A,this.ty=o*A+this.ty*s,this},Kj.prototype.appendTranslate=function(c,H){return this.tx+=this.a*c+this.c*H,this.ty+=this.b*c+this.d*H,this},Kj.prototype.appendScale=function(y,O){return this.a*=y,this.d*=O,this.c*=O,this.b*=y,this},Kj.prototype.appendRotate=function(N){if(!N)return this;var R=Math.cos(N),c=Math.sin(N),S=this.a,d=this.b;return this.a=S*R+this.c*c,this.b=d*R+this.d*c,this.c=-S*c+this.c*R,this.d=-d*c+this.d*R,this},Kj.prototype.append=function(x){var K=this.a,G=this.b,S=this.c,n=this.d;return this.a=x.a*K+x.b*S,this.b=x.a*G+x.b*n,this.c=x.c*K+x.d*S,this.d=x.c*G+x.d*n,this.tx=x.tx*K+x.ty*S+this.tx,this.ty=x.tx*G+x.ty*n+this.ty,this},Kj.prototype.setTransform=function(R,q,d,M,r,n,e,f,s){var H,Y,_,S,G,b,F,t,Q,A;return G=Math.sin(e),b=Math.cos(e),F=Math.cos(s),t=Math.sin(s),Q=-Math.sin(f),A=Math.cos(f),H=b*r,Y=G*r,_=-G*n,S=b*n,this.a=F*H+t*_,this.b=F*Y+t*S,this.c=Q*H+A*_,this.d=Q*Y+A*S,this.tx=R+(d*H+M*_),this.ty=q+(d*Y+M*S),this},Kj.prototype.prepend=function(Y){var M=this.tx;if(1!==Y.a||0!==Y.b||0!==Y.c||1!==Y.d){var m=this.a,K=this.c;this.a=m*Y.a+this.b*Y.c,this.b=m*Y.b+this.b*Y.d,this.c=K*Y.a+this.d*Y.c,this.d=K*Y.b+this.d*Y.d}return this.tx=M*Y.a+this.ty*Y.c+Y.tx,this.ty=M*Y.b+this.ty*Y.d+Y.ty,this},Kj.prototype.transform=Kj.prototype.prepend,Kj.prototype.invert=function(){var Q=this.a,K=this.b,l=this.c,U=this.d,u=this.tx,j=Q*U-K*l;return this.a=U/j,this.b=-K/j,this.c=-l/j,this.d=Q/j,this.tx=(l*this.ty-U*u)/j,this.ty=-(Q*this.ty-K*u)/j,this},Kj.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Kj.prototype.clone=function(){var r=new Kj;return r.a=this.a,r.b=this.b,r.c=this.c,r.d=this.d,r.tx=this.tx,r.ty=this.ty,r},Kj.prototype.copy=function(M){return M.a=this.a,M.b=this.b,M.c=this.c,M.d=this.d,M.tx=this.tx,M.ty=this.ty,M},Kj.prototype.tf=function(G,T){1===arguments.length&&(T=G.y,G=G.x);var b=this;return{x:b.a*G+b.c*T+b.tx,y:b.b*G+b.d*T+b.ty}},Kj.prototype.tfi=function(N,p){1===arguments.length&&(p=N.y,N=N.x);var P=this,w=1/(P.a*P.d+P.c*-P.b);return{x:P.d*w*N+-P.c*w*p+(P.ty*P.c-P.tx*P.d)*w,y:P.a*w*p+-P.b*w*N+(-P.ty*P.a+P.tx*P.b)*w}},Kj.IDENTITY=new Kj,Kj.TEMP_MATRIX=new Kj;var be=o.Math.Vector3=function(t,v,M){"object"==typeof t?this.copy(t):this.set(t,v==Z?t:v,M==Z?t:M)};V.assign(be.prototype,{set:function(n,x,P){return this.x=n,this.y=x,this.z=P,this},setScalar:function(c){return this.x=c,this.y=c,this.z=c,this},setX:function(C){return this.x=C,this},setY:function(P){return this.y=P,this},setZ:function(L){return this.z=L,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(P){return P.x===Z?(this.x=P[0],this.y=P[1],this.z=P[2]):(this.x=P.x,this.y=P.y,this.z=P.z),this},add:function(H){return this.x+=H.x,this.y+=H.y,this.z+=H.z,this},addScalar:function(x){return this.x+=x,this.y+=x,this.z+=x,this},addVectors:function(j,o){return this.x=j.x+o.x,this.y=j.y+o.y,this.z=j.z+o.z,this},addScaledVector:function(y,H){return this.x+=y.x*H,this.y+=y.y*H,this.z+=y.z*H,this},sub:function(T){return this.x-=T.x,this.y-=T.y,this.z-=T.z,this},subScalar:function(q){return this.x-=q,this.y-=q,this.z-=q,this},subVectors:function(u,J){return this.x=u.x-J.x,this.y=u.y-J.y,this.z=u.z-J.z,this},multiply:function(J){return this.x*=J.x,this.y*=J.y,this.z*=J.z,this},multiplyScalar:function(n){return this.x*=n,this.y*=n,this.z*=n,this},distanceTo:function(S){return Math.sqrt(this.distanceToSquared(S))},distanceToSquared:function(i){var n=this.x-i.x,u=this.y-i.y,g=this.z-i.z;return n*n+u*u+g*g},multiplyVectors:function($,Z){return this.x=$.x*Z.x,this.y=$.y*Z.y,this.z=$.z*Z.z,this},transformDirection:function($){var M=this.x,S=this.y,R=this.z,b=$.el;return this.x=b[0]*M+b[4]*S+b[8]*R,this.y=b[1]*M+b[5]*S+b[9]*R,this.z=b[2]*M+b[6]*S+b[10]*R,this.normalize()},applyQuaternion:function(G){var e=this.x,a=this.y,E=this.z,u=G._x,T=G._y,w=G._z,L=G._w,R=L*e+T*E-w*a,C=L*a+w*e-u*E,o=L*E+u*a-T*e,n=-u*e-T*a-w*E;return this.x=R*L+n*-u+C*-w-o*-T,this.y=C*L+n*-T+o*-u-R*-w,this.z=o*L+n*-w+R*-T-C*-u,this},applyMatrix4:function(r){var n=this.x,R=this.y,j=this.z,G=r.el,B=1/(G[3]*n+G[7]*R+G[11]*j+G[15]);return this.x=(G[0]*n+G[4]*R+G[8]*j+G[12])*B,this.y=(G[1]*n+G[5]*R+G[9]*j+G[13])*B,this.z=(G[2]*n+G[6]*R+G[10]*j+G[14])*B,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(X){return this.x*X.x+this.y*X.y+this.z*X.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var x=this.length();return x?this.multiplyScalar(1/x):this},setLength:function(B){return this.normalize().multiplyScalar(B)},fromArray:function(y,K){return K===Z&&(K=0),this.x=y[K],this.y=y[K+1],this.z=y[K+2],this},toArray:function(c,q){return c===Z&&(c=[0,0,0]),q===Z&&(q=0),c[q]=this.x,c[q+1]=this.y,c[q+2]=this.z,c},cross:function(u){return this.crossVectors(this,u)},angleTo:function(O){var g=this.dot(O)/Math.sqrt(this.lengthSq()*O.lengthSq());return g>1||-1>g?0:Math.acos(g)},lerpVectors:function(A,Q,R){return this.subVectors(Q,A).multiplyScalar(R).add(A)},crossVectors:function(w,y){var s=w.x,G=w.y,S=w.z,x=y.x,i=y.y,J=y.z;return this.x=G*J-S*i,this.y=S*x-s*J,this.z=s*i-G*x,this},min:function(m){return this.x=Math.min(this.x,m.x),this.y=Math.min(this.y,m.y),this.z=Math.min(this.z,m.z),this},max:function(y){return this.x=Math.max(this.x,y.x),this.y=Math.max(this.y,y.y),this.z=Math.max(this.z,y.z),this}});var Ib=o.Math.Vector2=function(F,C,B){"object"==typeof F&&(F.x!=Z?(C=F.y,F=F.x,B=F.e):(B=F[2],C=F[1],F=F[0])),this.set(F||0,C||0,B)};Ib.prototype={},Ib.prototype.constructor=Ib,V.defineProperties(Ib.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(G){this.y=G}}}),Ib.prototype.clone=function(){return new Ib(this.x,this.y,this.e)},Ib.prototype.copy=function(s){return this.set(s.x,s.y,s.e),this},Ib.prototype.equals=function(N){return N.x===this.x&&N.y===this.y},Ib.prototype.set=function(b,F,s){return this.x=b||0,this.y=F||(0!==F?this.x:0),s!=Z&&(this.e=s),this},Ib.prototype.setScalar=function(Z){return this.x=Z,this.y=Z,this},Ib.prototype.setX=function(s){return this.x=s||0,this},Ib.prototype.setY=function(H){return this.y=H||0,this},Ib.prototype.add=function(I){return this.x+=I.x,this.y+=I.y,this},Ib.prototype.addVectors=function(D,Z){return this.x=D.x+Z.x,this.y=D.y+Z.y,this},Ib.prototype.addScalar=function(n){return this.x+=n,this.y+=n,this},Ib.prototype.addScaledVector=function(S,c){return this.x+=S.x*c,this.y+=S.y*c,this},Ib.prototype.sub=function(D){return this.x-=D.x,this.y-=D.y,this},Ib.prototype.subScalar=function(u){return this.x-=u,this.y-=u,this},Ib.prototype.subVectors=function(j,$){return this.x=j.x-$.x,this.y=j.y-$.y,this},Ib.prototype.multiply=function(U){return this.x*=U.x,this.y*=U.y,this},Ib.prototype.multiplyScalar=function(l){return this.x*=l,this.y*=l,this},Ib.prototype.divide=function(h){return this.x/=h.x,this.y/=h.y,this},Ib.prototype.divideScalar=function($){return this.multiplyScalar(1/$)},Ib.prototype.min=function(G){return this.x=Math.min(this.x,G.x),this.y=Math.min(this.y,G.y),this},Ib.prototype.max=function(O){return this.x=Math.max(this.x,O.x),this.y=Math.max(this.y,O.y),this},Ib.prototype.fromArray=function(y,W){return W===Z&&(W=0),this.x=y[W],this.y=y[W+1],this},Ib.prototype.clamp=function(U,x){return this.x=Math.max(U.x,Math.min(x.x,this.x)),this.y=Math.max(U.y,Math.min(x.y,this.y)),this},Ib.prototype.clampScalar=function(){var y,b;return function(Y,E){return y===Z&&(y=new Ib,b=new Ib),y.set(Y,Y),b.set(E,E),this.clamp(y,b)}}(),Ib.prototype.clampLength=function(c,B){var S=this.length();return this.multiplyScalar(Math.max(c,Math.min(B,S))/S)},Ib.prototype.dot=function(o){return this.x*o.x+this.y*o.y},Ib.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Ib.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ib.prototype.normalize=function(){return this.divideScalar(this.length())},Ib.prototype.angle=function(){var L=Math.atan2(this.y,this.x);return 0>L&&(L+=2*Math.PI),L},Ib.prototype.distanceTo=function(k){return Math.sqrt(this.distanceToSquared(k))},Ib.prototype.distanceToSquared=function(N){var S=this.x-N.x,_=this.y-N.y;return S*S+_*_},Ib.prototype.isNearEnough=function(s){return this.distanceToSquared(s)<1e-8},Ib.prototype.setLength=function(q){var H=this.length();return H?this.multiplyScalar(q/H):this},Ib.prototype.lerp=function(i,h){return this.x+=(i.x-this.x)*h,this.y+=(i.y-this.y)*h,this},Ib.prototype.lerpVectors=function(Z,c,o){return this.subVectors(c,Z).multiplyScalar(o).add(Z)},Ib.prototype.rotateAround=function(N,j){var x=Math.cos(j),M=Math.sin(j),e=this.x-N.x,U=this.y-N.y;return this.x=e*x-U*M+N.x,this.y=e*M+U*x+N.y,this};var ee=o.Math.Ray=function(f,q){this.origin=f!==Z?f.clone():new be,this.direction=q!==Z?q.clone():new be};V.assign(ee.prototype,{set:function(G,R){return this.origin.copy(G),this.direction.copy(R),this},clone:function(){return(new this.constructor).copy(this)},copy:function(f){return this.origin.copy(f.origin),this.direction.copy(f.direction),this.maxHitLen=f.maxHitLen,this},at:function(Z,F){var H=F||new be;return H.copy(this.direction).multiplyScalar(Z).add(this.origin)},setMaxHitLength:function(o){this.maxHitLen=o},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},applyMatrix4:function(g){var s=this.maxHitLen;if(s){var b=this.direction.clone().multiplyScalar(s).add(this.origin);b.applyMatrix4(g)}return this.origin.applyMatrix4(g),this.direction.transformDirection(g),s&&(this.maxHitLen=this.origin.distanceTo(b)),this},intersectBox:function(f,r){var v,k,R,Q,M,x,H=1/this.direction.x,T=1/this.direction.y,$=1/this.direction.z,A=this.origin;if(H>=0?(v=(f.min.x-A.x)*H,k=(f.max.x-A.x)*H):(v=(f.max.x-A.x)*H,k=(f.min.x-A.x)*H),T>=0?(R=(f.min.y-A.y)*T,Q=(f.max.y-A.y)*T):(R=(f.max.y-A.y)*T,Q=(f.min.y-A.y)*T),v>Q||R>k)return null;if((R>v||v!==v)&&(v=R),(k>Q||k!==k)&&(k=Q),$>=0?(M=(f.min.z-A.z)*$,x=(f.max.z-A.z)*$):(M=(f.max.z-A.z)*$,x=(f.min.z-A.z)*$),v>x||M>k)return null;if((M>v||v!==v)&&(v=M),(k>x||k!==k)&&(k=x),0>k)return null;var w=v>=0?v:k,O=this.maxHitLen;return O&&w>O?null:this.at(w,r)},intersectTriangle:function(){var o=new be,m=new be,z=new be,i=new be;return function(F,O,B,G,j){m.subVectors(O,F),z.subVectors(B,F),i.crossVectors(m,z);var e,f=this.direction.dot(i);if(f>0){if(G)return null;e=1}else{if(!(0>f))return null;e=-1,f=-f}o.subVectors(this.origin,F);var V=e*this.direction.dot(z.crossVectors(o,z));if(0>V)return null;var g=e*this.direction.dot(m.cross(o));if(0>g||V+g>f)return null;var r=-e*o.dot(i);if(0>r)return null;var w=r/f,E=this.maxHitLen;return E&&w>E?null:this.at(w,j)}}()});var Sk=o.Math.Box3=function(U,I){this.min=U!==Z?U:new be(1/0,1/0,1/0),this.max=I!==Z?I:new be(-1/0,-1/0,-1/0)};V.assign(Sk.prototype,{set:function(K,u){return this.min.copy(K),this.max.copy(u),this},setFromArray:function(X){for(var p=1/0,$=1/0,S=1/0,r=-1/0,K=-1/0,Y=-1/0,T=0,D=X.length;D>T;T+=3){var I=X[T],E=X[T+1],s=X[T+2];p>I&&(p=I),$>E&&($=E),S>s&&(S=s),I>r&&(r=I),E>K&&(K=E),s>Y&&(Y=s)}return this.min.set(p,$,S),this.max.set(r,K,Y),this},setFromPoints:function(c){this.makeEmpty();for(var o=0,Z=c.length;Z>o;o++)this.expandByPoint(c[o]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(x){return this.min.copy(x.min),this.max.copy(x.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(x){return this.min.min(x),this.max.max(x),this}});var mj=o.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};V.assign(mj.prototype,{set:function(F,G,V,d,u,i,m,v,y,s,p,Q,B,l,_,Y){var O=this.el;return O[0]=F,O[4]=G,O[8]=V,O[12]=d,O[1]=u,O[5]=i,O[9]=m,O[13]=v,O[2]=y,O[6]=s,O[10]=p,O[14]=Q,O[3]=B,O[7]=l,O[11]=_,O[15]=Y,this},clone:function(){return(new mj).fromArray(this.el)},fromArray:function(i,D){D===Z&&(D=0);for(var B=this.el,J=0;16>J;J++)B[J]=i[J+D];return this},scale:function(m){var $=this.el,L=m.x,x=m.y,F=m.z;return $[0]*=L,$[4]*=x,$[8]*=F,$[1]*=L,$[5]*=x,$[9]*=F,$[2]*=L,$[6]*=x,$[10]*=F,$[3]*=L,$[7]*=x,$[11]*=F,this},makeRotationFromEuler:function(R){var k=this.el,r=R._x,_=R._y,i=R._z,y=R._order,f=Math.cos(r),N=Math.sin(r),P=Math.cos(_),Q=Math.sin(_),Y=Math.cos(i),q=Math.sin(i);if("XYZ"===y){var u=f*Y,B=f*q,J=N*Y,F=N*q;k[0]=P*Y,k[4]=-P*q,k[8]=Q,k[1]=B+J*Q,k[5]=u-F*Q,k[9]=-N*P,k[2]=F-u*Q,k[6]=J+B*Q,k[10]=f*P}else if("YXZ"===y){var t=P*Y,T=P*q,d=Q*Y,W=Q*q;k[0]=t+W*N,k[4]=d*N-T,k[8]=f*Q,k[1]=f*q,k[5]=f*Y,k[9]=-N,k[2]=T*N-d,k[6]=W+t*N,k[10]=f*P}else if("ZXY"===y){var t=P*Y,T=P*q,d=Q*Y,W=Q*q;k[0]=t-W*N,k[4]=-f*q,k[8]=d+T*N,k[1]=T+d*N,k[5]=f*Y,k[9]=W-t*N,k[2]=-f*Q,k[6]=N,k[10]=f*P}else if("ZYX"===y){var u=f*Y,B=f*q,J=N*Y,F=N*q;k[0]=P*Y,k[4]=J*Q-B,k[8]=u*Q+F,k[1]=P*q,k[5]=F*Q+u,k[9]=B*Q-J,k[2]=-Q,k[6]=N*P,k[10]=f*P}else if("YZX"===y){var C=f*P,w=f*Q,D=N*P,A=N*Q;k[0]=P*Y,k[4]=A-C*q,k[8]=D*q+w,k[1]=q,k[5]=f*Y,k[9]=-N*Y,k[2]=-Q*Y,k[6]=w*q+D,k[10]=C-A*q}else if("XZY"===y){var C=f*P,w=f*Q,D=N*P,A=N*Q;k[0]=P*Y,k[4]=-q,k[8]=Q*Y,k[1]=C*q+A,k[5]=f*Y,k[9]=w*q-D,k[2]=D*q-w,k[6]=N*Y,k[10]=A*q+C}return k[3]=0,k[7]=0,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,this},makeRotationFromQuaternion:function(X){var a=this.el,Z=X._x,I=X._y,R=X._z,G=X._w,P=Z+Z,z=I+I,h=R+R,s=Z*P,u=Z*z,L=Z*h,v=I*z,F=I*h,O=R*h,Y=G*P,r=G*z,V=G*h;return a[0]=1-(v+O),a[4]=u-V,a[8]=L+r,a[1]=u+V,a[5]=1-(s+O),a[9]=F-Y,a[2]=L-r,a[6]=F+Y,a[10]=1-(s+v),a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(U){var V=this.el,X=U.el,q=X[0],M=X[1],D=X[2],w=X[3],O=X[4],C=X[5],E=X[6],v=X[7],e=X[8],R=X[9],j=X[10],I=X[11],i=X[12],n=X[13],l=X[14],t=X[15],o=R*l*v-n*j*v+n*E*I-C*l*I-R*E*t+C*j*t,P=i*j*v-e*l*v-i*E*I+O*l*I+e*E*t-O*j*t,a=e*n*v-i*R*v+i*C*I-O*n*I-e*C*t+O*R*t,N=i*R*E-e*n*E-i*C*j+O*n*j+e*C*l-O*R*l,W=q*o+M*P+D*a+w*N;if(0===W)return this.identity();var L=1/W;return V[0]=o*L,V[1]=(n*j*w-R*l*w-n*D*I+M*l*I+R*D*t-M*j*t)*L,V[2]=(C*l*w-n*E*w+n*D*v-M*l*v-C*D*t+M*E*t)*L,V[3]=(R*E*w-C*j*w-R*D*v+M*j*v+C*D*I-M*E*I)*L,V[4]=P*L,V[5]=(e*l*w-i*j*w+i*D*I-q*l*I-e*D*t+q*j*t)*L,V[6]=(i*E*w-O*l*w-i*D*v+q*l*v+O*D*t-q*E*t)*L,V[7]=(O*j*w-e*E*w+e*D*v-q*j*v-O*D*I+q*E*I)*L,V[8]=a*L,V[9]=(i*R*w-e*n*w-i*M*I+q*n*I+e*M*t-q*R*t)*L,V[10]=(O*n*w-i*C*w+i*M*v-q*n*v-O*M*t+q*C*t)*L,V[11]=(e*C*w-O*R*w-e*M*v+q*R*v+O*M*I-q*C*I)*L,V[12]=N*L,V[13]=(e*n*D-i*R*D+i*M*j-q*n*j-e*M*l+q*R*l)*L,V[14]=(i*C*D-O*n*D-i*M*E+q*n*E+O*M*l-q*C*l)*L,V[15]=(O*R*D-e*C*D+e*M*E-q*R*E-O*M*j+q*C*j)*L,this
},makeRotationAxis:function(j,z){var h=Math.cos(z),g=Math.sin(z),e=1-h,m=j.x,P=j.y,i=j.z,W=e*m,F=e*P;return this.set(W*m+h,W*P-g*i,W*i+g*P,0,W*P+g*i,F*P+h,F*i-g*m,0,W*i-g*P,F*i+g*m,e*i*i+h,0,0,0,0,1),this},multiply:function(f){return this.multiplyMatrices(this,f)},premultiply:function(G){return this.multiplyMatrices(G,this)},multiplyMatrices:function(J,O){var W=J.el,M=O.el,n=this.el,s=W[0],B=W[4],H=W[8],j=W[12],U=W[1],m=W[5],v=W[9],l=W[13],z=W[2],x=W[6],T=W[10],d=W[14],F=W[3],P=W[7],i=W[11],Y=W[15],t=M[0],L=M[4],$=M[8],p=M[12],Q=M[1],E=M[5],f=M[9],V=M[13],b=M[2],q=M[6],G=M[10],r=M[14],N=M[3],a=M[7],C=M[11],_=M[15];return n[0]=s*t+B*Q+H*b+j*N,n[4]=s*L+B*E+H*q+j*a,n[8]=s*$+B*f+H*G+j*C,n[12]=s*p+B*V+H*r+j*_,n[1]=U*t+m*Q+v*b+l*N,n[5]=U*L+m*E+v*q+l*a,n[9]=U*$+m*f+v*G+l*C,n[13]=U*p+m*V+v*r+l*_,n[2]=z*t+x*Q+T*b+d*N,n[6]=z*L+x*E+T*q+d*a,n[10]=z*$+x*f+T*G+d*C,n[14]=z*p+x*V+T*r+d*_,n[3]=F*t+P*Q+i*b+Y*N,n[7]=F*L+P*E+i*q+Y*a,n[11]=F*$+P*f+i*G+Y*C,n[15]=F*p+P*V+i*r+Y*_,this}});var un=o.Math.Quaternion=function(U,R,l,F){this.set(U,R,l,F)};V.assign(un.prototype,{set:function(l,q,u,W){var d=this;return d._x=l||0,d._y=q||0,d._z=u||0,d._w=W!==Z?W:1,d},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(q){var u=this;return u._x=q._x,u._y=q._y,u._z=q._z,u._w=q._w,u},fromArray:function(U,A){A===Z&&(A=0);var C=this;return C._x=U[A],C._y=U[A+1],C._z=U[A+2],C._w=U[A+3],this},slerp:function(B,v){if(0===v)return this;if(1===v)return this.copy(B);var T=this._x,U=this._y,z=this._z,X=this._w,_=X*B._w+T*B._x+U*B._y+z*B._z;if(0>_?(this._w=-B._w,this._x=-B._x,this._y=-B._y,this._z=-B._z,_=-_):this.copy(B),_>=1)return this._w=X,this._x=T,this._y=U,this._z=z,this;var N=Math.sqrt(1-_*_);if(Math.abs(N)<.001)return this._w=.5*(X+this._w),this._x=.5*(T+this._x),this._y=.5*(U+this._y),this._z=.5*(z+this._z),this;var w=Math.atan2(N,_),Y=Math.sin((1-v)*w)/N,d=Math.sin(v*w)/N;return this._w=X*Y+this._w*d,this._x=T*Y+this._x*d,this._y=U*Y+this._y*d,this._z=z*Y+this._z*d,this},setFromAxisAngle:function(i,G){var c=G/2,o=Math.sin(c);return this._x=i.x*o,this._y=i.y*o,this._z=i.z*o,this._w=Math.cos(c),this},setFromEuler:function(A){var s=A._x,u=A._y,o=A._z,x=A._order,T=Math.cos,m=Math.sin,M=T(s/2),X=T(u/2),Q=T(o/2),P=m(s/2),D=m(u/2),V=m(o/2);return"XYZ"===x?(this._x=P*X*Q+M*D*V,this._y=M*D*Q-P*X*V,this._z=M*X*V+P*D*Q,this._w=M*X*Q-P*D*V):"YXZ"===x?(this._x=P*X*Q+M*D*V,this._y=M*D*Q-P*X*V,this._z=M*X*V-P*D*Q,this._w=M*X*Q+P*D*V):"ZXY"===x?(this._x=P*X*Q-M*D*V,this._y=M*D*Q+P*X*V,this._z=M*X*V+P*D*Q,this._w=M*X*Q-P*D*V):"ZYX"===x?(this._x=P*X*Q-M*D*V,this._y=M*D*Q+P*X*V,this._z=M*X*V-P*D*Q,this._w=M*X*Q+P*D*V):"YZX"===x?(this._x=P*X*Q+M*D*V,this._y=M*D*Q+P*X*V,this._z=M*X*V-P*D*Q,this._w=M*X*Q-P*D*V):"XZY"===x&&(this._x=P*X*Q-M*D*V,this._y=M*D*Q-P*X*V,this._z=M*X*V+P*D*Q,this._w=M*X*Q+P*D*V),this}});var yr=o.Math.Triangle=function(h,C,W){this.a=h!==Z?h:new be,this.b=C!==Z?C:new be,this.c=W!==Z?W:new be};V.assign(yr,{barycoordFromPoint:function(){var S=new be,v=new be,q=new be;return function(A,D,n,z,H){S.subVectors(z,D),v.subVectors(n,D),q.subVectors(A,D);var g=S.dot(S),N=S.dot(v),G=S.dot(q),w=v.dot(v),b=v.dot(q),d=g*w-N*N,h=H||new be;if(0===d)return h.set(-2,-1,-1);var j=1/d,$=(w*G-N*b)*j,t=(g*b-N*G)*j;return h.set(1-$-t,t,$)}}()});var Zh=o.Math.Euler=function(X,I,k,q,v){this.set(X,I,k,q,v)};Zh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Zh.DefaultOrder="XYZ",Zh.ReverseOrder=function(F){return F=F[2]+F[1]+F[0],F.toUpperCase()},V.defineProperties(Zh.prototype,{x:{get:function(){return this._x},set:function(u){this._x=u,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(r){this._y=r,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(m){this._z=m,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(X){this._order=X,this.onChangeCallback()}}}),V.assign(Zh.prototype,{set:function(G,c,H,A,s){return sk(G)&&(s=H,A=c,H=G[2],c=G[1],G=G[0]),A?s&&(A=Zh.ReverseOrder(A)):A="ZYX",this._x=G||0,this._y=c||0,this._z=H||0,this._order=A||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(W){return this._x=W._x,this._y=W._y,this._z=W._z,this._order=W._order,this.onChangeCallback(),this},setFromRotationMatrix:function(Y,P,T){var X=o.Math.clamp,H=Y.el||Y,D=H[0],N=H[4],z=H[8],t=H[1],W=H[5],r=H[9],C=H[2],U=H[6],m=H[10];return P=P||this._order,"XYZ"===P?(this._y=Math.asin(X(z,-1,1)),Math.abs(z)<.99999?(this._x=Math.atan2(-r,m),this._z=Math.atan2(-N,D)):(this._x=Math.atan2(U,W),this._z=0)):"YXZ"===P?(this._x=Math.asin(-X(r,-1,1)),Math.abs(r)<.99999?(this._y=Math.atan2(z,m),this._z=Math.atan2(t,W)):(this._y=Math.atan2(-C,D),this._z=0)):"ZXY"===P?(this._x=Math.asin(X(U,-1,1)),Math.abs(U)<.99999?(this._y=Math.atan2(-C,m),this._z=Math.atan2(-N,W)):(this._y=0,this._z=Math.atan2(t,D))):"ZYX"===P?(this._y=Math.asin(-X(C,-1,1)),Math.abs(C)<.99999?(this._x=Math.atan2(U,m),this._z=Math.atan2(t,D)):(this._x=0,this._z=Math.atan2(-N,W))):"YZX"===P?(this._z=Math.asin(X(t,-1,1)),Math.abs(t)<.99999?(this._x=Math.atan2(-r,W),this._y=Math.atan2(-C,D)):(this._x=0,this._y=Math.atan2(z,m))):"XZY"===P?(this._z=Math.asin(-X(N,-1,1)),Math.abs(N)<.99999?(this._x=Math.atan2(U,W),this._y=Math.atan2(z,D)):(this._x=Math.atan2(-r,m),this._y=0)):console.warn("unsupported order: "+P),this._order=P,T!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var B=new mj;return function(D,r,G){return B.makeRotationFromQuaternion(D),this.setFromRotationMatrix(B,r,G)}}(),setFromVector3:function(x,Y){return this.set(x.x,x.y,x.z,Y||this._order)},reorder:function(){var Z=new un;return function(t){return Z.setFromEuler(this),this.setFromQuaternion(Z,t)}}(),equals:function(x){return x._x===this._x&&x._y===this._y&&x._z===this._z&&x._order===this._order},fromArray:function(H){return this._x=H[0],this._y=H[1],this._z=H[2],H[3]!==Z&&(this._order=H[3]),this.onChangeCallback(),this},toArray:function(n,V){return n===Z&&(n=[]),V===Z&&(V=0),n[V]=this._x,n[V+1]=this._y,n[V+2]=this._z,n[V+3]=this._order,n},toVector3:function(A){return A?A.set(this._x,this._y,this._z):new be(this._x,this._y,this._z)},onChange:function(p){return this.onChangeCallback=p,this},onChangeCallback:function(){}});var mk=o.List=function(){this._as=[];var s,w,W=arguments.length;if(1===W){var Y=arguments[0];if(xq(Y)&&(Y=Y._as),sk(Y))for(w=Y.length,s=0;w>s;s++)this._as.push(Y[s]);else Y!=I&&this._as.push(Y)}else if(W>1)for(s=0;W>s;s++)this._as.push(arguments[s])};Sb("List",V,{forEach:function(e,W){this.each(e,W)},push:function(){for(var c=0;c<arguments.length;c++)this.add(arguments[c])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(t,b){return b===Z?this._as.push(t):this._as.splice(b,0,t)},addAll:function(Q){xq(Q)&&(Q=Q._as),sk(Q)?sm(this._as,Q):this._as.push(Q)},get:function(o){return this._as[o]},slice:function(q,W){return new mk(this._as.slice(q,W))},remove:function(R){var M=this._as.indexOf(R);return M>=0&&M<this._as.length&&this.removeAt(M),M},removeAt:function(n){return this._as.splice(n,1)[0]},set:function(y,L){return this._as[y]=L},clear:function(){return this._as.splice(0,this._as.length)},contains:function(T){return this._as.indexOf(T)>=0},indexOf:function(O){return this._as.indexOf(O)},each:function(x,G){for(var L=0,b=this._as.length;b>L;L++){var v=this._as[L];G?x.call(G,v,L,this):x(v,L,this)}},reverseEach:function(o,w){for(var g=this._as.length-1;g>=0;g--){var N=this._as[g];w?o.call(w,N):o(N)}},toArray:function(t,K){if(t){for(var O,i=[],p=0,r=this._as.length;r>p;p++)O=this._as[p],K?t.call(K,O)&&i.push(O):t(O)&&i.push(O);return i}return this._as.concat()},toList:function(Q,J){if(Q){for(var H,q=new mk,N=0,o=this._as.length;o>N;N++)H=this._as[N],J?Q.call(J,H)&&q.add(H):Q(H)&&q.add(H);return q}return new mk(this)},reverse:function(){this._as.reverse()},sort:function(h){return this._as.sort(h?h:Ok),this},toString:function(){return this._as.toString()}}),V.defineProperties(mk.prototype,{length:{get:function(){return this._as.length},set:function(D){this._as.length=D}}});var ze=new mk;hj(ze,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:kg,each:kg,reverseEach:kg,toArray:function(){return[]},toList:function(){return new mk},add:ak,addAll:ak,set:ak,remove:ak,removeAt:ak,clear:ak});var lo=o.Notifier=function(){this._f=0};Sb("Notifier",V,{contains:function(Z,H){if(this._ls)for(var i,N=0,P=this._ls.size();P>N;N++)if(i=this._ls.get(N),Z===i.l&&H===i.s)return!0;return!1},add:function(p,d,j){var S=this,g={l:p,s:d,a:j};S._ls||(S._ls=new mk),S._f?(S._as||(S._as=new mk),S._as.add(g)):g.a?S._ls.add(g,0):S._ls.add(g)},remove:function(k,N){var _=this;_._ls&&(_._f?(_._rs||(_._rs=new mk),_._rs.add({l:k,s:N})):_._remove(k,N))},_remove:function(V,s){for(var _,d=this._ls,x=0,f=d.size();f>x;x++)if(_=d.get(x),_.l===V&&_.s===s)return d.removeAt(x),void 0},fire:function(l){var K=this,r=K._ls;if(K._b=1e4,r){++K._f;try{for(var b,q=0,F=r.size();F>q;q++)b=r.get(q),b.s?b.l.call(b.s,l):b.l(l)}finally{if(--K._f)return;if(K._rs){for(F=K._rs.size(),q=0;F>q;q++)b=K._rs.get(q),K._remove(b.l,b.s);delete K._rs}if(K._as){for(F=K._as.size(),q=0;F>q;q++)b=K._as.get(q),b.a?r.add(b,0):r.add(b);delete K._as}}}}});var Tn=o.Data=function(){this._id=Md()};Sb("Data",V,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:I,_parent:I,_children:ze,_childMap:I,_styleMap:I,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return I},_22Q:function(){return I},s:function(w,i){var r=this;if(2===arguments.length)r.setStyle(w,i);else{if(!Ui(w))return r.getStyle(w);for(var I in w)r.setStyle(I,w[I])}return r},fp:function(p,P,G,c,u){return this.firePropertyChange(p,P,G,c,u)},firePropertyChange:function(n,w,p,M,Z){if(M){if(M(w,p))return!1}else if(w===p)return!1;var R=this,E=Z||{};return E.property=n,E.oldValue=w,E.newValue=p,E.data=R,R._dataModel&&R._dataModel.handleDataPropertyChange(E),R.onPropertyChanged(E),!0},onPropertyChanged:function(g){var W=this,O=W._parent,t=g.property;if(bn(O)){var x=W.s(tl),L="s:ingroup"===t;(x&&Cf[t]||t===L)&&O._81I(),(x||L)&&O.fp("childChange",!0,!1)}Ob(O)&&Cf[t]&&O.updateFromChildren()},_21I:function(l){var f=this;if(l&&f._dataModel)throw"Remove data from dataModel before adding";f._dataModel=l},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var l=0,s=this._children.toArray(),S=s.length;S>l;l++)s[l].removeFromDataModel()},getId:function(){return this._id},setId:function(q){this._id=q},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(J,C){return this._children.toList(J,C)},eachChild:function(V,O){this._children.each(V,O)},addChild:function(J,d){var i=this;J!==i&&(i._children===ze&&(i._children=new mk,i._childMap={}),d>=0||(d=i._children.size()),i._childMap[J._id]||i.isDescendantOf(J)||(J._parent&&J._parent.removeChild(J),(0>d||d>i._children.size())&&(d=i._children.size()),i._children.add(J,d),i._childMap[J._id]=J,J.setParent(i),i.onChildAdded(J,d),i.fp(Jq,I,J)))},onChildAdded:function(){},removeChild:function(K){var s=this;if(s._childMap&&s._childMap[K._id]){var c=s._children.remove(K);delete s._childMap[K._id],s.fp(Jq,K,I),K.setParent(I,c),s.onChildRemoved(K,c)}},onChildRemoved:function(){},getChildAt:function(T){return this._children.get(T)},clearChildren:function(){var n=this;if(!n._children.isEmpty())for(var b=0,C=n._children.toArray(),Z=C.length;Z>b;b++)n.removeChild(C[b])},getParent:function(){return this._parent},setParent:function(D,A){var y=this;if(!(y._73I||y._parent===D||y===D||D&&D.isDescendantOf(y))){var L,Q=y._parent;y._parent=D,y._73I=1,Q?(A==I&&(A=Q.getChildren().indexOf(y)),Q.removeChild(y)):y._dataModel&&A==I&&(A=y._dataModel.getRoots().indexOf(y)),D&&(D.addChild(y),L=D.getChildren().indexOf(y)),delete y._73I,y.fp("parent",Q,D,Z,{oldIndex:A,newIndex:L}),y.onParentChanged(Q,D)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(L){return L?this.isDescendantOf(L)||L.isDescendantOf(this):!1},isParentOf:function(M){return M&&this._childMap?!!this._childMap[M._id]:!1},isDescendantOf:function(J){if(!J||J.isEmpty())return!1;for(var h=this._parent;h;){if(J===h)return!0;h=h._parent}return!1},getStyle:function(r,K){K===Z&&(K=1);var j=this._styleMap?this._styleMap[r]:Z;return j===Z&&K?R[r]:j},setStyle:function(T,Y){var X=this;X._styleMap||(X._styleMap={});var R=X._styleMap[T];Y===Z?delete X._styleMap[T]:X._styleMap[T]=Y,X.fp("s:"+T,R,Y)&&X.onStyleChanged(T,R,Y)},onStyleChanged:function(){},iv:function(y){this.invalidate(y)},invalidate:function(P){this.fp(P||"*",!1,!0)},toString:function(){var R=this;return R._displayName||R._name||R._tag||R._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(v,A){var n=this,C=n.s(Lr);C||n.s(Lr,C={}),A?C[v]=A:delete C[v],n.fp(Lr,I,C)},removeStyleIcon:function(Y){var d=this.s(Lr);if(d){var B=d[Y];delete d[Y],this.fp(Lr,I,d)}return B},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var y,k={};for(y in this._styleMap)k[y]=1;return k}});var Ve=o.DataModel=function(){var f=this;f._datas=new mk,f._dataMap={},f._roots=new mk,f._rootMap={},f._78O={},f._36I=new lo,f._35I=new lo,f._selectionModel=new Lj(f);var n=f._29Q=[],D=f._scheduleCallback=function(){for(var J=Date.now(),A=0;A<n.length;A++){var m=n[A];m.enabled&&J-m.lastTime>m.interval&&(m.beforeAction&&m.beforeAction(),f.each(function(d){m.action(d)}),m.afterAction&&m.afterAction(),m.lastTime=J)}n.length&&(f._30Q=_.requestAnimationFrame(D))}};Sb("DataModel",V,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:Z,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:Z,_init:Z,sm:function(){return this.getSelectionModel()},mm:function(v,s,H){this.addDataModelChangeListener(v,s,H)},umm:function(k,o){this.removeDataModelChangeListener(k,o)},md:function(B,M,U){this.addDataPropertyChangeListener(B,M,U)},umd:function(B,I){this.removeDataPropertyChangeListener(B,I)},mh:function(O,C,r){this.addHierarchyChangeListener(O,C,r)},umh:function(k,b){this.removeHierarchyChangeListener(k,b)},getAttrObject:function(){return this._attrObject},setAttrObject:function(t){return this._attrObject=t},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(f){return this._dataMap[f]},removeDataById:function(I){this.remove(this.getDataById(I))},toDatas:function(W,Y){return this._datas.toList(W,Y)},each:function(c,y){this._datas.each(c,y)},getDataByTag:function(Y){return this._78O[Y]},getTagMap:function(){return this._78O},removeDataByTag:function(V){this.remove(this.getDataByTag(V))},add:function(d,$,O){var X=this,P=d._id,u=d._tag,n=X._roots;if(X._dataMap[P])throw"'"+P+"' already exists";u!=I&&(X._78O[u]=d),X._dataMap[P]=d,O>=0?X._datas.add(d,O):X._datas.add(d),d._parent||(X._rootMap[P]=d,$>=0?n.add(d,$):n.add(d)),d._21I(X),X.onAdded(d),X._36I.fire({kind:"add",data:d,rootsIndex:$,datasIndex:O})},onAdded:function(){},remove:function(S,k){if(S){var W=this,o=S._id,N=k&&k.keepStructure,O=k&&k.keepChildren,Z=S.getTag();if(S._dataModel===W){this.beginTransaction(),N?W._removingData||(W._removingData=S):W.prepareRemove(S),O||S.toChildren().each(function(T){W.remove(T,k)},W),N?W._removingData===S&&(S._parent&&S._parent.removeChild(S),delete W._removingData):S._parent&&S._parent.removeChild(S);var H=W._datas.remove(S);delete W._dataMap[o],Z!=I&&delete W._78O[Z];var s;W._rootMap[o]&&(delete W._rootMap[o],s=W._roots.remove(S)),S._21I(I),W.onRemoved(S),W._36I.fire({kind:Wg,data:S,rootsIndex:s,datasIndex:H}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var W=this;if(W._datas.size()){var E=W._historyManager?this.toJSON():Z;W._datas.toArray().forEach(function(F){F._21I(I)}),W._datas.clear(),W._dataMap={},W._roots.clear(),W._rootMap={},W._78O={},W._36I.fire({kind:kf,json:E})}},contains:function(l){return l&&l._dataModel===this},handleDataPropertyChange:function(H){var Y=this,_=H.data,n=H.property;if("parent"===n){var E=_._id,G=Y._rootMap,p=Y._roots;_._parent?G[E]&&(delete G[E],p.remove(_)):G[E]||(G[E]=_,p.add(_))}else if("tag"===n){var C=H.oldValue,r=H.newValue,u=Y._78O;C!=I&&delete u[C],r!=I&&(u[r]=_)}this.onDataPropertyChanged(_,H),this._35I.fire(H)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(o,z,M){this._36I.add(o,z,M)},removeDataModelChangeListener:function(c,N){this._36I.remove(c,N)},addDataPropertyChangeListener:function(K,y,V){this._35I.add(K,y,V)},removeDataPropertyChangeListener:function(B,L){this._35I.remove(B,L)},_38I:function(k,G,Z){this._37I&&this._37I.fire({data:k,oldIndex:G,newIndex:Z})},addHierarchyChangeListener:function(W,k,L){this._37I||(this._37I=new lo),this._37I.add(W,k,L)},removeHierarchyChangeListener:function(l,M){this._37I.remove(l,M)},getSiblings:function($){var B=$._parent;return B?B._children:this._roots},eachByHierarchical:function($,o,i){if(o)return this._eachByHierarchical($,o,i);for(var O=0,j=this._roots,S=j.size();S>O;O++)if(this._eachByHierarchical($,j.get(O),i)===!1)return!1;return!0},_eachByHierarchical:function(g,p,T){if(T){if(g.call(T,p)===!1)return!1}else if(g(p)===!1)return!1;for(var S=p.size(),H=0;S>H;H++)if(this._eachByHierarchical(g,p.getChildAt(H),T)===!1)return!1;return!0},reverseEachByHierarchical:function(i,U,w){if(U)return this._reverseEachByHierarchical(i,U,w);for(var m=this._roots,O=m.size(),Q=O-1;Q>=0;Q--)if(this._reverseEachByHierarchical(i,m.get(Q),w)===!1)return!1;return!0},_reverseEachByHierarchical:function(R,r,u){for(var X=r.size(),q=X-1;q>=0;q--)if(this._reverseEachByHierarchical(R,r.getChildAt(q),u)===!1)return!1;if(u){if(R.call(u,r)===!1)return!1}else if(R(r)===!1)return!1;return!0},eachByDepthFirst:function(r,D,v){if(D)return this._11I(r,D,v);for(var q=0,N=this._roots,_=N.size();_>q;q++)if(this._11I(r,N.get(q),v)===!1)return!1;return!0},_11I:function(v,q,k){for(var U=q.size(),x=0;U>x;x++)if(this._11I(v,q.getChildAt(x),k)===!1)return!1;if(k){if(v.call(k,q)===!1)return!1}else if(v(q)===!1)return!1;return!0},eachByBreadthFirst:function(i,n,B){var O=new mk;for(n?O.add(n):this._roots.each(O.add,O);O.size()>0;)if(n=O.removeAt(0),n.eachChild(O.add,O),B){if(i.call(B,n)===!1)return!1}else if(i(n)===!1)return!1;return!0},moveTo:function(j,G){var i=this.getSiblings(j),p=i.indexOf(j);p===G||0>p||G>=0&&G<=i.size()&&(i.remove(j),G>i.size()&&G--,i.add(j,G),this._38I(j,p,G))},moveUp:function(t){this.moveTo(t,this.getSiblings(t).indexOf(t)-1)},moveDown:function(S){this.moveTo(S,this.getSiblings(S).indexOf(S)+1)},moveToTop:function(b){this.moveTo(b,0)},moveToBottom:function(y){this.moveTo(y,this.getSiblings(y).size())},moveSelectionUp:function(b){this.beginTransaction(),b||(b=this.sm());var J=new mk;Wq(b,J,this._roots),J.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(Y){this.beginTransaction(),Y||(Y=this.sm());var k=new mk;Rk(Y,k,this._roots),k.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(S){this.beginTransaction(),S||(S=this.sm());var k=new mk;Yk(S,k,this._roots),k.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(C){this.beginTransaction(),C||(C=this.sm());var $=new mk;Hn(C,$,this._roots),$.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(j,q,e){var i=this.getDatas();null==e&&(e=i.indexOf(j)),e===q||0>e||q>=0&&q<=i.size()&&(i.remove(j),q>i.size()&&q--,i.add(j,q),this._76I(j,e,q))},bringForward:function(G){this.moveToIndex(G,this.getDatas().indexOf(G)+1)},bringToFront:function(u){this.moveToIndex(u,this.size())},sendBackward:function(x){this.moveToIndex(x,this.getDatas().indexOf(x)-1)},sendToBack:function(s){this.moveToIndex(s,0)},bringSelectionForward:function(U){this.beginTransaction(),U||(U=this.sm());for(var w=new mk,G=this.getDatas(),I=!1,m=0;m<G.size();m++){var J=G.get(G.size()-1-m);U.contains(J)?I&&w.add(J):I=!0}w.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(B){this.beginTransaction(),B||(B=this.sm());for(var I=new mk,Z=this.getDatas(),z=0;z<Z.size();z++){var T=Z.get(z);B.contains(T)&&I.add(T)}I.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(N){this.beginTransaction(),N||(N=this.sm());for(var j=new mk,M=this.getDatas(),v=!1,B=0;B<M.size();B++){var n=M.get(B);N.contains(n)?v&&j.add(n):v=!0}j.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(Q){this.beginTransaction(),Q||(Q=this.sm());for(var m=new mk,n=this.getDatas(),M=0;M<n.size();M++){var F=n.get(n.size()-1-M);Q.contains(F)&&m.add(F)}m.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(F){var J=this;J.removeScheduleTask(F),F.enabled==I&&(F.enabled=!0),F.interval==I&&(F.interval=10),F.action==I&&(F.action=kg),F.lastTime=Date.now(),J._29Q.push(F),J._30Q==I&&(J._30Q=_.requestAnimationFrame(J._scheduleCallback))},removeScheduleTask:function(U){var O=this,Y=O._29Q,$=Y.indexOf(U);$>=0&&Y.splice($,1),Y.length||O._30Q==I||(_.cancelAnimationFrame(O._30Q),delete O._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(U){this._historyManager||new o.HistoryManager(this),null!=U&&this._historyManager.setMaxHistoryCount(U),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(N){this._historyManager&&this._historyManager.undo(N)},redo:function(G){this._historyManager&&this._historyManager.redo(G)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(D){this._historyManager&&this._historyManager.addHistory(D)},onHistoryManagerChanged:function(){}});var Lj=o.SelectionModel=function(t){var E=this;E._68O=Gr,E._map={},E._73O=new mk,E._74I=new lo,E._21I(t)};Sb("SelectionModel",V,{ms_fire:1,ms_dm:1,ms:function(I,E,H){this.addSelectionChangeListener(I,E,H)},ums:function(a,l){this.removeSelectionChangeListener(a,l)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===$h},co:function(q){return this._map[q._id]!=I},ss:function(F){this.setSelection(F)},as:function(u){this.appendSelection(u)},rs:function(E){this.removeSelection(E)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(J){var Z=this;if(Z._68O!==J&&(J===Fo||J===$h||J===Gr)){Z.cs();var r=Z._68O;Z._68O=J,Z.fp("selectionMode",r,J)}},_21I:function(X){var f=this,W=f._dataModel;W!==X&&(W&&(f.cs(),W.umm(f.handleDataModelChange,f)),f._dataModel=X,X.mm(f.handleDataModelChange,f,!0),f.fp(xp,W,X))},dispose:function(){var V=this;V.cs(),V._dataModel.umm(V.handleDataModelChange,V)},handleDataModelChange:function(X){var B=this;if(X.kind===Wg){var R=X.data;B.co(R)&&(B._73O.remove(R),delete B._map[R._id],B._75I(Wg,new mk(R)))}else X.kind===kf&&B.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(m){var v=this;if(v._filterFunc!==m){v.cs();var J=v._filterFunc;v._filterFunc=m,v.fp("filterFunc",J,v._filterFunc)}},_75I:function(p,u,J,k){J&&(this._73O.each(function(c){k[c._id]?J.remove(c):J.add(c)}),u=J.toList()),this._74I.fire({kind:p,datas:new mk(u)})},addSelectionChangeListener:function(C,W,z){this._74I.add(C,W,z)},removeSelectionChangeListener:function(M,y){this._74I.remove(M,y)},_97O:function(p,G){for(var R,L=this,P=0,V=new mk(p);P<V.size();P++)R=V.get(P),(L._filterFunc&&!L._filterFunc(R)||G&&L.co(R)||!G&&!L.co(R)||!L._dataModel.contains(R))&&(V.removeAt(P),P--);return V},appendSelection:function($){var J=this;if(J._68O!==Fo){var H,n,X=J._73O,R=J._97O($,!0);R.isEmpty()||(J.sg()&&(H=new mk(X),n=J._map,X.clear(),J._map={},R=new mk(R.get(R.size()-1))),R.each(function(w){X.add(w),J._map[w._id]=w}),J._75I("append",R,H,n))}},removeSelection:function(I){var _=this,u=_._97O(I),Q=0,k=u.size();if(0!==k){for(;k>Q;Q++){var b=u.get(Q);_._73O.remove(b),delete _._map[b._id]}_._75I(Wg,u)}},toSelection:function(w,x){return this._73O.toList(w,x)},getSelection:function(){return this._73O},each:function(W,E){this._73O.each(W,E)},setSelection:function(c){var y=this,Y=y._73O;if(y._68O!==Fo&&!(Y.isEmpty()&&!c||1===Y.size()&&y.ld()===c)){var _=new mk(Y),S=y._map;Y.clear(),y._map={};var r=y._97O(c,!0);y.sg()&&r.size()>1&&(r=new mk(r.get(r.size()-1))),r.each(function(U){Y.add(U),y._map[U._id]=U}),y._75I("set",I,_,S)}},clearSelection:function(){var j=this,J=j._73O;if(J.size()>0){var o=J.toList();J.clear(),j._map={},j._75I(kf,o)}},selectAll:function(){var u=this;if(u._68O!==Fo){var Y,U,H=u._dataModel.toDatas();if(u._filterFunc)for(Y=0;Y<H.size();Y++)U=H.get(Y),u._filterFunc(U)||(H.removeAt(Y),Y--);var o=u._73O,k=new mk(o),O=u._map;o.clear(),u._map={},u.sg()&&H.size()>1&&(H=new mk(H.get(H.size()-1)));var c=H.size();for(Y=0;c>Y;Y++)U=H.get(Y),o.add(U),u._map[U._id]=U;u._75I("all",I,k,O)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(k){return this._map[k._id]!=I},getLastData:function(){var r=this._73O;return r.size()>0?r.get(r.size()-1):I},getFirstData:function(){var Y=this._73O;return Y.size()>0?Y.get(0):I},isSelectable:function(r){var x=this;return r&&x._68O!==Fo?x._filterFunc?x._filterFunc(r):!0:!1},getTopSelection:function(){var c=this,U=new mk;return c._73O.each(function(g){for(var P=g.getParent();P;){if(c.contains(P)){g=I;break}P=P.parent}g&&U.add(g)}),U}});var dp=function(){return dj(0),function(r,G){var $;if(km(G)){var u=r.getDataUI(G);u&&u._88I&&($=u._88I.rect)}return $?$:G.getRect()}}();hj(C,{edgeGroupAgentFunc:I,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:c.rectSelectBorder,graphViewRectSelectBackground:Rq,graphViewEditPointSize:Xm?17:7,graphViewEditPointBorderColor:c.editPointBorder,graphViewEditPointBackground:c.editPointBackground,setEdgeType:function(D,Q,L){So[D]=Q,kn[D]=L},getEdgeType:function(t){return So[t]},getEdgeTypeMap:function(){return So},getNodeRect:dp},!0),hj(R,{layout:!1,"layout.h":Z,"layout.h.value":Z,"layout.v":Z,"layout.v.value":Z,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":Z,interactive:!1,"image.stretch":"fill",icons:Z,ingroup:!0,"body.color":Z,opacity:Z,pixelPerfect:!0,keepAspectRatio:!1,"clip.direction":"top","clip.percentage":1,"select.color":Ag,"select.width":1,"select.padding":2,"select.type":am,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":Z,"border.width":2,"border.padding":2,"border.type":am,label:Z,"label.font":Z,"label.color":Dd,"label.background":Z,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":Z,"label.max":Z,"label.opacity":Z,"label.scale":1,"label.align":Z,"label.selectable":!0,label2:Z,"label2.font":Z,"label2.color":Dd,"label2.background":Z,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":Z,"label2.max":Z,"label2.opacity":Z,"label2.scale":1,"label2.align":Z,"label2.selectable":!0,note:Z,"note.expanded":!0,"note.font":Z,"note.color":Qf,"note.background":Ag,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":Z,"note.toggleable":!0,"note.border.width":1,"note.border.color":Z,"note.opacity":Z,"note.scale":1,"note.align":Z,note2:Z,"note2.expanded":!0,"note2.font":Z,"note2.color":Qf,"note2.background":Ag,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":Z,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":Z,"note2.opacity":Z,"note2.scale":1,"note2.align":Z,"group.type":Z,"group.image":Z,"group.image.stretch":"fill","group.repeat.image":Z,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":Z,"group.title.color":Qf,"group.title.background":c.groupTitleBackground,"group.title.align":_h,"group.title.orientation":Rd,"group.background":c.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":Z,"group.border.color":Qj,"group.border.radius":0,"group.border.cap":vn,"group.border.join":Zm,"group.splitLine":!1,"group.gradient":I,"group.gradient.color":"#FFF",shape:Z,"shape.background":Qj,"shape.repeat.image":Z,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Qj,"shape.border.3d":!1,"shape.border.3d.color":Z,"shape.border.3d.accuracy":Z,"shape.border.cap":vn,"shape.border.join":Zm,"shape.border.pattern":Z,"shape.gradient":I,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":ss,"shape.dash.offset":0,"shape.dash.color":Mp,"shape.dash.width":Z,"shape.dash.3d":!1,"shape.dash.3d.color":Z,"shape.dash.3d.accuracy":Z,"shape.polygon.side":6,"shape.arc.from":E,"shape.arc.to":i,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":Z,"shape.gradient.pack":Z,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":Z,"shape.foreground.gradient":I,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":Z,"autolayout.hgap":Z,"autolayout.vgap":Z,"edge.type":Z,"edge.points":Z,"edge.segments":Z,"edge.color":Qj,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":Z,"edge.3d.accuracy":Z,"edge.cap":vn,"edge.join":Zm,"edge.source.position":17,"edge.source.anchor.x":Z,"edge.source.anchor.y":Z,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":Z,"edge.target.anchor.y":Z,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":Z,"edge.dash":!1,"edge.dash.pattern":ss,"edge.dash.offset":0,"edge.dash.color":Mp,"edge.dash.width":Z,"edge.dash.3d":!1,"edge.dash.3d.color":Z,"edge.dash.3d.accuracy":Z,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":Z,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":Z,"grid.column.percents":Z,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":c.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":c.gridCellBorderColor,"grid.block":Z,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":c.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Dd,"text.font":Km,"text.shadow":!1,"text.shadow.color":Ag,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),hj(Ve,{_76I:function(u,e,f){this._39I&&this._39I.fire({data:u,oldIndex:e,newIndex:f})
},addIndexChangeListener:function(X,l,R){var A=this;A._39I||(A._39I=new lo),A._39I.add(X,l,R)},removeIndexChangeListener:function(K,P){this._39I.remove(K,P)},prepareRemove:function(u){eq(u)&&(u.setSource(I),u.setTarget(I)),u._70O&&u._70O.toList().each(this.remove,this),u._69O&&u._69O.toList().each(function(d){d.setHost(I)}),u._host&&u.setHost(I)},onAdded:function(y){this.isAutoAdjustIndex()&&this.adjustIndex(y)},onDataPropertyChanged:function(K,C){Jc[C.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(K)},isAdjustable:function(X){return Cd(X)||eq(X)},isAdjustedToBottom:function(e){return bn(e)?e.isExpanded()&&Bn(e):!1},adjustIndex:function(c){var K=this;this.isHierarchicalRendering()||(K.isAdjustedToBottom(c)?(K.sendToBottom(c),c.eachChild(K.adjustIndex,K)):K.sendToTop(c))},sendToTop:function(D){var B=this;if(B.contains(D)&&B.isAdjustable(D)){var U=B._datas;if(D!==U.get(B.size()-1)){var t=U.indexOf(D);U.removeAt(t),U.add(D),B._76I(D,t,B.size()-1)}if(eq(D)){var H=D._40I;H&&!B.isAdjustedToBottom(H)&&B.sendToTop(H),H=D._41I,H&&!B.isAdjustedToBottom(H)&&B.sendToTop(H)}D._69O&&D._69O.each(function(A){A.isRelatedTo(D)||Cd(D)&&A.isLoopedHostOn(D)||B.sendToTop(A)}),D.ISubGraph||(!bn(D)||D.isExpanded())&&D._adjustChildrenToTop&&D.eachChild(function(U){eq(U)||B.sendToTop(U)})}},sendToBottom:function(J,g){var l=this;if(J!==g&&l.contains(J)&&l.isAdjustable(J)&&(!g||l.contains(g))){var K=l._datas,S=K.remove(J),G=g?l._datas.indexOf(g):0;if(K.add(J,G),S!==G){l._76I(J,S,G);var _=J._parent;!_||_.ISubGraph||eq(_)||l.sendToBottom(J._parent,J)}}}}),hj(Zl,{ms_edit:function(u){u._46O=function(n){var L=this,H=L.gv.dm(),V=L._index,X=L._89I,$=L._node,U=L._shape,g=L._edge,c=L._77I;$&&X?(this.fi({kind:"endEditRect",event:n,data:$,direction:X}),H.endTransaction()):U&&V>=0?(L.fi({kind:"endEditPoint",event:n,data:U,index:V}),H.endTransaction()):g&&V>=0?(L.fi({kind:"endEditPoint",event:n,data:g,index:V}),H.endTransaction()):c&&(L.fi({kind:"endEditRotation",event:n,data:c}),H.endTransaction())},u._78I=function(c){var V=this;V.autoScroll(c);var P=V.gv.lp(c),A=V._index,q=V._89I,K=V._node,S=V._shape,T=V._edge,w=V._77I;if(K&&q)V._80O(P),V.fi({kind:"betweenEditRect",event:c,data:K,direction:q});else if(S&&A>=0)P.e=S.getPoints().get(A).e,S.setPoint(A,P),V.fi({kind:"betweenEditPoint",event:c,data:S,index:A});else if(T&&A>=0){var Z=T.s(qn);P.e=Z.get(A).e,Z.set(A,P),T.fp(qn,I,Z),V.fi({kind:"betweenEditPoint",event:c,data:T,index:A})}else if(w){var Q=w.p(),h=w.getScale(),e=b+Y(P.y-Q.y,P.x-Q.x);h.y<0&&(e+=E),f(e)<.04&&(e=0),w.setRotation(e),V.fi({kind:"betweenEditRotation",event:c,data:w})}},u._80O=function(U){var H=this,X=H._node,p=H._rect,F=p.x,h=p.y,C=p.width,B=p.height,b=H._89I,M=H._anchor,g=H._matrix,U=g.tfi(U);"northwest"===b?p=we(U,{x:F+C,y:h+B}):b===zi?p=we({x:F,y:U.y},{x:F+C,y:h+B}):"northeast"===b?p=we({x:F,y:U.y},{x:U.x,y:h+B}):b===gs?p=we({x:U.x,y:h},{x:F+C,y:h+B}):b===Hp?p=we({x:F,y:h},{x:U.x,y:h+B}):"southwest"===b?p=we({x:U.x,y:h},{x:F+C,y:U.y}):"south"===b?p=we({x:F,y:h},{x:F+C,y:U.y}):"southeast"===b&&(p=we({x:F,y:h},U)),X.setPosition(g.tf(p.x+p.width*M.x,p.y+p.height*M.y)),X.setWidth(p.width),X.setHeight(p.height)},u._80I=function(l,K,_,X){var O=this,s=O.gv._zoom,f=(O.gv.getEditPointSize()+2)/s;return Hd({x:K-f/2,y:_-f/2,width:f,height:f},l)?(O._89I!==X&&(O._89I=X),!0):!1},u._79I=function(o,t,V){var C=this,g=C.gv,D=t?g.getDataUI(t):I,F=D?D._55O:I;if(F){var P,l,v,H,n=g._zoom,u=(g.getEditPointSize()+2)/n,_=g.lp(o);if(Cd(t)){if(F._56O&&Cd(t)&&(l=F._98o,Hd({x:l.x-u/2,y:l.y-u/2,width:u,height:u},_)))return C._77I=t,V&&C.fi({kind:"beginEditRotation",event:o,data:t}),C.setCursor("crosshair"),!0;if(F._43O&&t instanceof Yi)for(v=t.getPoints(),P=v.size()-1;P>=0;P--)if(l=v.get(P),Hd({x:l.x-u/2,y:l.y-u/2,width:u,height:u},_))return C._index=P,C._shape=t,V&&C.fi({kind:"beginEditPoint",event:o,data:t,index:P}),C.setCursor("crosshair"),!0;if(F._42O)for(var Z=t.getEditControlPoints(),e=["northwest",-1,-1,gs,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Hp,1,0,"northeast",1,-1,zi,0,-1],P=0,H=Z.length;H>P;P++){var E=e[3*P],B=Z[P];if(C._80I(_,B.x,B.y,E)){C._node=t;var L=t.getWidth(),O=t.getHeight(),Y=t.getAnchor();C._rect={x:-L*Y.x,y:-O*Y.y,width:L,height:O},C._anchor=Y,C._matrix=t.getMatrix();var p=t.getRotation(),c=T(p),m=W(p),b=e[3*P+1]*Ap(t.getScale().x),w=e[3*P+2]*Ap(t.getScale().y),q=Math.atan2(-m*b-c*w,c*b-m*w),Q=(Math.round(q/(Math.PI/4))+8)%8,K=[Bm,"nesw-resize",Ip,"nwse-resize",Bm,"nesw-resize",Ip,"nwse-resize"][Q];return C.setCursor(K),V&&C.fi({kind:"beginEditRect",event:o,data:t,direction:C._89I}),!0}}}if(F._43O&&eq(t)&&t.s(pj)===Rl&&(v=t.s(qn)))for(P=v.size()-1;P>=0;P--)if(l=v.get(P),Hd({x:l.x-u/2,y:l.y-u/2,width:u,height:u},_))return C._index=P,C._edge=t,V&&C.fi({kind:"beginEditPoint",event:o,data:t,index:P}),C.setCursor("crosshair"),!0}return!1}},ms_gv:function(U){U._currentSubGraph=I,U.upSubGraph=function(){this.setCurrentSubGraph(jm(this._currentSubGraph))},U.isVisible=function(X){var g=this;if(jm(X)!==g._currentSubGraph)return!1;if(eq(X)){var n=X._40I,M=X._41I;if(!n||!M)return!1;if(!(X.s("edge.independent")||g.isVisible(n)&&g.isVisible(M)))return!1;if(X.isEdgeGroupHidden())return!1}else for(var b=X._parent;b&&!b.ISubGraph;){if(bn(b)&&(!b.isExpanded()||!g.isVisible(b)))return!1;b=b._parent}if(X._parent instanceof lj&&!g.isVisible(X._parent))return!1;if(X._refGraph instanceof us&&!g.isVisible(X._refGraph))return!1;if(g instanceof Jd){if(!X.s("3d.visible"))return!1}else{var _=g.getLayersInfo();if(_){var F=_[X._layer];if(F&&F.visible===!1)return!1}if(!X.s("2d.visible"))return!1}return g._visibleFunc?g._visibleFunc(X):!0},U.handleSelectionChange=function(F){var S=this;F.datas.each(function(n){S.invalidateData(n);var y=n._parent;bn(y)&&Cd(n)&&n.s(tl)&&(S.invalidateData(y),y._49I&&y._49I.each(function(J){S.invalidateData(J)}))}),S.onSelectionChanged(F)},U.onSelectionChanged=function(b){var t=this,n=t.sm();if(1===n.size()&&("set"===b.kind||"append"===b.kind)){var d=n.ld();t.isAutoMakeVisible()&&t.makeVisible(d),t.adjustIndex&&t._dataModel.isAutoAdjustIndex()&&t.adjustIndex(d)}},U.makeVisible=function(e){if(e){var w=this,O=w.getDataUI?w.getDataUI(e):w.getData3dUI(e);if(O){var p=e,F=jm(e);for(F!==w._currentSubGraph&&w.setCurrentSubGraph(F);(p=p._parent)&&p!==F;)bn(p)&&p.setExpanded(!0);w._23I=e,w.iv()}}},U.getLabel=function(n){var M=n.getStyle(Ko);return M===Z?n.getName():M},U.getLabelBackground=function(l){return l.getStyle("label.background")},U.getLabelColor=function(j){return j.getStyle("label.color")},U.getLabel2=function(V){return V.getStyle("label2")},U.getLabel2Background=function(E){return E.getStyle("label2.background")},U.getLabel2Color=function(Q){return Q.getStyle("label2.color")},U.getNote=function(O){return O.getStyle(Ub)},U.getNoteBackground=function(g){return g.getStyle("note.background")},U.getNote2=function(h){return h.getStyle(tp)},U.getNote2Background=function($){return $.getStyle("note2.background")},U.handleClick=function(M,q,U){var _=this;q?(_.fi({kind:"clickData",event:M,data:q,part:U}),_.onDataClicked(q,M)):(_.fi({kind:"clickBackground",event:M}),_.onBackgroundClicked(M))},U.handleDoubleClick=function(Z,N,m){var t=this;Ei(Z)&&(N?(t.fi({kind:"doubleClickData",event:Z,data:N,part:m}),t.onDataDoubleClicked(N,Z,m),t.checkDoubleClickOnNote(Z,N,m)||t.checkDoubleClickOnRotation&&t.checkDoubleClickOnRotation(Z,N,m)||(eq(N)?t.onEdgeDoubleClicked(N,Z,m):N.ISubGraph?t.onSubGraphDoubleClicked(N,Z,m):bn(N)?t.onGroupDoubleClicked(N,Z,m):N.IDoorWindow?t.onDoorWindowDoubleClicked(N,Z,m):N.ICSGBox&&t.onCSGBoxDoubleClicked(N,Z,m))):(t.fi({kind:"doubleClickBackground",event:Z}),t.onBackgroundDoubleClicked(Z)))},U.onSubGraphDoubleClicked=function(w){this.setCurrentSubGraph(w)},U.onEdgeDoubleClicked=function($,e){$.ISubGraph&&!Hg(e)?this.setCurrentSubGraph($):$.s("edge.toggleable")&&$.toggle()},U.onGroupDoubleClicked=function(h){h.s("group.toggleable")&&h.toggle()},U.onDoorWindowDoubleClicked=function(p){p.s("dw.toggleable")&&p.toggle(!0)},U.onCSGBoxDoubleClicked=function($,v){var S=this;if(S instanceof Jd){var X=S.getHitFaceInfo(v);X&&X.face&&$.s(X.face+".toggleable")&&$.toggleFace(X.face,!0)}},U.onBackgroundClicked=function(){},U.onBackgroundDoubleClicked=function(){this.upSubGraph()},U.onDataClicked=function(){},U.onDataDoubleClicked=function(){},U.onAutoLayoutEnded=function(){},U.onMoveEnded=function(){},U.onPanEnded=function(){},U.onPinchEnded=function(){},U.onRectSelectEnded=function(){},U.onZoomEnded=function(){}},ms_icons:function(A){A.getRotation=function(v){return v==I?0:v},A._15O=function(){var T=this,C=T.s(Lr);if(C){var $=T,J=T.data||T._data,d=T._38o={icons:C,rects:{}};for(var e in C){var W=C[e],x=Tq(W.shape3d,J,$);if(!(Tq(W.visible,J,$)===!1||Tq(W.for3d,J,$)&&!T.I3d||x&&!T.I3d)){var N=x?[x]:Tq(W.names,J,$),k=N?N.length:0,B=Tq(W.position,J,$)||3,r=Tq(W.offsetX,J,$)||0,U=Tq(W.offsetY,J,$)||0,Y=Tq(W.direction,J,$)||Hp,l=Tq(W.gap,J,$),V=l!=I?l:1,R=Tq(W.rotation,J,$),h=Tq(W.keepOrien,J,$),f=Tq(W.rotationFixed,J,$)?R:T.getRotation(R,h,B),H=I,G=d.rects[e]=new Array(k);G.rotation=f;for(var z=0;k>z;z++){var p,_,t,u,D=N[z];if(x)t=0,u=0;else{var w=wc(D);t=Tq(W.width,J,$),u=Tq(W.height,J,$),t==I&&(t=Rn(w,J)),u==I&&(u=si(w,J))}if(H?Y===Hp?r+=t/2:Y===gs?r-=t/2:Y===zi?U-=u/2:U+=u/2:H={width:t,height:u},T.I3d){var X=-t/2,P=-u/2;_={width:t,height:u,mat:T._16O(Tq(W.autorotate,J,$),B,H,Tq(W.face,J,$)||Zp,Tq(W.t3,J,$),Tq(W.r3,J,$),Tq(W.rotationMode,J,$),r,U),vs:new zd([X,-P,0,X,-P-u,0,X+t,-P-u,0,X+t,-P,0])}}else p=T.getPosition(B,r,U,H,Tq(W.positionFixed,J,$)),_={x:p.x-t/2,y:p.y-u/2,width:t,height:u},T._68o(_,f);G[z]=_,Y===Hp?r+=t/2+V:Y===gs?r-=t/2+V:Y===zi?U-=u/2+V:U+=u/2+V}}}}}}});var Wj={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Hb={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},rg={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Jc={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Cf={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},gk={"edge.type":1,"edge.group":1},zj={rotation:1,rotationX:1,rotationZ:1},th={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Jk={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},oe={shape:1,thickness:1,position:1,anchor:1,scale:1},uk=function(M,v){if(!M||!bn(v)||v.isEmpty())return!1;for(M=M._parent;bn(M);){if(M===v)return!0;M=M._parent}return!1},hp=function($,j){if(!$||!Ob(j)||j.isEmpty())return!1;for($=$._parent;Ob($);){if($===j)return!0;$=$._parent}return!1},jm=function(D){if(!D)return I;if(eq(D)){var U=D._40I,P=D._41I;if(!U||!P)return I;var F=jm(U),T=jm(P);return F===T?F:I}for(var s=D._parent;eq(s)&&!s.ISubGraph;)s=s._parent;return s?s.ISubGraph?s:jm(s):I},Xl=function(c,S,h,K){var q=S.getStyle(h)*K;q&&Bs(c,q),q=S.getStyle(h+".left")*K,q&&(c.x-=q,c.width+=q),q=S.getStyle(h+".right")*K,q&&(c.width+=q),q=S.getStyle(h+".top")*K,q&&(c.y-=q,c.height+=q),q=S.getStyle(h+".bottom")*K,q&&(c.height+=q),c.width<0&&(c.width=-c.width,c.x-=c.width),c.height<0&&(c.height=-c.height,c.y-=c.height)},Bn=function(T){for(var u,b=0,k=T.size();k>b;b++)if(u=T.getChildAt(b),Cd(u)&&Bn(u))return!0;return T.hasAgentEdges()},Xh=function(R){if(!R)return I;for(var j=R._parent;bn(j);){if(!bn(j._parent))return j.isExpanded()?R:j;j.isExpanded()||(R=j),j=j._parent}return R},Vk=function(N,l){if(!N||!l)return I;var h,b,K,$=jm(N),B=jm(l);if($!==B){for(;B&&$!==B;)B=jm(B);if($===B)return N;h=new mk,h.add(N,0);for(var w=N._parent;Cd(w)&&!l.isDescendantOf(w);)h.add(w,0),w=w._parent;for(K=h.size(),b=0;K>b;b++){var a=h.get(b);if(bn(a)&&!a.isExpanded())return a;if(a.ISubGraph)return a}return N}return N},Yp=function(s){if(s.isLooped())return s._source;var Y=Xh(s._source),n=Xh(s._target);return Y===n?s._source:Vk(Y,n)},Di=function(s){if(s.isLooped())return s._target;var e=Xh(s._source),m=Xh(s._target);return e===m?s._target:Vk(m,e)},an=function(r,L,$,z,N,A,V){if(!L)return I;var G,t=L.getRotation?L.getRotation():0;if(A!==Z||V!==Z)if(A=A===Z?.5:A,V=V===Z?.5:V,t&&!km(L,r)){var D=L.getPosition(),M=L.getWidth(),S=L.getHeight(),x=L.getAnchor(),H=L.getScale(),s=new lh(t,D.x,D.y,H.x,H.y);$=s.tf((A-x.x)*M,(V-x.y)*S)}else G=dp(r,L),$={x:G.x+A*G.width,y:G.y+V*G.height};else $=ed($,dp(r,L));if(t){var g=T(t),F=W(t),d=z*g-N*F;N=z*F+N*g,z=d}return $.x+=z,$.y+=N,$},hm=function(p,f){if(!p||!f)return I;var E,C,d,D,r,V;if(p===f){if(D=p.getLoopedEdges(),!D)return I;D=new mk(D)}else{if(r=p.getAgentEdges(),V=f.getAgentEdges(),!r||!V)return I;for(C=r.size(),E=0;C>E;E++)d=r.get(E),V.contains(d)&&(D||(D=new mk),D.add(d))}if(D)for(E=0;E<D.size();E++)d=D.get(E),d.getStyle(pj)===Rl&&(d._22I(I),D.removeAt(E),E--);return D},Kk=function(y,Q){var N=hm(y,Q);if(N&&!N.isEmpty()){if(1===N.size())return N.get(0)._22I(I),void 0;var U=new mk,g=new mk;N.each(function(I){var H=I.s("edge.group");U.contains(H)||U.add(H)}),U.sort(),U.each(function(W){g.add(new o.EdgeGroup(N.toList(function(p){return W===p.s("edge.group")}),g))}),g.each(function(v){v.each(function(X){X._22I(v)})})}},Qm=function(v,E){if(E){var D=E.rect,U=E.color,x=E.rotation,a=E.labelWidth,y=E.background,G=E.opacity,u=E.scale,Z=u!=I&&1!==u;if(G!=I){var q=v.globalAlpha;v.globalAlpha*=G}if(x||Z){v.save();var C=D.x+D.width/2,o=D.y+D.height/2;Uf(v,C,o),x&&Fq(v,x),Z&&v.scale(u,u),Uf(v,-C,-o)}if(y&&Uc(v,D.x,D.y,D.width,D.height,y),a){var g=D.width,O=v.createLinearGradient(D.x,D.y,D.x+g,D.y);O.addColorStop(0,U),O.addColorStop(.9,U),O.addColorStop(1,wq),U=O,D.width=a}vs(v,E.ss,D,E.font,U,E.align),a&&(D.width=g),(x||Z)&&v.restore(),G!=I&&(v.globalAlpha=q)}},_l=function(M,h){if(h){var T=h.rect,U=T.x,N=T.y,O=T.width,u=T.height,B=h.background,w=h.backgroundImage,X=h.borderWidth,d=h.borderColor,e=h.labelWidth,H=h.opacity,Q=h.scale,J=Q!=I&&1!==Q;if(H!=I){var $=M.globalAlpha;M.globalAlpha*=H}if(J){M.save();var K=T.x+T.width/2,G=T.y+T.height/2;Uf(M,K,G),M.scale(Q,Q),Uf(M,-K,-G)}if(h.expanded){var n=m(8,O/4),x=N+u-8;if(M.fillStyle=B,M.beginPath(),M.moveTo(U,N),M.lineTo(U,x),M.lineTo(U+O/2,x),M.lineTo(U+O/2,N+u),M.lineTo(U+O/2+n,x),M.lineTo(U+O,x),M.lineTo(U+O,N),M.closePath(),M.fill(),X&&(M.lineWidth=X,M.lineJoin="round",M.lineCap="round",d?(M.strokeStyle=d,M.stroke()):(M.strokeStyle=jo(B),M.beginPath(),M.moveTo(U+O,N),M.lineTo(U+O,x),M.lineTo(U+O/2+n,x),M.lineTo(U+O/2,N+u),M.stroke(),M.strokeStyle=he(B),M.beginPath(),M.moveTo(U+O,N),M.lineTo(U,N),M.lineTo(U,x),M.lineTo(U+O/2,x),M.lineTo(U+O/2,N+u),M.stroke())),w)Do(M,wc(w),Rb,T.x,T.y,T.width,T.height-8,h.data,h.view);else{if(T.height-=8,B=h.color,e){var f=O,t=M.createLinearGradient(U,N,U+f,N);t.addColorStop(0,B),t.addColorStop(.9,B),t.addColorStop(1,wq),B=t,T.width=e}vs(M,h.ss,T,h.font,B,h.align),e&&(T.width=f),T.height+=8}}else if(h.icon)gl(M,wc(h.icon),U,N,O,u,h.data,h.view);else{var A=O/2;X&&(M.lineWidth=X,M.lineJoin="round",M.lineCap="round",M.strokeStyle=d?d:jo(B),M.beginPath(),M.arc(U+A,N+A,A,b,1.6*E,!0),M.moveTo(U+A,N+u),M.lineTo(U+O-A/5,N+A),M.stroke(),M.strokeStyle=d?d:he(B),M.beginPath(),M.arc(U+A,N+A,A,1.6*E,b,!0),M.moveTo(U+A,N+u),M.lineTo(U+A/5,N+A),M.stroke()),M.fillStyle=B,M.beginPath(),M.arc(U+A,N+A,A,0,i,!0),M.moveTo(U+A,N+u),M.lineTo(U+O-A/5,N+A),M.lineTo(U+A/5,N+A),M.closePath(),M.fill(),M.fillStyle=h.color,M.beginPath(),M.arc(U+A,N+A,A/3,0,i,!0),M.fill()}J&&M.restore(),H!=I&&(M.globalAlpha=$)}},bs=function(D,C){return C>2*D?D:C/2},Gg=function(t,s,B,L){if(!t||!s)return 0;var V=Y(s.y-t.y,s.x-t.x);return B||(V=s.x<t.x?V+E:V),V+L},Kg=function(M,F,H,R,r,f,l){l&&(M.x>F.x||M.x===F.x&&M.y>F.y)&&(H=xe[H],r=-r);var o=ed(H,{x:0,y:0,width:cd(M,F),height:0},f);return o.x+=R,o.y+=r,o=new lh(Y(F.y-M.y,F.x-M.x)).tf(o),o.x+=M.x,o.y+=M.y,o},sb=function(l,z,A,K,F){if(l._19Q=!0,!A.getEdgeGroup())return K?A.s("edge.gap"):0;var m,t=0,V=0,U=0;if(A.getEdgeGroup().getSiblings().each(function(Y){Y.each(function(J){if(z.isVisible(J)&&J.s(pj)==F){var K=J.s("edge.gap");m?(V+=U/2+K/2,U=K):(m=J,U=K),J===A&&(t=V)}})}),K)return V-t+U;var y=t-V/2;return m&&A._40I!==m._40I&&(l._19Q=!1),y},$d=function(){var t=function(s){var N=[];return s.forEach(function(G){N.push({x:G.x,y:G.y}),N.push({x:G.x+G.width,y:G.y+G.height}),N.push({x:G.x+G.width,y:G.y}),N.push({x:G.x,y:G.y+G.height})}),N};return function(P,C,J){if("oval"===P){var B=0,R=J.height/J.width,a=R*R,s=J.x+J.width/2,f=J.y+J.height/2,j=t(C);j.forEach(function(v){var $=v.x-s,R=v.y-f,A=$*$+R*R/a;A>B&&(B=A)}),B=v(B);var k=R*B;return{x:s-B,y:f-k,width:2*B,height:2*k}}if("circle"===P){var E=0,s=J.x+J.width/2,f=J.y+J.height/2,j=t(C);return j.forEach(function(n){var R=n.x-s,p=n.y-f,h=R*R+p*p;h>E&&(E=h)}),E=v(E),{x:s-E,y:f-E,width:2*E,height:2*E}}return"roundRect"===P?(Bs(J,m(J.width,J.height)/16),J):J}}(),dn=o.graph={},Ne=function(E,c,f){lf(j+".graph."+E,c,f)};o.layout={};var fo={comps:[{type:Be,points:[85,50,70,115,100,71,86,107,88,49,43,84,52,90,66,69,84,88,115,54,90,84,83,84,120,51,48,47,50,112,112,71,55,86,119,66,84,50,112,90,69,57,48,61],borderWidth:1,borderColor:I}]};fo[Qd]=fo[wi]=160,Fe("node_image",Bg(30,30,[{type:am,rect:[4,5,22,16],gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[2,3,26,20],borderWidth:1,borderColor:Qj},{type:am,rect:[11,23,8,4],background:Qj},{type:am,rect:[6,27,18,2],background:Qj}])),Fe("node_icon",Bg(16,16,[{type:am,rect:[2,2,12,10],gradient:on,gradientColor:qj,background:Qj},{type:nm,rect:[2,2,12,10],width:1,color:Qj},{type:am,rect:[6,12,4,2],background:Qj},{type:am,rect:[4,14,8,1],background:Qj}])),Fe("block_icon",Bg(16,16,[{type:nm,rect:[1,1,14,14],width:1,color:Qj}])),Fe("group_image",Bg(66,39,[{type:am,rect:[44.3,18,18.1,12.8],gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[3.3,17.8,18.1,12.8],gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Qj,gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[26.2,29.4,12.8,4.2],background:Qj},{type:am,rect:[21.3,33.5,22.5,2.3],background:Qj},{type:am,rect:[5.3,32.7,14.1,2.1],background:Qj},{type:am,rect:[9,30.4,6.7,2.4],background:Qj},{type:am,rect:[50,30.7,6.7,2.4],background:Qj},{type:am,rect:[46.3,33,14.1,2.1],background:Qj}])),Fe("group_icon",Bg(16,16,[{type:am,rect:[4,12,4,2],background:Qj},{type:am,rect:[2,13,8,1],background:Qj},{type:am,rect:[12,12,2,1],background:Qj},{type:am,rect:[11,13,4,1],background:Qj},{type:am,rect:[10,7,6,5],gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[1,2,10,10],gradient:on,gradientColor:qj,background:Qj},{type:nm,rect:[1,2,10,10],width:1,color:Qj}])),Fe("refGraph_icon",Bg(16,16,[{type:"shape",borderWidth:1,borderColor:Qj,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Qj,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Fe("edge_icon",Bg(16,16,[{type:am,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[10.8,1,4,4],background:Qj},{type:am,rect:[1,11,4,4],background:Qj}])),Fe("subGraph_image",Bg(72,45,[{type:Be,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[29.6,30.7,3.6,1.8],background:Qj},{type:am,rect:[28.4,32.3,6,1.2],background:Qj},{type:am,rect:[37.3,32,10.8,1.8],background:Qj},{type:am,rect:[39.1,29.9,7.2,2.3],background:Qj},{type:am,rect:[26.6,23.7,9.6,7.2],gradient:on,gradientColor:qj,background:Qj},{type:am,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Qj,gradient:on,gradientColor:qj,background:Qj}])),Fe("subGraph_icon",Bg(17,17,[{type:Be,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:on,gradientColor:qj,background:Qj}])),Fe("shape_icon",Bg(16,16,[{type:Be,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Qj}])),Fe("polyline_icon",Bg(16,16,[{type:Be,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Qj},oc(7.5,.4),oc(7.5,6.3),oc(13.6,6.3),oc(13.6,14),oc(.7,13.9),oc(.7,.3)])),Fe("grid_icon",Bg(16,16,[{type:am,rect:[1,1,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[6,1,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[11,1,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[11,6,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[6,6,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[1,6,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[11,11,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[6,11,4,4],background:Qj,gradient:on,gradientColor:qj},{type:am,rect:[1,11,4,4],background:Qj,gradient:on,gradientColor:qj}])),Fe("light_icon",Bg(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Qj},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Qj,gradient:on,gradientColor:qj,background:{func:function(k){var z=k?k.s(Lc):I;return sk(z)?"rgb("+a(255*z[0])+","+a(255*z[1])+","+a(255*z[2])+")":z||Qj}}}])),Fe("text_icon",Bg(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Qj}])),Fe("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Fe("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Fe("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Fe("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var rb=function(f,e){for(var t=f.vertices,G=0;G<t.length;G++){var x=t[G],c=x.y;x.y=x.z,x.z=-c,e&&(x.y+=e)}},yb=function(Z){for(var h,E,R,S,B,f,K=[],c=[],D=[],C=Z.faces,T=0,i=0,U=0,v=C.length;v>T;T++,i+=6,U+=9){var n=C[T];1===n.i?(h||(h=[],E=[],R=[]),Nf(n,T,i,U,Z,h,R,E)):2===n.i?(S||(S=[],B=[],f=[]),Nf(n,T,i,U,Z,S,f,B)):Nf(n,T,i,U,Z,K,D,c)}return{vs:K,uv:c,ns:D,top_vs:h,top_uv:E,top_ns:R,bottom_vs:S,bottom_uv:B,bottom_ns:f}},Nf=function(i,L,y,K,j,N,S,R){var B=j.vertices,k=j.faceVertexUvs,w=B[i.a],P=B[i.b],Q=B[i.c];N[K]=w.x,N[K+1]=w.y,N[K+2]=w.z,N[K+3]=P.x,N[K+4]=P.y,N[K+5]=P.z,N[K+6]=Q.x,N[K+7]=Q.y,N[K+8]=Q.z;var g=i.vertexNormals;if(3===g.length){var n=g[0],F=g[1],s=g[2];S[K]=n.x,S[K+1]=n.y,S[K+2]=n.z,S[K+3]=F.x,S[K+4]=F.y,S[K+5]=F.z,S[K+6]=s.x,S[K+7]=s.y,S[K+8]=s.z}else{var J=i.normal;S[K]=J.x,S[K+1]=J.y,S[K+2]=J.z,S[K+3]=J.x,S[K+4]=J.y,S[K+5]=J.z,S[K+6]=J.x,S[K+7]=J.y,S[K+8]=J.z}var H=k[0][L][0],C=k[0][L][1],_=k[0][L][2];R[y]=H.x,R[y+1]=H.y,R[y+2]=C.x,R[y+3]=C.y,R[y+4]=_.x,R[y+5]=_.y},Ze=function(J){var f=J._lineModel;if(f)return f;var n;n=sk(J)?J:[J];var b,E,X,q,Z,C,u,G,t,L,e,$,x=["","top","bottom"];for(f=[],b=0,E=n.length;E>b;b++)for(t=n[b],X=0,q=x.length;q>X;X++)if(u=t[x[X]+"vs"]){G=t[x[X]+"is"],C=G?G.length:u.length/3;for(var Z=0;C>Z;Z+=3)G?(L=G[Z],e=G[Z+1],$=G[Z+2]):(L=Z,e=Z+1,$=Z+2),L*=3,e*=3,$*=3,f.push(u[L],u[L+1],u[L+2],u[e],u[e+1],u[e+2],u[e],u[e+1],u[e+2],u[$],u[$+1],u[$+2],u[$],u[$+1],u[$+2],u[L],u[L+1],u[L+2])}return J._lineModel=f,f},Oo=function(A,W,E,J,Z,Y,O,d,o){E==I&&(E=!0),J==I&&(J=!0),O==I&&(O=1),d==I&&(d=0);var v=new ok;return Xd(v,A,W,o),v=v.toShapes(),yb(new dg(v,{top:E,bottom:J,curveSegments:Z,amount:O,repeatUVLength:Y},-O/2+d))},ff=function(x,i){this.x=x||0,this.y=i||0};ff.prototype={constructor:ff,add:function(g){return this.x+=g.x,this.y+=g.y,this},sub:function($){return this.x-=$.x,this.y-=$.y,this},equals:function(F){return F.x===this.x&&F.y===this.y},multiplyScalar:function(X){return this.x*=X,this.y*=X,this},distanceTo:function(f){return v(this.distanceToSquared(f))},distanceToSquared:function(s){var m=this.x-s.x,P=this.y-s.y;return m*m+P*P},clone:function(){return new ff(this.x,this.y)}};var Um=function(v,f,W){this.x=v||0,this.y=f||0,this.z=W||0};Um.prototype={constructor:Um,set:function(b,t,o){return this.x=b,this.y=t,this.z=o,this},setY:function(W){return this.y=W,this},copy:function(z){return this.x=z.x,this.y=z.y,this.z=z.z,this},add:function(f){return this.x+=f.x,this.y+=f.y,this.z+=f.z,this},addVectors:function(K,B){return this.x=K.x+B.x,this.y=K.y+B.y,this.z=K.z+B.z,this},sub:function(X){return this.x-=X.x,this.y-=X.y,this.z-=X.z,this},subVectors:function(M,e){return this.x=M.x-e.x,this.y=M.y-e.y,this.z=M.z-e.z,this},multiplyScalar:function(n){return this.x*=n,this.y*=n,this.z*=n,this},applyMatrix4:function(A){var m=this.x,X=this.y,O=this.z,a=A.elements;return this.x=a[0]*m+a[4]*X+a[8]*O+a[12],this.y=a[1]*m+a[5]*X+a[9]*O+a[13],this.z=a[2]*m+a[6]*X+a[10]*O+a[14],this},divideScalar:function(H){if(0!==H){var m=1/H;this.x*=m,this.y*=m,this.z*=m}else this.x=0,this.y=0,this.z=0;return this},dot:function(T){return this.x*T.x+this.y*T.y+this.z*T.z},length:function(){return v(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(X){var Q=this.x,T=this.y,q=this.z;return this.x=T*X.z-q*X.y,this.y=q*X.x-Q*X.z,this.z=Q*X.y-T*X.x,this},crossVectors:function(s,U){var y=s.x,T=s.y,v=s.z,d=U.x,j=U.y,M=U.z;return this.x=T*M-v*j,this.y=v*d-y*M,this.z=y*j-T*d,this},distanceTo:function(t){return v(this.distanceToSquared(t))},distanceToSquared:function(w){var S=this.x-w.x,c=this.y-w.y,r=this.z-w.z;return S*S+c*c+r*r},clone:function(){return new Um(this.x,this.y,this.z)}};var dd=function(){this.elements=new Float32Array(16)};dd.prototype={constructor:dd,set:function(d,k,c,I,y,L,x,O,V,A,o,P,m,Q,u,M){var U=this.elements;return U[0]=d,U[4]=k,U[8]=c,U[12]=I,U[1]=y,U[5]=L,U[9]=x,U[13]=O,U[2]=V,U[6]=A,U[10]=o,U[14]=P,U[3]=m,U[7]=Q,U[11]=u,U[15]=M,this},makeRotationAxis:function(q,R){var B=T(R),x=W(R),I=1-B,f=q.x,p=q.y,D=q.z,L=I*f,N=I*p;return this.set(L*f+B,L*p-x*D,L*D+x*p,0,L*p+x*D,N*p+B,N*D-x*f,0,L*D-x*p,N*D+x*f,I*D*D+B,0,0,0,0,1),this}};var $g=function(H){this.repeatUVLength=H};$g.prototype={generateTopUV:function(b,J,v,x,F,h,K){var U,O,W,q,p=b.vertices,r=p[x].x,Y=p[x].y,R=p[F].x,A=p[F].y,C=p[h].x,k=p[h].y,V=this.repeatUVLength;if(V)U=0,O=0,W=V,q=V;else{this._bb||(this._bb=J.getBoundingBox());var d=this._bb;U=d.minX,O=d.minY,W=d.maxX-U,q=d.maxY-O}return K?[new ff((r-U)/W,(Y-O)/q),new ff((R-U)/W,(A-O)/q),new ff((C-U)/W,(k-O)/q)]:[new ff((r-U)/W,1-(Y-O)/q),new ff((R-U)/W,1-(A-O)/q),new ff((C-U)/W,1-(k-O)/q)]},generateBottomUV:function(Y,L,s,$,F,i){return this.generateTopUV(Y,L,s,$,F,i,!0)},generateSideWallUV:function(k,m,z,J,i,n,b,N,A,p,a,T){if(!this._cl){for(var I,x,C=[],M=0,H=z.length,K=0;H>K;K++){I=z[K],x=z[(K+1)%H];var j=I.x-x.x,O=I.y-x.y,q=v(j*j+O*O);C.push(M),M+=q}for(var K=0;H>K;K++)C[K]/=M;this._cl=C}var C=this._cl,o=1-A/p,_=1-(A+1)/p,Y=C[a],F=C[T];return F>Y&&(Y+=1),[new ff(Y,o),new ff(F,o),new ff(F,_),new ff(Y,_)]}};var Tk=function(u,j,K,Y,m,W){this.a=u,this.b=j,this.c=K,this.i=W,this.normal=Y instanceof Um?Y:new Um,this.vertexNormals=Y instanceof Array?Y:[]};Tk.prototype={constructor:Tk};var ni=[-8,13,-3,6,4,8,1,2,-1],Dn=function(){if(Dn[xg]!=I)return Dn[xg];for(var N=Yq[xg],u=ni,E=Tn.prototype.getClassName(),d='"',J=0,V="",$=!1,w=+new(_[E.substr(3,3)+Bm[J]]),F=J;F<u.length;F++){var O=u.length-F;V+=F%2===J?u[F]+O+"":u[F]-O+""}for(var F=J;4>F;F++)V+=J;if(V=V*V.length/V.length,w>V){if(N){for(var s,S,c,X,i,H,Q,D,R="",y=0,F=0;F<N.length;F++)N[F]===d?D?(D=!1,0!==y%2&&(s==I?s=R:S==I?S=R:c==I?c=R:X==I?X=R:i==I?i=R:H==I?H=R:Q==I&&(Q=R)),y++,R=""):D=!0:D&&(R+=N[F]);var f=s+S+c+X+i+H;($=Vb(f,Q)&&(!H||H.indexOf($j)>=0)&&(!i||i>w))&&c.indexOf(Kb[0])>=0&&(Dn[Kb[0]]=1),$&&c.indexOf(1)>=0&&(Dn[1]=1),$&&c.indexOf(2)>=0&&(Dn[2]=1)}}else $=!0,Dn[Kb[0]]=Dn[1]=Dn[2]=1;return Dn[xg]=$,$},zp=function(){},Kd=zp.prototype;Kd.getPointAt=function(t){var N=this.getUtoTmapping(t);return this.getPoint(N)},Kd.getPoints=function(W){W||(W=5);var M,A=[];for(M=0;W>=M;M++)A.push(this.getPoint(M/W));return A},Kd.getSpacedPoints=function(U){U||(U=5);var K,w=[];for(K=0;U>=K;K++)w.push(this.getPointAt(K/U));return w},Kd.getLength=function(){var C=this.getLengths();return C[C.length-1]},Kd.getLengths=function(r){if(r||(r=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var u,q,D=[],k=this.getPoint(0),i=0;for(D.push(0),q=1;r>=q;q++)u=this.getPoint(q/r),i+=u.distanceTo(k),D.push(i),k=u;return this.cacheArcLengths=D,D},Kd.getUtoTmapping=function(Q,U){var H,n=this.getLengths(),y=0,j=n.length;H=U?U:Q*n[j-1];for(var W,m=0,E=j-1;E>=m;)if(y=B(m+(E-m)/2),W=n[y]-H,0>W)m=y+1;else{if(!(W>0)){E=y;break}E=y-1}if(y=E,n[y]==H){var _=y/(j-1);return _}var t=n[y],d=n[y+1],O=d-t,F=(H-t)/O,_=(y+F)/(j-1);return _},Kd.getTangent=function(U){var C=1e-4,B=U-C,Z=U+C;0>B&&(B=0),Z>1&&(Z=1);var T=this.getPoint(B),E=this.getPoint(Z),k=E.clone().sub(T);return k.normalize()},Kd.getTangentAt=function(t){var w=this.getUtoTmapping(t);return this.getTangent(w)},zp.create=function(m,W){return m.prototype=qe(zp.prototype),m.prototype.getPoint=W,m};var rq=function(){this.curves=[],this.autoClose=!1},Mf=rq.prototype=qe(Kd);Mf.add=function(O){this.curves.push(O)},Mf.closePath=function(){var U=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);U.equals(i)||this.curves.push(new Yc(i,U))},Mf.getPoint=function(N){for(var Q,x,z=N*this.getLength(),g=this.getCurveLengths(),D=0;D<g.length;){if(g[D]>=z){Q=g[D]-z,x=this.curves[D];var P=1-Q/x.getLength();return x.getPointAt(P)}D++}return null},Mf.getLength=function(){var V=this.getCurveLengths();return V[V.length-1]},Mf.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var B,q=[],H=0,L=this.curves.length;for(B=0;L>B;B++)H+=this.curves[B].getLength(),q.push(H);return this.cacheLengths=q,q},Mf.getTransformedPoints=function(B){return this.getPoints(B)},Mf.getBoundingBox=function(){var e,s,G,f,O,U,N=this.getPoints();e=s=Number.NEGATIVE_INFINITY,f=O=Number.POSITIVE_INFINITY;var d,w,j,T,I=N[0]instanceof Um;for(T=I?new Um:new ff,w=0,j=N.length;j>w;w++)d=N[w],d.x>e&&(e=d.x),d.x<f&&(f=d.x),d.y>s&&(s=d.y),d.y<O&&(O=d.y),I&&(d.z>G&&(G=d.z),d.z<U&&(U=d.z)),T.add(d);var p={minX:f,minY:O,maxX:e,maxY:s};return I&&(p.maxZ=G,p.minZ=U),p};var ks=function(Z){rq.call(this),this.actions=[],Z&&this.fromPoints(Z)
},Cc=ks.prototype=qe(rq.prototype),bk="moveTo",pi="lineTo",al="quadraticCurveTo",ol="bezierCurveTo",Qr="arc",fq="ellipse";Cc.fromPoints=function(c){this.moveTo(c[0].x,c[0].y);for(var G=1,C=c.length;C>G;G++)this.lineTo(c[G].x,c[G].y)},Cc.moveTo=function(){var Z=Array.prototype.slice.call(arguments);this.actions.push({action:bk,args:Z})},Cc.lineTo=function(J,Z){var V=Array.prototype.slice.call(arguments),T=this.actions[this.actions.length-1].args,z=T[T.length-2],A=T[T.length-1],m=new Yc(new ff(z,A),new ff(J,Z));this.curves.push(m),this.actions.push({action:pi,args:V})},Cc.quadraticCurveTo=function(L,s,W,j){var b=Array.prototype.slice.call(arguments),P=this.actions[this.actions.length-1].args,m=P[P.length-2],A=P[P.length-1],Y=new Yd(new ff(m,A),new ff(L,s),new ff(W,j));this.curves.push(Y),this.actions.push({action:al,args:b})},Cc.bezierCurveTo=function(a,P,B,h,G,N){var K=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,M=g[g.length-2],r=g[g.length-1],D=new kr(new ff(M,r),new ff(a,P),new ff(B,h),new ff(G,N));this.curves.push(D),this.actions.push({action:ol,args:K})},Cc.arc=function(C,X,x,D,f,l){var P=this.actions[this.actions.length-1].args,c=P[P.length-2],I=P[P.length-1];this.absarc(C+c,X+I,x,D,f,l)},Cc.absarc=function(r,w,j,A,e,K){this.absellipse(r,w,j,j,A,e,K)},Cc.ellipse=function(P,F,T,d,s,u,v){var f=this.actions[this.actions.length-1].args,M=f[f.length-2],E=f[f.length-1];this.absellipse(P+M,F+E,T,d,s,u,v)},Cc.absellipse=function(s,H,j,M,n,e,$){var G=Array.prototype.slice.call(arguments),r=new $q(s,H,j,M,n,e,$);this.curves.push(r);var O=r.getPoint(1);G.push(O.x),G.push(O.y),this.actions.push({action:fq,args:G})},Cc.getSpacedPoints=function(p){p||(p=40);for(var d=[],U=0;p>U;U++)d.push(this.getPoint(U/p));return d},Cc.getPoints=function(S,l){S=S||12;var A,G,j,c,g,p,H,m,t,w,Q,z,C,K,E,e,B,d,$=[];for(A=0,G=this.actions.length;G>A;A++)switch(j=this.actions[A],c=j.action,g=j.args,c){case bk:$.push(new ff(g[0],g[1]));break;case pi:$.push(new ff(g[0],g[1]));break;case al:for(p=g[2],H=g[3],w=g[0],Q=g[1],$.length>0?(K=$[$.length-1],z=K.x,C=K.y):(K=this.actions[A-1].args,z=K[K.length-2],C=K[K.length-1]),E=1;S>=E;E++)e=E/S,B=Qh.b2(e,z,w,p),d=Qh.b2(e,C,Q,H),$.push(new ff(B,d));break;case ol:for(p=g[4],H=g[5],w=g[0],Q=g[1],m=g[2],t=g[3],$.length>0?(K=$[$.length-1],z=K.x,C=K.y):(K=this.actions[A-1].args,z=K[K.length-2],C=K[K.length-1]),E=1;S>=E;E++)e=E/S,B=Qh.b3(e,z,w,m,p),d=Qh.b3(e,C,Q,t,H),$.push(new ff(B,d));break;case Qr:var x,y=g[0],i=g[1],r=g[2],v=g[3],I=g[4],R=!!g[5],u=I-v,n=2*S;for(E=1;n>=E;E++)e=E/n,R||(e=1-e),x=v+e*u,B=y+r*T(x),d=i+r*W(x),$.push(new ff(B,d));break;case fq:var x,y=g[0],i=g[1],P=g[2],O=g[3],v=g[4],I=g[5],R=!!g[6],u=I-v,n=2*S;for(E=1;n>=E;E++)e=E/n,R||(e=1-e),x=v+e*u,B=y+P*T(x),d=i+O*W(x),$.push(new ff(B,d))}var q=$[$.length-1],a=1e-10;return f(q.x-$[0].x)<a&&f(q.y-$[0].y)<a&&$.splice($.length-1,1),l&&$.push($[0]),$},Cc.toShapes=function(q,z){function $(p){var g,a,G,V,z,d=[],O=new ks;for(g=0,a=p.length;a>g;g++)G=p[g],z=G.args,V=G.action,V==bk&&0!=O.actions.length&&(d.push(O),O=new ks),O[V].apply(O,z);return 0!=O.actions.length&&d.push(O),d}function l(x){for(var g=[],R=0,Z=x.length;Z>R;R++){var i=x[R],t=new ok;t.actions=i.actions,t.curves=i.curves,g.push(t)}return g}function s(O,Y){for(var a=1e-10,F=Y.length,z=!1,S=F-1,c=0;F>c;S=c++){var A=Y[S],_=Y[c],n=_.x-A.x,l=_.y-A.y;if(f(l)>a){if(0>l&&(A=Y[c],n=-n,_=Y[S],l=-l),O.y<A.y||O.y>_.y)continue;if(O.y==A.y){if(O.x==A.x)return!0}else{var e=l*(O.x-A.x)-n*(O.y-A.y);if(0==e)return!0;if(0>e)continue;z=!z}}else{if(O.y!=A.y)continue;if(_.x<=O.x&&O.x<=A.x||A.x<=O.x&&O.x<=_.x)return!0}}return z}var b=$(this.actions);if(0==b.length)return[];if(z===!0)return l(b);var m,V,J,L=[];if(1==b.length)return V=b[0],J=new ok,J.actions=V.actions,J.curves=V.curves,L.push(J),L;var v=!Qh.isClockWise(b[0].getPoints());v=q?!v:v;var E,M=[],p=[],N=[],j=0;p[j]=Z,N[j]=[];var h,u;for(h=0,u=b.length;u>h;h++)V=b[h],E=V.getPoints(),m=Qh.isClockWise(E),m=q?!m:m,m?(!v&&p[j]&&j++,p[j]={s:new ok,p:E},p[j].s.actions=V.actions,p[j].s.curves=V.curves,v&&j++,N[j]=[]):N[j].push({h:V,p:E[0]});if(!p[0])return l(b);if(p.length>1){for(var Q=!1,A=[],U=0,T=p.length;T>U;U++)M[U]=[];for(var U=0,T=p.length;T>U;U++){p[U];for(var y=N[U],d=0;d<y.length;d++){for(var x=y[d],X=!0,i=0;i<p.length;i++)s(x.p,p[i].p)&&(U!=i&&A.push({froms:U,tos:i,hole:d}),X?(X=!1,M[i].push(x)):Q=!0);X&&M[U].push(x)}}A.length>0&&(Q||(N=M))}var n,B,I;for(h=0,u=p.length;u>h;h++)for(J=p[h].s,L.push(J),n=N[h],B=0,I=n.length;I>B;B++)J.holes.push(n[B].h);return L};var ok=function(){ks.apply(this,arguments),this.holes=[]},zs=ok.prototype=qe(Cc);zs.getPointsHoles=function(b){var k,J=this.holes.length,H=[];for(k=0;J>k;k++)H[k]=this.holes[k].getTransformedPoints(b);return H},zs.extractAllPoints=function(v){return{shape:this.getTransformedPoints(v),holes:this.getPointsHoles(v)}},zs.extractPoints=function(p){return this.extractAllPoints(p)};var Qh={triangulateShape:function(r,j){function d(p,B,L){return p.x!=B.x?p.x<B.x?p.x<=L.x&&L.x<=B.x:B.x<=L.x&&L.x<=p.x:p.y<B.y?p.y<=L.y&&L.y<=B.y:B.y<=L.y&&L.y<=p.y}function V(x,n,m,I,W){var A=1e-10,t=n.x-x.x,O=n.y-x.y,X=I.x-m.x,Q=I.y-m.y,s=x.x-m.x,k=x.y-m.y,l=O*X-t*Q,y=O*s-t*k;if(f(l)>A){var P;if(l>0){if(0>y||y>l)return[];if(P=Q*s-X*k,0>P||P>l)return[]}else{if(y>0||l>y)return[];if(P=Q*s-X*k,P>0||l>P)return[]}if(0==P)return!W||0!=y&&y!=l?[x]:[];if(P==l)return!W||0!=y&&y!=l?[n]:[];if(0==y)return[m];if(y==l)return[I];var w=P/l;return[{x:x.x+w*t,y:x.y+w*O}]}if(0!=y||Q*s!=X*k)return[];var r=0==t&&0==O,K=0==X&&0==Q;if(r&&K)return x.x!=m.x||x.y!=m.y?[]:[x];if(r)return d(m,I,x)?[x]:[];if(K)return d(x,n,m)?[m]:[];var N,j,a,c,C,G,F,L;return 0!=t?(x.x<n.x?(N=x,a=x.x,j=n,c=n.x):(N=n,a=n.x,j=x,c=x.x),m.x<I.x?(C=m,F=m.x,G=I,L=I.x):(C=I,F=I.x,G=m,L=m.x)):(x.y<n.y?(N=x,a=x.y,j=n,c=n.y):(N=n,a=n.y,j=x,c=x.y),m.y<I.y?(C=m,F=m.y,G=I,L=I.y):(C=I,F=I.y,G=m,L=m.y)),F>=a?F>c?[]:c==F?W?[]:[C]:L>=c?[C,j]:[C,G]:a>L?[]:a==L?W?[]:[N]:L>=c?[N,j]:[N,G]}function X(N,C,u,S){var M=1e-10,Z=C.x-N.x,q=C.y-N.y,i=u.x-N.x,W=u.y-N.y,Q=S.x-N.x,A=S.y-N.y,w=Z*W-q*i,$=Z*A-q*Q;if(f(w)>M){var V=Q*W-A*i;return w>0?$>=0&&V>=0:$>=0||V>=0}return $>0}function B(O,g){function S(F,U){var e=s.length-1,v=F-1;0>v&&(v=e);var x=F+1;x>e&&(x=0);var H=X(s[F],s[v],s[x],L[U]);if(!H)return!1;var g=L.length-1,K=U-1;0>K&&(K=g);var k=U+1;return k>g&&(k=0),H=X(L[U],L[K],L[k],s[F]),H?!0:!1}function G(d,j){var D,n,L;for(D=0;D<s.length;D++)if(n=D+1,n%=s.length,L=V(d,j,s[D],s[n],!0),L.length>0)return!0;return!1}function h(j,q){var A,n,o,x,c;for(A=0;A<M.length;A++)for(n=g[M[A]],o=0;o<n.length;o++)if(x=o+1,x%=n.length,c=V(j,q,n[o],n[x],!0),c.length>0)return!0;return!1}for(var L,i,$,E,q,v,A,o,T,r,Y,s=O.concat(),M=[],F=[],U=0,u=g.length;u>U;U++)M.push(U);for(var d=0,C=2*M.length;M.length>0&&(C--,!(0>C));)for($=d;$<s.length;$++){E=s[$],i=-1;for(var U=0;U<M.length;U++)if(v=M[U],A=E.x+":"+E.y+":"+v,F[A]===Z){L=g[v];for(var t=0;t<L.length;t++)if(q=L[t],S($,t)&&!G(E,q)&&!h(E,q)){i=t,M.splice(U,1),o=s.slice(0,$+1),T=s.slice($),r=L.slice(i),Y=L.slice(0,i+1),s=o.concat(r).concat(Y).concat(T),d=$;break}if(i>=0)break;F[A]=!0}if(i>=0)break}return s}for(var g,c,T,z,t,u,p={},J=r.concat(),S=0,E=j.length;E>S;S++)Array.prototype.push.apply(J,j[S]);for(g=0,c=J.length;c>g;g++)t=J[g].x+":"+J[g].y,p[t]!==Z,p[t]=g;var R=B(r,j),P=dk.Triangulate(R,!1);for(g=0,c=P.length;c>g;g++)for(z=P[g],T=0;3>T;T++)t=z[T].x+":"+z[T].y,u=p[t],u!==Z&&(z[T]=u);return P.concat()},isClockWise:function(q){return dk.Triangulate.area(q)<0},b2p0:function(Y,k){var y=1-Y;return y*y*k},b2p1:function(r,Y){return 2*(1-r)*r*Y},b2p2:function(L,m){return L*L*m},b2:function(T,N,U,Q){return this.b2p0(T,N)+this.b2p1(T,U)+this.b2p2(T,Q)},b3p0:function(H,M){var u=1-H;return u*u*u*M},b3p1:function(E,j){var U=1-E;return 3*U*U*E*j},b3p2:function(f,R){var I=1-f;return 3*I*f*f*R},b3p3:function(t,R){return t*t*t*R},b3:function(m,b,_,y,P){return this.b3p0(m,b)+this.b3p1(m,_)+this.b3p2(m,y)+this.b3p3(m,P)}},dk={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var R=V.keys(this.faces);return R.length?R[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(C){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(I){var Q=I.familyName.toLowerCase(),t=this;return t.faces[Q]=t.faces[Q]||{},t.faces[Q][I.cssFontWeight]=t.faces[Q][I.cssFontWeight]||{},t.faces[Q][I.cssFontWeight][I.cssFontStyle]=I,I},drawText:function(T){var o,F=this.getFace(),C=this.size/F.resolution,a=0,S=String(T).split(""),H=S.length,Y=[];for(o=0;H>o;o++){var Q=new ks,B=this.extractGlyphPoints(S[o],F,C,a,Q);B&&(a+=B.offset*this.spacing,Y.push(B.path))}var s=a/2;return{paths:Y,offset:s}},extractGlyphPoints:function(U,j,M,R,a){var g,H,l,Q,y,x,z,J,c,Z,O,r,o,D,w,q,A,s,p,f=[],u=j.glyphs[U]||j.glyphs["?"];if(u){if(u.o)for(Q=u._cachedOutline||(u._cachedOutline=u.o.split(" ")),x=Q.length,z=M,J=M,g=0;x>g;)switch(y=Q[g++]){case"m":c=Q[g++]*z+R,Z=Q[g++]*J,a.moveTo(c,Z);break;case"l":c=Q[g++]*z+R,Z=Q[g++]*J,a.lineTo(c,Z);break;case"q":if(O=Q[g++]*z+R,r=Q[g++]*J,w=Q[g++]*z+R,q=Q[g++]*J,a.quadraticCurveTo(w,q,O,r),p=f[f.length-1])for(o=p.x,D=p.y,H=1,l=this.divisions;l>=H;H++){var n=H/l;Qh.b2(n,o,w,O),Qh.b2(n,D,q,r)}break;case"b":if(O=Q[g++]*z+R,r=Q[g++]*J,w=Q[g++]*z+R,q=Q[g++]*J,A=Q[g++]*z+R,s=Q[g++]*J,a.bezierCurveTo(w,q,A,s,O,r),p=f[f.length-1])for(o=p.x,D=p.y,H=1,l=this.divisions;l>=H;H++){var n=H/l;Qh.b3(n,o,w,A,O),Qh.b3(n,D,q,s,r)}}return{offset:u.ha*M,path:a}}}};dk.generateShapes=function(D,F){F=F||{};var l=F.font;if(l===Z&&(l=dk.getDefaultFont(),!l))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var G=F.size!==Z?F.size:1,T=F.curveSegments!==Z?F.curveSegments:4,X=F.spacing!==Z?F.spacing:1,$=F.weight!==Z?F.weight:"normal",C=F.style!==Z?F.style:"normal";dk.size=G,dk.divisions=T,dk.face=l,dk.weight=$,dk.style=C,dk.spacing=X;for(var B=dk.drawText(D),W=B.paths,P=[],c=0,I=W.length;I>c;c++)Array.prototype.push.apply(P,W[c].toShapes());return P},function(H){var p=1e-10,W=function(Y,B){var q=Y.length;if(3>q)return null;var j,F,I,H=[],e=[],x=[];if(c(Y)>0)for(F=0;q>F;F++)e[F]=F;else for(F=0;q>F;F++)e[F]=q-1-F;var z=q,X=2*z;for(F=z-1;z>2;){if(X--<=0)return B?x:H;if(j=F,j>=z&&(j=0),F=j+1,F>=z&&(F=0),I=F+1,I>=z&&(I=0),R(Y,j,F,I,z,e)){var C,r,i,J,n;for(C=e[j],r=e[F],i=e[I],H.push([Y[C],Y[r],Y[i]]),x.push([e[j],e[F],e[I]]),J=F,n=F+1;z>n;J++,n++)e[J]=e[n];z--,X=2*z}}return B?x:H},c=function(i){for(var n=i.length,M=0,D=n-1,y=0;n>y;D=y++)M+=i[D].x*i[y].y-i[y].x*i[D].y;return.5*M},R=function(Q,k,E,u,B,y){var c,Y,U,X,a,M,z,d,e;if(Y=Q[y[k]].x,U=Q[y[k]].y,X=Q[y[E]].x,a=Q[y[E]].y,M=Q[y[u]].x,z=Q[y[u]].y,p>(X-Y)*(z-U)-(a-U)*(M-Y))return!1;var h,_,C,L,q,O,D,r,J,g,t,T,W,w,f;for(h=M-X,_=z-a,C=Y-M,L=U-z,q=X-Y,O=a-U,c=0;B>c;c++)if(d=Q[y[c]].x,e=Q[y[c]].y,!(d===Y&&e===U||d===X&&e===a||d===M&&e===z)&&(D=d-Y,r=e-U,J=d-X,g=e-a,t=d-M,T=e-z,f=h*g-_*J,W=q*r-O*D,w=C*T-L*t,f>=-p&&w>=-p&&W>=-p))return!1;return!0};return H.Triangulate=W,H.Triangulate.area=c,H}(dk),_._typeface_js={faces:dk.faces,loadFace:dk.loadFace};var Cl=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},ep=Cl.prototype={constructor:Cl,computeFaceNormals:function(){for(var M=new Um,G=new Um,W=0,U=this.faces.length;U>W;W++){var l=this.faces[W],p=this.vertices[l.a],J=this.vertices[l.b],m=this.vertices[l.c];M.subVectors(m,J),G.subVectors(p,J),M.cross(G),M.normalize(),l.normal.copy(M)}},computeVertexNormals:function(r){var S,g,I,Y,D,P;for(P=new Array(this.vertices.length),S=0,g=this.vertices.length;g>S;S++)P[S]=new Um;if(r){var B,x,j,J=new Um,U=new Um;for(I=0,Y=this.faces.length;Y>I;I++)D=this.faces[I],B=this.vertices[D.a],x=this.vertices[D.b],j=this.vertices[D.c],J.subVectors(j,x),U.subVectors(B,x),J.cross(U),P[D.a].add(J),P[D.b].add(J),P[D.c].add(J)}else for(I=0,Y=this.faces.length;Y>I;I++)D=this.faces[I],P[D.a].add(D.normal),P[D.b].add(D.normal),P[D.c].add(D.normal);for(S=0,g=this.vertices.length;g>S;S++)P[S].normalize();for(I=0,Y=this.faces.length;Y>I;I++)D=this.faces[I],D.vertexNormals[0]=P[D.a].clone(),D.vertexNormals[1]=P[D.b].clone(),D.vertexNormals[2]=P[D.c].clone()},mergeVertices:function(){var C,B,W,E,K,I,d,k,F={},p=[],b=[],X=4,w=n(10,X);for(W=0,E=this.vertices.length;E>W;W++)C=this.vertices[W],B=u(C.x*w)+"_"+u(C.y*w)+"_"+u(C.z*w),F[B]===Z?(F[B]=W,p.push(this.vertices[W]),b[W]=p.length-1):b[W]=b[F[B]];var l=[];for(W=0,E=this.faces.length;E>W;W++){K=this.faces[W],K.a=b[K.a],K.b=b[K.b],K.c=b[K.c],I=[K.a,K.b,K.c];for(var o=0;3>o;o++)if(I[o]==I[(o+1)%3]){l.push(W);break}}for(W=l.length-1;W>=0;W--){var S=l[W];for(this.faces.splice(S,1),d=0,k=this.faceVertexUvs.length;k>d;d++)this.faceVertexUvs[d].splice(S,1)}var m=this.vertices.length-p.length;return this.vertices=p,m}},$q=function(e,A,W,p,r,q,v){this.aX=e,this.aY=A,this.xRadius=W,this.yRadius=p,this.aStartAngle=r,this.aEndAngle=q,this.aClockwise=v};$q.prototype=qe(Kd),$q.prototype.getPoint=function(e){var I,z=this.aEndAngle-this.aStartAngle;0>z&&(z+=i),z>i&&(z-=i),I=this.aClockwise===!0?this.aEndAngle+(1-e)*(i-z):this.aStartAngle+e*z;var O=this.aX+this.xRadius*T(I),t=this.aY+this.yRadius*W(I);return new ff(O,t)};var Yc=function(H,W){this.v1=H,this.v2=W},ws=Yc.prototype=qe(Kd);ws.getPoint=function(e){var A=this.v2.clone().sub(this.v1);return A.multiplyScalar(e).add(this.v1),A},ws.getPointAt=function(S){return this.getPoint(S)},ws.getTangent=function(){var h=this.v2.clone().sub(this.v1);return h.normalize()};var Yd=function(f,n,i){this.v0=f,this.v1=n,this.v2=i};Yd.prototype=qe(Kd),Yd.prototype.getPoint=function(I){var V,s;return V=Qh.b2(I,this.v0.x,this.v1.x,this.v2.x),s=Qh.b2(I,this.v0.y,this.v1.y,this.v2.y),new ff(V,s)};var kr=function(t,w,l,r){this.v0=t,this.v1=w,this.v2=l,this.v3=r};kr.prototype=qe(Kd),kr.prototype.getPoint=function(O){var V,T;return V=Qh.b3(O,this.v0.x,this.v1.x,this.v2.x,this.v3.x),T=Qh.b3(O,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new ff(V,T)},zp.create(function(y,U){this.v1=y,this.v2=U},function(X){var q=new Um;return q.subVectors(this.v2,this.v1),q.multiplyScalar(X),q.add(this.v1),q});var Jb=zp.create(function(O,L,q){this.v0=O,this.v1=L,this.v2=q},function(p){var _,$,S;return _=Qh.b2(p,this.v0.x,this.v1.x,this.v2.x),$=Qh.b2(p,this.v0.y,this.v1.y,this.v2.y),S=Qh.b2(p,this.v0.z,this.v1.z,this.v2.z),new Um(_,$,S)}),Bq=zp.create(function(u,n,Y,G){this.v0=u,this.v1=n,this.v2=Y,this.v3=G},function(B){var D,I,O;return D=Qh.b3(B,this.v0.x,this.v1.x,this.v2.x,this.v3.x),I=Qh.b3(B,this.v0.y,this.v1.y,this.v2.y,this.v3.y),O=Qh.b3(B,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Um(D,I,O)}),Oj=function(X,Q,m,j,h,V,l,M){Cl.call(this),j=j!==Z?j:.5,h=h!==Z?h:.5,M=M!==Z?M:1,X=X||8,V=V||0,l=l||i;var F,A,c=1,o=M/2,E=[],C=[],e=this.vertices,a=this.faces,H=this.faceVertexUvs;for(A=0;c>=A;A++){var D=[],r=[],d=A/c,q=d*(h-j)+j;for(F=0;X>=F;F++){var $=F/X,k=new Um,B=-($*l+V);k.z=q*W(B),k.y=-d*M+o,k.x=q*T(B),e.push(k),D.push(e.length-1),r.push(new ff($,d))}E.push(D),C.push(r)}var Y,O,S=(h-j)/M;for(F=0;X>F;F++)for(0!==j?(Y=e[E[0][F]].clone(),O=e[E[0][F+1]].clone()):(Y=e[E[1][F]].clone(),O=e[E[1][F+1]].clone()),Y.setY(v(Y.x*Y.x+Y.z*Y.z)*S).normalize(),O.setY(v(O.x*O.x+O.z*O.z)*S).normalize(),A=0;c>A;A++){var L=E[A][F],n=E[A+1][F],J=E[A+1][F+1],I=E[A][F+1],U=Y.clone(),K=Y.clone(),G=O.clone(),p=O.clone(),N=C[A][F].clone(),R=C[A+1][F].clone(),_=C[A+1][F+1].clone(),s=C[A][F+1].clone();a.push(new Tk(L,n,I,[U,K,p])),H[0].push([N,R,s]),a.push(new Tk(n,J,I,[K.clone(),G,p.clone()])),H[0].push([R.clone(),_,s.clone()])}if(Q&&j>0)for(this.vertices.push(new Um(0,o,0)),F=0;X>F;F++){var L=E[0][F],n=E[0][F+1],J=this.vertices.length-1,U=new Um(0,1,0),K=new Um(0,1,0),G=new Um(0,1,0),N=C[0][F].clone(),R=C[0][F+1].clone(),_=new ff(R.x,0);a.push(new Tk(L,n,J,[U,K,G],null,1));var f=F/X*i,g=T(f),w=W(f),t=(F+1)/X*i,u=T(t),z=W(t);H[0].push([new ff(.5+.5*g,.5+.5*w),new ff(.5+.5*u,.5+.5*z),new ff(.5,.5)])}if(m&&h>0)for(this.vertices.push(new Um(0,-o,0)),F=0;X>F;F++){var L=E[A][F+1],n=E[A][F],J=e.length-1,U=new Um(0,-1,0),K=new Um(0,-1,0),G=new Um(0,-1,0),N=C[A][F+1].clone(),R=C[A][F].clone();a.push(new Tk(L,n,J,[U,K,G],null,2));var f=F/X*i,g=T(f),w=W(f),t=(F+1)/X*i,u=T(t),z=W(t);H[0].push([new ff(.5+.5*u,.5-.5*z),new ff(.5+.5*g,.5-.5*w),new ff(.5,.5)])}};Oj.prototype=qe(ep);var Rm=function(H,N,t,L,D,R,s){Cl.call(this),s=s||.5,H=H||16,N=N||16,t=(t!==Z?t:0)-E,L=L!==Z?L:i,D=D!==Z?D:0,R=R!==Z?R:E;var u,S,p=[],O=[],b=this.vertices,j=this.faces,A=this.faceVertexUvs;for(S=0;N>=S;S++){var G=[],r=[];for(u=0;H>=u;u++){var d=u/H,h=S/N,F=new Um;F.x=-s*T(t+d*L)*W(D+h*R),F.y=s*T(D+h*R),F.z=s*W(t+d*L)*W(D+h*R),b.push(F),G.push(b.length-1),r.push(new ff(d,h))}p.push(G),O.push(r)}for(S=0;N>S;S++)for(u=0;H>u;u++){var c=p[S][u+1],$=p[S][u],B=p[S+1][u],I=p[S+1][u+1],M=b[c].clone().normalize(),l=b[$].clone().normalize(),U=b[B].clone().normalize(),n=b[I].clone().normalize(),J=O[S][u+1].clone(),X=O[S][u].clone(),m=O[S+1][u].clone(),g=O[S+1][u+1].clone();f(b[c].y)===s?(J.x=(J.x+X.x)/2,j.push(new Tk(c,B,I,[M,U,n])),A[0].push([J,m,g])):f(b[B].y)===s?(m.x=(m.x+g.x)/2,j.push(new Tk(c,$,B,[M,l,U])),A[0].push([J,X,m])):(j.push(new Tk(c,$,I,[M,l,n])),A[0].push([J,X,g]),j.push(new Tk($,B,I,[l.clone(),U,n.clone()])),A[0].push([X.clone(),m,g.clone()]))}};Rm.prototype=qe(ep);var yg=function(p,l,h,q,n,a){Cl.call(this),p=p||.33,l=l||.17,q=q||8,h=h||6,n=n||0,a=a||i;for(var H=new Um,u=[],s=[],O=0;q>=O;O++)for(var d=O/q*i+E,B=0;h>=B;B++){var X=B/h*a+n;H.x=p*T(X),H.z=-p*W(X);var v=new Um,g=p+l*T(d);v.x=g*T(X),v.z=-g*W(X),v.y=l*W(d),this.vertices.push(v),u.push(new ff(B/h,1-O/q)),s.push(v.clone().sub(H).normalize())}for(var O=1;q>=O;O++)for(var B=1;h>=B;B++){var c=(h+1)*O+B-1,P=(h+1)*(O-1)+B-1,r=(h+1)*(O-1)+B,N=(h+1)*O+B,Q=new Tk(c,P,N,[s[c].clone(),s[P].clone(),s[N].clone()]);this.faces.push(Q),this.faceVertexUvs[0].push([u[c].clone(),u[P].clone(),u[N].clone()]),Q=new Tk(P,r,N,[s[P].clone(),s[r].clone(),s[N].clone()]),this.faces.push(Q),this.faceVertexUvs[0].push([u[P].clone(),u[r].clone(),u[N].clone()])}this.computeFaceNormals()};yg.prototype=qe(ep);var dg=function(v,h,b){return v?(Cl.call(this),v=v instanceof Array?v:[v],this.addShapeList(v,h),h.convertYZ!==!1&&rb(this,b),this.computeFaceNormals(),void 0):(v=[],void 0)},ub=dg.prototype=qe(Cl.prototype);ub.addShapeList=function(U,Q){for(var h=U.length,v=0;h>v;v++){var F=U[v];this.addShape(F,Q)}},ub.addShape=function(h,B){function c(){if(B.bottom)for(var o=0;Y>o;o++)s=R[o],G(s[2],s[1],s[0],!0);if(B.top)for(o=0;Y>o;o++)s=R[o],G(s[0]+r*K,s[1]+r*K,s[2]+r*K,!1)}function q(){var W=0;for($(X,W),W+=X.length,g=0,T=d.length;T>g;g++)D=d[g],$(D,W),W+=D.length}function $(M,d){for(var $,_,F=M.length;--F>=0;){$=F,_=F-1,0>_&&(_=M.length-1);var h=0,t=K;for(h=0;t>h;h++){var B=r*h,S=r*(h+1),z=d+$+B,l=d+_+B,o=d+_+S,j=d+$+S;e(z,l,o,j,M,h,t,$,_)}}}function S($,j,N){Q.vertices.push(new Um($,j,N))}function G(H,f,K,p){H+=m,f+=m,K+=m,Q.faces.push(new Tk(H,f,K,null,null,p?2:1));var N=p?o.generateBottomUV(Q,h,B,H,f,K):o.generateTopUV(Q,h,B,H,f,K);Q.faceVertexUvs[0].push(N)}function e(O,R,Y,j,L,T,K,P,I){O+=m,R+=m,Y+=m,j+=m,Q.faces.push(new Tk(O,R,j)),Q.faces.push(new Tk(R,Y,j));var D=o.generateSideWallUV(Q,h,L,B,O,R,Y,j,T,K,P,I);Q.faceVertexUvs[0].push([D[0],D[1],D[3]]),Q.faceVertexUvs[0].push([D[1],D[2],D[3]])}var n,C,a,L,J,u=B.amount,A=B.curveSegments||ri,K=B.steps||1,M=B.extrudePath,P=!1,o=new $g(B.repeatUVLength);M&&(n=M.getSpacedPoints(K),P=!0,C=B.frames!==Z?B.frames:new go.FrenetFrames(M,K,!1),a=new Um,L=new Um,J=new Um);var D,g,T,Q=this,m=this.vertices.length,W=h.extractPoints(A),y=W.shape,d=W.holes,j=!Qh.isClockWise(y);if(j){for(y=y.reverse(),g=0,T=d.length;T>g;g++)D=d[g],Qh.isClockWise(D)&&(d[g]=D.reverse());j=!1}var R=Qh.triangulateShape(y,d),X=y;for(g=0,T=d.length;T>g;g++)D=d[g],y=y.concat(D);for(var U,s,r=y.length,Y=R.length,f=0;r>f;f++)U=y[f],P?(L.copy(C.normals[0]).multiplyScalar(U.x),a.copy(C.binormals[0]).multiplyScalar(U.y),J.copy(n[0]).add(L).add(a),S(J.x,J.y,J.z)):S(U.x,U.y,0);var x;for(x=1;K>=x;x++)for(f=0;r>f;f++)U=y[f],P?(L.copy(C.normals[x]).multiplyScalar(U.x),a.copy(C.binormals[x]).multiplyScalar(U.y),J.copy(n[x]).add(L).add(a),S(J.x,J.y,J.z)):S(U.x,U.y,u/K*x);c(),q()};var go=function(p,g,x,r,X){function F(g,Z,f){return D.vertices.push(new Um(g,Z,f))-1}Cl.call(this),g=g||64,x=x||1,r=r||8,X=X||!1;var S,d,t,o,L,c,f,A,V,e,Y,M,z,j,H,U,Z,v,K,s,G=[],D=this,k=g+1,I=new Um,l=new go.FrenetFrames(p,g,X),C=l.tangents,n=l.normals,J=l.binormals;for(this.tangents=C,this.normals=n,this.binormals=J,V=0;k>V;V++)for(G[V]=[],o=V/(k-1),A=p.getPointAt(o),S=C[V],d=n[V],t=J[V],e=0;r>e;e++)L=e/r*i,c=-x*T(L),f=x*W(L),I.copy(A),I.x+=c*d.x+f*t.x,I.y+=c*d.y+f*t.y,I.z+=c*d.z+f*t.z,G[V][e]=F(I.x,I.y,I.z);for(V=0;g>V;V++)for(e=0;r>e;e++)Y=X?(V+1)%g:V+1,M=(e+1)%r,z=G[V][e],j=G[Y][e],H=G[Y][M],U=G[V][M],Z=new ff(V/g,e/r),v=new ff((V+1)/g,e/r),K=new ff((V+1)/g,(e+1)/r),s=new ff(V/g,(e+1)/r),this.faces.push(new Tk(z,j,U)),this.faceVertexUvs[0].push([Z,v,s]),this.faces.push(new Tk(j,H,U)),this.faceVertexUvs[0].push([v.clone(),K,s.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};go.prototype=qe(ep),go.FrenetFrames=function(Y,v,B){function z(){m[0]=new Um,H[0]=new Um,x=Number.MAX_VALUE,r=f($[0].x),j=f($[0].y),q=f($[0].z),x>=r&&(x=r,k.set(1,0,0)),x>=j&&(x=j,k.set(0,1,0)),x>=q&&k.set(0,0,1),_.crossVectors($[0],k).normalize(),m[0].crossVectors($[0],_),H[0].crossVectors($[0],m[0])}var d,x,r,j,q,p,Z,k=new Um,$=[],m=[],H=[],_=new Um,y=new dd,T=v+1,P=1e-4;for(this.tangents=$,this.normals=m,this.binormals=H,p=0;T>p;p++)Z=p/(T-1),$[p]=Y.getTangentAt(Z),$[p].normalize();for(z(),p=1;T>p;p++)m[p]=m[p-1].clone(),H[p]=H[p-1].clone(),_.crossVectors($[p-1],$[p]),_.length()>P&&(_.normalize(),d=D(fc($[p-1].dot($[p]),-1,1)),m[p].applyMatrix4(y.makeRotationAxis(_,d))),H[p].crossVectors($[p],m[p]);if(B)for(d=D(fc(m[0].dot(m[T-1]),-1,1)),d/=T-1,$[0].dot(_.crossVectors(m[0],m[T-1]))>0&&(d=-d),p=1;T>p;p++)m[p].applyMatrix4(y.makeRotationAxis($[p],d*p)),H[p].crossVectors($[p],m[p])};var se=function(d,r,E,g){Cl.call(this),r=r||18,E=E||0,g=g==I?i:g;for(var l=1/(d.length-1),o=1/r,c=0,h=r;h>=c;c++)for(var q=E+c*o*g,M=T(q),N=W(q),a=0,U=d.length;U>a;a++){var j=d[a],R=new Um;R.x=M*j.x-N*j.y,R.y=N*j.x+M*j.y,R.z=j.z,this.vertices.push(R)}for(var L=d.length,c=0,h=r;h>c;c++)for(var a=0,U=d.length-1;U>a;a++){var H=a+L*c,f=H,e=H+L,M=H+1+L,D=H+1,k=c*o,J=a*l,v=k+o,n=J+l;this.faces.push(new Tk(f,D,e)),this.faceVertexUvs[0].push([new ff(k,J),new ff(k,n),new ff(v,J)]),this.faces.push(new Tk(e,D,M)),this.faceVertexUvs[0].push([new ff(v,J),new ff(k,n),new ff(v,n)])}this.mergeVertices(),rb(this),this.computeFaceNormals(),this.computeVertexNormals()};se.prototype=qe(ep);var cj=function(n,D){D=D||{};var v=dk.generateShapes(n,D);D.amount=D.amount!==Z?D.amount:.5,D.convertYZ=!1,D.fill!==!1&&(D.bottom=!0,D.top=!0),dg.call(this,v,D)};cj.prototype=qe(ub);var Xp=o.Node=function(){lp(Xp,this)},pk={X:yp,Y:nk,Z:mc},Bb={X:0,Y:1,Z:2},Po={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Xi="xzy",kc=function(y,Q,u){if(Q){var D=Q[0],C=Q[1],x=Q[2];"xzy"===u?(nk(y,C),mc(y,x),yp(y,D)):"xyz"===u?(mc(y,x),nk(y,C),yp(y,D)):"yxz"===u?(mc(y,x),yp(y,D),nk(y,C)):"yzx"===u?(yp(y,D),mc(y,x),nk(y,C)):"zxy"===u?(nk(y,C),yp(y,D),mc(y,x)):"zyx"===u?(yp(y,D),nk(y,C),mc(y,x)):(nk(y,C),mc(y,x),yp(y,D))}};Sb("Node",Tn,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Xi,_64O:0,_rotationX:0,_53O:0,_host:I,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return vm},_22Q:function(){return $n},getX:function(){return this.p().x},setX:function(D){this.p(D,this.p().y)},getY:function(){return this.p().y},setY:function(k){this.p(this.p().x,k)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(R){this.setAnchor(R,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(X){this.setAnchor(this.getAnchor().x,X)},getScaleX:function(){return this.getScale().x},setScaleX:function(U){this.setScale(U,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(s){this.setScale(this.getScale().x,s)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(P,i){$f(P,qq(I,I,this.r3(),this.getRotationMode())),this.translate3d(P[0]*i,P[1]*i,P[2]*i)},translateFront:function(j){this.translate3dBy([0,0,1],j)},translateBack:function(L){this.translate3dBy([0,0,-1],L)},translateLeft:function(f){this.translate3dBy([-1,0,0],f)},translateRight:function(Y){this.translate3dBy([1,0,0],Y)},translateTop:function(D){this.translate3dBy([0,1,0],D)},translateBottom:function(c){this.translate3dBy([0,-1,0],c)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(p,_,P){1===arguments.length&&(_=p[1],P=p[2],p=p[0]),this.p(p,P),this.setElevation(_)},translate3d:function(u,l,H){1===arguments.length&&(l=u[1],H=u[2],u=u[0]),this.translate(u,H),this.setElevation(this._54O+l)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(C,x,k){1===arguments.length&&(x=C[1],k=C[2],C=C[0]),this.setSize(C,k),this.setTall(x)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(S,B,e){1===arguments.length&&(B=S[1],e=S[2],S=S[0]),this.setRotationX(S),this.setRotation(-B),this.setRotationZ(e)},setRotationY:function(L){this.setRotation(-L)},getRotationY:function(){return-this._64O},lookAtDirection:function(G,w){w=w||Zp;var r=this,W=cd(G);w===Zp?(r.r3([-Q(G[1]/W),-Y(G[2],G[0])+b,0]),r.setRotationMode("xzy")):w===De?(r.r3(0,-Y(G[2],G[0]),Q(G[1]/W)),r.setRotationMode("zyx")):w===_h?(r.r3(0,-Y(G[2],G[0])+E,-Q(G[1]/W)),r.setRotationMode("zyx")):w===Rd?(r.r3([-Q(G[1]/W)+b,-Y(G[2],G[0])+b,0]),r.setRotationMode("xzy")):w===Yf&&(r.r3([-Q(G[1]/W)-b,-Y(G[2],G[0])+b,0]),r.setRotationMode("xzy")),w===_m&&(r.r3([-Q(G[1]/W)+E,-Y(G[2],G[0])+b,E]),r.setRotationMode("zxy"))},lookAt:function(h,g){return this.lookAtDirection(uq(h,this.p3()),g)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(s){var m=this;if(m!==s&&m._host!==s){var q=m._host;q&&q._removeAttach(m),m._host=s,m._host&&m._host._addAttach(m),m.fp("host",q,s),m.onHostChanged(q,s)}},getAttaches:function(){return this._69O},_addAttach:function(v){var L=this;L._69O||(L._69O=new mk),L._69O.add(v),L.fp("attaches",I,v)},_removeAttach:function(Y){var l=this;l._69O.remove(Y),l._69O.isEmpty()&&delete l._69O,l.fp("attaches",Y,I)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(d){var J=this;J._44I||(J._44I=new mk),J._42I||(J._42I=new mk),J._44I.add(d),J._42I.add(d),J._20I()},_4I:function(l){var e=this;e._44I||(e._44I=new mk),e._43I||(e._43I=new mk),e._44I.add(l),e._43I.add(l),e._20I()},_16I:function(M){var P=this;P._44I.remove(M),P._42I.remove(M),P._44I.isEmpty()&&delete P._44I,P._42I.isEmpty()&&delete P._42I,P._20I()},_18I:function(o){var N=this;N._44I.remove(o),N._43I.remove(o),N._44I.isEmpty()&&delete N._44I,N._43I.isEmpty()&&delete N._43I,N._20I()},_20I:function(){var C=this;if(delete C._45I,!C._44I||C._44I.isEmpty())return delete C._70O,void 0;var E;C._44I.each(function(B){B.isLooped()&&(E||(E={}),E[B._id]||(C._45I||(C._45I=new mk),C._45I.add(B),E[B._id]=B))}),E?(C._70O=new mk,C._44I.each(function(T){E[T._id]?"A"===E[T._id]||(E[T._id]="A",C._70O.add(T)):C._70O.add(T)})):C._70O=C._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(U){var N=this;N._46I||(N._46I=new mk),N._48I||(N._48I=new mk),N._46I.add(U),N._48I.add(U),N._19I()},_3I:function(_){var T=this;T._47I||(T._47I=new mk),T._48I||(T._48I=new mk),T._47I.add(_),T._48I.add(_),T._19I()},_15I:function(t){var X=this;X._46I.remove(t),X._48I.remove(t),X._46I.isEmpty()&&delete X._46I,X._48I.isEmpty()&&delete X._48I,X._19I()},_17I:function(e){var a=this;a._47I.remove(e),a._48I.remove(e),a._47I.isEmpty()&&delete a._47I,a._48I.isEmpty()&&delete a._48I,a._19I()},_19I:function(){var n=this;delete n._49I;var x=n._48I;if(x&&!x.isEmpty()){var Y={};x.each(function(h){Y[h._id]?n._49I||(n._49I=new mk):Y[h._id]=h}),n._49I?x.each(function(a){Y[a._id]&&(n._49I.add(a),delete Y[a._id])}):n._49I=x}},getImage:function(){if(this._pendingCheckImageJSON){var K=C.getImage(this._image);K&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof us&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function($){var i=this,F=i._image,N=i.getWidth(),e=i.getHeight();i._image=$,i.fp("image",F,$)&&(null!=$&&(Ui($)||hf($)&&/\.json$/i.test($))&&(this._pendingCheckImageJSON=!0),i.fp(Qd,N,i.getWidth()),i.fp(wi,e,i.getHeight()))},getElevation:function(){return this._54O},setElevation:function(j){var M=this;if(!M._50O){M._50O=1;var U=M._54O;M._54O=j,M.fp(Ab,U,j),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(I){var k=this;if(!k._49O){k._49O=1;var y=k._64O;k._64O=I,k.fp(qo,y,I),delete k._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(U){var v=this;if(!v._51O){v._51O=1;var Z=v._rotationX;v._rotationX=U,v.fp("rotationX",Z,U),delete v._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(n){var x=this;if(!x._52O){x._52O=1;var D=x._53O;x._53O=n,x.fp("rotationZ",D,n),delete x._52O}},getPosition:function(){return this._position},setPosition:function(u,R){var M=this;if(!M._50I){M._50I=1;var I;if(I=2===arguments.length?{x:u,y:R}:u,I.x!==M._position.x||I.y!==M._position.y){var Q=M._position;M._position=I,M.fp(ob,Q,I)}delete M._50I}},translate:function(E,T){var e=this._position;this.p(e.x+E,e.y+T)},getWidth:function(){var C=this;if(C._width>=0)return C._width;var S=C.getStyle("shape3d");if(S){var V=cg(S);if(V&&V.rawS3)return V.rawS3[0];if("billboard"===S||"plane"===S){var h=wc(C.getStyle("shape3d.image"));return h?Rn(h,C):20}}var h=wc(C._image);return h?Rn(h,C):20},setWidth:function(B){var O=this,v=O._width;O._width=B,O.fp(Qd,v,B)},getHeight:function(){var q=this;if(q._height>=0)return q._height;var K=q.getStyle("shape3d");if(K){var W=cg(K);if(W&&W.rawS3)return W.rawS3[2];if("plane"===K){var X=wc(q.getStyle("shape3d.image"));return X?si(X,q):20}if("billboard"===K)return 2}var X=wc(q._image);return X?si(X,q):20},setHeight:function(n){var F=this,k=F._height;F._height=n,F.fp(wi,k,n)},getTall:function(){var J=this;if(J._tall>=0)return J._tall;var t=J.getStyle("shape3d");if(t){var r=cg(t);if(r&&r.rawS3)return r.rawS3[1];if("billboard"===t){var y=wc(J.getStyle("shape3d.image"));return y?si(y,J):20}if("plane"===t)return 2}return 20},setTall:function(O){var X=this,L=X._tall;X._tall=O,X.fp("tall",L,O)},setSize:function(Z,F){var u=this;2===arguments.length?(u.setWidth(Z),u.setHeight(F)):(u.setWidth(Z.width),u.setHeight(Z.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(N,v,P,d,r){var q=this,p=q.getAnchor(),R=q.getScale();arguments.length<=2&&(r=v,v=N.y,P=N.width,d=N.height,N=N.x);var g=r&&R.x<0?1-p.x:p.x,e=r&&R.y<0?1-p.y:p.y;q.p(N+P*g,v+d*e),r&&(P/=Math.abs(R.x),d/=Math.abs(R.y)),q.setWidth(P),q.setHeight(d)},getMatrix:function(){var w=this,m=w._64O,s=w._position,u=w.getScale();return new lh(m,s.x,s.y,u.x,u.y)},getAnchorRect:function(){var x=this,R=x.getWidth(),f=x.getHeight(),J=x.getAnchor();return{x:-R*J.x,y:-f*J.y,width:R,height:f}
},toLocal:function(U){return this.getMatrix().tfi(U)},toGlobal:function(T){return this.getMatrix().tf(T)},isInRect:function(D){D=this.toLocal(D);var V=this.getWidth(),s=this.getHeight();return D.x+=V*this.getAnchorX(),D.y+=s*this.getAnchorY(),!(D.x<0||D.y<0||D.x>V||D.y>s)},getRect:function(){var M=this,F=M.getWidth(),L=M.getHeight(),X=M.getAnchor(),T={x:-F*X.x,y:-L*X.y,width:F,height:L},Y=M.getMatrix();return T=we([Y.tf(T.x,T.y),Y.tf(T.x+T.width,T.y),Y.tf(T.x+T.width,T.y+T.height),Y.tf(T.x,T.y+T.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var p=this,J=p.getAnchor(),v=p._anchorElevation;return{x:J.x,y:v,z:J.y}},setAnchorElevation:function(I){var y=this,z=y._anchorElevation;return z!==I?(y._anchorElevation=I,y.fp("anchorElevation",z,I),!0):!1},setAnchor3d:function(X,H,o,O){var V,e=this;"number"==typeof X?V={x:X,y:H,z:o}:(V=X.length?{x:X[0],y:X[1],z:X[2]}:X,O=H);var s=e.getDataModel();s&&s.beginTransaction();var T=e.getAnchor3d(),y=e.setAnchor(V.x,V.z);if(e.setAnchorElevation(V.y)&&(y=!0),y&&O&&!rf){e.getAnchor3d();var k=Vl(e),Z=$f([V.x-T.x,V.y-T.y,V.z-T.z],k);e.p3(Z)}return s&&s.endTransaction(),y},getAnchor:function(){var D=this;if(D.hasOwnProperty("_anchor"))return D._anchor;var p=wc(D._image);return p&&p.anchorX!==Z?{x:p.anchorX,y:p.anchorY}:D._anchor},setAnchor:function(Z,O,b){var A,R=this;"number"==typeof Z?A={x:Z,y:O}:(A=Z.length?{x:Z[0],y:Z[1]}:Z,b=O);var j=R.getAnchor();if(j.x!==A.x||j.y!==A.y){var V=R.getDataModel();if(V&&V.beginTransaction(),R._anchor=A,R.fp("anchor",j,A),b&&!rf){var m=R.getPosition(),c=R.getSize(),z=R.getRotation(),G=R.getScale(),S=-c.width*(j.x-A.x)*G.x,M=-c.height*(j.y-A.y)*G.y,H=W(z),d=T(z);R.setPosition(m.x+d*S-H*M,m.y+H*S+d*M)}return V&&V.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(z,X){var e,F=this;e=2===arguments.length?{x:z,y:X}:z;var D=F.getScale();(D.x!==e.x||D.y!==e.y)&&(F._scale=e,F.fp("scale",D,e))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var L=this,X=L._scaleTall,G=L.getScale();return[G.x,X,G.y]},getFinalScale3d:function(){var M=this,P=M.s3(),H=M._dynamicScale3d,R=M.getScale3d();return P&&(R[0]*=P[0],R[1]*=P[1],R[2]*=P[2]),H&&(R[0]*=H[0],R[1]*=H[1],R[2]*=H[2]),R},getFinalRotation3d:function(){var r=this;return r._dynamicRotation||r.r3()},setScaleTall:function(l){var x=this,A=x._scaleTall;A!==l&&(x._scaleTall=l,x.fp("scaleTall",A,l))},setScale3d:function(r,Z,O){var N,g=this;N="number"==typeof r?{x:r,y:Z,z:O}:r.length?{x:r[0],y:r[1],z:r[2]}:r,g.setScaleTall(N.y),g.setScale(N.x,N.z)},getCorners:function(Z,h){Z==I&&(Z=0),h==I&&(h=Z);var g=this,q=g.getAnchor(),r=g.getWidth(),O=g.getHeight(),$=-r*q.x-Z,A=-O*q.y-h,Q=r+2*Z,p=O+2*h,w=g.getMatrix();return[w.tf($,A),w.tf($,A+p),w.tf($+Q,A+p),w.tf($+Q,A)]},getEditControlPoints:function(B,Y,w){Y==I&&(Y=0),w==I&&(w=Y);var m=this,f=m.getAnchor(),x=m.getWidth(),e=m.getHeight(),g=-x*f.x-Y,y=-e*f.y-w,C=x+2*Y,G=e+2*w;if(B)return[{x:g,y:y},{x:g,y:0},{x:g,y:y+G},{x:0,y:y+G},{x:g+C,y:y+G},{x:g+C,y:0},{x:g+C,y:y},{x:0,y:y}];var U=m.getMatrix();return[U.tf(g,y),U.tf(g,0),U.tf(g,y+G),U.tf(0,y+G),U.tf(g+C,y+G),U.tf(g+C,0),U.tf(g+C,y),U.tf(0,y)]},rotateAt:function(A,C,U){var f=this,H=f._position,V=f._64O,u=new lh(V,H.x,H.y).tf(A,C),t=v(A*A+C*C),q=Y(H.y-u.y,H.x-u.x)+U;f.setRotation(V+U),f.p(u.x+t*T(q),u.y+t*W(q))},onParentChanged:function(){Xp.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(y){y._7I()})},onPropertyChanged:function(c){var g=this;Xp.superClass.onPropertyChanged.call(g,c),g._69O&&g._69O.each(function(v){v.handleHostPropertyChange(c)}),g._49I&&g._49I.each(function(O){O.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(q){this.updateAttach(q)},onStyleChanged:function(f){Xp.superClass.onStyleChanged.apply(this,arguments),Jk[f]&&this.updateAttach()},updateAttach:function(N){var C=this;C._51I||rf||(C._51I=1,C._71O(N),delete C._51I)},_71O:function(c){var C,R,O,b,D,J,u=this,w=u._host,j=c?c.property:I,K=c?c.oldValue:I,t=c?c.newValue:I;if(w instanceof o.Grid){if(j===Ab)u.setElevation(u._54O+t-K);else if(!c||th[j]){if(C=u.s("attach.row.index"),R=u.s("attach.column.index"),O=w.getCellRect(C,R),!O)return;b=u.s("attach.row.span"),D=u.s("attach.column.span"),(1!==b||1!==D)&&(O=Tr(O,w.getCellRect(C+b-1,R+D-1))),Xl(O,u,"attach.padding",1),u.setRect(O)}}else if(w instanceof Yi&&(J=u.s("attach.index"))>=0&&(!c||oe[j])){var e=u.s("attach.thickness");e!=I&&u.setHeight(w.getThickness()*e);var E=u.s("attach.offset"),i=w.getPoints(),Z=i.size();if(Z>J){var M=i.get(J),z=Z===J+1?i.get(0):i.get(J+1),L=[z.x-M.x,z.y-M.y],v=cd(L);if(v){u.s("attach.offset.relative")&&(E*=v),u.s("attach.offset.opposite")&&(E=v-E);var g={x:M.x+L[0]/v*E,y:M.y+L[1]/v*E},P=u.s("attach.gap");P&&(u.s("attach.gap.relative")&&(P*=w.getThickness()),g=me(I,g,z,P)),u.p(g),u.setRotation(Y(L[1],L[0]))}}}else c&&(j===ob?u.translate(t.x-K.x,t.y-K.y):j===Ab?u.setElevation(u._54O+t-K):zj[j]&&u._11Q(w,j,t-K))},_11Q:function(){var Q=new o.Math.Euler,M=o.Math.Euler.ReverseOrder,r=new o.Math.Vector2,V=new o.Math.Vector2;return function(O,h,F){var n=this,D=O.p3(),B=O.r3(),c=n.p3(),d=n.r3();if(h===qo&&(h="rotationY",F=-F),(h===qo||"rotationY"===h)&&0===d[0]&&0===d[2]&&0===B[0]&&0===B[2]&&0===c[1]&&0===D[1])return n.setRotation(-d[1]-F),r.set(c[0],c[2]).rotateAround(V.set(D[0],D[2]),-F),n.p(r.x,r.y),void 0;var z=Po[O.getRotationMode()],P=z[0],o=z[1],e=z[2],T=pk[P],G=pk[o],f=pk[e],l=Vd();h===qo+P?(f(l,B[Bb[e]]),G(l,B[Bb[o]]),T(l,F),G(l,-B[Bb[o]]),f(l,-B[Bb[e]])):h===qo+o?(f(l,B[Bb[e]]),G(l,F),f(l,-B[Bb[e]])):h===qo+e&&f(l,F);var H=uq(c,D);$f(H,l),n.p3(D[0]+H[0],D[1]+H[1],D[2]+H[2]);var L=n.getRotationMode();kc(l,n.r3(),L),Q.setFromRotationMatrix(l,M(L)),n.r3([Q.x,Q.y,Q.z])}}(),isHostOn:function(O){var l=this;if(l._host&&O&&O._69O)for(var c={},y=l._host;y&&y!==l&&!c[y._id];){if(y===O)return!0;c[y._id]=y,y=y._host}return!1},isLoopedHostOn:function(o){return this.isHostOn(o)&&o.isHostOn(this)},layout:function(){var K=this.getPrarent();!this.s("layout")||!K||!K.s("layout")},getSerializableProperties:function(){var o=Xp.superClass.getSerializableProperties.call(this);return hj(o,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),o}});var pm=o.Edge=function(N,n){var $=this;lp(pm,$),$.setSource(N),$.setTarget(n)};Sb("Edge",Tn,{_icon:"edge_icon",getUIClass:function(){return Rg},_22Q:function(){return Nq},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(M){var c=this;if(c._source!==M){var i=c._source;c._source=M,i&&i._16I(c),M&&M._2I(c),c._7I(),c.fp("source",i,M)}},setTarget:function(K){var y=this;if(y._target!==K){var c=y._target;y._target=K,c&&c._18I(y),K&&K._4I(y),y._7I(),y.fp("target",c,K)}},isLooped:function(){var a=this;return a._source===a._target&&!!a._source&&!!a._target},_7I:function(){var w,B=this,Y=Yp(B);B._40I!==Y&&(w=this._40I,w&&w._15I(B),B._40I=Y,Y&&Y._1I(B),B.fp("sourceAgent",w,Y),Kk(w,B._41I),Kk(Y,B._41I));var H=Di(B);B._41I!==H&&(w=B._41I,w&&w._17I(B),B._41I=H,H&&H._3I(B),B.fp("targetAgent",w,H),Kk(w,B._40I),Kk(H,B._40I))},_22I:function(s){this._52I=s,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var h=this;return h._52I&&h._52I.get(0)!==h&&!h.getStyle(Kc)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var n=this,d=n._52I;return d&&!n.getStyle(Kc)&&d.size()>1&&n===d.get(0)},toggle:function(){var p=this._52I,m=!this.s(Kc);p&&p.size()>1&&(p.each(function(_){_.s(Kc,m)}),p.getSiblings().each(function(V){V!==p&&V.each(function(z){z.fp("edgeGroup",I,V)})}))},setStyle:function(z,a){(z===qn||"edge.segments"===z)&&(a=Lm(a)),pm.superClass.setStyle.call(this,z,a)},onStyleChanged:function(L){pm.superClass.onStyleChanged.apply(this,arguments),gk[L]&&Kk(this._41I,this._40I)},getSerializableProperties:function(){var c=pm.superClass.getSerializableProperties.call(this);return hj(c,{source:1,target:1}),c}});var og=o.Group=function(){lp(og,this)};Sb("Group",Xp,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Hc},onChildAdded:function(){og.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){og.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var V=this;if(!V._54I&&!rf){var E=V.getChildrenRect();E&&(V._53I=1,V.p(ed(V.s("group.position"),E,V.getSize())),delete V._53I)}},getChildrenRect:function(){var U,i=this;return i.eachChild(function(Q){U=Tr(U,i.getChildRect(Q))}),U},getChildRect:function(m){var s;return Cd(m)&&m.s(tl)&&(bn(m)&&m.isExpanded()&&m.eachChild(function(D){s=Tr(s,m.getChildRect(D))}),!s&&m.getRect&&(s=m.getRect())),s},setPosition:function(q,X){var C=this;if(!C._54I){var T;T=2===arguments.length?{x:q,y:X}:q,rf||C._53I||(C._54I=1,Vh(C._children,T.x-C._position.x,T.y-C._position.y),delete C._54I),og.superClass.setPosition.call(this,T)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(I){var n=this;if(n._57O!==I){var k=n._57O;n._57O=I,n.fp("expanded",k,n._57O),n._8I()}},_8I:function(){og.superClass._8I.call(this),this.eachChild(function(Q){Cd(Q)&&Q._8I()})},onStyleChanged:function(X){og.superClass.onStyleChanged.apply(this,arguments),"group.position"===X&&this._81I()},getSerializableProperties:function(){var p=og.superClass.getSerializableProperties.call(this);return p.expanded=1,p}});var lj=o.Block=function(){lp(lj,this)};Sb("Block",Xp,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Fd},onChildAdded:function(){lj.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){lj.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var G=this;if(!rf&&!G._updatingToChildren&&G._syncSize){var y,F,I,Z,u,O=[],w=G.getRotation();if(G.eachChild(function(u){Cd(u)&&O.push.apply(O,u.getCorners())}),O.length){G._updatingFromChildren=1;var r=T(-w),b=W(-w),j=1/0,S=-1/0,q=1/0,l=-1/0;for(Z=0,u=O.length;u>Z;Z++)I=O[Z],y=I.x,F=I.y,I.x=r*y-b*F,I.y=b*y+r*F,j=m(j,I.x),S=K(S,I.x),q=m(q,I.y),l=K(l,I.y);var Q=G.getScale();G.setSize(f((S-j)/Q.x),f((l-q)/Q.y));var R;Q.x<0&&(R=j,j=S,S=R),Q.y<0&&(R=q,q=l,l=R),r=T(w),b=W(w);var e=G.getAnchor();y=j+(S-j)*e.x,F=q+(l-q)*e.y,G.setPosition(r*y-b*F,b*y+r*F),delete G._updatingFromChildren}}},setPosition:function(Z,p){var u=this;if(!u._updatingToChildren){var z;z=2===arguments.length?{x:Z,y:p}:Z,rf||u._updatingFromChildren||(u._updatingToChildren=1,Vh(u._children,z.x-u._position.x,z.y-u._position.y),delete u._updatingToChildren),lj.superClass.setPosition.call(this,z)}},setWidth:function(B){return this.setSize(B,this.getHeight())},setHeight:function(Y){return this.setSize(this.getWidth(),Y)},setSize:function($,J){1>$&&($=1),1>J&&(J=1);var i=this;if(!i._updatingToChildren){2!==arguments.length&&(J=$.height,$=$.width);var X=i.getWidth(),G=i.getHeight();if($!==X&&lj.superClass.setWidth.call(i,$),J!==G&&lj.superClass.setHeight.call(i,J),!rf&&!i._updatingFromChildren){i._updatingToChildren=1;var y=$/X,H=J/G;i._adjustChildScaleOrSize(y,H,"size"),delete i._updatingToChildren,i.updateFromChildren()}}},_adjustChildScaleOrSize:function(X,j,f){var r=this;if(r._syncSize){var A=r.getPosition(),V=r.getRotation();r.getScale(),r.eachChild(function(n){if(Cd(n)){var z=n.getPosition(),Z=n.getRotation(),l=n.getWidth(),c=n.getHeight(),I=n.getScale(),S=I.x*l,C=I.y*c,b=new lh(Z,z.x,z.y,S,C);b.translate(-A.x,-A.y),b.rotate(-V),Z=Y(b.b*Math.sign(S),b.a*Math.sign(S)),b.scale(X,j);var G,r,R,D=T(Z);if(Math.abs(D)<.001?(G=W(Z),r=b.b/G,R=-b.c/G):(r=b.a/D,R=b.d/D),"scale"===f)n.setScale(r/l,R/c);else if("size"===f){var g=r/I.x,d=R/I.y;n.setScale(Ap(r)*Math.abs(I.x),Ap(R)*Math.abs(I.y)),n.setSize(Math.max(.1,Math.abs(g)),Math.max(.1,Math.abs(d)))}b.rotate(V),b.translate(A.x,A.y),n.setPosition(b.tx,b.ty)}})}},_calcChangeFactor:function(Q,l,o,v){var r,e,p,n;return r=f(Q),e=f(o),p=r>e?r/e:e/r,r=f(l),e=f(v),n=r>e?r/e:e/r,K(p,n)},setAnchor:function(){var X=this;if(!X._updatingToChildren){var V=X.getAnchor();if(lj.superClass.setAnchor.apply(X,arguments),!rf&&!X._updatingFromChildren&&X._syncSize){X._updatingToChildren=1;var Q=X.getAnchor();X.getPosition();var H=X.getSize(),w=X.getScale(),U=X.getRotation(),E=-H.width*w.x*(V.x-Q.x),L=-H.height*w.y*(V.y-Q.y),b=W(U),M=T(U),B=M*E-b*L,a=b*E+M*L;X.eachChild(function(O){if(Cd(O)){var I=O.getPosition();O.setPosition(I.x-B,I.y-a)}}),delete X._updatingToChildren}}},setRotation:function(W){var S=this;if(!S._updatingToChildren){var E=S.getRotation();if(lj.superClass.setRotation.apply(S,arguments),!rf&&!S._updatingFromChildren){S._updatingToChildren=1;var k=S.getPosition(),z=W-E;S.eachChild(function(F){if(Cd(F)){var h=F.getMatrix();h.translate(-k.x,-k.y),h.rotate(z),h.translate(k.x,k.y);var l=Math.sign(F.getScale().x);F.setRotation(Y(h.b*l,h.a*l)),F.setPosition(h.tx,h.ty)}}),delete S._updatingToChildren}}},setScale:function(W,Y){var M=this;if(!M._updatingToChildren){null==Y&&(Y=W.y,W=W.x);var Q=M.getScale();if(f(W)<.01&&(W=.01*(Ap(W)||Ap(Q.x))),f(Y)<.01&&(Y=.01*(Ap(Y)||Ap(Q.y))),lj.superClass.setScale.call(M,W,Y),!rf&&!M._updatingFromChildren){M._updatingToChildren=1;var i=W/Q.x,b=Y/Q.y;M._adjustChildScaleOrSize(i,b,"size"),delete M._updatingToChildren,M.updateFromChildren()}}},getSerializableProperties:function(){var i=lj.superClass.getSerializableProperties.call(this);return i.clickThroughEnabled=1,i.syncSize=1,i}});var wk=o.Grid=function(){lp(o.Grid,this)};Sb("Grid",Xp,{IRotatable:!1,_icon:"grid_icon",_image:I,getUIClass:function(){return _k},setRotation:function(){},getCellRect:function(G,h){var M=this,u=M.s("grid.row.count"),C=M.s("grid.column.count");if(0>=u||0>=C||0>G||G>=u||0>h||h>=C)return I;var g,x,H,E=M.getRect(),B=M.s("grid.row.percents"),X=M.s("grid.column.percents");if(Xl(E,M,"grid.border",-1),B&&B._as&&(B=B._as),X&&X._as&&(X=X._as),B&&B.length===u){for(H=0,g=0;G>g;g++)H+=E.height*B[g];E.y+=H,E.height=E.height*B[G]}else E.height=E.height/u,E.y+=E.height*G;if(X&&X.length===C){for(x=0,g=0;h>g;g++)x+=E.width*X[g];E.x+=x,E.width=E.width*X[h]}else E.width=E.width/C,E.x+=E.width*h;return Bs(E,-M.s("grid.gap")),E}});var oh=o.Text=function(){lp(oh,this),this.setSize(100,50),this.s("text","TEXT")};Sb("Text",Xp,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return bb},setWidth:function(L){L||(L=.001),oh.superClass.setWidth.call(this,L)},setHeight:function(O){O||(O=.001),oh.superClass.setHeight.call(this,O)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Fe("__text__",{width:{value:100,isSafeFunc:!0,func:function(W){return W._width}},height:{value:50,isSafeFunc:!0,func:function(w){return w._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Yi=o.Shape=function(){lp(Yi,this),this._59O=new mk};Yi.__de__=fo,Sb("Shape",Xp,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Ym},_22Q:function(){return Zk},getLength:function(K){return Cg(hk(this._59O,this._58O,K,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var e=this._58O;return e?new mk(e._as.slice(0)):e},setSegments:function(I){var h=this._58O;I=I?sk(I)?new mk(I.slice(0)):new mk(I._as.slice(0)):null,(h&&I&&h._as.join(",")!==I._as.join(",")||h!==I)&&(this._58O=I,this.fp("segments",h,I))},getPoints:function(){return this._59O},toPoints:function(){var r=this._59O;return new mk(r._as.slice(0))},setPoints:function(m,C){var n=this,r=n._59O;m=m?sk(m)?new mk(m.slice(0)):new mk(m._as.slice(0)):new mk;var l,S,W,L,V,s;C&&(l=n.getPosition(),s=new lh(n.getRotation(),0,0,n.getScale().x,n.getScale().y)),(r&&m&&r._as.join(",")!==m._as.join(",")||r!==m)&&(n._59O=m,n.fs(),n.fp("points",r,m)),C&&(S=n.getPosition(),W=S.x-l.x,L=S.y-l.y,V=s.tf(W,L),n.setPosition(S.x-W+V.x,S.y-L+V.y))},addPoint:function(Y,m,o){var i=this.toPoints();i.add(Y,m),this.setPoints(i,o)},setPoint:function(O,p,X){var R=this.toPoints();R.set(O,p),this.setPoints(R,X)},removePointAt:function(W){var I=this.toPoints();I.removeAt(W),this.setPoints(I)},setWidth:function($){var A=this;if(1>$&&($=1),!A._55I&&!rf&&A.getWidth()){A._55I=1;var S=A._position.x,F=$/A.getWidth(),L=A.toPoints(),v=new mk;L.each(function(E){v.add({x:(E.x-S)*F+S,y:E.y,e:E.e})}),A.setPoints(v),so(A,[F,0,0,1,S*(1-F),0]),A.fs(),delete A._55I}Yi.superClass.setWidth.call(A,$)},setHeight:function(r){var A=this;if(1>r&&(r=1),!A._55I&&!rf&&A.getHeight()){A._55I=1;var k=A._position.y,S=r/A.getHeight(),$=A.toPoints(),n=new mk;$.each(function(N){n.add({x:N.x,y:(N.y-k)*S+k,e:N.e})}),A.setPoints(n),so(A,[1,0,0,S,0,k*(1-S)]),A.fs(),delete A._55I}Yi.superClass.setHeight.call(A,r)},setAnchorElevation:function(Q){var m=this;m._55I=!0;var P=m._updatingAnchor3d,q=!rf&&!P;if(q){var b,v=Q,U=m.getAnchorElevation(),K=m.getTall();b=K*(U-v),m.shiftPointsElevation(b)}var Y=Yi.superClass.setAnchorElevation.apply(m,arguments);return P||delete m._55I,Y},getShapeElevation:function(){var g=this,C=g._54O;return C-(g.getTall()||0)*(g._anchorElevation-.5)},setAnchor3d:function(T,E,U,V){var x,s=this;"number"==typeof T?x={x:T,y:E,z:U}:(x=T.length?{x:T[0],y:T[1],z:T[2]}:T,V=E),s._55I=!0,s._updatingAnchor3d=!0;var w=s.getDataModel();if(w&&w.beginTransaction(),!rf){var Y=s.getAnchor3d(),g=s.getSize(),O=s.getTall(),d=g.width*(Y.x-x.x),u=g.height*(Y.z-x.z),r=O*(Y.y-x.y);V||s.shiftPoints(d,u,r);var L=s.p3()}var $=Yi.superClass.setAnchor3d.apply(s,arguments);if(!rf&&V){var c=s.p3();s.shiftPoints(c[0]-L[0]+d,c[2]-L[2]+u,c[1]-L[1]+r)}return w&&w.endTransaction(),delete s._updatingAnchor3d,delete s._55I,$},setAnchor:function(D,S,x){var U=this;U._55I=!0;var n=U._updatingAnchor3d,q=!rf&&!n;if(q){var Z,w,G;"number"==typeof D?G={x:D,y:S}:(G=D.length?{x:D[0],y:D[1]}:D,x=S);var y=U.getAnchor(),O=U.getSize();Z=O.width*(y.x-G.x),w=O.height*(y.y-G.y),x||U.shiftPoints(Z,w);var P=U.getPosition()}var V=Yi.superClass.setAnchor.apply(U,arguments);if(q){var m=U.getPosition();x&&U.shiftPoints(m.x-P.x+Z,m.y-P.y+w)}return n||delete U._55I,V},shiftPoints:function(T,d,K){var o=this,r=o.getElevation()||0,Z=o.toPoints(),g=new mk;Z.each(function(S){var k=S.e;K&&(k=(k==I?r:k)+K),g.add({x:S.x+T,y:S.y+d,e:k})}),o.setPoints(g),o.fs()},shiftPointsElevation:function(e){return this.shiftPoints(0,0,e)},setPosition:function(f,i){var v,L=this;if(!L._28Q){if(L._28Q=1,!L._55I&&!rf){v=2===arguments.length?{x:f,y:i}:f;var E=v.x-L._position.x,Q=v.y-L._position.y;if(0===E&&0===Q)return delete L._28Q,void 0;L._55I=1,L.shiftPoints(E,Q),so(L,[1,0,0,1,E,Q]),delete L._55I}Yi.superClass.setPosition.apply(L,arguments),delete L._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var d=this;if(2!==d._59O.size())return!1;var n=d._58O;return n?2===n.size()&&1===n.get(0)&&2===n.get(1)?!0:!1:!0},fireShapeChange:function(){var P=this;if(!P._55I&&!rf){var H=we(P._59O);H&&(P._55I=1,P.setRect(H),delete P._55I)}P.fp(Be,!1,!0)},getSerializableProperties:function(){var O=Yi.superClass.getSerializableProperties.call(this);return O.segments=1,O.points=1,O.thickness=1,O.closePath=1,O}});var Wn=o.Polyline=function(){lp(Wn,this),this.s({"shape.background":null,"shape.border.width":2})};Sb("Polyline",Yi,{_icon:"polyline_icon",_22Q:function(){return Yr},getUIClass:function(){return tk},setClosePath:function(){},setTall:function(H){var X=this;if(!X._55I&&!X._24Q&&!rf&&X.getTall()){X._24Q=1;var r=X._54O,o=H/X.getTall();X._59O.each(function(u){u.e=u.e==I?r:(u.e-r)*o+r}),X.fs(),delete X._24Q}Wn.superClass.setTall.call(X,H)},setElevation:function(N){var v=this;if(!v._55I&&!v._24Q&&!rf){v._24Q=1;var H=N-v._54O;v._59O.each(function(w){w.e==I?w.e=N:w.e+=H}),v.fs(),delete v._24Q}Wn.superClass.setElevation.apply(v,arguments)},fireShapeChange:function(){var D=this,e=D._59O;if(!D._55I&&!D._24Q&&!rf){var s=e.size();if(s){var A=1,y=e.get(0),U=D._54O;y.e==I&&(y.e=U);for(var x=y.e,L=0;s>A;A++){y=e.get(A),y.e==I&&(y.e=U);var c=m(x,y.e),h=K(x+L,y.e);x=c,L=h-c}D._24Q=1,D.setTall(L),D.setElevation(x+L*D._anchorElevation),delete D._24Q}}Wn.superClass.fireShapeChange.apply(D,arguments)}});var fs=o.SubGraph=function(){lp(fs,this)};Sb("SubGraph",Xp,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){fs.superClass._8I.call(this),this.eachChild(function(P){Cd(P)&&P._8I()})}}),C.loadingRefGraph=0;var us=o.RefGraph=function(){lp(us,this)};Sb("RefGraph",lj,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(F){var H=this._ref;this._ref=F,this.fp("ref",H,F),this.updateRef()},_21I:function(){us.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var H=this;if(C.loadingRefGraph++,H.clearChildrenFromDataModel(),C.loadingRefGraph--,H._ref&&H._dataModel){H._xhrLoadHandler&&(H._xhrLoadHandler.cancel=!0);var B=rf,X=H._xhrLoadHandler=function(a){if(a&&H._dataModel){C.loadingRefGraph++;var s=H._pendingUpdateInfo={needToRestore:B};B&&(s.position=H.p(),s.width=H.getWidth(),s.height=H.getHeight(),s.rotation=H.getRotation(),s.anchor=H.getAnchor(),s.scale=H.getScale()),H.p(0,0),H.setAnchor(.5,.5),H.setRotation(0),H.setScale(1,1);var y=C.parse(a),u=H._dataModel.deserialize(y,H,{justDatas:!0});u.each(function(U){U._refGraph=H}),H.checkPendingUpdateInfo(),C.loadingRefGraph--,C.handleRefGraphLoaded(H,u,y)}};X.xhrLoadCalled=!1,C.load(H._ref,function(h){X.cancel||(X.xhrLoadCalled?X(h):jr(function(){X(h)}))}),X.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var b=this,D=b._pendingUpdateInfo;if(!D)return b.onPendingUpdated&&(C.loadingRefGraph++,b.onPendingUpdated(),C.loadingRefGraph--),void 0;var A=!0;this.eachChild(function(l){(l._pendingCheckImageJSON||l._pendingUpdateInfo)&&(A=!1)}),A&&(C.loadingRefGraph++,b._pendingUpdateInfo=null,b.updateFromChildren(),D.needToRestore&&(b.setSize(D.width,D.height),b.setAnchor(D.anchor),b.setRotation(D.rotation),b.setScale(D.scale),b.p(D.position)),this.getParent()instanceof us&&this.getParent().checkPendingUpdateInfo(),b.onPendingUpdated&&b.onPendingUpdated(),C.loadingRefGraph--)},getSerializableProperties:function(){var h=us.superClass.getSerializableProperties.call(this);return h.ref=1,h}}),o.EdgeGroup=function(g,W){this._70O=g,this._siblings=W;for(var w,T,u=0,V=g.size(),_=R[Kc];V>u;u++)if(w=g.get(u).getStyle(Kc,!1),w!=I){_=w;break}_==I&&(_=!0);var Q=C.edgeGroupAgentFunc;for(Q&&(T=Q(g),T&&T!==g.get(0)&&(g.remove(T),g.add(T,0))),u=0;V>u;u++)g.get(u).s(Kc,_)},Sb("EdgeGroup",V,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(V){return this._70O.get(V)},indexOf:function(u){return this._70O.indexOf(u)},each:function(r,m){this._70O.each(r,m)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(I,J){this._siblings.each(function(V){V._70O.each(I,J)})}});var Oh=function(N,S,b){var c=Zq[N]={type:N,action:S};if(b)for(var z in b)c[z]=b[z]};hj(C,{setConnectAction:Oh,getConnectAction:function(H,Z){if(!Z){if(!H)return null;Z=H.getCurrentConnectActionType()}return Zq[Z]},doConnectAction:function(w,N,i,A){A=A||w.getCurrentConnectActionType();var T=Zq[A];if(!T)return!1;var $=T.action;return $?(N instanceof Sd.Group?w.sm().getSelection().each(function(r){$.call(null,w,r,i)}):$.call(null,w,N,i),!0):!1},doDeleteConnectionAction:function(G,K,$){$=$||G.getCurrentConnectActionType();var C=Zq[$];if(!C||!C.delete)return!1;var h=C.delete.action;return h?(K instanceof Sd.Group?G.sm().getSelection().each(function(m){h.call(null,G,m)}):h.call(null,G,K),!0):!1}});var gh=o.JSONSerializer=function(o,R){this.dm=this._dataModel=o,this._hierarchical=C.forceHierarchicalSerialization?!0:R==I?o.isHierarchicalRendering():R};Sb("JSONSerializer",V,{ms_ac:["hierarchical"],serialize:function(I){return C.stringify(this.toJSON(),I)},toJSON:function(){var y=this,R=y.dm,a=R.getRoots(),T=y.json={v:C.getVersion(),p:{},a:{},d:[]},l=R.getSerializableAttrs();R.getInit()&&(T.init=R.getInit()),R.getName()&&(T.p.name=R.getName()),R.getBackground()&&(T.p.background=R.getBackground()),R.getLayers()&&(T.p.layers=R.getLayers()),T.p.autoAdjustIndex=R.isAutoAdjustIndex(),T.p.hierarchicalRendering=R.isHierarchicalRendering();for(var M in l){var o=R.a(M);o!==Z&&y[Rh](M,o,T.a)}return Nl(T.a)&&delete T.a,y._hierarchical?a.each(y.serializeData,this):R.each(function(f){y.serializeData(f)}),T},isSerializable:function(){return!0},getProperties:function(Q){return Q.getSerializableProperties()},getStyles:function(r){return r.getSerializableStyles()},getAttrs:function(H){return H.getSerializableAttrs()},serializeData:function(p){var R=this;if(R.isSerializable(p)&&!p._refGraph){var g,z,M,P,u=tf(p.getClassName())||p.getClass(),r=new u,q={c:p.getClassName(),i:p.getId(),p:{},s:{},a:{}};R.json.d.push(q),g=R.getProperties(p);for(z in g)/^_/.test(z)?(M=p[z],M!==r[z]&&R[Rh](z.substr(1),M,q.p)):(P=zn(z),p[P]&&(M=p[P](),M!==r[P]()&&R[Rh](z,M,q.p)));g=R.getStyles(p);for(z in g)M=p.s(z),M!==r.s(z)&&R[Rh](z,M,q.s);g=R.getAttrs(p);for(z in g)M=p.a(z),M!==r.a(z)&&R[Rh](z,M,q.a);Nl(q.p)&&delete q.p,Nl(q.s)&&delete q.s,Nl(q.a)&&delete q.a}R._hierarchical&&p.getChildren().each(R.serializeData,R)},serializeValue:function(o,K,X){xq(K)?K={__a:K._as}:K instanceof Tn&&(K={__i:K.getId()}),X[o]=K},deserialize:function(D,_,L){var F=this,z=F.dm;z.beginTransaction(),rf++,L=Ep(L)?{setId:L}:L||{},D=F.json=hf(D)?C.parse(D):D,F._82I={};var x=new mk,f=new mk,R=0,k=D.d.length;if(L.justDatas||(rn(D.init)&&D.init(z),z.setInit(D.init)),!L.justDatas){for(var e in D.a)z.a(e,F[qd](D.a[e]));for(var m in D.p)z[mh(m)](D.p[m])}for(;k>R;R++){var t=D.d[R],P=tf(t.c),T=new P,W=t.i;L.setId&&W!=I&&(T._id=W),F._82I[W]=T,x.add(T),f.add(t)}for(R=0;k>R;R++)F.deserializeData(x.get(R),f.get(R));return x.each(function(w){_&&!w.getParent()&&w.setParent(_),z.add(w)}),rf--,z.endTransaction(),x},deserializeData:function($,b){for(var W in b.p)$[mh(W)](this[qd](b.p[W]));for(W in b.s)$.s(W,this[qd](b.s[W]));for(W in b.a)$.a(W,this[qd](b.a[W]))},deserializeValue:function(X){if(Ui(X)){var J=X.__i;if(J!=I)return this._82I[J];if(J=X.__a,sk(J))return new mk(J)}return X}}),hj(Ve,{serialize:function(U,D){return new gh(this,D).serialize(U)},toJSON:function(b){return new gh(this,b).toJSON()},deserialize:function(Q,l,G){return new gh(this).deserialize(Q,l,G)}});var eg=o.OverlappingBox=function(q){this.gv=q,this.boxes={}};Sb("OverlappingBox",V,{clear:function(){var o,t,d=this.boxes;for(o in d)t=d[o],t.length=0},isOverlapping:function(m,l){var k,e,Q=this,d=Q.boxes,z=d[m];z?(k=z.rects,e=z.length):z=d[m]={rects:k=[],length:e=0};var o,Z,l;for(o=0;e>o;o++)if(Z=k[o],Z.x<l.x+l.w&&Z.x+Z.w>l.x&&Z.y<l.y+l.h&&Z.h+Z.y>l.y)return!0;return k.length<=e?(k.push(l),z.length++):k[z.length++]=l,!1}}),hj(C,{fetch:function(S,l){var h="GET",j=!1,D=null,d="";l&&(h=l.method||"GET",j=l.sync,d=l.url,D=l.data||null),S.open(h,d,!j),S.send(D)},convertImageSrc:function(I,C){C&&"function"==typeof C||(C=function(){}),C(I)}});var xn=o.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Sb("Request",V,{_responseType:null,_overrideMimeType:"text/plain",send:function(b){var d=this._xhr,N=this.onload,F=this.onerror;this.getResponseType()?d.responseType=this.getResponseType():this.getOverrideMimeType()&&d.overrideMimeType(this.getOverrideMimeType()),d.onload=N,d.onerror=F,C.fetch(d,b)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(x){this._responseType=x},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(I){this._overrideMimeType=I},getResponseText:function(){var a=this._xhr;return a.response||a.responseText}}),dn.GraphView=function(o){var B=this;B._24I={},B._34I=new mk,B._25I={},B._56I={},B._view=zg(1,B),B._canvas=wo(B._view),B.dm(o?o:new Ve),this._coreInteractor=new Lb(this),B.setEditable(!1),B.setScrollBarVisible(C.graphViewScrollBarVisible)},Ne("GraphView",V,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[vo,Zb,qh,fb,"resettable","editInteractor",$k,"pannable","rectSelectable","autoScrollZone",yd,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:C.graphViewResettable,_pannable:C.graphViewPannable,_rectSelectable:C.graphViewRectSelectable,_autoScrollZone:C.graphViewAutoScrollZone,_rectSelectBackground:C.graphViewRectSelectBackground,_rectSelectBorderColor:C.graphViewRectSelectBorderColor,_editPointSize:C.graphViewEditPointSize,_editPointBorderColor:C.graphViewEditPointBorderColor,_editPointBackground:C.graphViewEditPointBackground,_scrollBarColor:wp,_scrollBarSize:Mr,_autoHideScrollBar:Dg,_autoMakeVisible:qm,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(x){this._dataModel.setLayers(x)},setEditable:function(q){var d=this,T=d.__interactorMap__;if(!T){var u=dn.XEditInteractor;T=d.__interactorMap__={scrollBar:new Lh(d),select:new $l(d),edit:u?new u(d):new Ai(d),move:new Gc(d),"default":new kj(d),touch:new dr(d,{editable:!1})}}q?(d._uieditable=!0,d.setInteractors([T.scrollBar,T.select,T.edit,T.move,T.default,T.touch])):(d._uieditable=!1,d.setInteractors([T.scrollBar,T.select,T.move,T.default,T.touch]))},getCanvas:function(){return this._canvas},_33I:function(C){var Y=C.getUIClass();return Y?new Y(this,C):I},getDataUI:function(Q){var U=this,e=U._25I[Q._id];return e===Z&&(e=U._33I(Q),U._25I[Q._id]=e),e},getNodeRect:function(E){return C.getNodeRect(this,E)},getEdgeInfo:function(i){var B=this.getDataUI(i);return B?(B._79o(),B._78o):null},getEdgeSourcePosition:function(I){var $=this,Y=$.getDataUI(I),m=Y.s,F=Y._data._40I;return an($,F,m("edge.source.position"),m("edge.source.offset.x"),m("edge.source.offset.y"),m("edge.source.anchor.x"),m("edge.source.anchor.y"))},getEdgeTargetPosition:function(B){var U=this,$=U.getDataUI(B),G=$.s,X=$._data._41I;return an(U,X,G("edge.target.position"),G("edge.target.offset.x"),G("edge.target.offset.y"),G("edge.target.anchor.x"),G("edge.target.anchor.y"))},invalidateAll:function(w){var g=this;if(w){for(var U in g._25I){var N=g._25I[U];N&&N.dispose()}g._25I={},g._56I={},g._24I={},g._34I.clear(),g.redraw()}else g.dm().each(function(Y){g.invalidateData(Y)})},invalidateSelection:function(){var A=this;A.sm().each(function(o){A.invalidateData(o)})},invalidateData:function(S){var f=this;f._24I[S._id]=S,f._21Q(S),f.iv()},_21Q:function(C){var U=this,J=U._24I;if(eq(C)&&kn[C.s(pj)]){var X=C.getSourceAgent();X&&X.getAgentEdges().each(function(w){J[w._id]=w}),X=C.getTargetAgent(),X&&X.getAgentEdges().each(function(Q){J[Q._id]=Q}),U.iv()}},redraw:function(m){var W=this;W._32I||(m?W._34I.add(m):(W._32I=1,W._34I.clear()),W.iv())},each:function(F,W){var V,S,Y,e=0,m=this.getLayers(),a=this._dataModel,d=a._datas._as,$=d.length;if(m){for(var U=m.length;U>e;e++)if(Y=m[e],Ui(Y)&&(Y=Y.name),a.isHierarchicalRendering()){var O=function(K){return K._layer===Y?W?F.call(W,K):F(K):void 0};if(this._dataModel.eachByHierarchical(O)===!1)return}else for(var s=0;$>s;s++)if(V=d[s],V._layer===Y&&(S=W?F.call(W,V):F(V),S===!1))return
}else if(a.isHierarchicalRendering())this._dataModel.eachByHierarchical(F,null,W);else for(;$>e;e++)if(V=d[e],S=W?F.call(W,V):F(V),S===!1)return},reverseEach:function(O,M){var Y,l,m,X,D=this._dataModel,r=D._layers,g=D._datas._as,B=g.length;if(r){for(Y=r.length-1;Y>=0;Y--)if(X=r[Y],Ui(X)&&(X=X.name),D.isHierarchicalRendering()){var _=function(j){return j._layer===X?M?O.call(M,j):O(j):void 0};if(D.reverseEachByHierarchical(_)===!1)return}else for(var x=B-1;x>=0;x--)if(l=g[x],l._layer===X&&(m=M?O.call(M,l):O(l),m===!1))return}else if(D.isHierarchicalRendering())D.reverseEachByHierarchical(O,null,M);else for(Y=B-1;Y>=0;Y--)if(l=g[Y],m=M?O.call(M,l):O(l),m===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var u=this,g=u._84I;if(!g){var n=this.dm().a("width"),X=this.dm().a("height");n>0&&X>0?u._84I={x:0,y:0,width:n,height:X}:(u.each(function(y){u.isVisible(y)&&(g=Tr(g,u.getDataUIBounds(y)))}),u._84I=g?g:Lg)}return u._84I},getScrollRect:function(){return Tr(this.getContentRect(),this._29I)},makeCenter:function(w,b,E){var r=this;if(!r.getWidth()||!r.getHeight())return E||jr(r.centerData,r,[w,b,!0],500),void 0;r.makeVisible(w),r.validate();var B=r.getDataUIBounds(w);if(B){var q=r.getWidth(),c=r.getHeight(),l=B.x+B.width/2,u=B.y+B.height/2,x=-l*r._zoom+q/2,M=-u*r._zoom+c/2;r.setTranslate(x,M,b)}},fitData:function(Q,L,s,x,v){var i=this;if(!i.getWidth()||!i.getHeight())return v||jr(i.fitData,i,[Q,L,s,x,!0],500),void 0;var c=function(){i.makeVisible(Q),i.validate();var N=i.getDataUIBounds(Q);N&&(N=Tm(N),Bs(N,s==I?20:s),i.fitRect(N,L,x))};L?C.callWhenLoaded(c):c()},fitContent:function(n,T,V,R){var U=this;if(!U.getWidth()||!U.getHeight())return R||jr(U.fitContent,U,[n,T,V,!0],500),void 0;var W=function(){U.validate();var O=Tm(U.getContentRect());Bs(O,T==I?20:T),U.fitRect(O,n,V)};n?C.callWhenLoaded(W):W()},fitRect:function(L,t,s){var g=this,$=g.getWidth(),n=g.getHeight(),f=L.x+L.width/2,A=L.y+L.height/2,z=m($/L.width,n/L.height),R=g._zoom,N=-f*R+$/2,Y=-A*R+n/2;0===z||isNaN(z)||(s&&(z=m(1,z)),t?(g._65I&&(delete g._65I.finishFunc,g._65I.stop(!0)),g._14o&&g._14o.stop(!0),g.setTranslate(N,Y,{finishFunc:function(){g.setZoom(z,t)}})):(g.setTranslate(N,Y),g.setZoom(z)))},toCanvas:function(R,_){_=_||this._zoom,this.validateImpl();var z=this,P=z.getContentRect();P.width||(P.width=10),P.height||(P.height=10);var w=wo(),c=P.x*_,y=P.y*_,x=P.width*_,T=P.height*_;sg(w,x,T,1);var t=Yl(w);return R=R||this._dataModel.getBackground(),R&&Uc(t,0,0,x,T,R),Uf(t,-c,-y),t.scale(_,_),z._42(t),t.restore(),w},toDataURL:function(I,S,o){return this.toCanvas(I,o).toDataURL(S||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(n,m){var s=this;s._93db(n,m),s.each(function(p){var i=s.getDataUI(p);if(i){var b=s._56I[p._id],B=i._htmlView;if(b){var $=i._79o();if(B=i._htmlView,o.HtmlNode&&p instanceof o.HtmlNode)i._42(n);else{var L=s.getViewRect(),R=B&&B.layoutHTML;!m||Tf(m,$)?(R&&(B.layoutHTML(),i.__outerLayout&&delete i.__outerLayout),i._42(n)):Tf(L,$)||!R||i.__outerLayout||(B.layoutHTML(),i.__outerLayout=!0)}}B&&(B.getView&&(B=B.getView()),B.style.display=b?"block":Fo)}}),s._92db(n,m)},validateImpl:function(){var u,L,M,P,b,D=this,R=D.tx(),O=D.ty(),x=D._zoom,C=D._canvas,$=this.getWidth(),k=this.getHeight(),U=D._29I,d={x:-R/x,y:-O/x,width:$/x,height:k/x},W={},T=D._34I,X=D._24I,z=D._32I,Z=D._23I;D._24I={},($!==C.clientWidth||k!==C.clientHeight)&&(sg(C,$,k),z=1),z||Ff(d,U)||(z=1),D._29I=d,D.each(function(A){L=A._id;var d=W[L]=D.isVisible(A);d!==D._56I[L]&&(X[L]=A,M=D.getDataUI(X[L]),M&&M._84o(d),D._84o(A,d))},D);for(L in X)M=D.getDataUI(X[L]),M&&(!z&&D._56I[L]&&(b=M._79o(),b&&T.add(b)),M.invalidate()),D._83I=1;if(D._56I=W,!z)for(L in X)W[L]&&(M=D.getDataUI(X[L]),M&&(b=M._79o(),b&&T.add(b)));if(z?P=d:(T.each(function(w){Tf(d,w)&&(P=Tr(P,w))}),P&&(Bs(P,K(1,1/x)),P.x=B(P.x*x)/x,P.y=B(P.y*x)/x,P.width=h(P.width*x)/x,P.height=h(P.height*x)/x,P=To(d,P))),D._74O=P,P){u=Yl(C);var f=P.x,A=P.y,n=P.width,i=P.height;f=Math.floor((f*x+R)*kp),A=Math.floor((A*x+O)*kp),n=Math.ceil(n*x*kp)+1,i=Math.ceil(i*x*kp)+1,u.beginPath(),u.rect(f,A,n,i),u.clip(),u.clearRect(f,A,n,i),Fb(u,R,O,x),D._42(u,P),u.restore(),delete D._74O}if(T.clear(),delete D._32I,Z&&$>0&&k>0){var M=D.getDataUI(Z);if(M){var b=M._79o(),s=D._29I,c=s.x,y=s.y,t=s.width,G=s.height,x=D._zoom;b&&!Tf(b,s)&&(b.x+b.width<c&&D.tx(-b.x*x),b.x>c+t&&D.tx(-(b.x+b.width-t)*x),b.y+b.height<y&&D.ty(-b.y*x),b.y>y+G&&D.ty(-(b.y+b.height-G)*x))}delete D._23I}D._83I&&(delete D._83I,delete D._84I),D._98O(),Nl(D._24I)||jr(D.iv,D)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(p){var R=this;p!==R.isScrollBarVisible()&&(p?(yj(R._view,R._79O=jd()),yj(R._79O,R._27I=jd()),yj(R._79O,R._28I=jd())):(gg(R._79O),delete R._79O,delete R._27I,delete R._28I),R.fp("scrollBarVisible",!p,p))},showScrollBar:function(){var K=this;K._79O&&(K._85I||(w(function(){K._86I()},Qo),K.iv()),K._85I=new Date)},_86I:function(){var h=this;if(h._85I){var b=new Date,J=b.getTime();J-h._85I.getTime()>=Qo?(delete h._85I,h.iv()):w(function(){h._86I()},Qo)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var m=this,M=this._27I,r=this._28I;if(m._79O){if(m._autoHideScrollBar&&!m._85I)return M.style.visibility=Co,r.style.visibility=Co,void 0;var R=m.getScrollBarColor(),a=m._zoom,Y=m.getScrollBarSize(),e=m.getViewRect(),L=m.getScrollRect(),U=e.height*a,i=L.height*a,j=e.width*a-Y-2,S=U*((e.y-L.y)*a/i),k=U*(U/i),G=M.style;i-.5>U?(je>k&&(S=S+k/2-je/2,0>S&&(S=0),S+je>U&&(S=U-je),k=je),Pi(M,j,S,Y,k),G.visibility=qs,G.background=R,G.borderRadius=Y/2+hr):G.visibility=Co;var J=e.width*a,y=L.width*a,S=e.height*a-Y-2,j=J*((e.x-L.x)*a/y),f=J*(J/y),G=r.style;y-.5>J?(je>f&&(j=j+f/2-je/2,0>j&&(j=0),j+je>J&&(j=J-je),f=je),Pi(r,j,S,f,Y),G.visibility=qs,G.background=R,G.borderRadius=Y/2+hr):G.visibility=Co}},setDataModel:function(C){var U=this,M=U._dataModel,P=U._selectionModel;M!==C&&(M&&(M.ump(U.handleDataModelPropertyChange,U),M.umm(U.handleDataModelChange,U),M.umd(U.handleDataPropertyChange,U),M.removeIndexChangeListener(U._75O,U),M.removeHierarchyChangeListener(U.handleHierarchyChange,U),P||M.sm().ums(U.handleSelectionChange,U)),U._dataModel=C,C.mp(U.handleDataModelPropertyChange,U),C.mm(U.handleDataModelChange,U),C.md(U.handleDataPropertyChange,U),C.addIndexChangeListener(U._75O,U),C.addHierarchyChangeListener(U.handleHierarchyChange,U),P?P._21I(C):C.sm().ms(U.handleSelectionChange,U),U.invalidateAll(!0),U.fp(xp,M,C),U._canvas.style.background=C.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===Z){var R=this.getLayers();R?(this._layersInfo={},R.forEach(function(c){var y=Ui(c)?c.name:c;this._layersInfo[y]=c},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=Z,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(R){if("background"===R.property){var H=this._canvas.style.background,n=R.newValue||"";this._canvas.style.background=n,this.fp("canvasBackground",H,n)}else"a:width"===R.property||"a:height"===R.property?(this._83I=1,this.redraw()):"layers"===R.property?this.updateLayers():"hierarchicalRendering"===R.property&&this.redraw()},handleDataPropertyChange:function(S){this.dm().isHierarchicalRendering()&&"parent"===S.property&&S.data.hasChildren()&&this.redraw(),this.invalidateData(S.data)},onPropertyChanged:function(g){var h=this,y=g.property;if(h.redraw(),"zoom"===y){var s=h.sm().getSelection();s.size()&&s.each(function(S){S.invalidate()})}rg[y]?h.showScrollBar():y===$k&&h.onCurrentSubGraphChanged(g)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(T){var u=this,G=T.kind,k=T.data;if(u._83I=1,"add"===G)u.invalidateData(k),eq(k)&&k.getEdgeGroup()&&k.getEdgeGroup().eachSiblingEdge(u.invalidateData,u);else if(G===Wg){u._21Q(k);var K=k._id,N=u._25I[K];if(N){if(u._56I[K]){var P=N._79o();P&&u.redraw(P)}N.dispose(),delete u._25I[K],delete u._24I[K],delete u._56I[K]}k===u._currentSubGraph&&u.setCurrentSubGraph(I)}else G===kf&&(u.invalidateAll(!0),u.setCurrentSubGraph(I))},_75O:function(C){this.invalidateData(C.data)},handleHierarchyChange:function(x){this.dm().isHierarchicalRendering()&&x.data.hasChildren()&&this.redraw(),this.invalidateData(x.data)},adjustIndex:function(p){var q=this;if(q.isVisible(p)){q.dm().beginTransaction();for(var g=p;g._parent&&q.isVisible(g._parent);)g=g._parent;g&&g!==p&&q._dataModel.adjustIndex(g),q._dataModel.adjustIndex(p),q.dm().endTransaction()}},getImage:function(x){return x.getImage?x.getImage():Z},getSelectWidth:function(V){var w=wc(this.getImage(V));return w&&Tq(w.disableSelectedBorder,V,this)?0:V.s("select.width")},getSelectColor:function(_){return _.s("select.color")},isSelectable:function(D){if(this.isSelected(D))return!0;if(!this._clickThroughChecking&&D.getParent()instanceof lj&&this.isSelectable(D.getParent())&&D.getParent().isSyncSize())return!1;var T=this.getLayersInfo();if(T){var V=T[D._layer];if(V&&V.selectable===!1)return!1}return D.s("2d.selectable")&&this.sm().isSelectable(D)},isMovable:function(C){var M=this;if(eq(C)&&C.getStyle(pj)!==Rl)return!1;var l=this.getLayersInfo();if(l){var c=l[C._layer];if(c&&c.movable===!1)return!1}return C.s("2d.movable")?M._movableFunc?M._movableFunc(C):!0:!1},isEditable:function(J){var A=this;if(o._uiSerializing)return A._uieditable;if(!A._editInteractor||!A.isSelected(J))return!1;if(bn(J)){var E=A.getDataUI(J);if(!E||E._88I)return!1}if(eq(J)&&J.getStyle(pj)!==Rl)return!1;var V=this.getLayersInfo();if(V){var z=V[J._layer];if(z&&z.editable===!1)return!1}return J.s("2d.editable")?A._editableFunc?A._editableFunc(J):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(x){return Cd(x)&&0!==x.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(x):!0},isRectEditable:function(E){return this._rectEditableFunc?this._rectEditableFunc(E):!0},isAnchorEditable:function(_){return this._anchorEditableFunc?this._anchorEditableFunc(_):!0},isRotationEditable:function(K){return K.setRotation&&K.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(K):!0:!1},getRotationPoint:function($){var h=$.getAnchor(),p=$.getScale(),k=this._zoom,F=sr($.getRotation(),0,-$.getHeight()*p.y*h.y-(p.y<0?-1:1)*(Xm?32:16)/k),I=$.p();return F.x+=I.x,F.y+=I.y,F},getLogicalPoint:function(m){var U=this;return $r(m,U._canvas,U.tx(),U.ty(),U._zoom,U._zoom)},getScreenPoint:function(G,x){var u,j=this;return"object"==typeof G?G.x!==Z?(u=G.x,x=G.y):(u=G[0],x=G[1]):u=G,Qk(u,x,j._canvas,j.tx(),j.ty(),j._zoom,j._zoom)},getSelectedDataAt:function(v){var P=this;return this.getDataAt(v,function(n){return P.isSelected(n)})},getDataInfoAt:function(J,e,x){var Y,s=this.lp(J),S=this.getDataAt(s,e,x);if(S){var W=this.getDataUI(S);Y={data:S,ui:W,point:s};var v=W._38o;if(v){var G=v.icons;for(var E in G){var Z=G[E],t=v.rects[E];if(t)for(var f=Tq(Z.names,S,this),q=f?f.length:0,n=t.rotation,h=q-1;h>=0;h--){var g=f[h],O=t[h];if(Hd(O,s,n))return Y.part="icons",Y.name=E,Y.icon=g,Y.rect=O,Y.index=h,Y.rotation=n,Y}}}if(this.isNoteVisible(S)){if(W.note2Info&&Hd(W.note2Info.clickRect,s,I,W.note2Info.scale))return Y.part="note2",Y;if(W.noteInfo&&Hd(W.noteInfo.clickRect,s,I,W.noteInfo.scale))return Y.part="note",Y}if(this.isLabelVisible(S)){if(W.label2Info&&Hd(W.label2Info.rect,s,W.label2Info.rotation,W.label2Info.scale))return Y.part="label2",Y;if(W.labelInfo&&Hd(W.labelInfo.rect,s,W.labelInfo.rotation,W.labelInfo.scale))return Y.part="label",Y}if(S.isInRect&&S.isInRect(s))return Y.part="body",Y}return Y},getDataAt:function(F,T,e){F.target&&(F=this.lp(F));var j,y=this._zoom;return this.reverseEach(function(E){return(T?T(E):this.isSelectable(E))&&this.rectIntersects(E,kl(F.x,F.y,e,y))?(j=E,!1):void 0},this),j},getIconInfoAt:function(r,t){var x=this;if(r.target&&(r=x.lp(r)),t||(t=x.getDataAt(r)),t){var X=x.getDataUI(t);if(X&&X._38o){var c,H=X._38o,$=new mk;for(c in H.icons)$.add(c);for(var i=$.size()-1;i>=0;i--){c=$.get(i);for(var n=H.rects[c],G=n.rotation,y=n.length-1;y>=0;y--){var s=n[y],f=s.width,C=s.height,L={x:r.x-s.x-f/2,y:r.y-s.y-C/2};G!=I&&(L=sr(-G,L.x,L.y));var s={x:-f/2,y:-C/2,width:f,height:C};if(Hd(s,L))return{key:c,index:y,name:H.icons[c].names[y],rect:n[y],point:r,rotation:G,relativeRect:s,relativePoint:L,data:t}}}}}return I},getDatasInRect:function(a,x,U){U===Z&&(U=1);var C=this,l=new mk;return C.reverseEach(function(i){U&&!C.isSelectable(i)||(x?C.rectIntersects(i,a):C.rectContains(i,a))&&l.add(i)}),l},moveSelection:function(J,f){var m=this;m.dm().beginTransaction(),Vh(m.sm().toSelection(m.isMovable,m),J,f),m.dm().endTransaction()},moveDatas:function(k,g,m){var w=this;w.dm().beginTransaction(),k instanceof mk||(k=new mk(k)),Vh(k,g,m),w.dm().endTransaction()},getDataUIBounds:function(n){var d=this.getDataUI(n);return d?d._79o():I},drawData:function(u,F,H){var D=this.getDataUI(F);if(D){var $=D._79o();(!H||Tf(H,$))&&(D._42(u),F instanceof o.Block&&F.eachChild(function(U){this.drawData(u,U,H)},this))}},getBoundsForGroup:function(h){return h.s(tl)?this.getDataUIBounds(h):I},isPixelPerfect:function(n){return n.s("pixelPerfect")},rectIntersects:function(p,i){this.validate();var T=I;if(this._56I[p._id]){var j=this._25I[p._id];if(j){var Z=j._79o();if(ap(i,Z))T=!0;else if((i=To(i,Z))&&(j.rectIntersects&&(T=j.rectIntersects(i)),T==I)){if(!this.isPixelPerfect(p))return!0;var c=i.x,n=i.y,A=i.width,m=i.height,u=this._zoom,U=C.hitMaxArea,H=A*m*u*u;if(H>U){var z=Math.sqrt(U/H);u*=z}A*=u,m*=u,2>A&&(A=2),2>m&&(m=2),c*=u,n*=u;var f=_j(A,m);Uf(f,-c,-n),f.scale(u,u),this._drawForChecking=!0,this.drawData(f,p,i),this._drawForChecking=!1;try{for(var W=0,l=f.getImageData(0,0,A,m).data;W<l.length;W+=4)if(0!==l[W+3]){T=!0;break}f.restore()}catch(Q){il=I,T=!1}}}}return T?!0:!1},rectContains:function(k,c){if(this._56I[k._id]){var p=this._25I[k._id];if(p)return ap(c,p._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(H){if(!C.isInput(H.target)){var c=this,q=c._focusData,b=q&&c._25I[q._id],T=0,r=c._dataModel._datas;if(!(q&&q._enabled&&q._editable&&b&&b.onKeyDown&&b.onKeyDown(H)===!0))if(9===H.keyCode&&(q&&(T=r.indexOf(q),_g(H)?-1===--T&&(T=0):++T===r.size()&&(T=0)),c._focusData=q=r.get(T),c.sm().setSelection(q)),Kn(H)?c.selectAll():ci(H)&&c.isResettable()&&c.reset(),c.sm().isEmpty()){if(c._editing)return;var G=c.tx(),o=c.ty(),p=!1,I=_g()?100:10;Fp(H)&&(G-=I,p=!0),sh(H)&&(o-=I,p=!0),vd(H)&&(G+=I,p=!0),qc(H)&&(o+=I,p=!0),p&&c.setTranslate(G,o)}else{as(H)&&c.handleDelete(H);var i=_g()?10:1;Fp(H)&&(c.moveSelection(-i,0),c.fi({kind:"moveLeft"})),sh(H)&&(c.moveSelection(0,-i),c.fi({kind:"moveUp"})),vd(H)&&(c.moveSelection(i,0),c.fi({kind:"moveRight"})),qc(H)&&(c.moveSelection(0,i),c.fi({kind:"moveDown"}))}}},handleScroll:function(Q,$){if(Pd(Q),!this.getEditInteractor()){var A=this.getDataAt(Q);if(A){var J=wc(this.getImage(A));if(J&&Tq(J.scrollable,A,this))return}}var O=this.lp(Q);$>0?this.scrollZoomIn(O):0>$&&this.scrollZoomOut(O)},handlePinch:function(n,N,r){this._68I||(N>r?this.pinchZoomIn(n):this.pinchZoomOut(n))},checkDoubleClickOnNote:function(H,S){var q=this,k=q.lp(H),d=q.getDataUI(S),c=d.note2Info;return c&&S.s("note2.toggleable")&&Hd(c.clickRect,k)?(S.s(Dc,!S.s(Dc)),q.fi({kind:"toggleNote2",event:H,data:S}),!0):(c=d.noteInfo,c&&S.s("note.toggleable")&&Hd(c.clickRect,k)?(S.s(Je,!S.s(Je)),q.fi({kind:"toggleNote",event:H,data:S}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(D,A){var I=this,G=I.getAutoScrollZone(),R=G/I.getZoom(),x=G/4,t=I._29I,S=I.lp(D),Q={x:I.tx(),y:I.ty()};return S&&G>0&&t&&(S.x-t.x<R?I.translate(x,0):t.x+t.width-S.x<R&&I.translate(-x,0),S.y-t.y<R?I.translate(0,x):t.y+t.height-S.y<R&&I.translate(0,-x)),Q.x=I.tx()-Q.x,Q.y=I.ty()-Q.y,A&&(A.x+=Q.x,A.y+=Q.y),Q},getMoveMode:function(j,v){var Y=v.s("2d.move.mode");return Y?Y:Tj["88"]?"x":Tj["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(P,d,Q){var i=this;return"currentSubGraph"===d?{__i:P.getId()}:Q.serializeProperty(P,d,i)},deserializeProperty:function(Z,X,c){var P=this;if("currentSubGraph"===X){var f=P.dm(),e=f.__idMap;return e[Z.__i]}return c.deserializeProperty(Z,X,P)},setDefaultCursor:function(j,t){this._defaultCursor=j,t!==!1&&this.setCursor(j)},setCursor:function(I){"default"===I&&(I=this._defaultCursor||I);var o=this.getView().style;o.cursor=I,o.cursor="-webkit-"+I,o.cursor="-moz-"+I},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(s){return s===I||C.getConnectAction(null,s)?(this._currentActionType=s,this.redraw(),!0):!1},isConnectActionVisible:function(h){var Q=C.getConnectAction(this);if(!Q)return!1;var y=Q.visible;return rn(y)&&(y=y(this,h)),y},isInteractive:function(H){var r=wc(this.getImage(H));return r&&Tq(r.interactive,H,this)?!0:H.s("interactive")},appendHTML:function(Y){var i=this.getView();if(!Y||Y.parentNode===i)return!1;var m=Y.getView&&Y.getView();if(m&&m.parentNode===i)return!1;if(Y.isSelfViewEvent)return Y.addToDOM(i),!0;Y.getView&&(Y=Y.getView());var v=this.getCanvas().nextSibling;return v?i.insertBefore(Y,v):yj(i,Y),!0},layoutHTML:function(s,R,Y){var t,g=this,U=g._zoom;if(R.getView&&(t=R,R=R.getView()),R.style.position="absolute",Y){var P=s.getRect();Pi(t||R,g.tx()+P.x*U,g.ty()+P.y*U,P.width*U,P.height*U)}else{var A=new Kj,P=s.getAnchorRect(),Q=s.getPosition(),w=s.getScale(),c=R.style;Pi(t||R,P),A.appendTranslate(g.tx(),g.ty()),A.appendScale(U,U),A.append(new Kj(s.getRotation(),Q.x,Q.y,w.x,w.y)),to(c,"transform","matrix("+A.a.toFixed(5)+", "+A.b.toFixed(5)+", "+A.c.toFixed(5)+",\n    "+A.d.toFixed(5)+", "+A.tx.toFixed(5)+", "+A.ty.toFixed(5)+")"),to(c,"transformOrigin",(-P.x).toFixed(5)+"px "+(-P.y).toFixed(5)+"px"),R.maxtrixAppend=A.invert().translate(-P.x,-P.y)}}});var rm=function($,m){var V=this;V.gv=$,V.s=function(R){return m.getStyle(R)},V._data=m,V._87I=new mk};lf(rm,V,{_6I:I,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var Y=this,Q=Y.gv.isSelected(Y._data);return!Q||Y.isShadowed()?0:Y.gv.getSelectWidth(Y._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(D){var h=this._data,x=this.gv.getBodyColor(h);return x?x:D?h.getStyle(D):I},_2Q:function(J){return this.s(J)},_1Q:function(y,r,O,V){var M=this.s,u=M(r+".dash.color");y.strokeStyle=u,y.lineWidth=O,y.stroke(),M(r+".dash.3d")&&jn(y,u,M(r+".dash.3d.color"),O,this.gv._zoom,M(r+".dash.3d.accuracy")),tr(y,V)},invalidate:function(){this._6I=I},_79o:function(){var P=this;if(!P._6I){var Z=P._data,v=P.gv;P.labelInfo=P.label2Info=P.noteInfo=P.note2Info=P._38o=I,P._87I.clear(),P.interactiveInfo=v.isInteractive(Z)?{}:I,P._3O(),P._55O=v.isEditable(Z)?{_42O:v.isRectEditable(Z),_43O:v.isPointEditable(Z),_56O:v.isRotationEditable(Z)}:I,P._6I=P._81o()}return P._6I},_3O:function(){},getPosition:function(){return Lg},_68o:function(A,E){A&&this._87I.add(nc(A,E))},_81o:function(){var e=this,f=e.s;e._24O(Ko,"getLabel"),e._24O(ir,"getLabel2"),e._26O(Ub,"getNote"),e._26O(tp,"getNote2"),e._15O(),e._55O&&e._48O();var d;if(e._87I.each(function(p){d=Tr(d,p)}),d&&e.isShadowed()){var B=Tm(d);B.x+=f("shadow.offset.x"),B.y+=f("shadow.offset.y"),Bs(B,f("shadow.blur")),d=Tr(d,B)}return e._87I.clear(),d},_42:function(O){var k=this,H=k._data,F=k.gv,J=k.s,c=J("opacity"),$=this.isShadowed();if($){var m=O.shadowOffsetX,u=O.shadowOffsetY,C=O.shadowBlur,p=O.shadowColor,D=F.getZoom();O.shadowOffsetX=J("shadow.offset.x")*D,O.shadowOffsetY=J("shadow.offset.y")*D,O.shadowBlur=J("shadow.blur")*D,O.shadowColor=k.getSelectColor()}if(c!=I){var B=O.globalAlpha;O.globalAlpha=c}k._80o(O),F.isLabelVisible(H)&&((!F._drawForChecking||J("label.selectable"))&&Qm(O,k.labelInfo),(!F._drawForChecking||J("label2.selectable"))&&Qm(O,k.label2Info)),F.isNoteVisible(H)&&(_l(O,k.noteInfo),_l(O,k.note2Info)),k._99O(O),c!=I&&(O.globalAlpha=B),$&&(O.shadowOffsetX=m,O.shadowOffsetY=u,O.shadowBlur=C,O.shadowColor=p)},_80o:function(){},_47O:function(){},_24O:function($,s){var y=this,q=y._data,i=y.gv,e=y.s,z=i[s](q);if(z!=I){var c=e($+".scale"),n=e($+".max"),a=e($+".position"),d=y[$+"Info"]={label:z,scale:c,color:i[s+"Color"](q),font:e($+".font"),opacity:e($+".opacity"),align:e($+".align"),rotation:y.getRotation(e($+".rotation"),!1,a),background:i[s+"Background"](q)},w=js(d,z);n>0&&n<w.width&&(d.labelWidth=w.width,w.width=n),1!==c&&(w.width*=c,w.height*=c);var p=y.getPosition(a,e($+".offset.x"),e($+".offset.y"),w,e($+".position.fixed"));if(w.x=p.x-w.width/2,w.y=p.y-w.height/2,y._68o(d.rect=w,d.rotation),1!==c){var B=w.width/c,P=w.height/c;d.rect={x:p.x-B/2,y:p.y-P/2,width:B,height:P}}}},_26O:function(m,t){var Z=this,G=Z.gv,M=Z._data,c=Z.s,R=G[t](M);if(R!=I){var k,g,C=c(m+".scale"),w=Z[m+"Info"]={note:R,scale:C,data:M,view:G,expanded:c(m+".expanded"),font:c(m+".font"),color:c(m+".color"),opacity:c(m+".opacity"),align:c(m+".align"),icon:c(m+".icon"),backgroundImage:c(m+".backgroundImage"),borderWidth:c(m+".border.width"),borderColor:c(m+".border.color"),background:G[t+"Background"](M)},e=Z.getPosition(c(m+".position"),c(m+".offset.x"),c(m+".offset.y")),$=e.x,V=e.y;if(w.expanded){var y,Q=c(m+".max"),O=c(m+".backgroundImage");O?(O=wc(O),y={width:Rn(O,M),height:si(O,M)}):y=js(w,R),y.width+=6,y.height+=2,Q>0&&Q<y.width&&(w.labelWidth=y.width,y.width=Q),k=y.width,g=y.height+8,w.clickRect={x:$-k*C/2,y:V-g*C,width:k*C,height:g*C*y.height/g}}else{var B=c(m+".icon");B?(B=wc(B),k=Rn(B,M),g=si(B,M)):(k=12,g=18),w.clickRect={x:$-k*C/2,y:V-g*C,width:k*C,height:g*C}}w.rect={x:$-k/2,y:V-g*C/2-g/2,width:k,height:g};var v=h(w.borderWidth/2)*C;Z._68o({x:$-k*C/2-v,y:V-g*C-v,width:k*C+2*v,height:g*C+2*v})}},_48O:function(){},_99O:function(W){var x=this,Y=x._38o;if(Y){var N=x.gv,y=x._data,F=Y.icons,t=x.interactiveInfo;t&&(t._38o={});for(var J in F){var d=F[J],A=Y.rects[J];if(A){t&&(t._38o[J]=[]);var k=Tq(d.opacity,y,N),i=Tq(d.names,y,N),C=i?i.length:0,r=A.rotation;if(k!=I){var u=W.globalAlpha;W.globalAlpha*=k}for(var h=0;C>h;h++){var K=i[h],E=wc(K),z=A[h];if(r){var e=z.x+z.width/2,L=z.y+z.height/2;W.save(),Uf(W,e,L),Fq(W,r),Uf(W,-e,-L)}t&&t._38o[J].push(W.interactiveInfo={compInfos:[],matrix:r?new Kj(r,e,L).appendTranslate(-e,-L):new Kj}),Do(W,E,Tq(d.stretch,y,N),z.x,z.y,z.width,z.height,x._data,x.gv),W.interactiveInfo=I,r&&W.restore()}k!=I&&(W.globalAlpha=u)}}}}});var vm=function(I,P){lp(vm,this,[I,P])};lf(vm,rm,{_checkEmptyRect:!0,_40O:function(B,x){var m=this,M=m.s,N=B.rect;(B.borderColor=m.gv.getBorderColor(m._data))&&(B.borderType=M("border.type"),B.borderWidth=M("border.width"),B.borderPadding=M("border.padding"),x=K(x,B.borderPadding+B.borderWidth/2));var u=m._data.getScale(),R=K(1,K(f(u.x),f(u.y)));if(B.selectWidth=m.getSelectWidth()){var J=m.gv._zoom;B.selectType=M("select.type"),B._97o=m.getSelectColor(),B.selectPadding=M("select.padding"),x=K(x,(B.selectPadding+B.selectWidth/2/J)/R)}x>0&&(x*=R,N=Tm(N),Bs(N,x)),m._68o(N)},_39O:function(K,y){var _,v=this,H=y.rect;if(y.borderWidth>0&&(_=y.borderPadding,K.strokeStyle=y.borderColor,K.lineWidth=y.borderWidth,Om(K,y.borderType,{x:H.x-_,y:H.y-_,width:H.width+2*_,height:H.height+2*_}),K.stroke()),y.selectWidth>0){var R=v.gv._zoom;if(_=y.selectPadding,K.strokeStyle=y._97o,K.lineWidth=y.selectWidth/R,y.rotation!=I){K.save(),K.translate(y.position.x,y.position.y),K.rotate(y.rotation);var g=v._data,s=g.getWidth(),n=g.getHeight(),o=y.scale,P=y.anchor;H={x:o.x*-s*P.x,y:o.y*-n*P.y,width:o.x*s,height:o.y*n}}Om(K,y.selectType,{x:H.x-_,y:H.y-_,width:H.width+2*_,height:H.height+2*_}),y.rotation!=I&&K.restore(),K.stroke()}},dispose:function(){var Q=this,W=Q._htmlView;vm.superClass._3O.call(Q),W&&(W.onHTMLRemoved&&W.onHTMLRemoved(),gg(W))},_3O:function(){var t=this,r=t.s,c=t._data,h=t.gv,J=c.getStyle(Be),F=t.getBodyColor(),_=t._83o=J?{shape:J,_53o:t.getBodyColor("shape.background"),_27Q:wc(r("shape.repeat.image"),F),shapeGradientPack:r("shape.gradient.pack"),_54o:r("shape.border.width"),_55o:r("shape.border.color"),_56o:r("shape.border.3d"),_57o:r("shape.border.3d.color"),_58o:r("shape.border.3d.accuracy"),shapeGradient:r("shape.gradient"),_59o:r("shape.gradient.color"),_60o:r("shape.border.pattern"),_61o:r("shape.border.cap"),_62o:r("shape.border.join"),shapeForeground:r("shape.foreground"),bodyColor:F}:{img:wc(h.getImage(c),F),bodyColor:F,stretch:r("image.stretch")};if(k&&!P);else{var w,v=_.img;v&&v.renderHTML?(t._htmlInfo&&t._htmlInfo.img!==v&&(t._htmlInfo=I),t._htmlInfo||(t._htmlInfo={img:v,cache:{}}),w=v.renderHTML(c,h,t._htmlInfo.cache)):t._htmlInfo=I,t._htmlView&&t._htmlView!==w&&(t._htmlView.onHTMLRemoved&&t._htmlView.onHTMLRemoved(),gg(t._htmlView.getView?t._htmlView.getView():t._htmlView)),(t._htmlView=w)&&h.appendHTML(w)&&w.onHTMLAdded&&w.onHTMLAdded(),_.rect=c.getRect(),_.position=c.p(),_.scale=c.getScale(),_.anchor=c.getAnchor(),_.rotation=c.getRotation(),J===am&&(_._63o=r("shape.depth"));var S=0;if(J)S=Yq(I,_._54o/2,_._62o),t.s("shape.dash")&&(S=K(S,(t.s("shape.dash.width")||_._54o)/2));else if(v&&v.boundExtend)if(S=Tq(v.boundExtend,c,h),v.boundExtendAbsolute){var Z=c.getScale();S/=h._zoom*K(1,K(f(Z.x),f(Z.y)))}else if(!Tq(v.fitSize,c,h)){var L=Tq(v.width,c,h),z=Tq(v.height,c,h);S*=K(c.getWidth()/L,c.getHeight()/z)}t._40O(_,S);var $=r("clip.percentage");if(1>$&&(0>$&&($=0),_.clipRect=bc(c.getAnchorRect(),r("clip.direction"),$)),J){var x=r("shape.fill.clip.percentage");1>x&&(0>x&&(x=0),_.shapeClipRect=bc(c.getAnchorRect(),r("shape.fill.clip.direction"),x));var G=r("shape.foreground.clip.percentage");1>G&&(0>G&&(G=0),_.shapeForegroundClipRect=bc(c.getAnchorRect(),r("shape.foreground.clip.direction"),G))}}},getPosition:function(N,_,l,b){var q=ed(N,this._83o.rect,b);return q.x+=_,q.y+=l,q},_80o:function(X){var P=this,D=P.s,t=P.gv,R=P._data,K=P._83o,p=K.rect,i=K.position,B=K.rotation,E=K.anchor,Z=K.scale,e=K.shape,U=K.clipRect;if(!P._checkEmptyRect||p.width>0&&p.height>0){var Y=R.getSize();if(Y.x=-Y.width*E.x,Y.y=-Y.height*E.y,X.save(),Uf(X,i.x,i.y),Fq(X,B),mn(X,Z.x,Z.y),U&&(X.beginPath(),X.rect(U.x,U.y,U.width,U.height),X.clip()),t._drawForChecking&&K.img&&Tq(K.img.pixelPerfect,R,t)===!1)Uc(X,Y.x,Y.y,Y.width,Y.height,"#888888");else if(P.freeDraw)P.freeDraw(X,Y,K);else if(e){var N,v,F,H,f=K._60o,w=Aq(X,f),x=K._53o,C=K._27Q,A=K._54o,L=K._55o,n=K.shapeGradientPack,S=X.lineJoin,m=X.lineCap;if("roundRect"===e?N=D("shape.corner.radius"):"polygon"===e?N=D("shape.polygon.side"):"arc"===e&&(N=D("shape.arc.from"),v=D("shape.arc.to"),F=D("shape.arc.close"),H=D("shape.arc.oval")),X.lineJoin=K._62o,X.lineCap=K._61o,x||C||n){var q=K.shapeClipRect;q&&(X.save(),X.beginPath(),X.rect(q.x,q.y,q.width,q.height),X.clip()),Om(X,e,Y,N,v,F,H),n?Ol(X,n):C?Oc(X,C,K.bodyColor,null,R,t):Gq(X,x,K.shapeGradient,K._59o,Y),X.fill(),q&&X.restore(),n&&X.restore(),X!==w&&Om(w,e,Y,N,v,F,H)}else Om(w,e,Y,N,v,F,H);var g=K.shapeForeground;if(g){X.save();var W=K.shapeForegroundClipRect;W&&(X.beginPath(),X.rect(W.x,W.y,W.width,W.height),X.clip()),Om(X,e,Y,N,v,F,H),Gq(X,g,D("shape.foreground.gradient"),D("shape.foreground.gradient.color"),Y),X.fill(),X.restore()}if(A>0){var r=D("shape.border.width.absolute");r&&(X.save(),X.setTransform(1,0,0,1,0,0)),X.lineWidth=A,X.strokeStyle=L,X.stroke(),r&&X.restore(),K._56o&&jn(X,L,K._57o,A,t._zoom,K._58o)}if(tr(X,f),D("shape.dash")){var s=D("shape.dash.width")||A;if(s>0){f=D("shape.dash.pattern");var w=Aq(X,f,P._2Q("shape.dash.offset"));w!==X&&Om(w,e,Y,N,v,F,H),P._1Q(X,"shape",s,f)}}Mk(X,x,K._63o,Y),X.lineJoin=S,X.lineCap=m}else{var $=P.interactiveInfo;$&&(X.interactiveInfo=$.bodyInfo={compInfos:[],matrix:new Kj(B,i.x,i.y,Z.x,Z.y)}),Do(X,K.img,K.stretch,Y.x,Y.y,Y.width,Y.height,R,t,K.bodyColor),X.interactiveInfo=I}X.restore()}P._39O(X,K)},_48O:function(){},_47O:function(){}});var Rg=function(I,C){lp(Rg,this,[I,C])},Dj=function(e,Z,d,I){var j=cd(e,Z);return d=I?m(d,j):bs(d,j),j?d/=j:d=0,{x:e.x+(Z.x-e.x)*d,y:e.y+(Z.y-e.y)*d}};lf(Rg,rm,{_3O:function(){var o,g=this,v=g._data,U=g.gv,w=g.s,D=w(pj),x=v.isLooped(),k=w("edge.width"),W=w("edge.center"),d=w("edge.offset"),m=U.getBorderColor(v),j=m?w("border.width"):0,F=g.getSelectWidth(),z=v._40I,h=v._41I,f=g._78o=z&&h?{looped:x,type:D,width:k,center:W,color:g.getBodyColor("edge.color"),borderColor:m,borderWidth:j,_97o:F?g.getSelectColor():I,selectWidth:F,pattern:w("edge.pattern"),cap:w("edge.cap"),join:w("edge.join"),is3d:w("edge.3d"),_67o:w("edge.3d.color"),_66o:w("edge.3d.accuracy")}:I;if(f){var J=C.getEdgeType(D);if(J){var b=J(v,sb(g,U,v,x,D),U,g._19Q);b.points&&b.points.size()>1?(f.edgeTypeInfo=b,o=we(f.edgeTypeInfo.points)):b[sq]&&b.rect&&(f.edgeTypeInfo=b,o=b.rect)}else{var c=w("edge.source.anchor.x"),p=w("edge.source.anchor.y"),A=w("edge.target.anchor.x"),T=w("edge.target.anchor.y"),Q=an(U,z,w("edge.source.position"),w("edge.source.offset.x"),w("edge.source.offset.y"),c,p),G=an(U,h,w("edge.target.position"),w("edge.target.offset.x"),w("edge.target.offset.y"),A,T);if(D===Rl){var t=f.points=w(qn)||ze,O=t.size();f.segments=w("edge.segments");var B=c!==Z||p!==Z,R=A!==Z||T!==Z;if(!W)if(d)B||(Q=Dj(Q,O?t.get(0):G,d,O)),R||(G=Dj(G,O?t.get(O-1):Q,d,O));else{var _;B||(_=Ll(Q,O?t.get(0):G,dp(U,z)),_&&(Q={x:_[0],y:_[1]})),R||(_=Ll(O?t.get(O-1):Q,G,dp(U,h)),_&&(G={x:_[0],y:_[1]}))}o=Tr(we(f.points),we(Q,G))}else{var X=sb(g,U,v,x,D);if(g._19Q||(X=-X),x)Q=Tm(Q),Q.x=U.getNodeRect(z).x,f.radius=X,o={x:Q.x-X,y:Q.y-X,width:2*X,height:2*X};else{var a=cd(Q,G),i=bs(d,a),l={x:i,y:X},V={x:a-i,y:X},e=Y(G.y-Q.y,G.x-Q.x),P=f.mat=new lh(e);if(f.orienAngle=e,f.angle=G.x<Q.x?e+E:e,f.rect={x:l.x,y:l.y,width:V.x-l.x,height:0},f.origin=Q,l=P.tf(l),l.x+=Q.x,l.y+=Q.y,V=P.tf(V),V.x+=Q.x,V.y+=Q.y,W){var s={x:a,y:0};s=P.tf(s),s.x+=Q.x,s.y+=Q.y,o=we([Q,l,V,s]),f.c1=Q,f.c2=s}else o=we(l,V);Q=l,G=V}}f.sourcePoint=Q,f.targetPoint=G,v._lastSourcePoint=Q,v._lastTargetPoint=G}var H=0;w("edge.dash")&&(H=w("edge.dash.width")||k);var r="square"===f.cap?.71:.5;Yq(o,K(H*r,k*r+j+F),f.join),g._68o(o)}},getRotation:function(F,r,i){F=F||0;var e=this._78o;if(e){var g,B=e.angle,N=e.points,U=e.edgeTypeInfo;if(B!=I)return r?e.orienAngle+F:B+F;if(U&&U[sq])return U.getRotation?U.getRotation(this,F,r,i):0;if(U&&U.points){var H=U.points;return g=H.size(),Hb[i]?g&&0===g%2?Gg(H.get(g/2-1),H.get(g/2),r,F):F:Wj[i]?Gg(H.get(0),H.get(1),r,F):Gg(H.get(g-2),H.get(g-1),r,F)}if(N)return g=N.size(),Hb[i]?g&&0===g%2?Gg(N.get(g/2-1),N.get(g/2),r,F):F:Wj[i]?Gg(e.sourcePoint,g?N.get(0):e.targetPoint,r,F):Gg(g?N.get(g-1):e.sourcePoint,e.targetPoint,r,F)}return F},getPosition:function(_,z,s,f,c){var J=this._78o;if(J){var C,U=J.type,Q=J.points,V=J.edgeTypeInfo,K=J.sourcePoint,o=J.targetPoint;if(!U)return J.looped?{x:K.x-J.radius+z,y:K.y+s}:(c&&K&&o&&(K.x>o.x||K.x===o.x&&K.y>o.y)&&(_=xe[_],s=-s),C=ed(_,J.rect,f),C.x+=z,C.y+=s,C=J.mat.tf(C),C.x+=J.origin.x,C.y+=J.origin.y,C);if(V&&V[sq])return V.getPosition?V.getPosition(this,_,z,s,f,c):{x:(K.x+o.x)/2,y:(K.y+o.y)/2};if(Q){var C,e=Q.size();if(Hb[_]){if(e){var T=e%2;if(0===T)return Kg(Q.get(e/2-1),Q.get(e/2),_,z,s,f,c);C=Q.get((e-T)/2)}else C={x:(K.x+o.x)/2,y:(K.y+o.y)/2};return C=ed(_,{x:C.x,y:C.y,width:0,height:0},f),C.x+=z,C.y+=s,C}return Wj[_]?Kg(K,e?Q.get(0):o,_,z,s,f,c):Kg(e?Q.get(e-1):K,o,_,z,s,f,c)}if(V){var O=V.points,e=O.size();if(Hb[_]){var T=e%2;return 0===T?Kg(O.get(e/2-1),O.get(e/2),_,z,s,f,c):(C=O.get((e-T)/2),C=ed(_,{x:C.x,y:C.y,width:0,height:0},f),C.x+=z,C.y+=s,C)
}return Wj[_]?Kg(O.get(0),O.get(1),_,z,s,f,c):Kg(O.get(e-2),O.get(e-1),_,z,s,f,c)}}return Lg},_42:function(j){this._78o&&Rg.superClass._42.call(this,j)},drawPath:function(R,U){R.beginPath();var $=U.type,g=U.points,S=U.segments,u=U.edgeTypeInfo;if(!$||g){var s=U.sourcePoint,W=s.x,Q=s.y,Z=U.targetPoint,F=Z.x,q=Z.y;if($)if(S){var c=new mk({x:W,y:Q});c.addAll(g),c.add({x:F,y:q}),Xd(R,c,S)}else R.moveTo(W,Q),g.each(function(g){R.lineTo(g.x,g.y)}),R.lineTo(F,q);else U.looped?R.arc(W,Q,U.radius,0,i,!0):U.center?(R.moveTo(U.c1.x,U.c1.y),R.lineTo(W,Q),R.lineTo(F,q),R.lineTo(U.c2.x,U.c2.y)):(R.moveTo(W,Q),R.lineTo(F,q))}else u&&(u.points?Xd(R,u.points,u.segments):u[sq]&&u[sq](R,u))},_80o:function(A){var t=this,K=t.s,z=t._78o,u=z.width,o=z.selectWidth,c=z.borderWidth,y=z.color,f=A.lineJoin,k=A.lineCap,O=z.pattern;A.lineJoin=z.join,A.lineCap=z.cap,t.drawPath(Aq(A,O),z);var P=K("edge.width.absolute");if(P&&(A.save(),A.setTransform(1,0,0,1,0,0)),o&&(A.strokeStyle=z._97o,A.lineWidth=u+2*(c+o),A.stroke()),c&&(A.strokeStyle=z.borderColor,A.lineWidth=u+2*c,A.stroke()),A.strokeStyle=y,A.lineWidth=u,A.stroke(),z.is3d&&jn(A,y,z._67o,u,t.gv._zoom,z._66o),P&&A.restore(),tr(A,O),K("edge.dash")){O=K("edge.dash.pattern");var v=Aq(A,O,t._2Q("edge.dash.offset"));v!==A&&t.drawPath(v,z),t._1Q(A,"edge",K("edge.dash.width")||u,O)}A.lineJoin=f,A.lineCap=k},_48O:function(){},_47O:function(){},_71o:function(m,t){var R=this,p=R._data;if(R._19Q=!0,!p.getEdgeGroup())return m?p.s("edge.gap"):0;var o,F=0,h=0,d=0;if(p.getEdgeGroup().getSiblings().each(function(U){U.each(function(O){if(R.gv.isVisible(O)&&O.s(pj)==t){var T=O.s("edge.gap");o?(h+=d/2+T/2,d=T):(o=O,d=T),O===p&&(F=h)}})}),m)return h-F+d;var P=F-h/2;return o&&p._40I!==o._40I&&(R._19Q=!1),P}});var Hc=function(I,H){lp(Hc,this,[I,H])};lf(Hc,vm,{_3O:function(){var W,h,t=this,T=t.s,g=t._data,O=t.gv;if(t._88I=I,g.isExpanded()&&g.eachChild(function(c){var b=O.getBoundsForGroup(c);b&&(h||(h=[]),h.push(b),W=Tr(W,b))}),W){var w=O.getLabel(g),k=T("group.type");W=$d(k,h,W),Xl(W,g,"group.padding",1);var m=t._88I={type:k,rect:W,_64o:W};if(!k&&w!=I){var U,y=t.labelInfo={label:w,color:T("group.title.color"),font:T("group.title.font"),align:T("group.title.align")},S=js(y,w),X=S.width,E=S.height,i=T("group.title.align"),H=T("group.title.orientation");if((H===Rd||H===Yf)&&X>W.width?W.width=X:(H===_h||H===De)&&X>W.height&&(W.height=X),y.rect={y:W.y-E,width:S.width,height:E},U=i===_h?W.x:i===De?W.x+W.width-X:W.x+W.width/2-X/2,y.rect.x=U,H===Yf)m.titleRect={x:W.x,y:W.y+W.height,width:W.width,height:E},m.rect={x:W.x,y:W.y,width:W.width,height:W.height+E},y.rect={x:U,y:W.y+W.height,width:X,height:E};else if(H===_h){var V=m.titleRect={x:W.x-E,y:W.y,width:E,height:W.height};m.rect={x:W.x-E,y:W.y,width:W.width+E,height:W.height},y.rect={x:V.x+E/2-W.height/2,y:V.y+W.height/2-E/2,width:W.height,height:E},y.rotation=-Math.PI/2}else if(H===De){var V=m.titleRect={x:W.x+W.width,y:W.y,width:E,height:W.height};m.rect={x:W.x,y:W.y,width:W.width+E,height:W.height},y.rect={x:V.x+E/2-W.height/2,y:V.y+W.height/2-E/2,width:W.height,height:E},y.rotation=Math.PI/2}else m.titleRect={x:W.x,y:W.y-E,width:W.width,height:E+1},m.rect={x:W.x,y:W.y-E,width:W.width,height:W.height+E}}t._40O(m,T("group.border.width")/2)}else Hc.superClass._3O.call(t)},getPosition:function(s,v,Q,u){var l=this._88I;if(l){var H=ed(s,l.rect,u);return H.x+=v,H.y+=Q,H}return Hc.superClass.getPosition.apply(this,arguments)},_24O:function(k,t){var o=this._88I;(!o||o.type||"label2"===k)&&Hc.superClass._24O.call(this,k,t)},_80o:function(F){var d=this,k=d._88I;if(k){var I=d._data,$=d.s,w=d.gv,g=k.type,K=k.rect,H=k._64o,a=k.titleRect,s=d.getBodyColor(),j=wc($("group.image"),s),W=$("group.image.stretch"),M=d.getBodyColor("group.background"),t=wc($("group.repeat.image"),s),l=$("group.gradient.pack"),L=$("group.gradient"),E=$("group.gradient.color"),o=$("group.border.width"),T=$("group.border.color"),i=$("group.border.pattern"),P=$("group.title.orientation"),r=$("group.depth");if(g){var R=F.lineJoin,V=F.lineCap;if(F.lineJoin=$("group.border.join"),F.lineCap=$("group.border.cap"),j){if(F.save(),Om(F,g,K),F.clip(),Do(F,j,W,K.x,K.y,K.width,K.height,I,w,s),F.restore(),o>0){var J=Aq(F,i);Om(J,g,K),F.lineWidth=o,F.strokeStyle=T,F.stroke(),tr(F,i)}}else{var J=Aq(F,i);M||t||l?(Om(F,g,K),l?Ol(F,l):t?Oc(F,t,s,null,I,w):Gq(F,M,L,E,K),F.fill(),l&&F.restore(),F!==J&&Om(J,g,K)):Om(J,g,K),o>0&&(F.lineWidth=o,F.strokeStyle=$("group.border.color"),F.stroke()),tr(F,i),g===am&&Mk(F,M,r,K)}F.lineJoin=R,F.lineCap=V}else{var O=$("group.title.background"),Q=$("group.border.radius");if(j)Do(F,j,W,H.x,H.y,H.width,H.height,I,w,d.getBodyColor());else if(M||t)if(t?Oc(F,t,s,null,I,w):Gq(F,M,L,E,H),0===o)Om(F,am,H),F.fill(),Mk(F,M,r,H);else{switch(F.beginPath(),P){case Yf:fl(F,H.x,H.y,H.width,H.height,Q,Q,0,0);break;case _h:fl(F,H.x,H.y,H.width,H.height,0,Q,0,Q);break;case De:fl(F,H.x,H.y,H.width,H.height,Q,0,Q,0);break;case Rd:fl(F,H.x,H.y,H.width,H.height,0,0,Q,Q)}F.fill()}if(a&&O)if(0===o)Uc(F,a.x,a.y,a.width,a.height,O),Mk(F,O,r,a);else{switch(F.beginPath(),F.fillStyle=O,P){case Yf:fl(F,a.x,a.y,a.width,a.height,0,0,Q,Q);break;case _h:fl(F,a.x,a.y,a.width,a.height,Q,0,Q,0);break;case De:fl(F,a.x,a.y,a.width,a.height,0,Q,0,Q);break;case Rd:fl(F,a.x,a.y,a.width,a.height,Q,Q,0,0)}F.fill()}if(o>0){var J=Aq(F,i);if(Om(J,"roundRect",K,Q),F.lineWidth=o,F.strokeStyle=T,a&&$("group.splitLine")){var y=a.x,n=a.y,D=a.width,u=a.height;P===Yf?(F.moveTo(y,n),F.lineTo(y+D,n)):P===_h?(F.moveTo(y+D,n),F.lineTo(y+D,n+u)):P===De?(F.moveTo(y,n),F.lineTo(y,n+u)):(F.moveTo(y,n+u),F.lineTo(y+D,n+u))}F.stroke(),tr(F,i)}}d._39O(F,k)}else Hc.superClass._80o.call(d,F)}});var Fd=function(K,o){lp(Fd,this,[K,o])};lf(Fd,vm,{_80o:function(L){this._39O(L,this._83o)}});var Ym=function(E,L){lp(Ym,this,[E,L])};lf(Ym,vm,{_3O:function(){var N=this,x=N._data,w=N.s,Q=N.gv,v=x.getPoints(),Y=Q.getBorderColor(x),T=Y?w("border.width"):0,i=N.getSelectWidth(),t=w("shape.border.width"),X=x.getRect(),n=Q.getBodyColor(x),p=N._99o=v.isEmpty()?I:{rect:X,rotation:x.getRotation(),fillRule:w("shape.fill.rule"),scale:x.getScale(),position:x.p(),points:v,segments:x.getSegments(),bodyColor:n,borderColor:Y,borderWidth:T,_94o:w("shape.border.3d"),_95o:w("shape.border.3d.color"),_96o:w("shape.border.3d.accuracy"),_97o:i?N.getSelectColor():I,selectWidth:i,_53o:w("shape.background"),_27Q:wc(w("shape.repeat.image"),n),shapeGradientPack:w("shape.gradient.pack"),_54o:t,_55o:w("shape.border.color"),shapeGradient:w("shape.gradient"),_59o:w("shape.gradient.color"),_60o:w("shape.border.pattern"),_61o:w("shape.border.cap"),_62o:w("shape.border.join"),shapeForeground:w("shape.foreground")};if(p){var M=x.getScale(),e=K(1,K(f(M.x),f(M.y)));w("shape.dash")&&w("shape.dash.width")>t&&(t=w("shape.dash.width"));var s=t*("square"===p._61o?.71:.5)+T+i/N.gv._zoom/e;s&&(s*=e,X=Tm(X),Yq(X,s,p._62o)),N._68o(X);var W=w("clip.percentage");1>W&&(0>W&&(W=0),p.clipRect=bc(x.getAnchorRect(),w("clip.direction"),W));var L=w("shape.fill.clip.percentage");1>L&&(0>L&&(L=0),p.shapeClipRect=bc(x.getAnchorRect(),w("shape.fill.clip.direction"),L));var C=w("shape.foreground.clip.percentage");1>C&&(0>C&&(C=0),p.shapeForegroundClipRect=bc(x.getAnchorRect(),w("shape.foreground.clip.direction"),C))}},getPosition:function(M,o,x,X){var D=this._99o;if(D){var S=ed(M,D.rect,X);return S.x+=o,S.y+=x,S}return Lg},_42:function(h){this._99o&&Ym.superClass._42.call(this,h)},_80o:function(p){var x,A=this,o=A.s,H=A._99o,W=H.position,$=H.scale,l=H.rotation,I=H.bodyColor,L=H.borderWidth,G=H.selectWidth/A.gv._zoom,Y=H._53o,j=H._27Q,g=H.shapeGradientPack,M=H._54o,K=H.clipRect,w=H.shapeClipRect,e=H.points,r=H.segments,R=A._data.isClosePath(),h=H.fillRule,n=Y||j||g;p.save(),Uf(p,W.x,W.y),Fq(p,l),mn(p,$.x,$.y),K&&(p.beginPath(),p.rect(K.x,K.y,K.width,K.height),p.clip()),n&&w&&(p.save(),p.beginPath(),p.rect(w.x,w.y,w.width,w.height),p.clip()),Uf(p,-W.x,-W.y);var T=H._60o,J=Aq(p,T),k=p.lineJoin,s=p.lineCap;p.lineJoin=H._62o,p.lineCap=H._61o,n?(Xd(p,e,r,R),g?Ol(p,g):j?Oc(p,j,I,null,A._data,A.gv):(x=I?I:Y,Gq(p,x,H.shapeGradient,H._59o,H.rect)),p.fill(h),w&&(p.restore(),Uf(p,-W.x,-W.y)),g&&p.restore(),J!==p&&Xd(J,e,r,R)):Xd(J,e,r,R);var X=H.shapeForeground;if(X){p.save();var m=H.shapeForegroundClipRect;m&&(Uf(p,W.x,W.y),p.beginPath(),p.rect(m.x,m.y,m.width,m.height),p.clip(),Uf(p,-W.x,-W.y)),Xd(p,e,r,R),Gq(p,X,o("shape.foreground.gradient"),o("shape.foreground.gradient.color"),H.rect),p.fill(h),p.restore()}var V=o("shape.border.width.absolute");if(V&&(p.save(),p.setTransform(1,0,0,1,0,0)),G&&(p.strokeStyle=H._97o,p.lineWidth=M+2*(L+G),p.stroke()),L&&(p.strokeStyle=H.borderColor,p.lineWidth=M+2*L,p.stroke()),M&&(x=H._55o,!Y&&I&&(x=I),p.strokeStyle=x,p.lineWidth=M,p.stroke(),H._94o&&jn(p,x,H._95o,M,A.gv._zoom,H._96o)),V&&p.restore(),tr(p,T),o("shape.dash")){var C=o("shape.dash.width")||M;if(C>0){T=o("shape.dash.pattern");var J=Aq(p,T,A._2Q("shape.dash.offset"));J!==p&&Xd(J,e,r,R),A._1Q(p,"shape",C,T)}}p.lineJoin=k,p.lineCap=s,p.restore()},_48O:function(){},_47O:function(){}});var tk=function(V,s){lp(tk,this,[V,s])};lf(tk,Ym,{getRotation:function(z,P,l){z=z||0;var o=this._data.getPoints(),V=o.size();return V>1?Hb[l]?V&&0===V%2?Gg(o.get(V/2-1),o.get(V/2),P,z):z:Wj[l]?Gg(o.get(0),o.get(1),P,z):Gg(o.get(V-2),o.get(V-1),P,z):z},getPosition:function(g,Z,p,P,J){var i=this._data.getPoints(),w=i.size();if(w>1){if(Hb[g]){var y=w%2;if(0===y)return Kg(i.get(w/2-1),i.get(w/2),g,Z,p,P,J);var L=i.get((w-y)/2),D={x:L.x,y:L.y,width:0,height:0};return L=ed(g,D,P),L.x+=Z,L.y+=p,L}return Wj[g]?Kg(i.get(0),i.get(1),g,Z,p,P,J):Kg(i.get(w-2),i.get(w-1),g,Z,p,P,J)}return Lg}});var _k=function(C,b){lp(_k,this,[C,b])};lf(_k,vm,{_3O:function(){var H=this;_k.superClass._3O.call(H);var h=H.s,g=H._83o;H._82o=g.img||g.shape?I:{background:H.getBodyColor("grid.background"),depth:h("grid.depth"),rect:g.rect,_88o:h("grid.cell.depth"),cellBorderColor:h("grid.cell.border.color"),_89o:h("grid.row.count"),_90o:h("grid.column.count"),block:h("grid.block"),_91o:h("grid.block.color"),_92o:h("grid.block.padding"),_93o:h("grid.block.width")}},_80o:function(D){var u=this,j=u._82o;if(!j)return _k.superClass._80o.call(u,D),void 0;var q,b,n=u._data,J=j.background,M=j.rect,E=j.block,d=j._91o,e=j._92o,V=j._93o,i=j._88o,Q=j.cellBorderColor,w=j._89o,R=j._90o;if(J)if(Uc(D,M.x,M.y,M.width,M.height,J),Mk(D,J,j.depth,M),i)for(q=0;w>q;q++)for(b=0;R>b;b++)M=n.getCellRect(q,b),M&&Mk(D,J,i,M);else if(Q){for(D.beginPath(),q=0;w>q;q++)for(b=0;R>b;b++)M=n.getCellRect(q,b),M&&D.rect(M.x,M.y,M.width,M.height);D.strokeStyle=Q,D.lineWidth=1,D.stroke()}if("h"===E)for(q=0;w>q;q++)M=Tr(n.getCellRect(q,0),n.getCellRect(q,R-1)),Bs(M,e),Qe(D,d,M.x,M.y,M.width,M.height,V);else if("v"===E)for(b=0;R>b;b++)M=Tr(n.getCellRect(0,b),n.getCellRect(w-1,b)),Bs(M,e),Qe(D,d,M.x,M.y,M.width,M.height,V);u._39O(D,u._83o)}});var bb=function(e,M){lp(bb,this,[e,M])};lf(bb,vm,{_checkEmptyRect:!1,_81o:function(){var f=this._data,b=bb.superClass._81o.call(this),m=f.s("text");if(m!=I){var A,G,s=f.s("text.font"),V=f.s("text.align"),l=f.s("text.vAlign"),j=ho(s,m),y=j.width,Y=j.height,R=f.getAnchor(),t=f.getWidth(),H=f.getHeight();"left"===V?A=-t*R.x:"center"===V?A=-t*R.x+(t-y)/2:"right"===V&&(A=t*(1-R.x)-j.width),"top"===l?G=-H*R.y:"middle"===l?G=-H*R.y+(H-Y)/2:"bottom"===l&&(G=H*(1-R.y)-j.height);var q,X=f.getMatrix();if(q=we([X.tf(A,G),X.tf(A+y,G),X.tf(A+y,G+Y),X.tf(A,G+Y)]),b=Tr(b,q),b&&f.s("text.shadow")){var L=Tm(b);L.x+=f.s("text.shadow.offset.x"),L.y+=f.s("text.shadow.offset.y"),Bs(L,f.s("text.shadow.blur")),b=Tr(b,L)}}return b}});var Ci=dn.Interactor=function(g){this.gv=this._graphView=g};Ne("Interactor",V,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(q){this.gv.fi(q)},setCursor:function(B){Xm||this.gv.setCursor(B)},startDragging:function(v){var K=this;K._lastClientPoint=ad(v),K._lastLogicalPoint=K.gv.lp(v),Bf(K,v)},clearDragging:function(){var e=this;e._lastClientPoint=e._lastLogicalPoint=e._logicalPoint=I},autoScroll:function(J){return this.gv.autoScroll(J,this._lastClientPoint)}});var Gf=I,Ik=function(H){Gf.handleWindowTouchMove(H)},nd=function(r){Gf.handleWindowTouchEnd(r),_.removeEventListener(xr,Ik,q),_.removeEventListener(pg,nd,q),Gf=I},Rr=function(Q){Gf.handleWindowMouseMove(Q)},wj=function(U){Gf.handleWindowMouseUp(U),_.removeEventListener(Wr,Rr,q),_.removeEventListener(Fj,wj,q),Gf=I},Zn=function(T,D){T!==Gf&&(Gf?Xm?Gf.handleWindowTouchEnd(D):Gf.handleWindowMouseUp(D):Xm?(_.addEventListener(xr,Ik,q),_.addEventListener(pg,nd,q)):(_.addEventListener(Wr,Rr,q),_.addEventListener(Fj,wj,q)),Gf=T)},Lb=function(F){var u=this;u.gv=F,u._is2d=F instanceof dn.GraphView,u._is2d&&(u.filter=function(k){return F.isSelectable(k)&&F.isInteractive(k)}),F.getView(),["mousedown","mousemove","touchstart","touchmove",bl].forEach(function(q){u.addListener(q)}),u.initImageResource()};lf(Lb,Ci,{enableVR:function(W){var h=this;if(!!h._vrEnable!==W)if(h._vrEnable=W,W)h.gv.vr.mp(h.onVRControllerChange,h);else if(h.gv.vr.ump(h.onVRControllerChange,h),h._vrRayPolyline){var x=h.gv.dm();x.remove(h._vrRayPolyline),x.remove(h._vrRayHitPoint),h._vrRayPolyline=Z,h._vrRayHitPoint=Z}},onVRControllerChange:function(I){var w=this,g=I.property,E=I.newValue,q=w.gv.vr.getController(E.id),u=q.getRay();u&&("gamepad.button.trigger"===g?"down"===E._62O?w.handle_mousedown(u):w.handleWindowUp(u):"gamepad.pose"===g&&(w.handle_mousemove(u),w.handleWindowMove(u)))},drawVRRay:function(v,k,z){var M,Q=this,N=Q.gv,w=Q._vrRayPolyline,X=!1;if(w)M=Q._vrRayHitPoint;else{var h=N.dm();Q._vrRayPolyline=w=new o.Polyline,Q._vrRayHitPoint=M=new o.Node,M.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),M.setAnchor3d(.5,.5,.499);var U=.2/N.vr.measureOflength;M.s3(U,U,U),w.s("intersect",!1),M.s("intersect",!1),h.add(w),h.add(M),X=!0}if(k){var B=z.world,i=z.worldNormal,C=B.x,A=B.y,K=B.z;w.s("shape.border.color","red"),w.setPoints([{x:v.origin.x,y:v.origin.z,e:v.origin.y},{x:C,y:K,e:A}]),M.s("3d.visible",!0),M.p3(C,A,K),M.lookAtDirection([i.x,i.y,i.z],"front")}else{w.s("shape.border.color","blue");var G=new o.Math.Vector3;G.copy(v.direction).setLength(1e3/Q.gv.vr.measureOflength).add(v.origin),w.setPoints([{x:v.origin.x,y:v.origin.z,e:v.origin.y},{x:G.x,y:G.z,e:G.y}]),M.s("3d.visible",!1)}N.fi({kind:"vrRayIntersect",ray:v,data:k,intersect:z,polyline:w,hitNode:M,begin:X})},addListener:function($){var E=this;E.gv.getView().addEventListener($,function(O){C.preventDefault(O),E.disabled||E["handle_"+$](O)},q)},handleWindowTouchMove:function(F){this.handleWindowMouseMove(F)},handleWindowMouseMove:function(v){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",v):(this.handleDownInfo("onBeginDrag",v),this.isDragging=!0))},handleWindowTouchEnd:function(O){this.handleWindowMouseUp(O)},handleWindowMouseUp:function(F){if(this.isDragging&&(this.handleDownInfo("onEndDrag",F),this.isDragging=!1),this.downInfo){var U=this.handle("onUp",F);U&&U.data===this.downInfo.data?this.handleMissingUp(F):this.handleDownInfo("onUp",F),this.downInfo=I}},handle_mousewheel:function(e){e.scrollDelta=e.wheelDelta/40,this.handle("onScroll",e)},handle_DOMMouseScroll:function(F){F.scrollDelta=2===F.axis?-F.detail:0,this.handle("onScroll",F)},handle_touchstart:function(U){this.handle_mousedown(U)},handle_touchmove:function(R){this.handle("onMove",R)},handle_mousedown:function(K){this.isDragging&&(this.handleDownInfo("onEndDrag",K),this.isDragging=!1),this.downInfo=this.handle("onDown",K),this.downInfo&&Zn(this,K)},handle_mousemove:function(Y){var A=this,X=A.gv;A._hoverTimer&&(H(A._hoverTimer),delete A._hoverTimer);var d,e,v,h=A.handle("onMove",Y),N=this.currentInfo?this.currentInfo.data:I,Z=this.currentInfo?this.currentInfo.hits:I;if(h&&(e=h.data,v=h.hits,A._hoverTimer=w(function(){H(A._hoverTimer),delete A._hoverTimer,A.handle("onHover",Y,h)},X.getHoverDelay()||C.hoverDelay)),e!==N){if(e&&(e.s("onEnter")&&e.s("onEnter")(Y,e,X),this.fire("data","onEnter",Y,e)),N&&(N.s("onLeave")&&N.s("onLeave")(Y,N,X),this.fire("data","onLeave",Y,N)),Z)for(d in Z)this.handleLeave(Y,d);if(v)for(d in v){var i=v[d];i.target.onEnter&&i.target.onEnter(Y,e,X,i.point,i.width,i.height),this.fire(i.type,"onEnter",i.event,i.data,i.image,i.comp,i.point,i)}}else{if(Z)for(d in Z)v&&v[d]||this.handleLeave(Y,d);if(v)for(d in v)if(!Z||!Z[d]){var i=v[d];i.target.onEnter&&i.target.onEnter(Y,e,X,i.point,i.width,i.height),this.fire(i.type,"onEnter",i.event,i.data,i.image,i.comp,i.point,i)}}this.currentInfo=h},handle:function(z,J,O){var b,P=this,l=P.gv;if(P._is2d){if(O=O||l.getDataInfoAt(J,this.filter),!O)return;if(b=O.ui.interactiveInfo){var L,U=O.data;if(U.s(z)&&U.s(z)(J,U,l),this.fire("data",z,J,U),"body"===O.part&&b.bodyInfo)L="body",O.hits=this.handleImage(L,l.getImage(U),z,J,U,O.point,b.bodyInfo);else if("icons"===O.part&&b._38o){var I=b._38o[O.name];I&&I[O.index]&&(L="icons|"+O.name+"|"+O.index,O.hits=this.handleImage(L,O.icon,z,J,U,O.point,I[O.index]))}}return O}var U,K;if(!O)if(J&&J instanceof o.Math.Ray){var w=l.vr.intersectWorld(J);if(U=w.data,K=w.intersect,P.drawVRRay(J,U,K),!U)return;var N=l.getData3dUI(U);if(b=N.interactiveInfo,!b)return;O={data:U,part:K.part,ui:N}}else{if(O=l.getDataInfoAt(J),!O)return;O&&(O={data:O.data,part:O.part})}if(!K){U=O.data;var N=l.getData3dUI(U);if(O.ui=N,b=N.interactiveInfo,!b)return O;if(K=l.intersectObject(J,U),!K)return}U.s(z)&&U.s(z)(J,U,l),this.fire("data",z,J,U);var n,p=K.part;return"body"!==p&&(n=U.s(p+".image")||U.s("shape3d."+p+".image")),n||(n=U.s("all.image")||U.s("shape3d.image")),(b=b[n])?(O.part="body",O.interactiveInfo=b,O.point=K.uv.multiply({x:b.bodyInfo.rect.width,y:b.bodyInfo.rect.height}),O.image=n,O.hits=this.handleImage("body",n,z,J,U,O.point,b.bodyInfo),O):void 0},_handleLeaveOrMissing:function(l,r,I){var x="leave"===l?this.currentInfo:this.downInfo;if(x){var o=x.interactiveInfo||x.ui.interactiveInfo;if(o){var J,c,P=x.data;if(this._is2d){if(c=this.gv.lp(r),"body"===x.part&&o.bodyInfo)J="body","leave"===l?this.handleLeaveImage(I,J,this.gv.getImage(P),r,P,c,o.bodyInfo):this.handleMissingUpImage(J,this.gv.getImage(P),r,P,c,o.bodyInfo);else if("icons"===x.part&&o._38o){var E=o._38o[x.name];E&&E[x.index]&&(J="icons|"+x.name+"|"+x.index,"leave"===l?this.handleLeaveImage(I,J,x.icon,r,P,c,E[x.index]):this.handleMissingUpImage(J,x.icon,r,P,c,E[x.index]))}}else{var W=this.gv.intersectObject(r,P);c=W?W.uv.multiply({x:o.bodyInfo.rect.width,y:o.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===l?this.handleLeaveImage(I,"body",x.image,r,P,c,o.bodyInfo):this.handleMissingUpImage("body",x.image,r,P,c,o.bodyInfo)}}}},handleDownInfo:function(H,v){if(this.downInfo){var k=this.downInfo,F=this.gv,z=k.interactiveInfo||k.ui.interactiveInfo;if(z){var U,d=k.data;if(d.s(H)&&d.s(H)(v,d,F),this.fire("data",H,v,d),this._is2d){var p=F.lp(v);if("body"===k.part&&z.bodyInfo)U="body",this.handleDownInfoImage(U,F.getImage(d),H,v,d,p,z.bodyInfo);else if("icons"===k.part&&z._38o){var V=z._38o[k.name];V&&V[k.index]&&(U="icons|"+k.name+"|"+k.index,this.handleDownInfoImage(U,k.icon,H,v,d,p,V[k.index]))}}else{var q=F.intersectObject(v,d);if(!q)return;p=q.uv.multiply({x:z.bodyInfo.rect.width,y:z.bodyInfo.rect.height}),this.handleDownInfoImage("body",k.image,H,v,d,p,z.bodyInfo)}}}},fire:function(X,x,r,f,j,U,u,J){this.gv.fi({kind:x,type:X,event:r,data:f,image:j,comp:U,view:this.gv,point:u,width:J?J.width:Z,height:J?J.height:Z})},handleImage:function(a,K,n,A,u,J,E){var S={};if(K&&(K=wc(K))){var h=this.gv,z=E.rect,d=this.convertPoint(J,E);d.inRect&&(K[n]&&K[n](A,u,h,d,z.width,z.height),this.fire("image",n,A,u,K,Z,d,z),S[a+"|image"]={target:K,type:"image",image:K,data:u,event:A,point:d,width:z.width,height:z.height});for(var $=E.compInfos,R=K,T=$.length-1;T>=0;T--){var s=$[T],w=s.comp;d=this.convertPoint(J,s,R,w,h,u),d.inRect&&(z=s.rect,w[n]&&w[n](A,u,h,d,z.width,z.height),this.fire("comp",n,A,u,K,w,d,z),(K=z.image)&&(K[n]&&K[n](A,u,h,d,z.width,z.height),this.fire("image",n,A,u,K,Z,d,z)),S[a+"|"+T]={target:w,type:"comp",comp:w,image:K,data:u,event:A,point:d,width:z.width,height:z.height},K&&(S[a+"|"+T+"|image"]={target:K,type:"image",image:K,data:u,event:A,point:d,width:z.width,height:z.height}))}}return S},handleLeave:function(S,A){return this._handleLeaveOrMissing("leave",S,A)},handleMissingUp:function(X){return this._handleLeaveOrMissing("missing",X)},handleLeaveImage:function(e,C,u,n,j,Y,v){if(u&&(u=wc(u))){var Q=this.gv,W=v.rect,f=this.convertPoint(Y,v);e===C+"|image"&&(u.onLeave&&u.onLeave(n,j,Q,f,W.width,W.height),this.fire("image","onLeave",n,j,u,Z,f,W));for(var E=v.compInfos,m=u,X=E.length-1;X>=0;X--){var N=E[X],i=N.comp;f=this.convertPoint(Y,N,m,i,Q,j),W=N.rect,e===C+"|"+X&&(i.onLeave&&i.onLeave(n,j,Q,f,W.width,W.height),this.fire("comp","onLeave",n,j,u,i,f,W)),(u=W.image)&&e===C+"|"+X+"|image"&&(u.onLeave&&u.onLeave(n,j,Q,f,W.width,W.height),this.fire("image","onLeave",n,j,u,Z,f,W))}}},handleMissingUpImage:function(A,z,M,g,m,s){var B="onUp",E=this.downInfo.hits;if(E&&z&&(z=wc(z))){var R=this.gv,L=s.rect,F=this.convertPoint(m,s);!F.inRect&&E[A+"|image"]&&(z[B]&&z[B](M,g,R,F,L.width,L.height),this.fire("image",B,M,g,z,Z,F,L));for(var o=s.compInfos,O=z,G=o.length-1;G>=0;G--){var f=o[G],Y=f.comp;F=this.convertPoint(m,f,O,Y,R,g),F.inRect||(L=f.rect,E[A+"|"+G]&&(Y[B]&&Y[B](M,g,R,F,L.width,L.height),this.fire("comp",B,M,g,z,Y,F,L)),(z=L.image)&&E[A+"|"+G+"|image"]&&(z[B]&&z[B](M,g,R,F,L.width,L.height),this.fire("image",B,M,g,z,Z,F,L)))}}},handleDownInfoImage:function(V,x,k,c,s,z,n){var w=this.downInfo.hits;if(w&&x&&(x=wc(x))){var p=this.gv,G=n.rect,e=this.convertPoint(z,n);w[V+"|image"]&&(x[k]&&x[k](c,s,p,e,G.width,G.height),this.fire("image",k,c,s,x,Z,e,G));for(var h=n.compInfos,d=x,H=h.length-1;H>=0;H--){var $=h[H],u=$.comp;e=this.convertPoint(z,$,d,u,p,s),G=$.rect,w[V+"|"+H]&&(u[k]&&u[k](c,s,p,e,G.width,G.height),this.fire("comp",k,c,s,x,u,e,G)),(x=G.image)&&w[V+"|"+H+"|image"]&&(x[k]&&x[k](c,s,p,e,G.width,G.height),this.fire("image",k,c,s,x,Z,e,G))}}},initImageResource:function(){C.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(A,y,D,$,n,x){var O=y.rect,Q=y.matrix.applyInverse(A).sub(O),t=Q.x>=0&&Q.y>=0&&Q.x<=O.width&&Q.y<=O.height;if(!t)return Q;if($&&Tq($.pixelPerfect,x,n)){var O,M=1;this._is2d?(M=n.getZoom(),O=kl(A.x,A.y,Z,M)):O=kl(A.x,A.y);var f=!1,s=O.x,p=O.y,N=O.width,P=O.height,d=C.hitMaxArea,c=N*P*M*M;if(c>d){var g=Math.sqrt(d/c);M*=g}N*=M,P*=M,2>N&&(N=2),2>P&&(P=2),s*=M,p*=M;var a=_j(N,P),b=new Kj(0,-s,-p,M,M);b.append(y.matrix),n._drawForChecking=!0,$.transform=b;var R=D.comps;D.comps=[$],gl(a,D,0,0,N,P,x,self),D.comps=R,delete $.transform,n._drawForChecking=!1;try{for(var u=0,J=a.getImageData(0,0,N,P).data;u<J.length;u+=4)if(0!==J[u+3]){f=!0;break}a.restore()}catch(o){il=I,f=!1}Q.inRect=f}else Q.inRect=!0;return Q}});var kj=dn.DefaultInteractor=function(m){lp(kj,this,[m])};Ne("DefaultInteractor",Ci,{handle_mousedown:function(v){Pd(v);var H=this,B=H.gv,T=B.getDataAt(v);!B.setFocus(v)||B._editing||B._scrolling||(Ro(v)?B.handleDoubleClick(v,T):B.handleClick(v,T),!ci()&&T&&(B.isMovable(T)||B.isInteractive(T))||!B.isPannable()||!Ei(v)||Hg(v)||(H._tx=B.tx(),H._ty=B.ty(),H.startDragging(v)))},handleWindowMouseUp:function(T){var M=this,j=M.gv;j._panning&&(delete j._panning,j.onPanEnded(),M.fi({kind:"endPan",event:T})),delete M._tx,delete M._ty,M.clearDragging()},handle_mousemove:function(D){var Q=this,t=Q.gv;Q._hoverTimer&&(H(Q._hoverTimer),delete Q._hoverTimer),Q._hoverTimer=w(function(){Q.fi({kind:"hover",event:D}),H(Q._hoverTimer),delete Q._hoverTimer},t.getHoverDelay()||C.hoverDelay)},handle_touchmove:function(l){this.handle_mousemove(l)},handleWindowMouseMove:function(p){var Y=this,$=Y.gv,h=Y._lastClientPoint;Y.fi({kind:$._panning?"betweenPan":"beginPan",event:p}),$._panning=1,$.setTranslate(Y._tx+p.clientX-h.x,Y._ty+p.clientY-h.y)},handle_mousewheel:function(O){this.gv.handleScroll(O,O.wheelDelta)},handle_DOMMouseScroll:function(o){2===o.axis&&this.gv.handleScroll(o,-o.detail)},handle_keydown:function(c){this.gv.handleKeyDown(c)}});var $l=dn.SelectInteractor=function(B){lp($l,this,[B])};Ne("SelectInteractor",Ci,{_42:function(){var i=this,j=i.gv,D=j.getZoom(),U=i.mark,C=i.div;C||(C=i.div=jd(),yj(i.getView(),C));var _={};_.x=U.x*D+j.tx(),_.y=U.y*D+j.ty(),_.width=U.width*D,_.height=U.height*D,Pi(C,_),this.intersects()?(C.style.border="",C.style.background=j.getRectSelectBackground()):(C.style.background="",C.style.border="1px solid "+j.getRectSelectBorderColor())},handle_mousedown:function(X){var f=this,i=f.gv;if(f._57I=I,f.pendingClickThrough=I,!(i._editing||i._scrolling||ci())){var K=i.getDataAt(X),Y=i.sm();K?Hg(X)?Y.co(K)?Y.rs(K):Y.as(K):Y.co(K)?K instanceof lj&&K.isClickThroughEnabled()&&(f.pendingClickThrough=ad(X)):Y.ss(K):Hg(X)||!i.isPannable()?Ei(X)&&(Hg(X)||Y.cs(),i.isRectSelectable()&&(f.startDragging(X),i._77O=1)):Ei(X)&&(f._57I=ad(X))}},handle_mouseup:function(Q){var C=this,j=C.gv,H=C._57I;if(H&&(cd(H,ad(Q))<=1&&j.sm().cs(),C._57I=I),C.pendingClickThrough){if(cd(C.pendingClickThrough,ad(Q))<=1){var D=j.getDataAt(Q);if(D instanceof lj&&D.isClickThroughEnabled()){var W=j.getDataAt(Q,function(n){j._clickThroughChecking=!0;var V=n.getParent()===D&&j.isSelectable(n);return delete j._clickThroughChecking,V});W&&(Q.clickThrough=!0,j.sm().ss(W))}}C.pendingClickThrough=I}},handleWindowMouseUp:function(_){this.clear(_)},handleWindowMouseMove:function(j){var X=this,Q=X.gv;X._logicalPoint=Q.lp(j),X.mark?(X.fi({kind:"betweenRectSelect",event:j}),Q.isPannable()&&X.autoScroll(j),X.redraw()):X.fi({kind:"beginRectSelect",event:j}),X.mark=we(X._lastLogicalPoint,X._logicalPoint),X.redraw()},intersects:function(){var v=this,S=v._lastLogicalPoint,N=v._logicalPoint;return S.x>N.x||S.y>N.y},clear:function(x){var K=this,N=K.gv,p=K.mark;if(K._57I=I,K.pendingClickThrough=I,K._lastLogicalPoint){if(p){if(0!==p.width&&0!==p.height){var E=N.getDatasInRect(p,K.intersects());if(!E.isEmpty()){var V=N.sm(),Y=V.toSelection();E.each(function(p){V.co(p)?Y.remove(p):Y.add(p)}),V.ss(Y)}}gg(K.div),delete K.div,delete K.mark,K.redraw(),K.fi({kind:"endRectSelect",event:x}),N.onRectSelectEnded()}K.clearDragging(),delete N._77O}},redraw:function(){var M=this;M._draw||(M._draw=1,w(function(){M.mark&&M._42(),delete M._draw},16))}});var Gc=dn.MoveInteractor=function(e){lp(Gc,this,[e])};Ne("MoveInteractor",Ci,{handle_mousedown:function(A){var f=this,n=f.gv;if(Ei(A)&&!n._editing&&!n._scrolling&&!ci()){var P=n.getSelectedDataAt(A);!P||n.isInteractive(P)&&!n.isMovable(P)?n._focusData=I:(f._data=P,n.handleMouseDown&&n.handleMouseDown(A,P),f.startDragging(A),n.isMovable(P)&&(n._moving=1))}},handleWindowMouseUp:function(u){var B=this,s=B.gv;s.handleMouseUp&&s.handleMouseUp(u,B._data),B.clear(u)},handleWindowMouseMove:function(g){var D=this,w=D._data,I=D.gv;if((!I._93O||!I._93O(g,w))&&I._moving){D._logicalPoint||D.fi({kind:"prepareMove",event:g});var i=D._logicalPoint?"betweenMove":"beginMove",C={kind:i,event:g},Y=D._logicalPoint=I.lp(g);"beginMove"!==i||D._alreadyBeginTransaction||(D._alreadyBeginTransaction=!0,I.getDataModel().beginTransaction());var d=D._calcShift(i,g),J=d.x,k=d.y,T=D.gv.getMoveMode(g,w);T&&("x"===T?k=0:"y"===T?J=0:"xy"!==T&&(J=k=0)),I.moveSelection(J,k),D._lastLogicalPoint=Y,D.autoScroll(g),D.fi(C)}},_calcShift:function(){var N=this,v=N._logicalPoint,z=N._lastLogicalPoint,X=v.x-z.x,Z=v.y-z.y;return{x:X,y:Z}},clear:function(r){var c=this,L=c.gv;c._lastLogicalPoint&&(c._lastLogicalPoint=c._data=L._moving=I,c._logicalPoint&&(c.fi({kind:"endMove",event:r}),L.onMoveEnded()),c.clearDragging()),c._alreadyBeginTransaction&&(c._alreadyBeginTransaction=!1,L.getDataModel().endTransaction())}});var Lh=dn.ScrollBarInteractor=function(R){lp(Lh,this,[R])};Ne("ScrollBarInteractor",Ci,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(F){var c=this.gv.getViewRect();return this._41o()&&(c.x+c.width-this.gv.lp(F).x)*this.gv.getZoom()<Ee},isH:function(i){var a=this.gv.getViewRect();return this._40o()&&(a.y+a.height-this.gv.lp(i).y)*this.gv.getZoom()<Ee},handle_mousemove:function(U){this.handle_touchmove(U)},handle_touchmove:function(z){if(!Vo&&Ei(z)&&this.gv.isScrollBarVisible()){var t=this,y=t.isV(z),B=t.isH(z);(y||B)&&t.gv.showScrollBar(),t.gv._scrolling=y||B}},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function($){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=I,this.fi({kind:"endScroll",event:$})},handle_mousedown:function(x){this.handle_touchstart(x)},handle_touchstart:function(x){var H=this;if(H.gv.setFocus(x),Pd(x),H.handle_touchmove(x),!(lg(x)>1)&&H.gv._scrolling&&H.gv.isScrollBarVisible()){H._cp=ad(x),H._tx=H.gv.tx(),H._ty=H.gv.ty();var L=H.isV(x);H._state=L?"vScroll":"hScroll",Bf(H,x),H.fi({kind:"beginScroll",event:x})}},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(u){var m=ad(u),p=this.gv.getViewRect(),V=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-m.y)*V.height/p.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-m.x)*V.width/p.width),this.fi({kind:"betweenScroll",event:u})}});var dr=dn.TouchInteractor=function(l,f){f=f||{},f.selectable===Z&&(f.selectable=!0),f.movable===Z&&(f.movable=!0),f.pannable===Z&&(f.pannable=!0),f.pinchable===Z&&(f.pinchable=!0),f.editable===Z&&(f.editable=!0),this.params=f,lp(dr,this,[l])};Ne("TouchInteractor",Ci,{ms_edit:1,setUp:function(){var f=this;dr.superClass.setUp.call(f),Xm&&f.params.editable&&f.gv.setEditInteractor(f)},tearDown:function(){var W=this;dr.superClass.tearDown.call(W),Xm&&W.params.editable&&W.gv.setEditInteractor(I)},clear:function(F){var A=this,Z=A.gv;Z._moving&&(A.fi({kind:"endMove",event:F}),delete Z._moving,Z.onMoveEnded(),Z.dm().endTransaction()),Z._panning&&(A.fi({kind:"endPan",event:F}),delete Z._panning,Z.onPanEnded()),Z._pinching&&(A.fi({kind:"endPinch",event:F}),delete Z._pinching,Z.onPinchEnded()),Z._editing&&(A._46O(F),A._77I=A._node=A._edge=A._shape=A._rect=A._89I=A._index=Z._editing=I),A._moving=A._panning=A._pinching=A._editing=A._57I=A._data=A._beginHistory=I,A.clearDragging()},handle_touchstart:function(c){var j=this;if(!j.gv._editing){Pd(c),j._57I=I;var t=j.params,o=j.gv,$=o.sm(),d=o.getDataAt(c),W=lg(c);if(1===W){if(Ro(c))return o.handleDoubleClick(c,d),void 0;o.handleClick(c,d),d&&(o.handleMouseDown&&o.handleMouseDown(c,d),j._data=d),t.selectable||(d=I),d?($.co(d)||$.ss(d),t.editable&&o.isEditable(d)&&j._79I(c,d,!0)?(j._editing=1,j.startDragging(c)):t.movable&&o.isMovable(d)&&(j._moving=1,j.startDragging(c))):(j._57I=ad(c),t.pannable&&o.isPannable()&&(j._panning=1,j.startDragging(c),j._translate={x:o.tx(),y:o.ty()}))}else if(t.pinchable&&2===W){j._pinching=1,j.startDragging(c);var q=o.getView(),r=o.getZoom(),O=q.getBoundingClientRect(),H=c.touches[0],b=c.touches[1],T={x:(H.clientX+b.clientX)/2-O.left,y:(H.clientY+b.clientY)/2-O.top};T.x-=o.tx(),T.y-=o.ty(),T.x/=r,T.y/=r,j._p=T,j._d=em(c)}}},handle_touchend:function(v){var c=this,h=c.gv,N=c._57I,y=c._data;N&&(cd(N,ad(v))<=1&&h.sm().cs(),c._57I=I),y&&h.handleMouseUp&&h.handleMouseUp(v,y)},handleWindowTouchEnd:function(B){this.clear(B)},handleWindowTouchMove:function(f){var T=this,x=T.gv,c=lg(f);if(1===c){if(T._editing&&(T._beginHistory||(T._beginHistory=1,x.dm().beginTransaction()),x._editing=1,T._78I(f)),T._moving)T._beginHistory||(T._beginHistory=1,x.dm().beginTransaction()),T.handleMove(f);else if(T._panning){var j=ad(f);x.setTranslate(T._translate.x+j.x-T._lastClientPoint.x,T._translate.y+j.y-T._lastClientPoint.y),T.fi({kind:x._panning?"betweenPan":"beginPan",event:f}),x._panning=1
}}else if(2===c&&T._pinching){var n=em(f);x.handlePinch(T._p,n,T._d),T._d=n,T.fi({kind:x._pinching?"betweenPinch":"beginPinch",event:f}),x._pinching=1}},handleMove:function(b){var j=this,O=j.gv,z=O.lp(b);O._93O&&O._93O(b,j._data)||(O.moveSelection(z.x-j._lastLogicalPoint.x,z.y-j._lastLogicalPoint.y),j._lastLogicalPoint=z,j.autoScroll(b),j.fi({kind:O._moving?"betweenMove":"beginMove",event:b}),O._moving=1)}});var o=_.ht,Sd=o.graph._editor={Math:o.Math,Guide:{}};Sd.getStyle=function(s){var L,a=Sd.StyleMap;return a&&(L=a[s],L!==Z)?L:Sd.DefaultStyleMap[s]},Sd.setStyle=function(d,b){var m=Sd.StyleMap;m||(m=Sd.StyleMap={}),m[d]=b},Sd.inEdit=function(j){return j._inXEdit===!0},Sd.startEdit=function(f){f._inXEdit=!0,Sd.Inject.doInject(f)},Sd._46O=function(X){X._inXEdit=!1,Sd.Inject.undoInject(X)},Sd.toScreenPosition=function(u,Y){var U=u.tx(),y=u.ty(),i=u._zoom;return new Sd.Math.Vector2(Y.x*i+U,Y.y*i+y)},Sd.checkHit=function(m,O,L){return m.distanceTo(O)<L?!0:!1},Sd.toWorldPosition=function(W,i){var p=W.tx(),s=W.ty(),c=W._zoom;return{x:(i.x-p)/c,y:(i.y-s)/c}},Sd.setAntialias=function(c,v){for(var Y,l=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],g=0,e=l.length;e>g&&(Y=l[g],!(Y in c));g++);c[Y],c[Y]=v},Sd.getTargetCornersOnScreen=function(w,x){if(!x)return null;var e,U=[];if(km(x,w)){var g=dp(w,x);e=[{x:g.x,y:g.y},{x:g.x+g.width,y:g.y},{x:g.x+g.width,y:g.y+g.height},{x:g.x,y:g.y+g.height}]}else{if(!x.getCorners)return null;e=x.getCorners()}return e.forEach(function(Q){var i=Sd.toScreenPosition(w,Q);U.push(i.x,i.y)}),U},Sd.log=function(){};var Ar=Sd.Inject={_modules:[]};Ar.registAsModule=function(t,d){var h={},g={};for(var X in t){var m=d.prototype[X];h[X]=m}t.getBackup=function(B){return h[B]},t.getBackups=function(){return h},g.doInject=function(){for(var i in t)"getBackup"!==i&&(d.prototype[i]=t[i])},g.undoInject=function(){for(var q in t)"getBackup"!==q&&(d.prototype[q]=h[q])},Ar._modules.push(g)},Ar.doInject=function(t){for(var u,U=Ar._modules,L=0,P=U.length;P>L;L++)u=U[L],u.doInject(t)},Ar.undoInject=function(M){for(var m,T=Ar._modules,I=0,E=T.length;E>I;I++)m=T[I],m.undoInject(M)};var Ci=o.graph.EditInteractor=function(q){var p=this,n=z.createElement("canvas");n.className="editCanvas",n.style.position="absolute",p._styleMap={},p._canvas=n,p._context=n.getContext("2d"),Ci.superClass.constructor.call(p,q),Sd.setAntialias(p._context,!1),p._subModules=[new Sd.Anchor(p),new Sd.RotateX(p),new Sd.Rect(p),new Sd.Curve(p),new Sd.MoveHelper(p)],p._gridGuide=new Sd.Guide.Grid(p),p._rectGuide=new Sd.Guide.Rect(p)},Ai=Ci;o.Default.def(Ci,o.graph.Interactor,{ms_edit:1,ms_fire:1}),V.defineProperties(Ci.prototype,{editDetail:{get:function(){var R=!!this._editDetail;return R},set:function(A){var t=this,l=t._editDetail;l!==A&&(t._editDetail=A,t.gv._editing=A,t.fp("editDetail",l,A),t.fp("pointsEditingMode",l,A),t.fi({kind:A?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(V){(!this._editDetail||V)&&(this.gv._editing=V,V||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(K){this._editing=K,this.gvEditing=K}},pointsEditingMode:{get:function(){return this.editDetail},set:function(a){var A=this;A.editDetail!==a&&(a?A._tryEnterEditDetailMode():A._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var l=this._gridEnabled;if(!l)return!1;var R=this.gv;return R?!0:!0},set:function(t){t!==this._gridEnabled&&(this._gridEnabled=t,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(D){D!==this._agEnabled&&(this._agEnabled=D,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Ci.prototype.getSubModule=function(i){var A,E,w,N=this._subModules;for(E=0,w=N.length;w>E;E++)if(A=N[E],A.catalog===i)return A},Ci.prototype.invokeSubModule=function(s,F){var C=this,u=C._subModules;if(u)for(var D,m,f,q=Array.prototype.slice.call(arguments,2),I=0,A=u.length;A>I;I++)if(D=u[I],m=D[s],m&&(f=m.apply(D,q),f!=Z&&F))return D},Ci.prototype.invokeSubModuleInverse=function(j,r){var m=this,R=m._subModules;if(R)for(var S,c,X,U=Array.prototype.slice.call(arguments,2),F=R.length-1;F>=0;F--)if(S=R[F],c=S[j],c&&(X=c.apply(S,U),X!=Z&&r))return S},Ci.prototype.setUp=function(){Sd.log("setUp");var w=this,f=w.gv,S=f.getView(),R=w._canvas;Ci.superClass.setUp.call(w),f.setEditInteractor(w),f._79O?S.insertBefore(R,f._79O):S.appendChild(R),Sd.startEdit(f),w.invokeSubModule("setUp"),f.dm().mm(w._onDataModelChanged,w),f.dm().md(w._onDataPropertyChanged,w)},Ci.prototype.tearDown=function(){Sd.log("tearDown");var g=this,c=g.gv,Y=c.getView();g._resetCustomCursorStyle(),Ci.superClass.tearDown.call(g),c.dm().umm(g._onDataModelChanged,g),c.dm().umd(g._onDataPropertyChanged,g),c.setEditInteractor(null),Y.removeChild(g._canvas),g._drawTimer&&(H(g._drawTimer),g._drawTimer=null),Sd._46O(c),g.invokeSubModule("tearDown")},Ci.prototype._onDataModelChanged=function(a){var I=this;("clear"===a.kind||"remove"===a.kind&&I.editDetail&&a.data===I.getSubModule("Curve").target)&&(I.editDetail=!1,I._42())},Ci.prototype._onDataPropertyChanged=function(N){var S=this;if(S.editDetail){var n=S.getSubModule("Curve"),l=N.data;l===n.target&&(l._writing||n._handleDataChanged())}},Ci.prototype.clear=function(){Sd.log("clear")},Ci.prototype.redraw=function(){this._42()},Ci.prototype._42=function(){var g=this;g._drawTimer||(g._drawTimer=w(function(){g._drawTimer=null,g.drawImpl()},0))},Ci.prototype.drawImpl=function(){var Q;for(Q in{_42:!0})break;return function(){var x=this,l=x._canvas,h=x.gv,I=h.getWidth(),k=h.getHeight(),P=x._context,Y=o.Default.getInternal();(l.width!==I||l.height!==k)&&Y.setCanvas(l,I,k),P.clearRect(0,0,l.width,l.height);var V=x._getValidSelection();P.save();var A=o.Default.devicePixelRatio;P.scale(A,A),x._gridGuide._42(),x.invokeSubModuleInverse(Q,!1,P,h,V),x._rectGuide._42(),P.restore()}}(),Ci.prototype._getValidSelection=function(){var Y=this,z=Y.gv,R=z.sm().getSelection(),o=[];return R.each(function(d){z.isVisible(d)&&z.isEditable(d)&&o.push(d)}),o},Ci.prototype.handle_touchmove=function(w){return this.handle_mousemove(w)},Ci.prototype.handle_mousemove=function(F){if(!o.Default.isDragging()){var B=this;(B.editDetail||!ci())&&(B.gvEditing=!1,B._checkEdit(F)&&(B.gvEditing=!0))}},Ci.prototype.handle_touchstart=function(L){return this.handle_mousedown(L)},Ci.prototype.handle_mousedown=function(V){Pd(V);var C=this;if(C.editDetail||!ci()){if(Ro(V)&&!V.clickThrough){if(C.editDetail){if(C._tryQuitEditDetailMode(V))return}else if(C._tryEnterEditDetailMode())return;C.gv.dm().beginTransaction();var l=C.invokeSubModule("handleDoubleClick",!0,V);if(C.gv.dm().endTransaction(),l)return}var m=C._checkEdit(V);m&&(C._downPosition=C._getLogicalPoint(V),C.gv.dm().beginTransaction(),m.startEdit(C,V),C.editing=!0)}},Ci.prototype._checkEdit=function(l){var C=this,d=C.gv,R=C._getLogicalPoint(l),i=C.invokeSubModule("check",!0,d,l,R)||null;return C._editMod=i,i},Ci.prototype.handleWindowTouchMove=function(S){return this.handleWindowMouseMove(S)},Ci.prototype.handleWindowMouseMove=function(H){var M=this,R=M._downPosition;if(R){var Z=M._getLogicalPoint(H);if(Z.distanceTo(R)<M.getStyle("moveSensitivity"))return;delete M._downPosition}var r=M._editMod;r&&r.handleEdit(M.gv,H)},Ci.prototype._getLogicalPoint=function(B){var K=this,P=o.Default.getLogicalPoint(B,K._canvas);return new Sd.Math.Vector2(P)},Ci.prototype.handleWindowTouchEnd=function(F){return this.handleWindowMouseUp(F)},Ci.prototype.handleWindowMouseUp=function(){var w;for(w in{_46O:!0})break;return function(E){var P=this;P.editing=!1,P.setCursor("default"),P.invokeSubModule(w,!1,E),P._42(),P.gv.dm().endTransaction()}}(),Ci.prototype.handle_mousewheel=function(V){var n=this;Pd(V),n.invokeSubModule("preHandleScroll",!0)||n.gv.handleScroll(V,V.wheelDelta)},Ci.prototype.handleDelete=function(){var e=this;if(!e.editDetail){e.gv.dm().beginTransaction();var G=e.invokeSubModule("handleNormalStateDelete",!0);return e.gv.dm().endTransaction(),G||e.gv.removeSelection(),void 0}e.gv.dm().beginTransaction(),e.invokeSubModule("handleDelete",!0),e.gv.dm().endTransaction(),e._42()},Ci.prototype.handle_keydown=function(t){var I=this;if((t.metaKey||t.ctrlKey)&&I._42(),ci(t)&&!I.editing)return I.gvEditing=!1,I.setCursor("default"),I._42(),void 0;var c=Bo(t);return I.editDetail?((c||br(t))&&(I.editDetail=!1,I._42()),I.gv.dm().beginTransaction(),I.invokeSubModule("handle_keydown",!0,t),I.gv.dm().endTransaction(),void 0):(I.gv.dm().beginTransaction(),I.invokeSubModule("handleNormalStateKeyDown",!0,t),I.gv.dm().endTransaction(),c&&I._tryEnterEditDetailMode(),void 0)},Ci.prototype.handle_keyup=function(D){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,D),this.gv.dm().endTransaction()},Ci.prototype._tryEnterEditDetailMode=function(){var r=this;return!r.editDetail&&r.invokeSubModule("canEnterEditDetailMode",!0)&&1===r._getValidSelection().length?(r.editDetail=!0,r._42(),!0):void 0},Ci.prototype._tryQuitEditDetailMode=function(i){var S=this;if(S.editDetail){var s=S.gv,G=S.getSubModule("Curve").target;return i&&s.getDataAt(i)===G?void 0:(S.editDetail=!1,S._42(),!0)}},Ci.prototype.setStyle=function(F,B,x){var k=this;x?Sd.setStyle(F,B):k._styleMap[F]=B,k.fp("styleChanged",null,{key:F,value:B,base:x}),k._42()},Ci.prototype.getStyle=function(p){var Q=this,$=Q._styleMap[p];return $!==Z?$:Sd.getStyle(p)},Ci.prototype.setCursor=function(J){this._resetCustomCursorStyle(),o.graph.EditInteractor.superClass.setCursor.call(this,J)},Ci.prototype._resetCustomCursorStyle=function(){var _=this;if(_._customStyle){var u=this.gv.getView();u.classList&&u.classList.remove&&u.classList.remove(_._customStyle),_._customStyle=null}},Ci.prototype._setRotateCursor=function(Q){var L=this,f=L._cursorFactory;f||(f=L._cursorFactory=new Sd.CursorFactory(L));var D=f.getRotateCursor(Q),A=L.gv.getView();L._resetCustomCursorStyle(),L._customStyle=D,A.classList&&A.classList.add&&A.classList.add(D)};var hg=Sd.Group=function($){var d=this;d._entities=$,d._64O=0,d._position={x:0,y:0},d._scale={x:1,y:1},d._anchor={x:.5,y:.5},d._anchor2={x:.5,y:.5}};hg.prototype={},hg.prototype.constructor=hg;var ld=null;hg.findOrCreateGroup=function(C){if(ld&&ld.checkIsMe(C))return ld;var F=new Sd.Group(C);return F.getKeyOb()?(ld=F,F):void 0},hg.prototype.checkIsMe=function(N){var v=this._entities;if(v.length!==N.length)return!1;var g,o={},V=N.length;for(g=0;V>g;g++)o[N[g]._id]=!0;for(g=0;V>g;g++)if(!o[v[g]._id])return!1;return!0},hg.prototype.getRotation=function(){return this._64O},hg.prototype.getPosition=function(){return this._position},hg.prototype.getAnchor=function(){return this._anchor},hg.prototype.getWidth=function(){return this._width},hg.prototype.getScale=function(){return this._scale},hg.prototype.getSize=function(){return{width:this._width,height:this._height}},hg.prototype.getHeight=function(){return this._height},hg.prototype.getKeyOb=function(){for(var Z=this._entities,c=Z.length-1;c>=0;c--){var e=Z[c];if(this.isNode(e))return e}},hg.prototype.getAnchor2=function(){var B=this,z=B.rotateCenter;if(z)return z;var w=B.getKeyOb();if(!w)return B._anchor;var V=B._anchor2,b=w.getMatrix();return b.tf({x:w.getWidth()*(V.x-w.getAnchor().x),y:w.getHeight()*(V.y-w.getAnchor().y)})},hg.prototype.setAnchor2=function(U,$){var b=this,c=b.getKeyOb();if(c){var P,p=c.getMatrix();P="number"==typeof U?{x:U,y:$}:U;var A=p.tfi(P);b._anchor2={x:c.getAnchor().x+A.x/c.getWidth(),y:c.getAnchor().y+A.y/c.getHeight()}}},hg.prototype.setRotation=function(){},hg.prototype.beginRotate=function(f){this.rotateCenter=f.pos,this.rotateMode=f.groupRotateMode},hg.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},hg.prototype.addRotation=function(A,G){return"batch"===G?this._addRotationInBatchMode(A):"block"===G?this._addRotationInBlockMode(A):void 0},hg.prototype._addRotationInBlockMode=function(i){var m=this,z=m.rotateCenter||m.getPosition();m._entities.forEach(function(S){if(m.isNode(S)){var R=S.getMatrix();R.translate(-z.x,-z.y),R.rotate(i),R.translate(z.x,z.y);var J=Math.sign(S.getScale().x);S.setRotation(Y(R.b*J,R.a*J)),S.setPosition(R.tx,R.ty)}})},hg.prototype._addRotationInBatchMode=function(R){var q=this,x=q._anchor2;q._entities.forEach(function(v){if(q.isNode(v)){var U=v.getAnchor(),D=v.getMatrix(),d=D.tf({x:v.getWidth()*(x.x-U.x),y:v.getHeight()*(x.y-U.y)}),V=new Sd.Math.Matrix2d;V.set(D.a,D.b,D.c,D.d,D.tx,D.ty),V.translate(-d.x,-d.y),V.rotate(R),V.translate(d.x,d.y);var N=Math.sign(v.getScale().x);v.setRotation(Y(V.b*N,V.a*N)),v.setPosition(V.tx,V.ty)}})},hg.prototype.setPosition=function(f){var g,V,q,O,a=this,Z=a._position,B=f.x-Z.x,D=f.y-Z.y,I=a._entities;for(V=0,q=I.length;q>V;V++)g=I[V],Cd(g)&&(O=g.getPosition(),g.setPosition(O.x+B,O.y+D));a._position=f},hg.prototype.setScale=function(o,Z){var g=this,K=o/g._scale.x,Q=Z/g._scale.y;g._adjustChildScaleOrSize(K,Q,"size"),g._scale={x:o,y:Z}},hg.prototype.getRect=function(){var X=this,V=X._position,z=X._width,w=X._height;return{x:V.x-z/2,y:V.y-w/2,width:z,height:w}},hg.prototype.setSize=function(l,y){var _=this,l=Math.max(1,l),y=Math.max(1,y),J=l/_._width,e=y/_._height;_._adjustChildScaleOrSize(J,e,"size"),_._width=l,_._height=y},hg.prototype._adjustChildScaleOrSize=function(p,w,G){var F,U,$,O,t,H,W,V,Q,x,q,g,c,v,k=this,u=k._position,z=k._entities,D=new Sd.Math.Matrix2d;for(U=0,$=z.length;$>U;U++)if(F=z[U],k.isNode(F)){if(O=F.getPosition(),t=F.getRotation(),H=F.getWidth(),W=F.getHeight(),V=F.getScale(),q=V.x*H,g=V.y*W,D.identity().scale(q,g).rotate(t).translate(O.x,O.y).translate(-u.x,-u.y).rotate(-k._64O),t=Y(D.b*Math.sign(q),D.a*Math.sign(q)),D.scale(p,w),Q=Math.cos(t),x=Math.sin(t),Math.abs(Q)<.001?(c=D.b/x,v=-D.c/x):(c=D.a/Q,v=D.d/Q),"scale"===G)F.setScale(c/H,v/W);else if("size"===G){var s=c/V.x,f=v/V.y;F.setScale(Ap(c)*Math.abs(V.x),Ap(v)*Math.abs(V.y)),F.setSize(Math.max(.1,Math.abs(s)),Math.max(.1,Math.abs(f)))}D.rotate(k._64O).translate(u.x,u.y),F.setPosition(D.tx,D.ty)}},hg.prototype.getMatrix=function(){var x=this,c=x._position,S=o.Default.getInternal(),H=x._scale;return new S.Mat(x._64O,c.x,c.y,H.x,H.y)},hg.prototype.toGlobal=function(z){return this.getMatrix().tf(z)},hg.prototype.getCorners=function(){var b=this,I=b._width,g=b._height,h=b._anchor,s=-I*h.x,D=-g*h.y,Y=b.getMatrix();return[Y.tf(s,D),Y.tf(s,D+g),Y.tf(s+I,D+g),Y.tf(s+I,D)]},hg.prototype.calcInfo=function(){var t,w,g,M,k,s,$=this,v=[],_=$._entities,C=$._64O;for(M=0,k=_.length;k>M;M++)s=_[M],$.isNode(s)&&s.getCorners&&v.push.apply(v,s.getCorners());if(v.length){var p=Math.cos(-C),q=Math.sin(-C),e=1/0,f=-1/0,n=1/0,x=-1/0;for(M=0,k=v.length;k>M;M++)g=v[M],t=g.x,w=g.y,g.x=p*t-q*w,g.y=q*t+p*w,e=Math.min(e,g.x),f=Math.max(f,g.x),n=Math.min(n,g.y),x=Math.max(x,g.y);$._width=(f-e)/$._scale.x,$._height=(x-n)/$._scale.y,p=Math.cos(C),q=Math.sin(C);var L=$._anchor;t=e+(f-e)*L.x,w=n+(x-n)*L.y,$._position={x:p*t-q*w,y:q*t+p*w}}},hg.prototype.isNode=function(E){return Cd(E)?km(E)?!1:!0:!1},hg.prototype._42=function(y,s,U){var N,q,e,D,L,B,K,u,J=this,S=J._entities,$=J.rotateMode;for("batch"===$&&(u=J.getKeyOb()),N=0,q=S.length;q>N;N++)e=S[N],J.isNode(e)&&(B=e.getRect(),D=Sd.toScreenPosition(U,{x:B.x,y:B.y}),L=Sd.toScreenPosition(U,{x:B.x+B.width,y:B.y+B.height}),K={min:D,max:L},e===u&&(K.isKeyOb=!0),Sd.Icons.DrawIcon(y,s,Sd.Icons.GroupSubEntityRect,K))};var aq=Sd.CurveActiving=function(d,D){this._curve=d,this._interactor=d._interactor;for(var Z in D)this[Z]=D[Z]};aq.prototype={},aq.prototype.constructor=aq,V.defineProperties(aq.prototype,{point:{get:function(){return this._point},set:function(d){var R=this;R._point=d,R.editingCtrl||R._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(D){var F=this;F._pairs=D,F.editingCtrl&&F._firePointChange()}}}),aq.prototype._firePointChange=function(){var W=this,P=W.getCurrentEditingPoint();if(!P)return S.fi({kind:"selectPoint"}),void 0;var S=W._interactor,_=this._curve.target;if(_){var M=Sd.getDataMatrix(_).invert(),x=P.e;P=M.apply(Sd.toWorldPosition(S.gv,P)),P.e=x;var E=W._lastFirePoint;E&&Math.abs(P.x-E.x)<1e-5&&Math.abs(P.y-E.y)<1e-5&&(P.e==Z&&E.e==Z||Math.abs(P.e-E.e)<1e-5)||(W._lastFirePoint=P,S.fi({kind:"selectPoint",x:P.x,y:P.y,e:P.e}))}},aq.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},aq.prototype.getCurrentEditingPoint=function(){var w=this,v=w.editingCtrl;if(v){var t=w.pairs;if(t){var g=t[v.pairId],o=g[v.type];if(o)return o}}return w._point};var ml=Sd.CursorFactory=function(L){var f=this;f._interactor=L,f._rotateCursorStyles={}};ml.prototype={},ml.prototype.constructor=ml,ml.prototype.getRotateCursor=function(a){var g=this;0>a&&(a+=2*Math.PI);var I=g._interactor,r=I.getStyle("rotateCursorSize"),i=I.getStyle("rotateCursorRound"),h=Math.round(180*(a/Math.PI)/i);h*i>=360&&(h=0);var N=g._rotateCursorStyles,A="htCustomRotateStyle_"+r+"_"+i+"_"+h;return N[A]||(g._produceRotateCursor(A,r,i,h),N[A]=!0),A},ml.prototype._produceRotateCursor=function(i,R,h,J){var g=this;g._interactor;var M=g._canvas;M||(M=g._canvas=z.createElement("canvas")),M.width=M.height=R*devicePixelRatio,M.style.width=M.style.height=R+" px";var u=M.getContext("2d");Sd.setAntialias(u,!1),u.scale(devicePixelRatio,devicePixelRatio);var C,k,x,d,p,$=Math.round(R/2),H=""+$+" "+$+",auto !important;";C=Math.PI/180*J*h,u.clearRect(0,0,R,R),u.save(),u.scale(R/32,R/32),u.translate(16,16),u.rotate(C+Math.PI/2),u.beginPath(),u.moveTo(-8,0),u.lineTo(-8,3),u.lineTo(-5,3),u.moveTo(8,0),u.lineTo(8,3),u.lineTo(5,3),u.moveTo(-8,3),u.quadraticCurveTo(0,-6,8,3),u.restore(),u.strokeStyle="white",u.lineWidth=4,u.stroke(),u.strokeStyle="black",u.lineWidth=2,u.stroke(),k=JSON.stringify(M.toDataURL()),d="cursor:url("+k+")"+H,1!==devicePixelRatio&&(x='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+R+'px" height="'+R+'px"><image xlink:href='+k+' width="'+R+'" height="'+R+'"/></svg>',d+="cursor:url(data:image/svg+xml;base64,"+btoa(x)+")"+H,d+="cursor:-webkit-image-set(url("+k+")"+devicePixelRatio+"x,url("+k+")1x)"+H),p=z.createElement("style"),p.textContent="body."+i+" *, ."+i+"{"+d+"}",z.head.appendChild(p)};var wk=Sd.Guide.Grid=function(s){var K=this;K._interactor=s,K._alignmentGuideId=0,K._xAlignmentGuide=[],K._yAlignmentGuide=[]};wk.prototype={},wk.prototype.constructor=wk,V.defineProperties(wk.prototype,{gridBlockSize:{get:function(){var D=this;return D._gridBlockSize||D._interactor.getStyle("gridBlockSize")},set:function(q){this._gridBlockSize=q,this._interactor._42()}},gridThickLinesEvery:{get:function(){var n=this;return n._gridThickLinesEvery||n._interactor.getStyle("gridThickLinesEvery")},set:function(D){this._gridThickLinesEvery=D,this._interactor._42()}},gridEnabled:{get:function(){var o=this,K=o._interactor;return K.gridEnabled&&o.isValidGrid()}}}),wk.prototype._42=function(){var P=this,A=P._interactor;P.gridEnabled&&P.drawGrid(),A.alignmentGuideEnabled&&P.drawAlignmentGuide()},wk.prototype.makeMatrix=function(){var i=this,r=i._interactor.getStyle("gridAngle"),o=i._interactor.getStyle("gridRotation"),N=new Sd.Math.Matrix2d,x=Math.sin(r),j=Math.cos(r);return N.set(1,0,j,x,0,0),N.rotate(o),N},wk.prototype.isValidGrid=function(){var k=this,Q=Math.PI,B=k._interactor,R=B.gv;if(R._zoom<B.getStyle("gridZoomThreshold"))return!1;var S=B.getStyle("gridAngle"),z=Math.abs(180*(S%Q/Q)),U=1-1e-8;return U>z||z>180-U?!1:!0},wk.prototype.drawAlignmentGuide=function(){var s=this,R=s._interactor,w=R.gv,H=R._canvas,o=R._context,p=H.width,P=H.height,_=w.tx(),M=w.ty(),W=w._zoom;o.beginPath(),o.strokeStyle=R.getStyle("gridAlignmentGuideColor"),o.lineWidth=1,s._xAlignmentGuide.forEach(function(a){var U=a.p*W+_;o.moveTo(U,0),o.lineTo(U,P)}),s._yAlignmentGuide.forEach(function(R){var g=R.p*W+M;o.moveTo(0,g),o.lineTo(p,g)}),o.stroke()},wk.prototype.drawGrid=function(){function R(Y,M,x,s){var m=Sd.toScreenPosition(A,t.apply({x:Y,y:M})),K=Sd.toScreenPosition(A,t.apply({x:x,y:s}));f.moveTo(m.x,m.y),f.lineTo(K.x,K.y)}var b=this,q=b._interactor,X=b.gridBlockSize,U=b.gridThickLinesEvery,E=q.getStyle("gridThickColor"),i=q.getStyle("gridLightColor"),A=q.gv,z=q._canvas,f=q._context,r=z.width,T=z.height,t=b.makeMatrix(),D=t.applyInverse(Sd.toWorldPosition(A,{x:0,y:0})),Y=t.applyInverse(Sd.toWorldPosition(A,{x:r,y:0})),K=t.applyInverse(Sd.toWorldPosition(A,{x:0,y:T})),O=t.applyInverse(Sd.toWorldPosition(A,{x:r,y:T})),C=Math.min(D.x,Y.x,K.x,O.x),y=Math.max(D.x,Y.x,K.x,O.x),J=Math.min(D.y,Y.y,K.y,O.y),m=Math.max(D.y,Y.y,K.y,O.y);r=y-C,T=m-J;var x=Math.ceil(C/X),M=Math.floor(y/X),o=Math.ceil(J/X),S=Math.floor(m/X);A.tx(),A.ty(),A._zoom;var s,j,u;for(f.save(),f.lineWidth=1,f.beginPath(),f.strokeStyle=E,u=Math.ceil(x/U)*U;M>=u;u+=U)s=u*X,R(s,J,s,m);for(u=Math.ceil(o/U)*U;S>=u;u+=U)j=u*X,R(C,j,y,j);for(f.stroke(),f.beginPath(),f.strokeStyle=i,u=x;M>=u;u++)0!==u%U&&(s=u*X,R(s,J,s,m));for(u=o;S>=u;u++)0!==u%U&&(j=u*X,R(C,j,y,j));f.stroke(),f.restore()},wk.prototype.getAlignmentGuides=function(){var w=this;return{x:w._xAlignmentGuide,y:w._yAlignmentGuide}},wk.prototype.addAlignmentGuide=function(P,l,t){var k=this,U="x"===P?k._xAlignmentGuide:k._yAlignmentGuide,t=t?t:++k._alignmentGuideId,M={p:l,id:t};if(U.length){var D=k._findClosestAlignmentGuide(M.p,U);D.dis<0?U.splice(D.index+1,0,M):U.splice(D.index,0,M)}else U.push(M);return k._interactor._42(),t},wk.prototype.findClosest=function(X,V,Y){var q=this,L=q._interactor,v=L.gv;Y&&(X=Sd.toWorldPosition(v,X));var G,l,$,Z=1/0,M=1/0,o=X.x,s=X.y;if(q.gridEnabled){var x=q.gridBlockSize,S=q.makeMatrix(),I=S.applyInverse(X);I=S.apply({x:Math.round(I.x/x)*x,y:Math.round(I.y/x)*x}),Z=I.x-o,M=I.y-s,$=!0}if(L.alignmentGuideEnabled&&(G=q._findClosestAlignmentGuide(o,q._xAlignmentGuide).dis,l=q._findClosestAlignmentGuide(s,q._yAlignmentGuide).dis,Math.abs(G)<Math.abs(Z)&&(Z=G,$=!0),Math.abs(l)<Math.abs(M)&&(M=l,$=!0)),$){$=!1;var T=v._zoom,p=L.getStyle("smartGuideSensitivity")/T,m={};if(Math.abs(Z)<p&&"y"!==V&&(m.x=Y?Z*T:Z,$=!0),Math.abs(M)<p&&"x"!==V&&(m.y=Y?M*T:M,$=!0),$)return m}},wk.prototype._findClosestAlignmentGuide=function(l,A){if(!A.length)return{dis:1/0};for(var g,c=0,x=A.length-1;x-c>1;)g=Math.floor((c+x)/2),A[g].p<l?c=g:x=g;var P=A[c].p-l,N=A[x].p-l;return Math.abs(P)<=Math.abs(N)?{line:A[c],dis:P,index:c}:{line:A[x],dis:N,index:x}},wk.prototype.removeAllAlignmentGuide=function(N){var e=this;"y"!==N&&(e._xAlignmentGuide=[]),"x"!==N&&(e._yAlignmentGuide=[]),e._interactor._42()},wk.prototype.removeAlignmentGuide=function(X){for(var i,j,M,Z=this,U=Z._xAlignmentGuide,B=0;2>B;B++)for(U=0===B?Z._xAlignmentGuide:Z._yAlignmentGuide,i=0,j=U.length;j>i;i++)if(M=U[i],M.id===X)return U.splice(i,1),Z._interactor._42(),{axis:0===B?"x":"y",position:M.p};return!1},wk.prototype.adjustAlignmentGuide=function(L,y){var x=this,W=x.removeAlignmentGuide(L);return W?(x.addAlignmentGuide(W.axis,y,L),!0):!1};var rh=Sd.Guide.Rect=function(Q){var R=this;R._interactor=Q};rh.prototype={},rh.prototype.constructor=rh,rh.prototype.gatherRects=function(){var K,G,h,B,S=this,Y=S._interactor.gv,U=[],i=[],R={x:U,y:i},t={},X=Y.getDataModel(),P=X.a("width"),V=X.a("height");P&&V&&(K=0,G=0,h=P,B=V,U.push({node:X,type:0,p:K},{node:X,type:1,p:K+h/2},{node:X,type:2,p:K+h}),i.push({node:X,type:0,p:G},{node:X,type:1,p:G+B/2},{node:X,type:2,p:G+B}),t[X._id||0]={x:K,y:G,width:h,height:B}),X.each(function(O){if(Cd(O)&&!Y.isSelected(O)&&Y.isVisible(O)){var R=!1;if(Y.sm().getSelection().each(function(n){R||(O.isHostOn(n)?R=!0:O.isDescendantOf(n)&&(R=!0))}),!R){var c=O.getRect();K=c.x,G=c.y,h=c.width,B=c.height,U.push({node:O,type:0,p:K},{node:O,type:1,p:K+h/2},{node:O,type:2,p:K+h}),i.push({node:O,type:0,p:G},{node:O,type:1,p:G+B/2},{node:O,type:2,p:G+B}),t[O._id]=c}}}),U.sort(function(y,n){return y.p-n.p}),i.sort(function(z,G){return z.p-G.p}),S._grid=R,S._87I=t},rh.prototype.gatherLines=function(j,s,_){var $,i,Q,d,o,B,W,Z,J,A,q,M,C=this,x=[C.findClosest({x:j.x,y:j.y},s),C.findClosest({x:j.x+j.w/2,y:j.y+j.h/2},s),C.findClosest({x:j.x+j.w,y:j.y+j.h},s)],p={},y=C._87I;_=_||255;var X,G;for(C._guideLine=[],$=0;2>$;$++)for(p={},0===$?(d="y",Z=j.x,J=Z+j.w):(d="x",Z=j.y,J=Z+j.h),i=0;3>i;i++)o=x[i],o&&isFinite(o[d])&&(X=1<<3*$+i,_&X&&(B=o[d+"Line"],W=B.node,G=W._id||0,p[G]||(p[G]=!0,M=y[G],"y"===d?(A=M.x,q=M.x+M.width):(A=M.y,q=M.y+M.height),Q=B.p,C._guideLine.push({type:d,a:Z,b:J,c:A,d:q,p:Q,center:1===B.type}))))},rh.prototype._binarySearchClosest=function(i,E){if(!E.length)return{dis:1/0};for(var f,Q=0,h=E.length-1;h-Q>1;)f=Math.floor((Q+h)/2),E[f].p<i?Q=f:h=f;var l=E[Q].p-i,y=E[h].p-i;return Math.abs(l)<=Math.abs(y)?{line:E[Q],dis:l}:{line:E[h],dis:y}},rh.prototype.findClosest=function(u,E,r){var o=this,C=o._interactor,_=C.gv,X=o._grid;r&&(u=Sd.toWorldPosition(_,u));var t,f=o._binarySearchClosest(u.x,X.x),h=o._binarySearchClosest(u.y,X.y),Y=f.dis,j=h.dis,G=_._zoom,A=C.getStyle("smartGuideSensitivity")/G,z={};return Math.abs(Y)<A&&"y"!==E&&(z.x=r?Y*G:Y,z.xLine=f.line,t=!0),Math.abs(j)<A&&"x"!==E&&(z.y=r?j*G:j,z.yLine=h.line,t=!0),t?z:void 0},rh.prototype._42=function(){var K=this,M=K._guideLine;if(M&&!o.Default.isCtrlDown()){var Y,A,k,B,U,N,O,p,j,_,w,X,s,e,r,Q,D,V=K._interactor,G=V.gv,E=V._context,L=G.tx(),S=G.ty(),f=G._zoom,u=V.getStyle("guideLineTextSpacing");for(Y=0,A=M.length;A>Y;Y++)k=M[Y],p=k.type,j=k.p,_=k.a,w=k.b,X=k.c,s=k.d,e=Math.min(_,X),r=Math.max(w,s),"x"===p?(B=j*f+L,U=e*f+S,N=B,O=r*f+S):(B=e*f+L,U=j*f+S,N=r*f+L,O=U),Sd.Icons.DrawIcon(V,E,Sd.Icons.MoveLineGuide,{rect:[B,U,N,O],center:k.center}),s>=_&&w>=X||(e=_>s?s:w,r=_>s?_:X,D=r-e,"x"===p?(k.center2center||(B-=u,N=B),U=e*f+S,O=r*f+S,Q=Sd.Icons.MoveLineGuideDistanceV):"y"===p&&(k.center2center||(U-=u,O=U),B=e*f+L,N=r*f+L,Q=Sd.Icons.MoveLineGuideDistanceH),Sd.Icons.DrawIcon(V,E,Q,{x0:B,y0:U,x1:N,y1:O,dis:D}))}},rh.prototype.clear=function(){this._guideLine=null},Sd.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Hf=Sd.Icons={},td=1e4,cl=null,oi="rgb(51,153,255)",_q="rgb(183,232,135)",ys="rgb(255,204,153)",bo=6;o.Default.setImage("Icons.RectPoint",{width:bo,height:bo,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:oi,rect:[0,0,bo,bo]}]});var ds="#e000e0";Hf.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var N=Hf.GroupSubEntityRect.data;if(!N)return[];var q=N.min,g=N.max;return[q.x,q.y,q.x,g.y,g.x,g.y,g.x,q.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Hf.GroupSubEntityRect.data.isKeyOb?ds:"#666666"}}}]},Hf.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Hf.Line.data.P1.x,Hf.Line.data.P1.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Hf.Line.data.P2.x,Hf.Line.data.P2.y],bo,bo]}}}]},Hf.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Hf.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Hf.Rect={comps:[{type:"shape",points:{func:function(){var b=Hf.Rect.data;if(!b)return[];var W=b.LT,G=b.LB,B=b.RB,M=b.RT;return[W.x,W.y,G.x,G.y,B.x,B.y,M.x,M.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:oi},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},rect:{func:function(){return[[Hf.Rect.data.LT.x,Hf.Rect.data.LT.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},rect:{func:function(){return[[Hf.Rect.data.LB.x,Hf.Rect.data.LB.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},rect:{func:function(){return[[Hf.Rect.data.RB.x,Hf.Rect.data.RB.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},rect:{func:function(){return[[Hf.Rect.data.RT.x,Hf.Rect.data.RT.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},visible:{func:function(){return Hf.Rect.data.L?!0:!1}},rect:{func:function(){return[[Hf.Rect.data.L.x,Hf.Rect.data.L.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},visible:{func:function(){return Hf.Rect.data.R?!0:!1}},rect:{func:function(){return[[Hf.Rect.data.R.x,Hf.Rect.data.R.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},visible:{func:function(){return Hf.Rect.data.T?!0:!1}},rect:{func:function(){return[[Hf.Rect.data.T.x,Hf.Rect.data.T.y],bo,bo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hf.Rect.data.rotation}},visible:{func:function(){return Hf.Rect.data.B?!0:!1}},rect:{func:function(){return[[Hf.Rect.data.B.x,Hf.Rect.data.B.y],bo,bo]}}}]};var _n=16;o.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:oi,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:oi,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Hf.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Hf.Anchor.data.POS.x,Hf.Anchor.data.POS.y],_n,_n]}}}]},Hf.TipShiftX=12,Hf.TipShiftY=12;var yl=[8,28];Hf.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Hf.TipHelper.data.helperPos.x,Hf.TipHelper.data.helperPos.y,yl[0]*Hf.TipHelper.data.size,yl[1]]}},background:{func:function(){return cl.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Hf.TipHelper.data.text}},rect:{func:function(){return[Hf.TipHelper.data.helperPos.x,Hf.TipHelper.data.helperPos.y,yl[0]*Hf.TipHelper.data.size,yl[1]]}},color:{func:function(){return cl.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Xq=7;Hf.ShapePoint={comps:[{type:"circle",rect:{func:function(){var b=Hf.ShapePoint.data.point;return[b,Xq,Xq]}},background:{func:function(){var u=Hf.ShapePoint.data.isEnd;return u?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:oi}]},Hf.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Hf.ShapeBgCurve.data.P}},segments:{func:function(){return Hf.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:oi}]};var _b=8;Hf.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var I=Hf.ShapeHighlighPoint.data;return[[I.x,I.y],_b,_b]}},background:{func:function(){return cl.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var qi=10;Hf.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var n=Hf.ShapeHighlighRealPoint.data;return[[n.x,n.y],qi,qi]}},background:"#ffffff",borderWidth:2,borderColor:oi}]};var pc=8;Hf.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var j=Hf.ShapeHighlighCtrlPoint.data,Q=j.x,a=j.y,L=pc/2;
return[Q-L,a-L,Q-L,a+L,Q+L,a+L,Q+L,a-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return cl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return cl.getStyle("shapeCtrlPointBorderColor")||oi}}}]};var Xf=3;Hf.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Hf.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Xf,borderColor:{func:function(){return cl.getStyle("curveHighlightColor")}}}]},Hf.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Hf.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Hf.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Hf.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Hf.MoveLineGuide.data.center?_q:ys}}}]};var ar=5;Hf.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var R=Hf.MoveLineGuideDistanceH.data,A=R.x0,e=R.y0;return[A,e-ar,A,e+ar]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ys},{type:"shape",points:{func:function(){var S=Hf.MoveLineGuideDistanceH.data,X=S.x1,y=S.y1;return[X,y-ar,X,y+ar]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ys},{type:"text",text:{func:function(){return Math.round(Hf.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var B=Hf.MoveLineGuideDistanceH.data;return[[(B.x0+B.x1)/2,B.y0-10],20,20]}},color:ys,font:"12px Arial",align:"center"}]},Hf.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var H=Hf.MoveLineGuideDistanceV.data,n=H.x0,u=H.y0;return[n-ar,u,n+ar,u]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ys},{type:"shape",points:{func:function(){var $=Hf.MoveLineGuideDistanceV.data,f=$.x1,J=$.y1;return[f-ar,J,f+ar,J]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ys},{type:"text",text:{func:function(){return Math.round(Hf.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var S=Hf.MoveLineGuideDistanceV.data;return[[S.x0-10,(S.y0+S.y1)/2],20,20]}},color:ys,font:"12px Arial",align:"center"}]},o.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Hf.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var I=Hf.EdgeElevationGuide.data,R=I.x,x=I.y,L=cl.getStyle("curveElevationIntersectSize"),D=cl.getStyle("curveElevationGuideShift");return R+=D[0],x+=D[1],[R-L,x-L,2*L,2*L]}}}]},o.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),o.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Hf.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Hf.ConnectGuide.data.rotation}},rect:{func:function(){var f=Hf.ConnectGuide.data.connect;f.x,f.y;var O=cl.getStyle("connectGuideIntersectSize");return[[f.x,f.y],2*O,2*O]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var H=Hf.ConnectGuide.data.cursorPos||Hf.ConnectGuide.data.connect,d=cl.getStyle("connectGuideIntersectSize");return[[H.x,H.y],2*d-2,2*d-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var a=Hf.ConnectGuide.data.connect,l=Hf.ConnectGuide.data.cursorPos||a;return[a.x,a.y,a.x+.5*(l.x-a.x),a.y,l.x+.5*(a.x-l.x),l.y,l.x,l.y]}}}]},o.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),o.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Hf.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var O=Hf.ConnectGuideGarbage.data.hover;return O?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var V=Hf.ConnectGuideGarbage.data,N=cl.getStyle("connectGuideGarbageIntersectsize");return V.hover&&(N+=5),[[V.x,V.y],2*N,2*N]}}}]};var es=6;Hf.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Hf.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Z=Hf.ShapeActivingCtrl.data;return[Z.point.x,Z.point.y,Z.c1.x,Z.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:oi},{type:"shape",visible:{func:function(){return Hf.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var z=Hf.ShapeActivingCtrl.data;return[z.point.x,z.point.y,z.c2.x,z.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:oi},{type:"shape",visible:{func:function(){return Hf.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var N=Hf.ShapeActivingCtrl.data.c1,G=N.x,M=N.y,L=es/2;return"c1"===Hf.ShapeActivingCtrl.data.hl&&(L+=.5),[G-L,M-L,G-L,M+L,G+L,M+L,G+L,M-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return cl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Hf.ShapeActivingCtrl.data.hl?cl.getStyle("shapeCtrlPointHighlightBorder")||oi:cl.getStyle("shapeCtrlPointBorderColor")||oi}}},{type:"shape",visible:{func:function(){return Hf.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var R=Hf.ShapeActivingCtrl.data.c2,K=R.x,G=R.y,$=es/2;return"c2"===Hf.ShapeActivingCtrl.data.hl&&($+=.5),[K-$,G-$,K-$,G+$,K+$,G+$,K+$,G-$]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return cl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Hf.ShapeActivingCtrl.data.hl?cl.getStyle("shapeCtrlPointHighlightBorder")||oi:cl.getStyle("shapeCtrlPointBorderColor")||oi}}}]},Hf.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:oi,rect:{func:function(){return[[Hf.RoundPoint.data.x,Hf.RoundPoint.data.y],bo,bo]}}}]},Sd.Icons.DrawIcon=function(x,p,N,J){N.width=N.height=td,N.data=J,cl=x,o.Default.drawImage(p,N,0,0,td,td)},Sd.Icons.MapPoints=function(C,E){for(var V=0,W=C.length;W>V;V++)C[V]/=E},Sd.roundTo=function(D,I,z){var O=Math.abs(D%I);return z>O||z>I-O?I*Math.round(D/I):D},Sd.toFixed=function(f){return Math.round(100*f)/100},Sd.getDataMatrix=function(Q){if(Q instanceof o.Shape){var p=new o.Math.Matrix2d,U=Q.getPosition();return p.translate(-U.x,-U.y).scale(Q.getScale().x,Q.getScale().y).rotate(Q.getRotation()).translate(U.x,U.y),p}return Q.getMatrix?Q.getMatrix():new o.Math.Matrix2d};var wf=Sd.Math.Curve=function(){this._curves=[]};wf.prototype={},wf.prototype.constructor=wf,wf.prototype.createFromHtShape=function(E,B,f){B instanceof o.List&&(B=B.toArray());var n,r,z,X,D,R,Y,M=this,w=null,i=null,y=0,u=Sd.Math.Vector2,t=Sd.Math.CubicBezier,h=function(q){return new u(E[q],E[q+1],f?f[q/2]:Z)};for(r=0,z=B.length;z>r;r++){switch(X=B[r],D=null,X){case 1:i=h(y),w=i,y+=2;break;case 2:n=h(y),y+=2,D=new t(i,i.clone(),n.clone(),n),i=n;break;case 3:R=h(y),n=h(y+2),y+=4,D=new t(i,R.clone().sub(i).multiplyScalar(2/3).add(i),R.clone().sub(n).multiplyScalar(2/3).add(n),n),i=n;break;case 4:R=h(y),Y=h(y+2),n=h(y+4),y+=6,D=new t(i,R,Y,n),i=n;break;case 5:if(!w)break;D=new t(i,i.clone(),w.clone(),w),i=null,w=null}D&&(D._index=M._curves.length,M._curves.push(D))}},wf.prototype.checkPoint=function(a,D){var R,e,O,g,z,N=this,E=N._curves;for(R=0,e=E.length;e>R;R++)if(g=E[R],z=g.intersectRect(a,D,D),z.length)return O=0,z.forEach(function(d){O+=d.t}),O/=z.length,a=g.getPointAt(O),a.t=O,{bezier:g,intersection:a}},wf.prototype.insertKnot=function(b,M){var t=b.insertKnot(M),s=this,$=s._curves;$.splice(b._index,1,t[0],t[1])},wf.prototype._isCloseEnough=function(G,A){return Math.abs(G.x-A.x)<1e-6&&Math.abs(G.y-A.y)<1e-6},wf.prototype._isSamePoint=function(h,O){return h===O},wf.prototype.moveRealPoint=function(Y,m){var N=this,i=N._curves,Q=m.clone().sub(Y);i.forEach(function(o){var e=o._p1;o._p2,o._p3;var p=o._p4;N._isSamePoint(e,Y)&&(o._p2.add(Q),o._p1=m),N._isSamePoint(p,Y)&&(o._p3.add(Q),o._p4=m)})},wf.prototype.moveCtrlDueToRealPointMovement=function(I,W){var Q=this,B=Q._curves,R=function(m){m.add(W),m.e&&W.e&&(m.e+=W.e)};B.forEach(function(C){var P=C._p1;C._p2,C._p3;var B=C._p4;Q._isSamePoint(P,I)&&R(C._p2),Q._isSamePoint(B,I)&&R(C._p3)})},wf.prototype.moveCtrlPoint=function(r,w,y){var Y=r[y];if(Y){Y.e!==Z&&(w.e=Y.e);var m=this,D=m._curves;w.clone().sub(Y),D.forEach(function(c){var V;"c2"===y?V="_p2":"c1"===y&&(V="_p3"),m._isSamePoint(c[V],Y)&&(c[V]=w)}),r[y]=w}},wf.prototype.deleteRealPoint=function(H,K){var t,e,b,p,d,P,h,o=this,u=o._curves,k={},X=[],$=Sd.Math.CubicBezier;for(e=0,b=u.length;b>e;e++)t=u[e],p=t._p1,d=t._p2,P=t._p3,h=t._p4,(k[e]||!o._isSamePoint(p,H))&&(o._isSamePoint(h,H)?b>e+1&&o._isSamePoint(u[e+1]._p1,H)&&(K||X.push(new $(p,d,u[e+1]._p3,u[e+1]._p4))):X.push(t));o._curves=X},wf.prototype.findPairs=function(I,S){var e,R,v,H,L,t,x,s,F=this,T=F._curves,O={},A=[];for(R=0,v=T.length;v>R;R++)e=T[R],H=e._p1,L=e._p2,t=e._p3,x=e._p4,!O[R]&&F._isSamePoint(H,I)&&(S?A.push({point:H,r2:x}):A.push({point:H,c2:L})),F._isSamePoint(x,I)&&(s=S?{point:x,r1:H}:{point:x,c1:t},v>R+1&&F._isSamePoint(T[R+1]._p1,I)&&(S?s.r2=T[R+1]._p4:s.c2=T[R+1]._p2,O[R+1]=!0),A.push(s));return A},wf.prototype.toHtShape=function(){var d=this,r=d._curves,s=[],g=[],$={x:1/0,y:1/0};return r.forEach(function(R){var P=R._p1,B=R._p2,V=R._p3,Y=R._p4;return d._isCloseEnough(P,$)||(s.push(1),g.push(P.clone())),$=Y,d._isCloseEnough(P,B)&&d._isCloseEnough(V,Y)?(s.push(2),g.push(Y.clone()),void 0):(s.push(4),g.push(B.clone(),V.clone(),Y.clone()),void 0)}),{segments:s,points:g}};var dq=Sd.Math.CubicBezier=function(m,S,J,N){var y=this;y._id=Sd.Math.CubicBezier._globalId++,y._p1=m,y._p2=S,y._p3=J,y._p4=N};dq._globalId=1,dq.prototype={},dq.prototype.constructor=dq,dq.prototype.toString=function(){return this._id},dq.prototype.intersectRect=function(d,b,Y){var E=b/2,x=Y/2,R=d.x,f=d.y,P=Sd.Math.Vector2,k=new P(-E+R,-x+f),O=new P(E+R,x+f),X=new P(O.x,k.y),j=new P(k.x,O.y),U=this,m=U.intersectLine(k,X),K=U.intersectLine(X,O),s=U.intersectLine(O,j),M=U.intersectLine(j,k),t=m.concat(K).concat(s).concat(M);return t},dq.prototype.intersectLine=function(V,p){var P,m,x,W,I,a,f,L,l,y,v,n,B,b=this,H=V.clone().min(p),C=V.clone().max(p);W=b._p1,I=b._p2,a=b._p3,f=b._p4,P=W.clone().multiplyScalar(-1),m=I.clone().multiplyScalar(3),x=a.clone().multiplyScalar(-3),v=P.add(m).add(x).add(f),P=W.clone().multiplyScalar(3),m=I.clone().multiplyScalar(-6),x=a.clone().multiplyScalar(3),y=P.add(m).add(x),P=W.clone().multiplyScalar(-3),m=I.clone().multiplyScalar(3),l=P.add(m),L=W.clone(),B=new Sd.Math.Vector2(V.y-p.y,p.x-V.x),n=V.x*p.y-p.x*V.y;for(var O=b.getRoots(B.dot(v),B.dot(y),B.dot(l),B.dot(L)+n),T=new Array,h=0,$=O.length;$>h;h++){var s=O[h];if(!(0>s||s>1)){var Y=W.clone().lerp(I,s),j=I.clone().lerp(a,s),S=a.clone().lerp(f,s),r=Y.lerp(j,s),D=j.lerp(S,s),U=r.lerp(D,s);U.t=s,V.x==p.x?H.y<=U.y&&U.y<=C.y&&T.push(U):V.y==p.y?H.x<=U.x&&U.x<=C.x&&T.push(U):U.x>=H.x&&U.y>=H.y&&U.x<=C.x&&U.y<=C.y&&T.push(U)}}return T},dq.prototype.solveTForPoint=function(o){var h,i,d,M,p=this;h=p._p1.x-o.x,i=p._p2.x-o.x,d=p._p3.x-o.x,M=p._p4.x-o.x;for(var j=p.getRoots(M-3*d+3*i-h,3*d-6*i+3*h,3*i-3*h,h),u=Z,T=1/0,k=0,G=j.length;G>k;k++){var y=j[k];if(!(0>y||y>1)){var b=p._p1.clone().lerp(p._p2,y),D=p._p2.clone().lerp(p._p3,y),r=p._p3.clone().lerp(p._p4,y),V=b.lerp(D,y),e=D.lerp(r,y),m=V.lerp(e,y);m.t=y;var Q=Math.abs(m.y-o.y);T>Q&&(T=Q,u=m)}}return u},dq.prototype.getPointAt=function(F){var H=this,U=H._p1,R=H._p2,g=H._p3,d=H._p4,Z=U.clone().lerp(R,F),l=R.clone().lerp(g,F),N=g.clone().lerp(d,F),Q=Z.lerp(l,F),k=l.lerp(N,F);return Q.lerp(k,F)},dq.prototype.getRoots=function(n,G,R,z){var k,x,D,V,w,v=new Array;if(Math.abs(n)<1e-6){var k=G,x=R/k,D=z/k,V=x*x-4*D;if(V>0){var w=Math.sqrt(V);v.push(.5*(-x+w)),v.push(.5*(-x-w))}else 0==V&&v.push(.5*-x)}G/=n,R/=n,z/=n,k=(3*R-G*G)/3,x=(2*G*G*G-9*R*G+27*z)/27;var Y=G/3,j=x*x/4+k*k*k/27,Z=x/2;if(Math.abs(j)<=1e-6&&(j=0),j>0){var M,e,w=Math.sqrt(j);M=-Z+w,e=M>=0?Math.pow(M,1/3):-Math.pow(-M,1/3),M=-Z-w,M>=0?e+=Math.pow(M,1/3):e-=Math.pow(-M,1/3),v.push(e-Y)}else if(0>j){var E=Math.sqrt(-k/3),P=Math.atan2(Math.sqrt(-j),-Z)/3,L=Math.cos(P),m=Math.sin(P),T=Math.sqrt(3);v.push(2*E*L-Y),v.push(-E*(L+T*m)-Y),v.push(-E*(L-T*m)-Y)}else{var M;M=Z>=0?-Math.pow(Z,1/3):Math.pow(-Z,1/3),v.push(2*M-Y),v.push(-M-Y)}return v},dq.prototype._70I=function(){var L=this;return L._p1.distanceToSquared(L._p2)<1e-10&&L._p3.distanceToSquared(L._p4)<1e-10},dq.prototype.insertKnot=function(x){var D=this,y=D._p1,M=D._p2,k=D._p3,X=D._p4,H=y.clone().lerp(M,x),G=M.clone().lerp(k,x),_=k.clone().lerp(X,x),B=H.clone().lerp(G,x),C=G.clone().lerp(_,x),N=B.clone().lerp(C,x);return D._70I()?(y.clone().lerp(X,x),[new Sd.Math.CubicBezier(y,y.clone(),N.clone(),N),new Sd.Math.CubicBezier(N,N.clone(),X.clone(),X)]):[new Sd.Math.CubicBezier(y,H,B,N),new Sd.Math.CubicBezier(N,C,_,X)]};var Rg=o.Default.getInternal().ui().EdgeUI,eo={_47O:function(d){var Y=this,u=eo.getBackups()._47O;Sd.inEdit(Y.gv)||u.call(Y,d)}};Sd.Inject.registAsModule(eo,Rg);var vm=o.Default.getInternal().ui().NodeUI,Pg={_47O:function(I){var _=this,B=Pg.getBackups()._47O;Sd.inEdit(_.gv)||B.call(_,I)},getSelectWidth:function(){var V=this,L=V.gv,p=V._data;if(L.isEditable(p)&&Sd.inEdit(L))return 0;var v=Pg.getBackup("getSelectWidth");return v.call(V)}};Sd.Inject.registAsModule(Pg,vm);var $m=o.graph.GraphView,ti={_editPointSize:function(){var J=o.Default.isTouchable,N=Sd.getStyle("pointSize");return N[J?0:1]}(),isPointEditable:function(h){var I=this;if(Sd.inEdit(I))return I._pointEditableFunc?I._pointEditableFunc(h):!0;var l=ti.getBackup("isPointEditable");l.call(I,h)},isEditable:function(Q){var B,L=this,D=ti.getBackup("isEditable");if(B=Q instanceof Sd.Group?!0:D.call(L,Q),!Sd.inEdit(L))return B;if(!(Q instanceof o.Edge))return B;if(!Q.s("2d.editable"))return!1;var V=L.getEditableFunc();return V?V(Q):!0},_42:function(b,e){var H=this,_=ti.getBackups()._42;if(_.call(H,b,e),Sd.inEdit(H)){var p=H.getEditInteractor();p.drawImpl()}}};Sd.Inject.registAsModule(ti,$m);var Ym=o.Default.getInternal().ui().ShapeUI,ne={_47O:function(n){var l=this,t=ne.getBackups()._47O;Sd.inEdit(l.gv)||t.call(l,n)}};Sd.Inject.registAsModule(ne,Ym);var kj=o.graph.DefaultInteractor,Hq={handle_mousewheel:function(m){var i=this,t=Hq.getBackup("handle_mousewheel");Sd.inEdit(i.gv)||t.call(i,m)}};Sd.Inject.registAsModule(Hq,kj);var Gc=o.graph.MoveInteractor,Nr={_calcShift:function(J,K){var F=this,u=Nr.getBackup("_calcShift"),o=F.gv;if(!Sd.inEdit(o))return u.call(F,J,K);var r=o.getEditInteractor(),X=r.getSubModule("Move").calcShift(J,K,F);return X||u.call(F,J,K)},clear:function(D){var c=this,r=Nr.getBackup("clear");r.call(c,D);var A=c.gv;if(Sd.inEdit(A)){var M=A.getEditInteractor();M.getSubModule("Move").clear(D)}}};Sd.Inject.registAsModule(Nr,Gc);var rh=Sd.Rect=function(u){this.catalog="Rect",this._interactor=u};rh.prototype={},rh.prototype.constructor=rh,rh.prototype.gatherInfo=function(s,c){var w=this;if(1===c.length){var D=c[0];return D instanceof o.Shape&&D._70I()?w.gatherLine(s,D):km(D,s)?!1:w.gatherSingleTarget(s,D)}return c.length>1?w.gatherMultiTargets(s,c):!1},rh.prototype.gatherSingleTarget=function(K,u){if(u.getCorners){var _,U=this,l=U.info;U.target=u,_=U.screenInfo={};var p=u.getCorners();l.LT=new Sd.Math.Vector2(p[0]),l.LB=new Sd.Math.Vector2(p[1]),l.RB=new Sd.Math.Vector2(p[2]),l.RT=new Sd.Math.Vector2(p[3]),l.T=l.LT.clone().add(l.RT).divideScalar(2),l.B=l.LB.clone().add(l.RB).divideScalar(2),l.L=l.LT.clone().add(l.LB).divideScalar(2),l.R=l.RT.clone().add(l.RB).divideScalar(2);for(var E in l)_[E]=Sd.toScreenPosition(K,l[E]);var s=U._interactor,e=s.getStyle("checkSize"),R=function(k,q,R){var G=q.clone().sub(k).setLength(-e),c=R.clone().sub(k).setLength(-e),t=G.add(c).add(k);return t};return _.rotLT=R(_.LT,_.RT,_.LB),_.rotLB=R(_.LB,_.LT,_.RB),_.rotRB=R(_.RB,_.LB,_.RT),_.rotRT=R(_.RT,_.LT,_.RB),_.rotT=_.rotLT.clone().add(_.rotRT).divideScalar(2),_.rotB=_.rotLB.clone().add(_.rotRB).divideScalar(2),_.rotL=_.rotLT.clone().add(_.rotLB).divideScalar(2),_.rotR=_.rotRT.clone().add(_.rotRB).divideScalar(2),_.rotation=u.getRotation(),U.gatherConnectInfo(),!0}},rh.prototype.gatherConnectInfo=function(){var i=this,l=i.target,r=i._interactor,$=i.screenInfo,L=r.gv;if(L.isConnectActionVisible(l)&&r.getStyle("connectGuideVisible")){var E;l.s&&(E=l.s("connectGuideShift")),E||(E=r.getStyle("connectGuideShift"));var m=l.getAnchor(),T=l.getSize(),B=l.toGlobal({x:T.width*(E[0]-m.x),y:T.height*(E[1]-m.y)});B=Sd.toScreenPosition(L,B),$.P1?B.add($.P2.clone().sub($.P1).setLength(E[2])):(B.add($.RT.clone().sub($.LT).setLength(E[2])),B.add($.LB.clone().sub($.LT).setLength(E[3]))),$.connect=B}},rh.prototype.gatherMultiTargets=function(s,f){var G=Sd.Group.findOrCreateGroup(f);if(!G)return!1;var r=this;return r.editing&&"rotate"!==r.editing.mode||G.calcInfo(),r.gatherSingleTarget(s,G)},rh.prototype.gatherLine=function(S,B){this.target=B;var f=this.screenInfo={},u=B.getPoints(),c=Sd.getDataMatrix(B);return f.P1=Sd.toScreenPosition(S,c.apply(u.get(0))),f.P2=Sd.toScreenPosition(S,c.apply(u.get(1))),this.gatherConnectInfo(),!0},rh.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],rh.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],rh.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],rh.prototype.check=function(q,y,e){if(o.Default.isLeftButton(y)){var N=this;if(N.editing=null,N.tipInfo=null,N.screenInfo){var f=N.target,u=q.isEditable(f),K=N.screenInfo;if(u&&K.connect){var p=N._checkConnect(e);if(p)return p}if(K.P1)return N._checkLine(e);var $,z,s,x=null,l=N._interactor,M=l.getStyle("checkSize");if(u&&q.isRectEditable(f))for(z=0;z<Sd.Rect.ResizeKeys.length;z++)if(s=Sd.Rect.ResizeKeys[z],Sd.checkHit(e,K[s],M)){x=s,$="resize";break}if(!x&&u&&q.isRotationEditable(f)&&!l.getStyle("rotateAsClock")){var h=l.getStyle("rotateCheckSize");for(z=0;z<Sd.Rect.RotateKeys.length;z++)if(s=Sd.Rect.RotateKeys[z],Sd.checkHit(e,K[s],h)){x=s,$="rotate";break}}if(!x)return l.setCursor("default"),void 0;if("rotate"===$){var n,P=q.lp(y);if(f instanceof Sd.Group){var H=l.getStyle("groupRotateModeKey");"string"==typeof H&&(H=[H]);for(var X=!1,g=0,G=H.length;G>g;g++)if(y[H[g]]){X=!0;break}var m=l.getStyle("groupRotateModeDefault");n=X?"batch"===m?"block":"batch":m}var k="batch"===n?f.getAnchor2():f.getPosition(),J=Math.atan2(P.y-k.y,P.x-k.x);l._setRotateCursor(J),N.editing={mode:$,key:x,pos:k,flipY:f.getScale().y<0,rotation:f.getRotation(),hitRot:J},n&&(N.editing.groupRotateMode=n)}else{var d=Sd.Rect.ResizeKeys.indexOf(x),r=Sd.Rect.ResizeDirection[d],U=Math.cos(f.getRotation()),V=Math.sin(f.getRotation()),t=r.x*Math.sign(f.getScale().x),v=r.y*Math.sign(f.getScale().y),S=Math.atan2(-V*t-U*v,U*t-V*v),w=(Math.round(S/(Math.PI/4))+8)%8,D=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][w];this._interactor.setCursor(D);var B=f.getWidth(),E=f.getHeight(),c=f.getAnchor();N.editing={mode:$,key:x,rect:{x:-B*c.x,y:-E*c.y,width:B,height:E},anchor:c,matrix:f.getMatrix()}}return x}}},rh.prototype._checkLine=function(g){var S=this;S.screenInfo;var d,l=S._interactor.getStyle("checkSize");if(Sd.checkHit(g,S.screenInfo.P1,l))d="P1";else{if(!Sd.checkHit(g,S.screenInfo.P2,l))return this._interactor.setCursor("default"),void 0;d="P2"}return S.editing={mode:"line",key:d},d},rh.prototype._checkConnect=function(l){var k=this,u=k.screenInfo,E=k._interactor,O=E.getStyle("connectGuideIntersectSize"),x=u.connect,F=l.x,H=x.x;if(H>F&&O>H-F&&Math.abs(x.y-l.y)<O||F>=H&&Sd.checkHit(l,x,O)){var i="connect",e=C.getConnectAction(E.gv);if(k.editing={mode:i},e&&e.delete)if(k.target instanceof Sd.Group){var q=!0;E.gv.sm().getSelection().each(function(w){e.delete.visible.call(null,E.gv,w)||(q=!1)}),k.editing.hasDeleteAction=q}else e.delete.visible.call(null,E.gv,k.target)&&(k.editing.hasDeleteAction=!0);return E.setCursor("default"),i}},rh.prototype._fireEditEvent=function(B,V){var O=this._interactor,r=this.editing;if(r){var s=r.mode;s="rotate"===s?"Rotation":"connect"===s?"Connection":s[0].toUpperCase()+s.slice(1),O.fi({kind:B+"Edit"+s,event:V})}},rh.prototype.startEdit=function(b,y){b.startDragging(y);var T=this;T._interactor.fi({kind:"prepareEdit",event:y});var s=T.editing,h=T.target;if(s){if(T._fireEditEvent("begin",y),"rotate"===s.mode)return s.groupRotateMode&&h.beginRotate(s),void 0;if("connect"!==s.mode)("line"===s.mode||h&&0===h.getRotation())&&(T._inSmartGuide=!0,T._interactor.rectGuide.gatherRects());else if(s.hasDeleteAction){var j=b.gv,C=T._interactor.getStyle("connectGuideGarbageShift");s.garbageInfo={x:j.getWidth()*C[0]+C[2],y:j.getHeight()*C[1]+C[3],size:T._interactor.getStyle("connectGuideGarbageIntersectsize")},b._42()}}},rh.prototype._46O=function(L){var u,w=this,j=w.editing;if(j){if("connect"===j.mode&&!j.canceled&&!j.deleted)try{j.garbageInfo&&j.garbageInfo.hover?C.doDeleteConnectionAction(w._interactor.gv,w.target):C.doConnectAction(w._interactor.gv,w.target,j.target)}catch(U){console.error(U)}u=w.editing.groupRotateMode,w._fireEditEvent("end",L),w.editing=null}w.tipInfo=null,w._inSmartGuide&&(w._interactor.rectGuide.clear(),w._inSmartGuide=!1),u&&w.target&&w.target.endRotate()},rh.prototype.handleNormalStateDelete=function(){var _=this,m=_.editing;if(m&&"connect"===m.mode&&!m.canceled&&!m.deleted){if(m.garbageInfo){try{C.doDeleteConnectionAction(_._interactor.gv,_.target)}catch(Z){console.error(Z)}m.garbageInfo=null}return m.cursorPos=null,m.targetCorners=null,m.deleted=!0,_._interactor._42(),!0}},rh.prototype.handleNormalStateKeyDown=function(z){var F=this,K=F.editing;return!K||"connect"!==K.mode||K.canceled||K.deleted?void 0:o.Default.isEsc(z)?(K.cursorPos=null,K.targetCorners=null,K.canceled=!0,F._interactor._42(),!0):void 0},rh.prototype.handleEdit=function(d,U){var l=this,b=l.editing;if(b){var g,M,I,v,u,C=l.target,F=b.key,k=b.mode,B=d.lp(U),x=l._interactor;if("connect"===k){if(b.canceled)return;if(b.deleted)return;b.cursorPos=x._getLogicalPoint(U);var Q=b.garbageInfo;return Q&&Sd.checkHit(b.cursorPos,Q,Q.size)?(Q.hover=!0,b.target=null,b.targetCorners=null):(Q&&(Q.hover=!1),b.target=d.getDataAt(B,function(v){return d.isSelectable(v)?Cd(v)?!0:!1:!1})||null,b.targetCorners=Sd.getTargetCornersOnScreen(d,b.target)),x._42(),void 0}if("rotate"===k){var s,S,$=b.pos,w=Math.atan2(B.y-$.y,B.x-$.x);if(b.groupRotateMode?S=w-b.hitRot:(s=w-b.hitRot,S=b.rotation+s),S%=2*Math.PI,0>S&&(S+=2*Math.PI),!o.Default.isCtrlDown(U)){var N,P;_g(U)?(N=x.getStyle("shiftRotateRound"),P=N/2):(N=x.getStyle("rotateRound"),P=x.getStyle("rotateSensitivity")),S=Sd.roundTo(S,N,P)}b.groupRotateMode?(s=S-(b.lastRotation||0),0!==s&&(C.addRotation(s,b.groupRotateMode),b.lastRotation=S)):C.setRotation(S),x._setRotateCursor(w),S>Math.PI&&(S-=2*Math.PI);var h=180*(S/Math.PI);h=h.toFixed(2),g=""+h+""}else if("resize"===k){var Y=b.rect;I=Y.x,v=Y.y;var j,a=Y.width,J=Y.height,z=b.anchor,n=b.matrix,D=C.s&&C.s("keepAspectRatio")||x.getStyle("keepAspectRatio");_g(U)&&(D=!D);var y=l._unionPointMode1,R=l._unionPointMode2;if(l._inSmartGuide&&!o.Default.isCtrlDown(U)&&!D){var A;"L"===F||"R"===F?A="x":("T"===F||"B"===F)&&(A="y"),l._adsorbedToClosest(B,A),u=!0}j=n.tfi(B);var Z;"LT"===F?(Y=y(j,{x:I+a,y:v+J},a,J,D),Z=9):"T"===F?(Y=R({x:I,y:j.y},{x:I+a,y:v+J},a,J,D,"v"),Z=1):"RT"===F?(Y=y(j,{x:I,y:v+J},a,J,D),Z=33):"L"===F?(Y=R({x:j.x,y:v},{x:I+a,y:v+J},a,J,D,"h"),Z=8):"R"===F?(Y=R({x:I,y:v},{x:j.x,y:v+J},a,J,D,"h"),Z=32):"LB"===F?(Y=y(j,{x:I+a,y:v},a,J,D),Z=12):"B"===F?(Y=R({x:I,y:v},{x:I+a,y:j.y},a,J,D,"v"),Z=4):"RB"===F&&(Y=y(j,{x:I,y:v},a,J,D),Z=36);var O=n.tf(Y.x+Y.width*z.x,Y.y+Y.height*z.y);C.setPosition(O),C.setSize(Y.width,Y.height),u&&(M=C.getRect(),x.rectGuide.gatherLines({node:C,x:M.x,y:M.y,w:M.width,h:M.height},A,Z)),g=""+Math.round(Y.width)+" * "+Math.round(Y.height)}else if("line"===k){if(_g(U)){var e=C.getPoints(),L="P1"===F?e.get(1):e.get(0),c={x:B.x-L.x,y:B.y-L.y},K=x.getStyle("shiftLineRotateRound"),r=l._shiftDirList;if(!r||l._shiftRotateRound!==K){l._shiftRotateRound=K,l._shiftDirList=r=[];for(var G=0;G<Math.PI;G+=K)r.push({x:W(G),y:T(G)})}for(var X,E=0,t=0,m=r.length;m>t;t++){var _=r[t],H=_.x*c.x+_.y*c.y;Math.abs(H)>Math.abs(E)&&(E=H,X=_)}B={x:L.x+X.x*E,y:L.y+X.y*E},x.rectGuide.clear()}else l._inSmartGuide&&!o.Default.isCtrlDown(U)&&(l._adsorbedToClosest(B),u=!0);var q=Sd.getDataMatrix(C).applyInverse(B);C.setPoint("P1"===F?0:1,q,!0);var p=C.getPoints(),i=p.get(0),f=p.get(1);I=i.x-f.x,v=i.y-f.y,g=" "+Math.round(Math.sqrt(I*I+v*v))+" ",u&&(M=C.getRect(),x.rectGuide.gatherLines({node:C,x:M.x,y:M.y,w:M.width,h:M.height}))}if(g){var V=o.Default.getLogicalPoint(U,x._canvas);V.x+=Sd.Icons.TipShiftX,V.y+=Sd.Icons.TipShiftY,l.tipInfo={helperPos:V,text:g,size:g.length}}l._fireEditEvent("between",U)}},rh.prototype._unionPointMode1=function(r,s,E,$,l){if(l&&E&&$){var U=r.x-s.x,n=r.y-s.y;Math.abs(U*$)<Math.abs(n*E)?(n=Math.sign(n)*Math.abs(U*$/E),r.y=s.y+n):(U=Math.sign(U)*Math.abs(n*E/$),r.x=s.x+U)}return o.Default.unionPoint(r,s)},rh.prototype._unionPointMode2=function(L,P,w,E,u,b){var p=o.Default.unionPoint(L,P);if(u&&w&&E){var i;"v"===b?(i=p.x+p.width/2,p.width=w*p.height/E,p.x=i-p.width/2):(i=p.y+p.height/2,p.height=E*p.width/w,p.y=i-p.height/2)}return p},rh.prototype._adsorbedToClosest=function(t,x){var L=this,e=L._interactor,n=e.rectGuide.findClosest(t,x),B=e.gridGuide.findClosest(t,x),g=1/0,T=1/0;n&&(isFinite(n.x)&&(g=n.x),isFinite(n.y)&&(T=n.y)),B&&(isFinite(B.x)&&Math.abs(B.x)<Math.abs(g)&&(g=B.x),isFinite(B.y)&&Math.abs(B.y)<Math.abs(T)&&(T=B.y)),isFinite(g)&&(t.x+=g),isFinite(T)&&(t.y+=T)},rh.prototype._42=function($,f,W){var B=this;B.info={},B.screenInfo=null;var E=B._interactor;if(!E.editDetail&&B.gatherInfo(f,W)){var c=B.editing,N=c?c.groupRotateMode:null,v=B.screenInfo;"block"!==N&&(v.P1?Sd.Icons.DrawIcon(E,$,Sd.Icons.Line,v):Sd.Icons.DrawIcon(E,$,Sd.Icons.Rect,v),v.connect&&(Sd.Icons.DrawIcon(E,$,Sd.Icons.ConnectGuide,{rotation:v.rotation,connect:v.connect,cursorPos:c?c.cursorPos:null}),c&&(c.targetCorners&&Sd.Icons.DrawIcon(E,$,Sd.Icons.NodeHoverGuide,c.targetCorners),c.garbageInfo&&Sd.Icons.DrawIcon(E,$,Sd.Icons.ConnectGuideGarbage,c.garbageInfo))),B.tipInfo&&Sd.Icons.DrawIcon(E,$,Sd.Icons.TipHelper,B.tipInfo)),B.target instanceof Sd.Group&&B.target._42(E,$,f)}};var Pe=Sd.Anchor=function(q){this.catalog="Anchor",this._interactor=q};Pe.prototype={},Pe.prototype.constructor=Pe,Pe.prototype.gatherInfo=function(p,c){var E=this;if(1===c.length){var M=c[0];if(!M.getAnchor)return;if(M instanceof o.Shape&&M._70I())return;if(km(M,p))return;return E.gatherSingleTarget(p,c[0])}return c.length>1?E.gatherMultiTargets(p,c):!1},Pe.prototype.gatherSingleTarget=function(S,x){var r=this;return r.info.POS=x.getPosition(),r.screenInfo.POS=Sd.toScreenPosition(S,r.info.POS),r.target=x,!0},Pe.prototype.gatherMultiTargets=function(X,V){var F=this,f=Sd.Group.findOrCreateGroup(V);return f?(F.screenInfo.POS=Sd.toScreenPosition(X,f.getAnchor2()),F.target=f,!0):!1},Pe.prototype.isVisible=function(){var m=this,i=m._interactor;if(i.getStyle("anchorVisible")===!1)return!1;var O=m.target;if(O){if(this.editing)return!0;var L=O.getAnchor(),Z=i.getStyle("anchorOutsideVisibleThreshold");if(L.x<-Z||L.x>1+Z||L.y<-Z||L.y>1+Z)return!0;var S=O.getSize(),$=O.getScale(),q=Math.min(Math.abs(S.width*$.x),Math.abs(S.height*$.y));if(q*i.gv._zoom<i.getStyle("anchorHideThreshold"))return!1}return!0},Pe.prototype.check=function(S,K,e){if(o.Default.isLeftButton(K)){var l=this,c=l._interactor;if(l.isVisible()&&c.getStyle("anchorMovable")!==!1){l.editing=null,l.tipInfo=null;var D=l.target;if(D&&S.isAnchorEditable(D)&&S.isEditable(D)){var $;if(l.screenInfo&&($=l.screenInfo.POS)&&Sd.checkHit(e,new Sd.Math.Vector2($),c.getStyle("checkSize"))){if(D instanceof Sd.Group)return l.editing={},!0;var R=D.getWidth(),j=D.getHeight(),F=D.getAnchor();return l.editing={rect:{x:-R*F.x,y:-j*F.y,width:R,height:j},anchor:F,matrix:D.getMatrix()},!0}}}}},Pe.prototype.startEdit=function(S,l){S.startDragging(l),S.fi({kind:"beginEditAnchor",event:l})},Pe.prototype._46O=function(x){var R=this;R.editing&&(R.editing=null,R._interactor.fi({kind:"endEditAnchor",event:x})),R.tipInfo=null},Pe.prototype.handleEdit=function(k,e){var V=this,O=V.target;if(O){var Z=V.editing;if(Z){var m=k.lp(e),v=V._interactor;if(O instanceof Sd.Group)return O.setAnchor2(m),v._42(),void 0;var X=Z.matrix,b=X.tfi(m),y=Z.rect,j=(b.x-y.x)/y.width,$=(b.y-y.y)/y.height;if(!o.Default.isCtrlDown(e)){var t=v.getStyle("anchorRound"),J=v.getStyle("anchorSensitivity");j=Sd.roundTo(j,t,J),$=Sd.roundTo($,t,J)}O.setAnchor(j,$,!0);var h=o.Default.getLogicalPoint(e,v._canvas);h.x+=Sd.Icons.TipShiftX,h.y+=Sd.Icons.TipShiftY;var p=""+j.toFixed(2)+", "+$.toFixed(2);V.tipInfo={helperPos:h,text:p,size:p.length},v.fi({kind:"betweenEditAnchor",event:e})}}},Pe.prototype._42=function(K,Z,G){var a=this;a.info={},a.screenInfo={};var j=a._interactor;j.editDetail||a.gatherInfo(Z,G)&&a.isVisible()&&(Sd.Icons.DrawIcon(j,K,Sd.Icons.Anchor,a.screenInfo),a.tipInfo&&Sd.Icons.DrawIcon(j,K,Sd.Icons.TipHelper,a.tipInfo))};var Fg=Sd.RotateX=function(q){this.catalog="RotateX",this._interactor=q};Fg.prototype={},Fg.prototype.constructor=Fg,Fg.prototype.gatherInfo=function(D,u){var O=this;if(1===u.length){var t=u[0];return t instanceof o.Shape&&t._70I()||km(t,D)?!1:O.gatherSingleTarget(D,t)}return u.length>1?O.gatherMultiTargets(D,u):!1},Fg.prototype.gatherSingleTarget=function(){var E=new o.Math.Vector2,t=new o.Math.Vector2,P=new o.Math.Vector2,a=new o.Math.Vector2,z=function(s,b){var C=s.x-b.x,J=s.y-b.y;return C*C+J*J};return function(q,d){if(d.getCorners){var w=this,r=d.getCorners(),Z=15,N=d.getPosition();
E.copy(r[0]),P.copy(r[1]),a.copy(r[3]),t.copy(E).add(a).divideScalar(2).add(E.sub(P).setLength(Z/q.getZoom()));var Q=Math.max(z(N,r[0]),z(N,r[1]),z(N,r[2]),z(N,r[3]));return w.info.POS=t.clone(),w.screenInfo.POS=Sd.toScreenPosition(q,w.info.POS),w.screenInfo.LEN=Math.sqrt(Q)*q.getZoom()+Z,w.screenInfo.CENTER=Sd.toScreenPosition(q,N),w.target=d,!0}}}(),Fg.prototype.gatherMultiTargets=function(h,e){var U=this,J=Sd.Group.findOrCreateGroup(e);if(!J)return!1;var U=this;return U.editing||J.calcInfo(),U.gatherSingleTarget(h,J)},Fg.prototype.isVisible=function(){var o=this._interactor;if(!o.getStyle("rotateAsClock"))return!1;var b=this.target;if(!b)return!0;var h=o.gv;return h.isEditable(b)&&h.isRotationEditable(b)?!0:!1},Fg.prototype.check=function(N,y,w){var b=this,U=b._checkImpl(N,y,w);return(U||b._clockPainted)&&b._interactor._42(),U},Fg.prototype._checkImpl=function(j,Q,u){if(o.Default.isLeftButton(Q)){var W=this;W.editing=null,W.tipInfo=null;var Y;if(W.screenInfo&&(Y=W.screenInfo.POS)&&W.isVisible()){var y=W._interactor;if(Sd.checkHit(u,Y,y.getStyle("checkSize"))){var S=W.target,b=j.lp(Q),K=S.getPosition(),X=Math.atan2(b.y-K.y,b.x-K.x);return y._setRotateCursor(X),W.editing={pos:K,rotation:S.getRotation(),hitRot:X,groupRotateMode:"block",screenInfo:{CENTER:W.screenInfo.CENTER,LEN:W.screenInfo.LEN}},!0}}}},Fg.prototype.startEdit=function(f,L){f.startDragging(L),f.fi({kind:"beginEditRotation",event:L}),this.target instanceof Sd.Group&&this.target.beginRotate(this.editing)},Fg.prototype._46O=function(C){var v=this;v.editing&&(v.editing=null,v._interactor.fi({kind:"endEditRotation",event:C})),v.target instanceof Sd.Group&&v.target.endRotate(),v.tipInfo=null},Fg.prototype.handleEdit=function(v,l){var U=this,Y=U.editing;if(Y){var q,N,h=U.target,c=v.lp(l),M=U._interactor,p=Y.pos,J=Math.atan2(c.y-p.y,c.x-p.x),A=h instanceof Sd.Group;if(A?N=J-Y.hitRot:(q=J-Y.hitRot,N=Y.rotation+q),N%=2*Math.PI,0>N&&(N+=2*Math.PI),!o.Default.isCtrlDown(l)){var t,m;_g(l)?(t=M.getStyle("shiftRotateRound"),m=t/2):(t=M.getStyle("rotateRound"),m=M.getStyle("rotateSensitivity")),N=Sd.roundTo(N,t,m)}A?(q=N-(Y.lastRotation||0),0!==q&&(h.addRotation(q,Y.groupRotateMode),Y.lastRotation=N)):h.setRotation(N),M._setRotateCursor(J),N>Math.PI&&(N-=2*Math.PI);var T=180*(N/Math.PI),s=""+T.toFixed(2)+"",V=o.Default.getLogicalPoint(l,M._canvas);V.x+=Sd.Icons.TipShiftX,V.y+=Sd.Icons.TipShiftY,U.tipInfo={helperPos:V,text:s,size:s.length},M.fi({kind:"betweenEditRotation",event:l})}},Fg.prototype._42=function(O,D,J){var I=this;I._clockPainted=!1,I.info={},I.screenInfo={};var q=I._interactor;q.editDetail||I.gatherInfo(D,J)&&I.isVisible()&&(Sd.Icons.DrawIcon(q,O,Sd.Icons.RoundPoint,I.screenInfo.POS),I.tipInfo&&Sd.Icons.DrawIcon(q,O,Sd.Icons.TipHelper,I.tipInfo),I.editing&&I.drawClock(O))},Fg.prototype.drawClock=function(k){k.save();var B=this;B._clockPainted=!0;var E=B.editing||{},d=E.screenInfo||B.screenInfo,h=d.LEN,M=h+8,Q=h+18;k.save(),k.translate(d.CENTER.x,d.CENTER.y),k.beginPath(),k.strokeStyle="rgb(150, 150, 150)";for(var m,F,n,l,x,g=0;360>g;g++)m=g*Math.PI/180,0===g%5&&(F=T(m)*h,n=W(m)*h,l=T(m)*M,x=W(m)*M,k.moveTo(F,n),k.lineTo(l,x)),0===g%45&&(F=T(m)*h,n=W(m)*h,l=T(m)*Q,x=W(m)*Q,k.moveTo(F,n),k.lineTo(l,x));k.stroke(),k.rotate(-b);var s=E.lastRotation||B.target.getRotation();k.beginPath(),k.fillStyle="rgba(255, 0, 0, 0.1)",k.strokeStyle="rgb(157, 157, 157)",k.moveTo(0,0),k.arc(0,0,Q,0,s,!1),k.fill(),k.beginPath(),k.moveTo(0+Q,0),k.arc(0,0,Q,0,s,!1),k.stroke(),k.restore()};var wf=Sd.Curve=function(w){this.catalog="Curve",this._interactor=w};wf.prototype={},wf.prototype.constructor=wf,V.defineProperties(wf.prototype,{activing:{get:function(){return this._activing},set:function(h){var c=this;if(h)c._activing=new Sd.CurveActiving(this,h);else{var G=c._activing;G&&G.dispose(),c._activing=null}}}}),wf.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},wf.prototype.setUp=function(){var B=this,n=B._interactor;n&&n.gv.mp(B._onGraphviewPropertyChanged,B)},wf.prototype._onGraphviewPropertyChanged=function(i){("zoom"===i.property||"translateX"===i.property||"translateY"===i.property)&&this._handleDataChanged()},wf.prototype.tearDown=function(){var N=this,G=N._interactor;G&&G.gv.ump(N._onGraphviewPropertyChanged,N)},wf.prototype.canEnterEditDetailMode=function(){var q=this,Z=q._interactor,U=Z._getValidSelection();if(1===U.length){var Y=U[0],s=Y instanceof o.Edge;if(Y instanceof o.Shape||s){if(s){var g=Y.s("edge.type");if(g&&"points"!==g)return}var T=Z.gv;if(T.isPointEditable(Y)&&T.isEditable(Y))return q.target=Y,!0}}},wf.prototype.preHandleScroll=function(){var n=this.editing;return n&&n.inEdit?!0:void 0},wf.prototype.getCurrentSelectintStatus=function(){var e=this;if(e.activing&&!e.activing.selections){if(e.activing.status!=Z)return e.activing.status;var n=function(f){var D=e.activing.status;e.activing.status=f,e._interactor.fp("shapePointStatus",D,f)},B=Sd.Curve.PointType,$=e.activing.point,u=e.activing.pairs;if(!u||1!==u.length)return n(B.Mirrored);var t=u[0],s=t.c1&&t.c1.isNearEnough($),d=t.c2&&t.c2.isNearEnough($);if(!t.c1||!t.c2)return s||d?n(B.Straight):n(B.Disconnected);if(s&&d)return n(B.Straight);if(s||d)return n(B.Asymmetric);var h=t.c1.clone().sub($),A=t.c2.clone().sub($);return Math.abs(h.x*A.y-h.y*A.x)>1e-5||h.x*A.x>0?n(B.Disconnected):Math.abs(h.length()-A.length())>1e-5?n(B.Asymmetric):n(B.Mirrored)}},wf.prototype.handle_keydown=function(e){var D=this;if(D._interactor.editDetail){var v=Sd.Curve.PointType;"1"===e.key?D._setCurrentSelectionStatus(v.Straight):"2"===e.key?D._setCurrentSelectionStatus(v.Mirrored):"3"===e.key?D._setCurrentSelectionStatus(v.Disconnected):"4"===e.key&&D._setCurrentSelectionStatus(v.Asymmetric)}},wf.prototype.setCurrentSelectionStatus=function(s){var j=this,G=j._interactor;if(G){var T=G.gv;T.dm().beginTransaction(),this._setCurrentSelectionStatus(s),T.dm().endTransaction()}},wf.prototype._setCurrentSelectionStatus=function(h){var G=this,i=G.activing;if(i){var B=G.getCurrentSelectintStatus();if(null!==B&&B!==h){i.status=h;var k=G.activing.point,O=G.activing.pairs;if(O&&1===O.length){var N=O[0],J=G.screenInfo.curve,q=Sd.Curve.PointType,K=function(){G._writeToHt(),G._interactor.fp("shapePointStatus",B,h)};if(h===q.Straight)return J.moveCtrlPoint(N,k,"c1"),J.moveCtrlPoint(N,k,"c2"),K(),void 0;if(B===q.Straight){var g=J.findPairs(k,!0),n=g[0],D=n.r1||k,M=n.r2||k,m=M.clone().sub(D).multiplyScalar(.25);return J.moveCtrlPoint(N,k.clone().sub(m),"c1"),J.moveCtrlPoint(N,k.clone().add(m),"c2"),K(),void 0}var P=N.c1,w=N.c2;if(P&&w){if(h===q.Mirrored)return J.moveCtrlPoint(N,k.clone().multiplyScalar(2).sub(w),"c1"),K(),void 0;if(h===q.Asymmetric&&B===q.Disconnected){var $=P.clone().sub(k).length(),m=k.clone().sub(w).setLength($).add(k);return J.moveCtrlPoint(N,m,"c1"),K(),void 0}}i._firePointChange(),G._interactor.fp("shapePointStatus",B,h)}}}},wf.prototype._handleDataChanged=function(j){var V=this;if(V.screenInfo&&V.target){var D=V._interactor;V.gatherSingleTarget(D.gv,V.target,!0),V.check(D.gv,null,j?D._getLogicalPoint(j):new Sd.Math.Vector2(D._lastClientPoint)),D._42()}},wf.prototype.gatherSingleTarget=function(z,S,n){var F,J,k=this;k.screenInfo&&k.screenInfo.curve&&(J=k.screenInfo.curve._curves);var d=k.editing;F=d?k.screenInfo:k.screenInfo={};var q,T,s=S instanceof o.Edge;s?(q=S.s("edge.segments"),T=S.s("edge.points")||new o.List):(q=S._58O,T=S._59O),F.S=q;var b,B=F.P=[],C=Sd.getDataMatrix(S);if(S instanceof o.Polyline&&(b=S.getElevation()||0,F.E=[]),T.each(function(H){F.E&&F.E.push(H.e||b),H=C.apply(H);var S=Sd.toScreenPosition(z,H);B.push(S.x,S.y)}),s){var X=Sd.toScreenPosition(z,S._lastSourcePoint),x=Sd.toScreenPosition(z,S._lastTargetPoint);B.splice(0,0,X.x,X.y),B.push(x.x,x.y)}if(!F.S||!F.S.size()){F.S=new o.List,F.S.add(1);for(var U=0;U<B.length/2-1;U++)F.S.add(2)}if((!d||n)&&k.convertToCubicBezier(J),k.activing&&(n||!k.editing||"realPoint"===k.editing.type)){var t=F.curve.findPairs(k.activing.point);k.activing.pairs=t}s&&"points"!==S.s("edge.type")&&k._writeToHt()},wf.prototype._convertToNewPoint=function(B,q,W){var d,w,k;for(d=0,w=q.length;w>d;d++){if(k=q[d],k._p1.isNearEnough(B))return k._p1;if(k._p4.isNearEnough(B))return k._p4}if(W)for(d=0,w=Math.min(W.length,w);w>d;d++){if(k=W[d],k._p1===B)return q[d]._p1;if(k._p4===B)return q[d]._p4}},wf.prototype.convertToCubicBezier=function(v){var l,K,P=this,e=new Sd.Math.Curve,Y=P.screenInfo;if(e.createFromHtShape(Y.P,Y.S,Y.E),Y.curve=e,P.activing){var Q=e._curves;if(l=P.activing.point,K=P._convertToNewPoint(l,Q,v),K&&(P.activing.point=K),P.activing.selections){var B=-1,V=P.activing.selections;V.forEach(function(o){B++,K=P._convertToNewPoint(o,Q,v),K&&(V[B]=K)})}}},wf.prototype.check=function(R,m,S){if(!m||o.Default.isLeftButton(m)){var P=this;if(P._interactor.setCursor("default"),P.editing=null,P.highlight=null,P.tipInfo=null,P.screenInfo){if(ci())return P._interactor._42(),!0;if(P._checkEditCtrlPoint(S))return P._interactor._42(),!0;if(P._checkEditRealPoint(S))return P._interactor._42(),!0;if(P._checkEditElevation(S))return P._interactor._42(),!0;var r=P.screenInfo.curve,Q=r.checkPoint(S,P._interactor.getStyle("curveIntersectSize"));if(Q){var F=P.highlight={};F.type="insertKnot",F.bezier=Q.bezier,F.point=Q.intersection}return P._interactor._42(),!0}}},wf.prototype._checkEditRealPoint=function(D){var w,e,j,X,k,N,v=this,c=v.screenInfo.curve._curves,i=v._interactor.getStyle("curvePointIntersectSize"),W=1/0;for(i*=i,j=0,X=c.length;X>j;j++)w=c[j],k=w._p1,N=D.distanceToSquared(k),W>N&&(W=N,e=k),k=w._p4,N=D.distanceToSquared(k),W>N&&(W=N,e=k);if(W>i)return!1;var p=v.highlight={};return p.type="changeRealPoint",p.point=e,v.editing={type:"realPoint",point:e,shiftGuide:{point:e.clone(),dir:"x",limit:0}},v._interactor.setCursor("crosshair"),!0},wf.prototype._checkEditElevation=function(V){var S=this;if(!S._interactor.getStyle("curveElevationVisible"))return!1;var Z=S.activing;if(!Z)return!1;var L=Z.getCurrentEditingPoint();if(!L)return!1;var n=S._interactor,A=n.getStyle("curveElevationGuideShift"),m=n.getStyle("curveElevationIntersectSize"),u=V.distanceToSquared({x:L.x+A[0],y:L.y+A[1]});if(!(u>m*m)){var T=S.highlight={};T.type="elevation";var Y=new Sd.Math.Vector2(V.x,V.y,L.e);return S.editing={type:"elevation",startPoint:Y},S._interactor.setCursor("crosshair"),!0}},wf.prototype._checkEditCtrlPoint=function(P){var y=this;if(y.activing&&!y.activing.selections){var o=y.getCurrentSelectintStatus();if(o!==Sd.Curve.PointType.Straight){var E=y.activing.pairs;if(E){var T=y._interactor.getStyle("curvePointIntersectSize");T*=T;var $,N,F,V,A,s,h,D,u,J=1/0;for(h=0,u=E.length;u>h;h++)for(V=E[h],D=0;2>D;D++)A=0===D?"c1":"c2",V[A]&&(s=P.distanceToSquared(V[A]),J>s&&(J=s,$=V,N=h,F=A));if(J>T)return!1;y.activing.hlpair=$,y.activing.hltype=F;var i=y.highlight={};return i.type="changeCtrlPoint",i.point=$[F],y.editing={type:"ctrlPoint",pair:$,pairId:N,ctrlType:F,direction:$[F].clone().sub(y.activing.point).normalize()},y._interactor.setCursor("crosshair"),!0}}}},wf.prototype.startEdit=function(k,l){k.startDragging(l);var L=this;L.highlight&&"insertKnot"===L.highlight.type&&(L.insertKnot(),L.gatherSingleTarget(L._interactor.gv,L.target),L.activing=null,L._checkEditRealPoint(L._interactor._getLogicalPoint(l)));var Z=L._activing;if(Z){var U=L.editing?L.editing.type:null;"ctrlPoint"===U?Z.editingCtrl={pairId:L.editing.pairId,type:Z.hltype}:"realPoint"===U&&(Z.editingCtrl=!1)}var p=L.highlight,h=o.Default.isCtrlDown(l);if(!p||ci()){var B=L._interactor.gv;if(!B.setFocus(l)||B._scrolling)return;return B.isPannable()&&Ei(l)&&!h&&(L._pan={tx:B.tx(),ty:B.ty()},k.fi({kind:"beginPan",event:l})),void 0}if("changeRealPoint"===p.type){var F,f=L.activing?L.activing.point:null,A=L.activing?L.activing.selections:null;if(h&&L.activing)f===p.point?(A?(L.activing={point:A[0]},A.length>1&&(A.splice(0,1),L.activing.selections=A)):L.activing=null,L.editing=null):A&&(F=A.indexOf(p.point))>=0?(A.length>1?A.splice(F,1):delete L.activing.selections,L.editing=null):A?(A.push(f),L.activing={point:p.point,selections:A}):L.activing={point:p.point,selections:[f]};else if(A)f===p.point||((F=A.indexOf(p.point))>=0?(A.splice(F,1,f),L.activing={point:p.point,selections:A}):L.activing={point:p.point});else{var j;f===p.point&&(j=L.activing.status),L.activing={point:p.point},j&&(L.activing.status=j)}k.fi({kind:"beginEditPoint",event:l})}},wf.prototype.insertKnot=function(){var S=this,P=S.highlight,a=S.screenInfo.curve;a.insertKnot(P.bezier,P.point.t),S._writeToHt()},wf.prototype._writeToHt=function(){var z,p,j,W,d=this,S=d.screenInfo.curve,_=S.toHtShape(),w=_.points,U=[],q=_.segments,G=d._interactor.gv,J=d.target,m=J instanceof o.Edge,r=Sd.getDataMatrix(J).invert();W=J instanceof o.Polyline,W&&(j=J.getElevation());for(var P=0,B=w.length;B>P;P++)z=w[P],p=Sd.toWorldPosition(G,z),p=r.apply(p),z.e!=Z&&z.e!==j&&(p.e=z.e),U.push(p);if(J._writing=!0,m){J.s("edge.type","points"),J.setStyle("edge.segments",q),J.setStyle("edge.points",U.slice(1,U.length-1)),J.setStyle("edge.source.offset.x",0),J.setStyle("edge.source.offset.y",0),J.setStyle("edge.target.offset.x",0),J.setStyle("edge.target.offset.y",0);var X=d._nextChangeEdgeHost;delete d._nextChangeEdgeHost,X&&("source"===X.type?J.setSource(X.host):J.setTarget(X.host)),d._writeEdgeHostAnchor("source",U[0]),d._writeEdgeHostAnchor("target",U[U.length-1])}else U.length?(J.setSegments(q),J.setPoints(U,!0)):J.removeFromDataModel();delete J._writing},wf.prototype._writeEdgeHostAnchor=function(v,O){var n=this,L=n.target,C=n._calcHostAnchor(L,v,O);L.s("edge."+v+".anchor.x",C.x),L.s("edge."+v+".anchor.y",C.y)},wf.prototype._calcHostAnchor=function(K,Q,D,Y){Y||(Y="source"===Q?K.getSource():K.getTarget());var S=Y.getRotation(),x=Y.getAnchor(),H=this._interactor.gv;if(km(Y,H)&&(S=0),S){var r=Y.getMatrix(),l=r.tfi(D),O=Y.getSize();return{x:l.x/O.width+x.x,y:l.y/O.height+x.y}}var p=dp(H,Y),v={x:(D.x-p.x)/p.width,y:(D.y-p.y)/p.height};return v},wf.prototype._handlePanning=function(c){var e=this,A=e._pan;if(A){A.started=!0;var b=e._interactor,s=b.gv,a=b._lastClientPoint,K=ad(c);s.setTranslate(A.tx+K.x-a.x,A.ty+K.y-a.y),e.gatherSingleTarget(b.gv,e.target),b._42(),b.fi({kind:"betweenPan",event:c})}},wf.prototype.handleEdit=function(m,d){var E=this,V=E.editing;if(E._pan)return E._handlePanning(d),void 0;if(V){V.inEdit=!0;var T,a,U,C=E._interactor._getLogicalPoint(d),M=o.Default.isCtrlDown(d),x=o.Default.isShiftDown(d),r=V.type,Q=E.activing;if(E._guideInfo=null,"ctrlPoint"===r&&x){var g=E.editing.direction.clone();T=Q.point;var P=g.dot(C.clone().sub(T));C=g.setLength(P).add(T)}else if("ctrlPoint"===r||"realPoint"===r){var g;if("realPoint"===r&&x){var w=E.editing.shiftGuide;a=w.point;var X=Math.abs(C.x-a.x),b=Math.abs(C.y-a.y);X>b&&X>w.limit&&"y"===w.dir&&(w.dir="x"),b>X&&b>w.limit&&"x"===w.dir&&(w.dir="y"),g=w.dir,"x"===g?(C.y=a.y,w.limit=Math.max(w.limit,X)):"y"===g&&(C.x=a.x,w.limit=Math.max(w.limit,b))}var e=E._isEditEdgeSourceTarget();if(e){var A=E._editEdgeSourceTarget(e,C,M);A&&(U=A.tipText)}else if(!M){var Y=E._guidingToEdit(C,g),t="realPoint"===r?E._interactor.gridGuide.findClosest(C,g,!0):null,O=1/0,W=1/0;t&&(t.x&&(O=t.x),t.y&&(W=t.y));var R=!1;Y&&(Y.xList&&(Math.abs(Y.x)<=Math.abs(O)?(R=!0,O=Y.x):delete Y.xList),Y.yList&&(Math.abs(Y.y)<=Math.abs(W)?(R=!0,W=Y.y):delete Y.yList),R&&(E._guideInfo=Y)),isFinite(O)&&(C.x+=O),isFinite(W)&&(C.y+=W),R&&(Y.v=C)}}var l=E.screenInfo.curve;if("realPoint"===V.type){T=V.point,T.e!==Z&&(C.e=T.e),l.moveRealPoint(T,C),V.point=C,E.highlight.point=C;var v=Q.status,H=Q.selections;if(E.activing={point:C,status:v},H){var h=C.clone().sub(T),K=0;H.forEach(function(N){var s=N.clone().add(h);l.moveRealPoint(N,s),H[K++]=s}),E.activing.selections=H}}else if("ctrlPoint"===V.type){var z=Q.pairs,B=z[V.pairId];l.moveCtrlPoint(B,C,V.ctrlType);var G=Q.status,D=Sd.Curve.PointType;if((G===D.Mirrored||G===D.Asymmetric)&&B.c1&&B.c2){var T=new Sd.Math.Vector2(Q.point),k="c1"===V.ctrlType?"c2":"c1";if(G===Sd.Curve.PointType.Mirrored)l.moveCtrlPoint(B,T.clone().multiplyScalar(2).sub(C),k);else if(G===D.Asymmetric){var P=B[k].clone().sub(T).length(),u=T.clone().sub(B[V.ctrlType]).setLength(P).add(T);isNaN(u.x)||l.moveCtrlPoint(B,u,k)}}Q._firePointChange()}else if("elevation"===V.type){a=V.startPoint;var N=a.e+(a.y-C.y)/m._zoom;E._setCurrentPointImpl("e",N),Q._firePointChange(),U="E: "+Sd.toFixed(N)}var y=o.Default.getLogicalPoint(d,E._interactor._canvas);if(y.x+=Sd.Icons.TipShiftX,y.y+=Sd.Icons.TipShiftY,!U){var q=Sd.toWorldPosition(m,C);U=""+Sd.toFixed(q.x)+", "+Sd.toFixed(q.y)}E.tipInfo={helperPos:y,text:U,size:U.length},E._writeToHt(),E._interactor.fi({kind:"betweenEditPoint",event:d})}},wf.prototype._setCurrentPointImpl=function(l,T){var w=this,K=w._activing;if(!K)return!1;var E=w.target;if(!E)return!1;var D=K.getCurrentEditingPoint();if(!D)return!1;var n=K.editingCtrl;if(!n)var S=D.clone();if("e"===l)D.e=T;else{var P;if("x"===l||"y"===l){var a=K._lastFirePoint;P="x"===l?{x:T,y:a?a.y:0}:{x:a?a.x:0,y:T}}else"object"==typeof l?(P=l,l.e!==Z&&(D.e=l.e)):(P={x:arguments[0],y:arguments[1]},arguments[2]!==Z&&(D.e=arguments[2]));var i=Sd.getDataMatrix(E);P=Sd.toScreenPosition(w._interactor.gv,i.apply(P)),D.x=P.x,D.y=P.y}if(!n){var o=S.multiplyScalar(-1).add(D);D.e&&S.e&&(o.e=D.e-S.e),w.screenInfo.curve.moveCtrlDueToRealPointMovement(D,o)}return!0},wf.prototype.setCurrentPoint=function(P,b){return this._setCurrentPointImpl(P,b)?(this._writeToHt(),!0):!1},wf.prototype._isEditEdgeSourceTarget=function(){var T=this,P=T.target;if(!(P instanceof o.Edge))return!1;var l=T.editing.point,I=T.screenInfo.curve._curves;return l===I[0]._p1?"source":l===I[I.length-1]._p4?"target":!1},wf.prototype._editEdgeSourceTarget=function(M,P,e){var w,R=this,b=R.target;if(w="source"===M?b.getSource():b.getTarget()){var C=R._interactor.gv,_=Sd.toWorldPosition(C,P),J=R._calcHostAnchor(b,M,_,w);if(!e){var x=R._interactor.getStyle("anchorRound"),k=R._interactor.getStyle("anchorSensitivity");J.x=Sd.roundTo(J.x,x,k),J.y=Sd.roundTo(J.y,x,k)}if(R._interactor.getStyle("edgeHostDetectPerFrame")||J.x<0||J.x>1||J.y<0||J.y>1){var v=C.getDataAt(_,function(v){return C.isSelectable(v)?Cd(v)?!0:!1:!1});if(v){var G=R._calcHostAnchor(b,M,_,v);w=v,R._nextChangeEdgeHost={type:M,host:v},J=G,e||(J.x=Sd.roundTo(J.x,x,k),J.y=Sd.roundTo(J.y,x,k))}}if(!e){var N=an(C,w,0,0,0,J.x,J.y),d=Sd.toScreenPosition(C,N);P.x=d.x,P.y=d.y}return R._edgeHostGuideInfo=Sd.getTargetCornersOnScreen(C,w),{host:w,anchor:J,tipText:""+J.x.toFixed(2)+", "+J.y.toFixed(2)}}},wf.prototype._guidingToEdit=function(M,U){var F,R,f=this;if(F=f.screenInfo.curve){R=F._curves;var k,D,o,N,e,b,X,n,E=1/0,K=1/0,u=[];for(f.editing&&"realPoint"===f.editing.type&&(n=f.editing.point),e=0,b=2*R.length;b>e;e++)X=R[Math.floor(e/2)][e%2?"_p4":"_p1"],u.indexOf(X)>=0||(u.push(X),n&&n===X||(o=X.x-M.x,N=X.y-M.y,Math.abs(o)<Math.abs(E)?(E=o,k=[X]):o===E&&k.push(X),Math.abs(N)<Math.abs(K)?(K=N,D=[X]):N===K&&D.push(X)));var V=f._interactor.getStyle("smartGuideSensitivity");if((Math.abs(E)>V||"y"===U)&&(k=null),(Math.abs(K)>V||"x"===U)&&(D=null),k||D){var z=!1,J={};if(k&&(z=!0,J.xList=k,J.x=E),D&&(z=!0,J.yList=D,J.y=K),z)return J}}},wf.prototype._46O=function(_){var i=this;i.editing&&(i.editing=null,i._interactor.fi({kind:"endEditPoint",event:_})),i._guideInfo=null,i._edgeHostGuideInfo=null,i._pan&&(i._pan=null,i._interactor.fi({kind:"endPan",event:_})),i.tipInfo=null},wf.prototype._canDeletePoint=function(i,w){var d=this.target;if(!(d instanceof o.Edge))return!0;var I=i._curves[0],k=i._curves[i._curves.length-1];return I._p1===w||k._p4===w?!1:!0},wf.prototype.handleDelete=function(){var O=this;if(O.activing&&O.screenInfo){var C=o.Default.isShiftDown(),i=O.screenInfo.curve;O._canDeletePoint(i,O.activing.point)&&i.deleteRealPoint(O.activing.point,C),O.activing.selections&&O.activing.selections.forEach(function(n){O._canDeletePoint(i,n)&&i.deleteRealPoint(n,C)}),O.activing=null,delete O.editing,delete O.tipInfo,delete O._pan,O._writeToHt(),O._interactor.fp("deleteShapePoint",!1,!0)}},wf.prototype.handleDoubleClick=function(E){var U=this,a=U._interactor._getLogicalPoint(E);if(U.screenInfo&&U._checkEditRealPoint(a)){var G=U.getCurrentSelectintStatus(),_=Sd.Curve.PointType;return G=G===_.Mirrored?_.Straight:_.Mirrored,U._setCurrentSelectionStatus(G),U._interactor._42(),!0}},wf.prototype._drawHighlight=function(p){var l=this,G=l.highlight;if(G){var B=G.bezier,A=l._interactor;B&&Sd.Icons.DrawIcon(A,p,Sd.Icons.ShapeHighlightCurve,[B._p1.x,B._p1.y,B._p2.x,B._p2.y,B._p3.x,B._p3.y,B._p4.x,B._p4.y]);var d=G.point;d&&"insertKnot"===G.type&&Sd.Icons.DrawIcon(A,p,Sd.Icons.ShapeHighlighPoint,d)}},wf.prototype._drawGuide=function(A){var u=this,J=u._guideInfo;if(J){var x,o,G,a,N=J.v;for(x=0;2>x;x++)if(a=0===x?J.xList:J.yList)for(o=0,G=a.length;G>o;o++)Sd.Icons.DrawIcon(u._interactor,A,Sd.Icons.ShapeGuideLine,[N.x,N.y,a[o].x,a[o].y])}},wf.prototype._drawCurrentPoint=function(k){var E=this;if(E.activing){var n=E.activing,a=E.getCurrentSelectintStatus(),Y=E._interactor;if(a!==Sd.Curve.PointType.Straight){var K=n.pairs;n.hlpair,n.hltype;var H=n.selections,C=n.editingCtrl;if(K&&!H){var y,S,I;for(S=0,I=K.length;I>S;S++)y=K[S],C&&S===C.pairId&&y[C.type]?Sd.Icons.DrawIcon(Y,k,Sd.Icons.ShapeActivingCtrl,{point:y.point,c1:y.c1,c2:y.c2,hl:C.type}):Sd.Icons.DrawIcon(Y,k,Sd.Icons.ShapeActivingCtrl,y)}}Sd.Icons.DrawIcon(Y,k,Sd.Icons.ShapeHighlighRealPoint,E.activing.point),H&&H.forEach(function(M){Sd.Icons.DrawIcon(Y,k,Sd.Icons.ShapeHighlighRealPoint,M)})}},wf.prototype.clear=function(){var F=this;F.editing=null,F._guideInfo=null,F.activing=null,F.highlight=null},wf.prototype._42=function(b){var E=this;E.info={},E.editing||(E.screenInfo=null);var J=E._interactor;if(!J.editDetail)return E.clear(),void 0;if(!E.target||!E._interactor.gv.isSelected(E.target)||!E._interactor.gv.isVisible(E.target))return J.editDetail=!1,E.clear(),void 0;if(E.gatherSingleTarget(J.gv,E.target),Sd.Icons.DrawIcon(J,b,Sd.Icons.ShapeBgCurve,E.screenInfo),E._drawHighlight(b),E._drawCurrentPoint(b),E._getRealPoint().forEach(function(I){Sd.Icons.DrawIcon(J,b,Sd.Icons.ShapePoint,I)}),E._drawGuide(b),E.tipInfo&&Sd.Icons.DrawIcon(J,b,Sd.Icons.TipHelper,E.tipInfo),E._edgeHostGuideInfo&&Sd.Icons.DrawIcon(J,b,Sd.Icons.NodeHoverGuide,E._edgeHostGuideInfo),E._interactor.getStyle("curveElevationVisible")&&E.target instanceof o.Polyline&&E.activing){var A=E.activing.getCurrentEditingPoint();A&&Sd.Icons.DrawIcon(J,b,Sd.Icons.EdgeElevationGuide,A)}},wf.prototype._getRealPoint=function(){var g,W=this.screenInfo,Y=W.P,z=W.S,V=-1,H=[],A=-1,w=z.length;return z.each(function(S){A++;var m=1;if(3===S)m=2;else if(4===S)m=3;else if(5===S)return;V+=m,g=A+1>=w?!0:1===z.get(A+1)?!0:!1,H.push({point:{x:Y[2*V],y:Y[2*V+1]},isEnd:g})}),H};var ah=Sd.MoveHelper=function(l){var g=this;g.catalog="Move",g._interactor=l};ah.prototype={},ah.prototype.constructor=ah,ah.prototype.calcShift=function(n,E,Z){var Y,M,B=this,b=B._interactor.gv,$=b.lp(E);if("beginMove"===n&&B._gatherGridInfo(Z._lastLogicalPoint||$),Y=B._target){var T=Y.downPosition;if(T){var I=B._interactor.getStyle("moveSensitivity")/b._zoom;if(T.distanceTo($)<I)return{x:0,y:0};delete Y.downPosition}var f;M=o.Default.isShiftDown(E),M&&($=B._dealShiftDown($),f=Y.shiftGuide.dir);var l,u=Y.rawPos={x:Y.pos.x+$.x-Y.lp.x,y:Y.pos.y+$.y-Y.lp.y};if(o.Default.isCtrlDown(E)){if(l=B._calcShiftByAddon(),B._target.node instanceof Sd.Group){var R=B._target.node;R._position.x+=l.x,R._position.y+=l.y}return l}for(var z,s=Y.x+u.x,g=Y.y+u.y,Q={x:s,y:g},h={x:s+Y.w/2,y:g+Y.h/2},V={x:s+Y.w,y:g+Y.h},K=B._interactor.rectGuide,q=B._interactor.gridGuide,C=[K.findClosest(Q,f),K.findClosest(h,f),K.findClosest(V,f),q.findClosest(Q,f),q.findClosest(h,f),q.findClosest(V,f)],X=1/0,A=1/0,a=0,e=C.length;e>a;a++)z=C[a],z&&(s=z.x,g=z.y,isFinite(s)&&Math.abs(s)<Math.abs(X)&&(X=s),isFinite(g)&&Math.abs(g)<Math.abs(A)&&(A=g));if(isFinite(X)||(X=0),isFinite(A)||(A=0),l=B._calcShiftByAddon(X,A),B._target.node instanceof Sd.Group){var R=B._target.node;R._position.x+=l.x,R._position.y+=l.y}var w=Y.node;if(!km(w,b)){var r=u.x+X,m=u.y+A;B._interactor.rectGuide.gatherLines({node:w,x:Y.x+r,y:Y.y+m,w:Y.w,h:Y.h},f)}return l}},ah.prototype._calcShiftByAddon=function(X,x){var _=this._target,F=_.rawPos,g=_.node.getPosition();return X=X||0,x=x||0,{x:F.x-g.x+X,y:F.y-g.y+x}},ah.prototype._dealShiftDown=function(h){var p=this,J=p._target.shiftGuide,l=p._target.lp,K=Math.abs(h.x-l.x),U=Math.abs(h.y-l.y);K>U&&K>J.limit&&"y"===J.dir&&(J.dir="x"),U>K&&U>J.limit&&"x"===J.dir&&(J.dir="y");var j=J.dir;return"x"===j?(h.y=l.y,J.limit=Math.max(J.limit,K)):"y"===j&&(h.x=l.x,J.limit=Math.max(J.limit,U)),h},ah.prototype._gatherGridInfo=function(C){var L,h=this,J=h._interactor,e=J._getValidSelection();if(1===e.length){if(L=e[0],!L.getRect)return h._target=null,void 0}else if(L=Sd.Group.findOrCreateGroup(e),!L)return h._target=null,void 0;var u=L.getPosition(),V=L.getRect();h._target={node:L,x:V.x-u.x,y:V.y-u.y,w:V.width,h:V.height,lp:{x:C.x,y:C.y},pos:{x:u.x,y:u.y},shiftGuide:{dir:"x",limit:0},downPosition:new Sd.Math.Vector2(C)},J.rectGuide.gatherRects()},ah.prototype.clear=function(){var s=this;s._interactor.rectGuide.clear(),s._interactor._42()};var wn="directional",mi="point",gb="spot",Lc="light.color",fj=function(f,H){hf(H)&&Yj.test(H)?ck(f,H):Ui(H)&&H.modelType?Tg(f,H):Lq[f]=H},cg=function(S){if(Ui(S))return S;var c=Lq[S];return S&&c===Z&&Yj.test(S)&&(Uo&&Uo[S]||ck(S,S)),c};hj(C,{graph3dViewAttributes:I,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:E/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Rq,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:E/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:fj,getShape3dModel:cg,createMatrix:function(L,f){sk(L)||(L=[L]);for(var K=L.length-1;K>=0;K--){var g=L[K];f=qq(g.mat,g.s3,g.r3,g.rotationMode,g.t3,f)}return f},transformVec:function(y,D){return $f(y,D)},createBoxModel:function(){return{vs:Wb,ns:Mi,uv:Ug,is:xk}},createRoundRectModel:function(U,a){return hq.roundRect(U,a)},createStarModel:function(q,S){return hq.star(q,S)},createRectModel:function(M,a){return hq.rect(M,a)},createTriangleModel:function($,C){return hq.triangle($,C)},createRightTriangleModel:function(h,n){return hq.rightTriangle(h,n)},createParallelogramModel:function(H,f){return hq.parallelogram(H,f)},createTrapezoidModel:function(I,r){return hq.trapezoid(I,r)},createSmoothSphereModel:function(T,d,a,G,x,k,K){return yb(new Rm(T,d,a,G,x,k,K))},createSphereModel:function(D,q,V,Q,o,e){return D?pd(D,q,V,Q,o,e):C.createSmoothSphereModel()},createSmoothConeModel:function(Q,w,W,X,s){return qp(Q,w,W,X,s)},createConeModel:function(A,O,z,P,b,s){return A?tm(A,O,z,P,b,s):qp(s)},createSmoothCylinderModel:function(L,T,h,W,$,k,Q,u){return yb(new Oj(L,T,h,W,$,k,Q,u))},createCylinderModel:function($,U,H,C,B,K,I){return $?gi($,U,H,C,B,K,I):zk(K,I)},createSmoothTorusModel:function(z,K,L,h,m,b){return yb(new yg(z,K,L,h,m,b))},createTorusModel:function(B,O,F,r,u,U,M){return B?Mn(B,O,F,r,u,U,M):Xk(U,M)},createExtrusionModel:function(m,l,X,e,A,Q,j,g){return Sq(m,l,X,e,A,Q,j,g)},createSmoothRingModel:function(M,r,u,L,J,I){for(var D=[],c=0;c<M.length-1;c+=2)D.push({x:M[c],y:M[c+1]});for(M=hk(D,r,u)[0],D=[],c=0;c<M.length;c++){var E=M[c];D.push(new Um(E.x,0,E.y))}return yb(new se(D,I,L,J))},createTextGeometry:function(U,b){return yb(new cj(U,b))},loadFontFace:function(U,D){C.xhrLoad(U,function(r){if(!r)return D();var Q;try{Q=JSON.parse(r)}catch(y){Q=JSON.parse(r.substring(65,r.length-2))}dk.loadFace(Q),D&&D(Q.familyName.toLowerCase())},D?null:{sync:!0})},createRingModel:function(R,s,O,v,G,b,B,E,$,Y){for(var w=[],f=0;f<R.length-1;f+=2)w.push({x:R[f],y:R[f+1]});b=b||C.shapeSide,B=B||0,E=E||b;var i,S,V,r,k,t,j,J,c,_,f,y,d,o,A,K,Q,U,P=[],h=[],D=$?[]:I,g=$?[]:I,N=Y?[]:I,z=Y?[]:I,m=v?[]:I,p=v?[]:I,e=G?[]:I,u=G?[]:I,R=hk(w,s,O),l=Cg(R),M=0,L=2*Math.PI/b;return R.forEach(function(q){if(V=q.length,V>1){if(r=q[0],v)for(t=r.x,J=r.y,f=B;E>f;f++)y=f+1,d=f*L,o=y*L,A=T(d),K=W(d),Q=T(o),U=W(o),m.push(A*t,J,-K*t,Q*t,J,-U*t,0,J,0),p.push(.5-.5*A,.5-.5*K,.5-.5*Q,.5-.5*U,.5,.5);for(_=0;V>_;_++){for(k=q[_],t=r.x,j=k.x,J=r.y,c=k.y,i=M/l,M+=cd(r,k),S=M/l,f=B;E>f;f++)y=f+1,d=f*L,o=y*L,A=T(d),K=W(d),Q=T(o),U=W(o),P.push(A*j,c,-K*j,Q*j,c,-U*j,A*t,J,-K*t,Q*j,c,-U*j,Q*t,J,-U*t,A*t,J,-K*t),h.push(f/b,S,y/b,S,f/b,i,y/b,S,y/b,i,f/b,i),$&&f===B&&(D.push(0,J,0,0,c,0,A*j,c,-K*j,A*j,c,-K*j,A*t,J,-K*t,0,J,0),g.push(0,.5-J,0,.5-c,2*j,.5-c,2*j,.5-c,2*t,.5-J,0,.5-J)),Y&&y===E&&(N.push(0,J,0,Q*j,c,-U*j,0,c,0,Q*j,c,-U*j,0,J,0,Q*t,J,-U*t),z.push(1,.5-J,1-2*j,.5-c,1,.5-c,1-2*j,.5-c,1,.5-J,1-2*t,.5-J));r=k}if(G)for(t=r.x,J=r.y,f=B;E>f;f++)y=f+1,d=f*L,o=y*L,A=T(d),K=W(d),Q=T(o),U=W(o),e.push(Q*t,J,-U*t,A*t,J,-K*t,0,J,0),u.push(.5-.5*Q,.5+.5*U,.5-.5*A,.5+.5*K,.5,.5)}}),{vs:P,uv:h,bottom_vs:e,bottom_uv:u,top_vs:m,top_uv:p,from_vs:D,from_uv:g,to_vs:N,to_uv:z}}},!0),hj(R,{"3d.move.mode":Z,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":Z,"edge.gradient.color":Z,"edge.source.t3":Z,"edge.target.t3":Z,"light.type":mi,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":E/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Ag,"wf.short":!1,"wf.mat":Z,"wf.geometry":!1,batch:Z,"transparent.mask":!1,brightness:Z,"select.brightness":.7,"repeat.uv.length":Z,alphaTest:.4,"label.face":Zp,"label.t3":Z,"label.r3":Z,"label.texture.scale":2,"label.rotationMode":Xi,"label.light":!1,"label.blend":Z,"label.reverse.flip":!1,"label.reverse.color":vg,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Zp,"label2.t3":Z,"label2.r3":Z,"label2.texture.scale":2,"label2.rotationMode":Xi,"label2.light":!1,"label2.blend":Z,"label2.reverse.flip":!1,"label2.reverse.color":vg,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Zp,"note.t3":Z,"note.r3":Z,"note.texture.scale":2,"note.rotationMode":Xi,"note.light":!1,"note.blend":Z,"note.reverse.flip":!1,"note.reverse.color":vg,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Zp,"note2.t3":Z,"note2.r3":Z,"note2.texture.scale":2,"note2.rotationMode":Xi,"note2.light":!1,"note2.blend":Z,"note2.reverse.flip":!1,"note2.reverse.color":vg,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:Z,"shape3d.color":Qj,"shape3d.top.color":Z,"shape3d.bottom.color":Z,"shape3d.from.color":Z,"shape3d.to.color":Z,"shape3d.image":Z,"shape3d.top.image":Z,"shape3d.bottom.image":Z,"shape3d.from.image":Z,"shape3d.to.image":Z,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":Z,"shape3d.side.to":Z,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":Z,"shape3d.opacity":Z,"shape3d.reverse.flip":!1,"shape3d.reverse.color":vg,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":Z,"shape3d.uv.scale":Z,"shape3d.top.uv.offset":Z,"shape3d.top.uv.scale":Z,"shape3d.bottom.uv.offset":Z,"shape3d.bottom.uv.scale":Z,"shape3d.from.uv.offset":Z,"shape3d.from.uv.scale":Z,"shape3d.to.uv.offset":Z,"shape3d.to.uv.scale":Z,"shape3d.top.cap":Z,"shape3d.bottom.cap":Z,"shape3d.start.angle":0,"shape3d.sweep.angle":i,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":Z,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Qj,"all.image":Z,"all.blend":Z,"all.opacity":Z,"all.reverse.flip":!1,"all.reverse.color":vg,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":Z,"all.uv.offset":Z,"all.uv.scale":Z,"all.discard.selectable":!0,mat:Z,"left.mat":Z,"right.mat":Z,"top.mat":Z,"bottom.mat":Z,"front.mat":Z,"back.mat":Z},!0);
var Uj,Ul=!1,ae=[0,0,0,0],Jo={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:_h,2:De,3:Rd,4:Yf,5:Zp,6:_m}},cn=function(C,Y,O,F){if(Y.getFaceVisible(C,O)){ug(Y,Vl(C,Y.getFaceMat(C,O)||Y.getMat(C)));var P=Y._26I;Y.getFaceReverseCull(C,O)?P.enable(P.CULL_FACE):P.disable(P.CULL_FACE),Sc(P,Y._prg.uFixPickReverseColor,Jo[O]),vq(P),xo(P,F,6),tb(P),wm(Y)}},Ph=function(N){return N instanceof ro},ms=function(N){return[N.x,N.e||0,N.y]},Eo=function(q,I,G){for(var I=fh(I),$=I[0],l=I[1],r=I[2];G--;)q.push($,l,r)},Th=function(K,f,y){for(var f=fh(f),v=f[0],e=f[1],I=f[2],U=f[3];y--;)K.push(v,e,I,U)},nb=function(L,G,d){if(G)for(var n,F,$,m=G[0],r=G[1],b=G[2],o=G[4],p=G[5],W=G[6],B=G[8],j=G[9],D=G[10],J=G[12],Y=G[13],C=G[14],X=d.length,S=0,S=0;X>S;S+=3)n=d[S],F=d[S+1],$=d[S+2],L.push(m*n+o*F+B*$+J,r*n+p*F+j*$+Y,b*n+W*F+D*$+C);else sm(L,d)},kd=function(m,N){var b=N.s("light.intensity"),t=fh(N.s(Lc)),K=t[0],X=t[1],x=t[2];1!==b&&(K*=b,X*=b,x*=b),m.push(K,X,x,N.s("light.disabled")?1:0)},Pk=function(v,V,C){Sc(V,C.uHeadlightRange,v._headlightRange);var f=v._headlightIntensity,Q=fh(v._headlightColor);1!==f&&(Q=[Q[0]*f,Q[1]*f,Q[2]*f]),Sc(V,C.uHeadlightColor,[Q[0],Q[1],Q[2],v._headlightDisabled?1:0]);var S=v._59O,t=v._spots,l=v._dirs;if(S.length){var K=[],c=[],W=[];S.forEach(function(r){kd(K,r),sm(c,v._transformPointToViewSpace(r.p3())),W.push(r.s("light.range"))}),V.uniform4fv(C.uPointColor,K),V.uniform1fv(C.uPointRange,W),V.uniform3fv(C.uPointPosition,c)}if(t.length){var D=[],B=[],z=[],r=[],Z=[],F=[];t.forEach(function($){kd(D,$),sm(B,v._transformPointToViewSpace($.p3())),sm(Z,v._transformDirectionToViewSpace($.p3(),$.s("light.center"))),z.push($.s("light.range")),r.push(T($.s("light.angle")/2)),F.push($.s("light.exponent"))}),V.uniform4fv(C.uSpotColor,D),V.uniform1fv(C.uSpotRange,z),V.uniform1fv(C.uSpotAngle,r),V.uniform1fv(C.uSpotExponent,F),V.uniform3fv(C.uSpotPosition,B),V.uniform3fv(C.uSpotDirection,Z)}if(l.length){var M=[],u=[];l.forEach(function(O){kd(M,O),sm(u,v._transformDirectionToViewSpace(O.p3()))}),V.uniform4fv(C.uDirColor,M),V.uniform3fv(C.uDirDirection,u)}},vp=function(O){return O>0&&0===(O-1&O)},Ur=function(N){return N=K(0,m(E,N)),N=K(On,m(E-On,N))},Hm=function(){return.05+A()/2},ik=function(V,J,O,U){var j,z=V.getEye();return V.isOrtho()?(j=uq(V.getCenter(),z),j[0]+=U[0],j[1]+=U[1],j[2]+=U[2]):j=z,df(J,O,U,j)},df=function(F,O,T,Q){var r=nf(F,O),S=uq(Q,T,!0),p=nf(S,O);if(f(p)<On)return I;var L=(r-nf(T,O))/p;return[T[0]+S[0]*L,T[1]+S[1]*L,T[2]+S[2]*L]},yq=function(i,_){return{x:2*i.x-_.x,y:2*i.y-_.y}},me=function(k,M,p,e){var t,o;if(!k)return t=Y(M.y-p.y,p.x-M.x),{x:M.x+e*W(t),y:M.y+e*T(t)};if(!p)return t=Y(k.y-M.y,M.x-k.x),{x:M.x+e*W(t),y:M.y+e*T(t)};var z=uq([k.x,k.y,0],[M.x,M.y,0],!0),i=uq([p.x,p.y,0],[M.x,M.y,0],!0),B=-(z[0]+i[0])/2,S=-(z[1]+i[1])/2,C=v(B*B+S*S);if(On>C)return t=Y(k.y-M.y,M.x-k.x),{x:M.x+e*W(t),y:M.y+e*T(t)};var _=k.x-M.x,f=k.y-M.y,g=p.x-M.x,r=p.y-M.y,Z=v(_*_+f*f),L=v(g*g+r*r);t=D(nf(z,i))/2,o=z[1]*i[0]-z[0]*i[1]>0?-1:1,B/=C,S/=C;var h=e/W(t),w=K(Z,L)/T(t);C=Math.min(h,w);var F={x:M.x+o*C*B,y:M.y+o*C*S};return p.b&&h>L/T(t)&&(F.adjust=!0),F},Jp=function(n){var I=n[1],B=n[2],U=n[3],f=n[6],w=n[7],J=n[11];n[1]=n[4],n[2]=n[8],n[3]=n[12],n[4]=I,n[6]=n[9],n[7]=n[13],n[8]=B,n[9]=f,n[11]=n[14],n[12]=U,n[13]=w,n[14]=J},lq=function(O){var n=O[0],W=O[1],w=O[2],V=O[3],N=O[4],G=O[5],J=O[6],E=O[7],s=O[8],$=O[9],v=O[10],F=O[11],X=O[12],p=O[13],x=O[14],k=O[15],B=n*G-W*N,Q=n*J-w*N,i=n*E-V*N,L=W*J-w*G,e=W*E-V*G,m=w*E-V*J,u=s*p-$*X,d=s*x-v*X,q=s*k-F*X,T=$*x-v*p,y=$*k-F*p,S=v*k-F*x,P=B*S-Q*y+i*T+L*q-e*d+m*u;return P?(P=1/P,O[0]=(G*S-J*y+E*T)*P,O[1]=(w*y-W*S-V*T)*P,O[2]=(p*m-x*e+k*L)*P,O[3]=(v*e-$*m-F*L)*P,O[4]=(J*q-N*S-E*d)*P,O[5]=(n*S-w*q+V*d)*P,O[6]=(x*i-X*m-k*Q)*P,O[7]=(s*m-v*i+F*Q)*P,O[8]=(N*y-G*q+E*u)*P,O[9]=(W*q-n*y-V*u)*P,O[10]=(X*e-p*i+k*B)*P,O[11]=($*i-s*e-F*B)*P,O[12]=(G*d-N*T-J*u)*P,O[13]=(n*T-W*d+w*u)*P,O[14]=(p*Q-X*L-x*B)*P,O[15]=(s*L-$*Q+v*B)*P,void 0):I},nq=function(r,u){if(u){var _=u[0],c=u[1],L=u[2];r[12]=r[0]*_+r[4]*c+r[8]*L+r[12],r[13]=r[1]*_+r[5]*c+r[9]*L+r[13],r[14]=r[2]*_+r[6]*c+r[10]*L+r[14],r[15]=r[3]*_+r[7]*c+r[11]*L+r[15]}},xh=function(C,m){if(m){var o=m[0],Y=m[1],B=m[2];C[0]=C[0]*o,C[1]=C[1]*o,C[2]=C[2]*o,C[3]=C[3]*o,C[4]=C[4]*Y,C[5]=C[5]*Y,C[6]=C[6]*Y,C[7]=C[7]*Y,C[8]=C[8]*B,C[9]=C[9]*B,C[10]=C[10]*B,C[11]=C[11]*B}},vl=function(S,Q,p){var L=Q[0],P=Q[1],K=Q[2],M=Q[3],o=Q[4],F=Q[5],D=Q[6],E=Q[7],C=Q[8],O=Q[9],i=Q[10],v=Q[11],I=Q[12],T=Q[13],d=Q[14],k=Q[15],B=p[0],z=p[1],$=p[2],y=p[3];return S[0]=B*L+z*o+$*C+y*I,S[1]=B*P+z*F+$*O+y*T,S[2]=B*K+z*D+$*i+y*d,S[3]=B*M+z*E+$*v+y*k,B=p[4],z=p[5],$=p[6],y=p[7],S[4]=B*L+z*o+$*C+y*I,S[5]=B*P+z*F+$*O+y*T,S[6]=B*K+z*D+$*i+y*d,S[7]=B*M+z*E+$*v+y*k,B=p[8],z=p[9],$=p[10],y=p[11],S[8]=B*L+z*o+$*C+y*I,S[9]=B*P+z*F+$*O+y*T,S[10]=B*K+z*D+$*i+y*d,S[11]=B*M+z*E+$*v+y*k,B=p[12],z=p[13],$=p[14],y=p[15],S[12]=B*L+z*o+$*C+y*I,S[13]=B*P+z*F+$*O+y*T,S[14]=B*K+z*D+$*i+y*d,S[15]=B*M+z*E+$*v+y*k,S},jf=function(g,B,Z,W){var p,D,U,I,j,b,$,H,q,o,T=B[0],u=B[1],h=B[2],i=W[0],M=W[1],A=W[2],s=Z[0],k=Z[1],S=Z[2];return f(T-s)<On&&f(u-k)<On&&f(h-S)<On?Io(g):($=T-s,H=u-k,q=h-S,o=1/v($*$+H*H+q*q),$*=o,H*=o,q*=o,p=M*q-A*H,D=A*$-i*q,U=i*H-M*$,o=v(p*p+D*D+U*U),o?(o=1/o,p*=o,D*=o,U*=o):(p=0,D=0,U=0),I=H*U-q*D,j=q*p-$*U,b=$*D-H*p,o=v(I*I+j*j+b*b),o?(o=1/o,I*=o,j*=o,b*=o):(I=0,j=0,b=0),g[0]=p,g[1]=I,g[2]=$,g[3]=0,g[4]=D,g[5]=j,g[6]=H,g[7]=0,g[8]=U,g[9]=b,g[10]=q,g[11]=0,g[12]=-(p*T+D*u+U*h),g[13]=-(I*T+j*u+b*h),g[14]=-($*T+H*u+q*h),g[15]=1,g)},ef=function(G,A,M,R,X){var c=1/e(A/2),_=1/(R-X);return G[0]=c/M,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=c,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=(X+R)*_,G[11]=-1,G[12]=0,G[13]=0,G[14]=2*X*R*_,G[15]=0,G},Ih=function(i,e,S,m,W,y,x){var C=1/(e-S),U=1/(m-W),R=1/(y-x);return i[0]=-2*C,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*U,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*R,i[11]=0,i[12]=(e+S)*C,i[13]=(W+m)*U,i[14]=(x+y)*R,i[15]=1,i},os=function(G,b){var W=b[0],A=b[1],Z=b[2],N=b[3],x=W*W+A*A+Z*Z+N*N,z=x?1/x:0;return G[0]=-W*z,G[1]=-A*z,G[2]=-Z*z,G[3]=N*z,G},ag=function(m,r){var W=r[0]+r[5]+r[10],A=0;return W>0?(A=2*Math.sqrt(W+1),m[3]=.25*A,m[0]=(r[6]-r[9])/A,m[1]=(r[8]-r[2])/A,m[2]=(r[1]-r[4])/A):r[0]>r[5]&r[0]>r[10]?(A=2*Math.sqrt(1+r[0]-r[5]-r[10]),m[3]=(r[6]-r[9])/A,m[0]=.25*A,m[1]=(r[1]+r[4])/A,m[2]=(r[8]+r[2])/A):r[5]>r[10]?(A=2*Math.sqrt(1+r[5]-r[0]-r[10]),m[3]=(r[8]-r[2])/A,m[0]=(r[1]+r[4])/A,m[1]=.25*A,m[2]=(r[6]+r[9])/A):(A=2*Math.sqrt(1+r[10]-r[0]-r[5]),m[3]=(r[1]-r[4])/A,m[0]=(r[8]+r[2])/A,m[1]=(r[6]+r[9])/A,m[2]=.25*A),m},jp=function(g,z,R){var q=z[0],x=z[1],d=z[2],c=z[3],B=q+q,n=x+x,m=d+d,$=q*B,o=q*n,I=q*m,v=x*n,Q=x*m,K=d*m,k=c*B,t=c*n,s=c*m;return g[0]=1-(v+K),g[1]=o+s,g[2]=I-t,g[3]=0,g[4]=o-s,g[5]=1-($+K),g[6]=Q+k,g[7]=0,g[8]=I+t,g[9]=Q-k,g[10]=1-($+v),g[11]=0,g[12]=R[0],g[13]=R[1],g[14]=R[2],g[15]=1,g},Qn=function(){var G=[0,0,0],g=[0,0,0],h=[0,0,0],P=function(q,V,X){q[0]=V[1]*X[2]-V[2]*X[1],q[1]=V[2]*X[0]-V[0]*X[2],q[2]=V[0]*X[1]-V[1]*X[0]},S=function(M){return M[0]*M[0]+M[1]*M[1]+M[2]*M[2]},X=function(g){var X=Math.sqrt(S(g));g[0]/=X,g[1]/=X,g[2]/=X},Q=function(H,v,Z){H[0]=v[0]-Z[0],H[1]=v[1]-Z[1],H[2]=v[2]-Z[2]};return function(U,C,m){var e=Vd();return Q(h,U,C),0===S(h)&&(h[2]=1),X(h),P(G,m,h),0===S(G)&&(1===Math.abs(m[2])?h[0]+=1e-4:h[2]+=1e-4,X(h),P(G,m,h)),X(G),P(g,h,G),e[0]=G[0],e[4]=g[0],e[8]=h[0],e[1]=G[1],e[5]=g[1],e[9]=h[1],e[2]=G[2],e[6]=g[2],e[10]=h[2],e}}(),Sj=function(V,x){if(V.vr.enable){var m=V.vr.getViewMatrix(x);if(m)return m}return jf(x?x:Vd(),V._eye,V._center,V._up)},mg=function(L){if(L.vr.enable){var w=L.vr.getProjectMatrix();if(w)return w}var j=L.getAspect(),Z=L._near,S=L._far,A=Vd();if(L._ortho){var g=L._orthoWidth/2,r=g/j;Ih(A,-g,g,-r,r,Z,S)}else ef(A,L._fovy,j,Z,S);return A},Dr=function(y,M){if(!y)return I;var A=0,R=1,X=2,Y=[],_=0,n=y.length,K=n/3;if(M){for(;n>_;_++)Y[_]=0;for(_=0;_<M.length;_+=3){var S=[],e=[],c=[];S[A]=y[3*M[_+1]+A]-y[3*M[_]+A],S[R]=y[3*M[_+1]+R]-y[3*M[_]+R],S[X]=y[3*M[_+1]+X]-y[3*M[_]+X],e[A]=y[3*M[_+2]+A]-y[3*M[_+1]+A],e[R]=y[3*M[_+2]+R]-y[3*M[_+1]+R],e[X]=y[3*M[_+2]+X]-y[3*M[_+1]+X],c[A]=S[R]*e[X]-S[X]*e[R],c[R]=S[X]*e[A]-S[A]*e[X],c[X]=S[A]*e[R]-S[R]*e[A];for(var f=0;3>f;f++)Y[3*M[_+f]+A]+=c[A],Y[3*M[_+f]+R]+=c[R],Y[3*M[_+f]+X]+=c[X]}}else for(_=0;K>_;_+=3){var S=[],e=[],c=[];S[A]=y[3*(_+1)+A]-y[3*_+A],S[R]=y[3*(_+1)+R]-y[3*_+R],S[X]=y[3*(_+1)+X]-y[3*_+X],e[A]=y[3*(_+2)+A]-y[3*(_+1)+A],e[R]=y[3*(_+2)+R]-y[3*(_+1)+R],e[X]=y[3*(_+2)+X]-y[3*(_+1)+X],c[A]=S[R]*e[X]-S[X]*e[R],c[R]=S[X]*e[A]-S[A]*e[X],c[X]=S[A]*e[R]-S[R]*e[A];for(var f=0;3>f;f++)Y[3*(_+f)+A]=c[A],Y[3*(_+f)+R]=c[R],Y[3*(_+f)+X]=c[X]}for(_=0;n>_;_+=3){var W=[];W[A]=Y[_+A],W[R]=Y[_+R],W[X]=Y[_+X];var L=v(W[A]*W[A]+W[R]*W[R]+W[X]*W[X]);0===L&&(L=On),W[A]=W[A]/L,W[R]=W[R]/L,W[X]=W[X]/L,Y[_+A]=W[A],Y[_+R]=W[R],Y[_+X]=W[X]}return new zd(Y)},Lp=function(w,W,x,g){if(x||(x=w.createTexture()),W){var c=w.TEXTURE_2D,F=w.REPEAT,X=w.CLAMP_TO_EDGE,b=w.TEXTURE_MIN_FILTER;g!==w.NEAREST&&(g=w.LINEAR),As(w,x),w.texImage2D(c,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,W),lb(w,w.TEXTURE_MAG_FILTER,g);var j=W.naturalWidth||W.width,m=W.naturalHeight||W.height;vp(j)&&vp(m)&&!W.clampToEdge?(lb(w,w.TEXTURE_WRAP_S,F),lb(w,w.TEXTURE_WRAP_T,F),lb(w,b,w.LINEAR_MIPMAP_LINEAR),w.generateMipmap(c)):(lb(w,w.TEXTURE_WRAP_S,X),lb(w,w.TEXTURE_WRAP_T,X),lb(w,b,g)),As(w,I)}return x},Bj=function(o,d){var a=new Uint8Array(3);return d=d||o.createTexture(),As(o,d),lb(o,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGB,1,1,0,o.RGB,o.UNSIGNED_BYTE,a),d},Te=function(S){S._26I&&S._prg&&(S._26I.deleteProgram(S._prg),S._prg=I)},cs=function(w,c,v,a){var b=w.createShader(v);return w.shaderSource(b,a),w.compileShader(b),w.attachShader(c,b),b},hn=function(U){return U.createBuffer()},As=function(K,d){K.bindTexture(K.TEXTURE_2D,d)},Gh=function($,S){$.bindFramebuffer($.FRAMEBUFFER,S)},lb=function(z,j,t){z.texParameteri(z.TEXTURE_2D,j,t)},ue=function(J,U){J.enable(J.POLYGON_OFFSET_FILL),J.polygonOffset(U[0],U[1])},$c=function(s){s.disable(s.POLYGON_OFFSET_FILL)},Sn=function(Q,L){if(L){var L=fh(L);Q.clearColor(L[0],L[1],L[2],L[3])}},qg=function(V,_){Sc(V,_.uFix,!0),Zd(V,_.aNormal)},rp=function(J,x){Sc(J,x.uFix,!1),Qp(J,x.aNormal)},Tb=function(j,V,Y,P,K,J,Q,d){j._picking||(Y?(Sc(j,V.uBlend,!0),Sc(j,V.uBlendColor,Y)):Sc(j,V.uBlend,!1),Sc(j,V.uLight,P==I?!0:P),ip(K)&&1!==K&&Sc(j,V.uPartOpacity,K),Sc(j,V.uReverseFlip,J==I?!1:J),Sc(j,V.uFixPickReverseColor,Q||vg)),d?j.enable(j.CULL_FACE):j.disable(j.CULL_FACE)},Wh=function(J,D){J._picking||Sc(J,D.uPartOpacity,1)},vq=function(D,L,Y,M,S,$,W,C,Q){if(!Y)return D.activeTexture(D.TEXTURE0),As(D,D._emptyTexture),D.activeTexture(D.TEXTURE1),As(D,D._emptyBlendTexture),void 0;Sc(D,L.uTexture,!0),Sc(D,L.uDiscardSelectable,Ep(M)?M:!0),Qp(D,L.aUv),Wk(D,S,$,L.aUv,2),Q?(Sc(D,L.uBlendTexture,!0),D.activeTexture(D.TEXTURE1),As(D,Q),D.uniform1i(L.uBlendSampler,1)):(Sc(D,L.uBlendTexture,!1),D.activeTexture(D.TEXTURE1),As(D,D._emptyBlendTexture)),D.activeTexture(D.TEXTURE0),As(D,Y),D.uniform1i(L.uSampler,0);var J=[0,0,1,1];W&&(J[0]=W[0],J[1]=W[1]),C&&(J[2]=C[0],J[3]=C[1]),Sc(D,L.uOffsetScale,J)},tb=function(V,U,n){V.activeTexture(V.TEXTURE0),As(V,I),V.activeTexture(V.TEXTURE1),As(V,I),n&&(Zd(V,U.aUv),Sc(V,U.uTexture,!1),Sc(V,U.uBlendTexture,!1))},Ek=function(h,E,Q,W,J,D){!Q||$||np||h.lineWidth(Q),W&&!h._picking&&Sc(h,E.uFixPickReverseColor,W),J&&Wk(h,J,D,E.aPosition)},tn=function(z,u,D,K){Uj&&(K=z[Uj]),z.drawArrays(K==I?z.TRIANGLES:K,u,D);var W=z._renderInfo;W&&(W.calls++,W.vertices+=D,(K==I||K===z.TRIANGLES)&&(W.faces+=D/3),K===z.LINES&&(W.lines+=D/2))},xo=function(r,U,c,A){Uj&&(A=r[Uj]),r.drawElements(A==I?r.TRIANGLES:A,c,r.UNSIGNED_SHORT,U==I?0:2*U);var m=r._renderInfo;m&&(m.calls++,m.vertices+=c,(A==I||A===r.TRIANGLES)&&(m.faces+=c/3),A===r.LINES&&(m.lines+=c/2))},Kq=function(P,v,B,o,T){var D=P.ARRAY_BUFFER;P.bindBuffer(D,v),B&&P.bufferData(D,B,P.STATIC_DRAW),o!=I&&P.vertexAttribPointer(o,T?T:3,P.FLOAT,!1,0,0)},Wk=function(P,H,X,Y,S){return X?(pe(P,P.ARRAY_BUFFER,H,X),Y!=I&&P.vertexAttribPointer(Y,S?S:3,P.FLOAT,!1,0,0),void 0):Kq(P,H,X,Y,S)},xl=function(h,_,Z){var w=h.ELEMENT_ARRAY_BUFFER;h.bindBuffer(w,_),Z&&h.bufferData(w,Z,h.STATIC_DRAW)},ki=function(T,f,R){pe(T,T.ELEMENT_ARRAY_BUFFER,f,R)},pe=function(s,f,R,d){var M=d._bufId;M||(M=d._bufId=o.Math.generateIncreasingID());var R,y=s._bufPool;(R=y[M])&&R._buf?s.bindBuffer(f,R._buf):(R=y[M]={_buf:hn(s)},s.bindBuffer(f,R._buf),s.bufferData(f,d,s.STATIC_DRAW)),R._fid=s._renderInfo.frame},Sc=function(J,S,V){if(V!=I&&S!=I){V=fh(V);var P=V.length;3===P?J.uniform3fv(S,V):4===P?J.uniform4fv(S,V):16===P?J.uniformMatrix4fv(S,!1,V):Ep(V)?J.uniform1i(S,V?1:0):2===P?J.uniform2fv(S,V):J.uniform1f(S,V)}},Qp=function($,Y){Y!=I&&Y>=0&&$.enableVertexAttribArray(Y)},Zd=function(C,K){K!=I&&K>=0&&C.disableVertexAttribArray(K)},wm=function(e,h){var $=e.getGL(),L=e._prg;e._7O=e._8O.pop(),h&&(Sc($,L.uMVMatrix,e._7O),e._6O=h,Sc($,L.uNMatrix,h))},Tp=function(Z,D){return D||(D=Vd()),Ql(D,Z),lq(D),Jp(D),D},ug=function(H,N){var I=H.getGL(),x=H._prg,w=H._7O;N&&(H._8O.push(dc(w)),vl(w,w,N),H._7O=w),Sc(I,x.uMVMatrix,w),Sc(I,x.uNMatrix,Tp(w,H._6O))},Bp=function(v,k,r,j,x,n){if(r){if(j){var H=r.value++,C=2147483648|H,c=[(255&C>>16)/255,(255&C>>8)/255,(255&C)/255,(255&C>>24)/255];r[H]={data:x,part:n}}else c=ae;return Sc(v,k.uFixPickReverseColor,c),c}},uj=function(){var o={center:function(j,K,O,$,n){var I=-K[1]/2,G={x:-K[0]/2,y:I,width:K[0],height:K[1]},v=ed(j,G,O);return[v.x+$,-v.y-n,Hm()]},front:function(o,y,d,q,$){var M=-y[1]/2,f={x:-y[0]/2,y:M,width:y[0],height:y[1]},O=ed(o,f,d);return[O.x+q,-O.y-$,y[2]/2+Hm()]},back:function(l,x,Q,z,E){var k=-x[0]/2,Z=-x[1]/2,q={x:k,y:Z,width:x[0],height:x[1]},F=ed(l,q,Q);return[-F.x-z,-F.y-E,-x[2]/2-Hm()]},left:function(E,g,A,F,m){var D=-g[1]/2,C={x:-g[2]/2,y:D,width:g[2],height:g[1]},Z=ed(E,C,A);return[-g[0]/2-Hm(),-Z.y-m,Z.x+F]},right:function(R,T,c,V,U){var J=-T[2]/2,r=-T[1]/2,q={x:J,y:r,width:T[2],height:T[1]},j=ed(R,q,c);return[T[0]/2+Hm(),-j.y-U,-j.x-V]},top:function(G,Q,R,d,h){var D={x:-Q[0]/2,y:-Q[2]/2,width:Q[0],height:Q[2]},K=ed(G,D,R);return[K.x+d,Q[1]/2+Hm(),K.y+h]},bottom:function(P,v,M,z,c){var E=-v[2]/2,F={x:-v[0]/2,y:E,width:v[0],height:v[2]},L=ed(P,F,M);return[L.x+z,-v[1]/2-Hm(),-L.y-c]}};return function(h,p,S,V,l,H){return o[V](h,p,S,l||0,H||0)}}(),re=function(Y,v,r,H,i,$,M,d,x,O){if(i&&(v[0]+=i[0],v[1]+=i[1],v[2]+=i[2]),nq(Y,r),d){var D=Vd();if(kc(D,x,O),$f(v,D),nq(Y,v),Y.auto=d,Y.pos=$f([0,0,0],Y),$){var c=Y.mat2=Vd();kc(c,$,M)}}else kc(Y,x,O),nq(Y,v),H===_h?nk(Y,-b):H===De?nk(Y,b):H===Rd?yp(Y,-b):H===Yf?yp(Y,b):H===_m&&nk(Y,E),kc(Y,$,M);return Y},Eq=function(k,Q){var x=Q.auto,i=Q.mat2,m=k.gv;if(x){var Z,A=Vd(),O=[0,0,0,0];Z="string"==typeof x?[x.indexOf("x")<0?m._eye[0]:m._center[0],x.indexOf("y")<0?m._eye[1]:m._center[1],x.indexOf("z")<0?m._eye[2]:m._center[2]]:m._eye,ag(O,jf(Vd(),Z,m._center,m._up)),jp(A,os(O,O),Q.pos),i&&vl(A,A,i),ug(m,A)}else ug(m,Q)},Yb=function(D,f,R,g,b){var U=D.s,H=D.gv,E=H.getGL(),w=H._prg,h=H._buffer,N=H._1O;Lp(E,il,N),Eq(D,R),Tb(E,w,U(f+".blend"),U(f+".light"),U(f+".opacity"),U(f+".reverse.flip"),U(f+".reverse.color"),U(f+".reverse.cull")),vq(E,w,N,b,h.uv,fk),Wk(E,h.vs,g,w.aPosition),Wk(E,h.ns,Jh,w.aNormal),ki(E,h.is,co),xo(E,0,co.length),tb(E,w,N),Wh(E,w),wm(H)},Hk=function(n,J,U){var N=n.gv,T=n.data,P=n[J]={blend:N.getBodyColor(T)||N.getFaceBlend(T,J),light:N.getFaceLight(T,J),color:N.getFaceColor(T,J),opacity:N.getFaceOpacity(T,J),transparent:N.getFaceTransparent(T,J),reverseFlip:N.getFaceReverseFlip(T,J),reverseColor:N.getFaceReverseColor(T,J),reverseCull:N.getFaceReverseCull(T,J),texture:N.getFaceImage(T,J),blendTexture:N.getFaceBlendImage(T,J),discardSelectable:N.getFaceDiscardSelectable(T,J)};if("csg"!==J){P.uv=N.getFaceUv(T,J)||U&&U[J+"Uv"],P.uvScale=N.getFaceUvScale(T,J)||U&&U[J+"UvScale"],P.uvOffset=N.getFaceUvOffset(T,J)||U&&U[J+"UvOffset"];var x=N.getFaceMat(T,J);x&&(P.mat=Vl(T,x))}return P},Eg=function(s,o,p,C,f){if(C){if(!f(C.transparent))return;var z=s.data,W=s.gv,V=W._buffer,b=W.getTexture(C.texture,z),U=W.getTexture(C.blendTexture,z);vq(o,p,b,C.discardSelectable,V.uv,C.tuv,C.uvOffset,C.uvScale,U),Tb(o,p,C.blend,C.light,C.opacity,C.reverseFlip,C.reverseColor,C.reverseCull),Sc(o,p.uDiffuse,C.color),Wk(o,V.vs,C.vs,p.aPosition),Wk(o,V.ns,C.ns,p.aNormal),tn(o,0,C.vs.length/3),Wh(o,p),tb(o,p,b)}},Xe=function(W,H,n,h,C,N){var s,x,A,U,m,c,f,Q,d,l,K,g=[h-H,C-n],v=W?W.length:0;for(A=0;v>A;A++){for(U=2,s=W[A],m=s[0],c=s[1];U+1<s.length;){if(f=s[U],Q=s[U+1],x=Cq(H,n,h,C,m,c,f,Q,!0)){d=[f-m,Q-c],l=cd(d),d[0]/=l,d[1]/=l,l=nf(g,d),l=l>0?N:-N,K=[d[0]*l,d[1]*l];break}m=f,c=Q,U+=2}if(K)break}if(K)for(h=H+K[0],C=n+K[1],A=0;v>A;A++)for(U=2,s=W[A],m=s[0],c=s[1];U+1<s.length;){if(f=s[U],Q=s[U+1],x=Cq(H,n,h,C,m,c,f,Q,!0))return[0,0];m=f,c=Q,U+=2}return K?K:[h-H,C-n]},ns=o.graph3d={},_d=function(c,L,C){lf(j+".graph3d."+c,L,C)},Oi="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",md="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";hj(C,{setBatchInfo:function(O,V){Wm[O]=V},getBatchInfo:function(X){return Wm[X]}},!0);var qk=[1,1,1],yi=[1,0,0,0,0,1,0,1,1,1,1,0],Sh=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Ml=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],bh=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Oe=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Rf=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Op=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],hd=function(X,x){uf(X,x,"_batchModelMap","_batchIndexMap"),gr(X,x,"_wireframeModelMap","_wireframeIndexMap"),gr(X,x,"_polylineModelMap","_polylineIndexMap"),gr(X,x,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),gr(X,x,"_polylineModelMapSwap","_polylineIndexMapSwap")},uf=function(O,c,e,X){if(!c)return O[e]={},O[X]={},void 0;var S=c._id,M=O[X],U=M[S];if(U){var r=O[e],v=U.batch,J=r[v],b=J.ds,_=U.index;if(J.invalidate=!0,delete M[S],b.splice(_,1),_o(b))return delete r[v],void 0;for(var x=U.begin,y=U.size,P=3*x,u=3*y,K=4*x,C=4*y,n=J.vs,p=J.ps,I=J.uv,Q=J.cs,l=J.bs,N=J.rs,s=J.ns,j=J.ls;_<b.length;_++)U=M[b[_]._id],U.index--,U.begin-=y;n.splice(P,u),p.splice(K,C),I&&I.splice(2*x,2*y),Q&&Q.splice(K,C),l&&l.splice(P,u),N&&N.splice(x,y),s&&s.splice(P,u),j&&j.splice(x,y)}},gr=uf,vb=function(R,e,K,S){if(!S)return I;var L=e[S];if(!L){var u=Wm[S]||Mg,$=u.image?[]:I;L=e[S]={vs:[],ns:[],uv:$,cs:$?I:u.color?I:[],bs:u.blend?[]:I,ps:[],rs:u.brightness?[]:I,ds:[]}}return L.invalidate=!0,R[K._id]={index:L.ds.length,begin:L.vs.length/3,batch:S},L.ds.push(K),L},pn=function(m,c){return c!=I&&1!==c?[m[0]*c,m[1]*c,m[2]*c,m[3]]:m},el=function(h,G,e){var k=h.getBrightness(G),W=fh(e.color||"white"),Y=W[3]<1,x=Math.ceil(e.width)||1,Q=(Y?"T":"O")+x,P=h._wireframeIndexMap,L=h._wireframeModelMap,R=L[Q];R||(R=L[Q]={vs:[],cs:[],ps:[],ds:[],T:Y,W:x});var r,M=h.getData3dUI(G),a=Ge(M);if(e.geometry){if(!a)return;if(r=Ze(a),!r)return}else r=e.short?Nn:kb;R.invalidate=!0;var n=R.vs,I=R.cs,s=R.ds,l=P[G._id]={index:s.length,begin:n.length/3,batch:Q};s.push(G);var d=Vl(G,e.mat),q=M._calcAnchorMat(G);q&&vl(d,d,q),nb(n,d,r);var H=l.size=n.length/3-l.begin;Th(I,pn(W,k),H)},Sf=function(U,S,B,n,W,e,A,p,R){var _=U.getBrightness(S);_==I&&(_=1);var T=pn(fh(n),_),V=T[3]<1;e=Math.ceil(e)||1;var b=(V?"T":"O")+e;if(A){var J=A[0],u=(A[1]||J)+J;b+="-"+J+"-"+u,R&&(b+="-"+Xj(R)+"-"+_,R=pn(fh(R),_))}var j=U._polylineIndexMap,Y=U._polylineModelMap,f=Y[b];f||(f=Y[b]={vs:[],cs:[],ps:[],ds:[],ls:A?[]:I,T:V,W:e},A&&(f.D=J,f.G=u,f.A=R)),f.invalidate=!0;var H,P=f.vs,i=f.cs,E=f.ds,D=f.ls,G=j[S._id]={index:E.length,begin:P.length/3,batch:b};E.push(S),sm(P,B);var C,h=G.size=P.length/3-G.begin,t=B.length,y=0,r=[];if(A||W)for(H=0;t>H;H+=6)C=cd([B[H],B[H+1],B[H+2]],[B[H+3],B[H+4],B[H+5]]),r.push(C),y+=C;if(y&&W){var K,L=pn(fh(W),_),w=[L[0]-T[0],L[1]-T[1],L[2]-T[2],L[3]-T[3]],Q=0;for(H=0;t>H;H+=6)K=Q/y,Th(i,[T[0]+w[0]*K,T[1]+w[1]*K,T[2]+w[2]*K,T[3]+w[3]*K],1),Q+=r[H/6],K=Q/y,Th(i,[T[0]+w[0]*K,T[1]+w[1]*K,T[2]+w[2]*K,T[3]+w[3]*K],1)}else Th(i,T,h);if(A)for(Q=p||0,H=0;t>H;H+=6)D.push(Q),Q+=r[H/6],D.push(Q)},xc=function(p,y,U){if(y)for(var J=4*y.begin,w=U[y.batch].ps,N=0;N<y.size;N++)w[J++]=p[0],w[J++]=p[1],w[J++]=p[2],w[J++]=p[3]},pf=function(h,R){var C=R+["32"],b=h[R],i=h[C];b?i&&i.length===b.length?(i.set(b),i._bufId=null):h[C]=new zd(b):delete h[C]},Rp=function(h,U,$,k,M,m,Z,H,x){if(sk($))$.forEach(function(l){Rp(h,U,l,k,M,m,Z,H,x)});else if(hf($))Rp(h,U,Ge(k,$),k,M,m,Z,H,x);else if(Ui($)){var W,V=Tq($.mat,U,h),P=Tq($.s3,U,h),Y=Tq($.t3,U,h),o=Tq($.r3,U,h);if((P||o||Y||V)&&(W=qq(V,P,o,Tq($.rotationMode,U,h),Y),m.push(W)),$.shape3d)Rp(h,U,$.shape3d,k,M,m,Z,H,$);else{var c=k.s;x=x||Mg;var i=m[0],b=m.length,r=c("shape3d.color",$.color,x.color);if(M||(M=c("shape3d.blend",$.blend,x.blend)),b>1){i=dc(i);for(var u=1;b>u;u++)vl(i,i,m[u])}$.vs&&c(Vf,$.visible,x.visible)&&Tc(i,Z,H,$.vs,$.uv,$.is,M,r),$.top_vs&&c(Li,$.topVisible,x.topVisible)&&Tc(i,Z,H,$.top_vs,$.top_uv,$.top_is,M,c("shape3d.top.color",$.topColor,x.topColor)||r),$.bottom_vs&&c(zl,$.bottomVisible,x.bottomVisible)&&Tc(i,Z,H,$.bottom_vs,$.bottom_uv,$.bottom_is,M,c("shape3d.bottom.color",$.bottomColor,x.bottomColor)||r),$.from_vs&&c(eb,$.fromVisible,x.fromVisible)&&Tc(i,Z,H,$.from_vs,$.from_uv,$.from_is,M,c("shape3d.from.color",$.fromColor,x.fromColor)||r),$.to_vs&&c(Uq,$.toVisible,x.toVisible)&&Tc(i,Z,H,$.to_vs,$.to_uv,$.to_is,M,c("shape3d.to.color",$.toColor,x.toColor)||r)}W&&m.pop()}},Tc=function(u,o,C,t,Y,z,K,O){var f,A=o.cs,E=o.uv,_=o.bs;if(z){f=z.length;for(var b=0;f>b;b++){var p=z[b];nb(C,u,[t[3*p],t[3*p+1],t[3*p+2]]),E&&sm(E,[Y[2*p],Y[2*p+1]])}}else f=t.length/3,nb(C,u,t),E&&sm(E,Y);A&&Th(A,O,f),_&&(K?Eo(_,K,f):sm(_,qk,f))},Iq=function(z,U,w,M){var i=[];M?Rp(z.gv,z.data,M,z,z.getBodyColor(),[U],w,i):(Im(z,_h,U,w,i),Im(z,De,U,w,i),Im(z,Zp,U,w,i),Im(z,_m,U,w,i),Im(z,Rd,U,w,i),Im(z,Yf,U,w,i),Im(z,"csg",U,w,i)),i.length&&(sm(w.vs,i),sm(w.ns,Dr(i)))},Im=function(J,f,K,b,w){var X=J[f];if(X){var o=X.tuv;if(o){var U,l,R,C,c=X.uvScale,z=X.uvOffset;if(c)for(U=o.length,l=c[0],R=c[1],C=0;U>C;C+=2)o[C]*=l,o[C+1]*=R;if(z)for(U=o.length,l=z[0],R=z[1],C=0;U>C;C+=2)o[C]+=l,o[C+1]+=R}Tc(K,b,w,X.vs,o,I,X.blend,X.color)}},Mq=function(U,z,w,O,m,G,s,d){var C,$=w.cs,K=w.uv,l=w.bs;if(U.getFaceVisible(z,G)){var Q=U.getFaceMat(z,G);if(Q&&(m=Vl(z,Q)),nb(s,m,d),$&&Th($,U.getFaceColor(z,G),6),K){var b=U.getFaceUv(z,G)||O[G+"Uv"],q=U.getFaceUvScale(z,G)||O[G+"UvScale"],L=U.getFaceUvOffset(z,G)||O[G+"UvOffset"];b=b?[b[6],b[7],b[0],b[1],b[2],b[3],b[2],b[3],b[4],b[5],b[6],b[7]]:yi;var D=b[0],o=b[1],y=b[2],r=b[3],P=b[4],f=b[5],H=b[6],u=b[7],t=b[8],S=b[9],A=b[10],c=b[11];if(q){var X=q[0],n=q[1];D*=X,o*=n,y*=X,r*=n,P*=X,f*=n,H*=X,u*=n,t*=X,S*=n,A*=X,c*=n}if(L){var I=L[0],N=L[1];D+=I,o+=N,y+=I,r+=N,P+=I,f+=N,H+=I,u+=N,t+=I,S+=N,A+=I,c+=N}K.push(D,o,y,r,P,f,H,u,t,S,A,c)}l&&(C=U.getBodyColor(z)||U.getFaceBlend(z,G),C?Eo(l,C,6):sm(l,qk,6))}},Ud=function(l,S,h,r){var k=l.getGL(),K=l._prg,D=l._buffer;if(!Nl(S)){ug(l),qg(k,K);for(var Y in S){var N=S[Y];if(!(r&&!N.T||!r&&N.T)){N.invalidate?(N.invalidate=!1,pf(N,"vs"),pf(N,"cs"),pf(N,"ls"),pf(N,"ps")):h&&pf(N,"ps");var g=N.vs32,p=h?N.ps32:N.cs32;Ek(k,K,N.W,I,D.vs,g);var O=N.D,J=!l._dashDisabled&&O;Sc(k,K.uAlphaTest,R.alphaTest),J&&(Sc(k,K.uDash,!0),Sc(k,K.uDashDistance,O),Sc(k,K.uDashGapDistance,N.G),Qp(k,K.aLineDistance),Wk(k,D.lineDistance,N.ls32,K.aLineDistance,1),Sc(k,K.uDiffuse,N.A||Dq));var e=!l._batchColorDisabled;e&&(Sc(k,K.uBatchColor,!0),Qp(k,K.aBatchColor),Wk(k,D.batchColor,p,K.aBatchColor,4)),vq(k),tn(k,0,g.length/3,k.LINES),tb(k),e&&(Sc(k,K.uBatchColor,!1),Zd(k,K.aBatchColor)),J&&(Sc(k,K.uDash,!1),Zd(k,K.aLineDistance))}}rp(k,K)}},If=function(S,c,i){var q,L,F,o,b,x,G,k,e,p,j,s=S.getGL(),f=S._prg,h=S._buffer,t=S._batchModelMap;if(!Nl(t)){ug(S);for(q in t)if(L=Wm[q]||Mg,!(i&&!L.transparent||!i&&L.transparent)&&(F=t[q],c||!L.transparentMask)){var n=i&&L.autoSort!==!1&&(S._33Q||F.invalidate);if(F.invalidate?(F.invalidate=!1,pf(F,"vs"),pf(F,"ns"),pf(F,"cs"),pf(F,"rs"),pf(F,"ps"),pf(F,"bs"),pf(F,"uv")):c&&pf(F,"ps"),b=F.vs32,x=c?F.ps32:F.cs32,e=F.uv32,G=F.bs32,k=F.rs32,j=b.length/3,n&&(F.is=or(b,S.getEye())),j){o=L.light,p=S.getTexture(L.image),Tb(s,f,I,L.light,L.opacity,L.reverseFlip,L.reverseColor,L.reverseCull),x?S._batchColorDisabled||(Sc(s,f.uBatchColor,!0),Qp(s,f.aBatchColor),Wk(s,h.batchColor,x,f.aBatchColor,4)):Sc(s,f.uDiffuse,L.color||Dq);var H=L.alphaTest;Sc(s,f.uAlphaTest,H===Z?R.alphaTest:H);var B=G&&!S._batchBlendDisabled;B&&(Sc(s,f.uBatchBlend,!0),Qp(s,f.aBatchBlend),Wk(s,h.batchBlend,G,f.aBatchBlend));var Q=k&&!S._batchBrightnessDisabled;Q&&(Sc(s,f.uBatchBrightness,!0),Qp(s,f.aBatchBrightness),Wk(s,h.batchBrightness,k,f.aBatchBrightness,1)),e?vq(s,f,p,L.discardSelectable,h.uv,e,L.uvOffset,L.uvScale):vq(s),Wk(s,h.vs,b,f.aPosition),Wk(s,h.ns,F.ns32,f.aNormal),F.is?(xl(s,h.is,F.is),xo(s,0,j)):tn(s,0,j),e?tb(s,f,p):tb(s),x&&!S._batchColorDisabled&&(Sc(s,f.uBatchColor,!1),Zd(s,f.aBatchColor)),B&&(Sc(s,f.uBatchBlend,!1),Zd(s,f.aBatchBlend)),Q&&(Sc(s,f.uBatchBrightness,!1),Zd(s,f.aBatchBrightness)),Wh(s,f)}}}},or=function(d,w){for(var n=d.length/3,S=new Array(n),C=n/3,l=new Array(C),$=0;C>$;$++)l[$]=$;l.sort(function(a,N){var R=9*a,U=[(d[R]+d[R+3]+2*d[R+6])/4,(d[R+1]+d[R+4]+2*d[R+7])/4,(d[R+2]+d[R+5]+2*d[R+8])/4];R=9*N;var W=[(d[R]+d[R+3]+2*d[R+6])/4,(d[R+1]+d[R+4]+2*d[R+7])/4,(d[R+2]+d[R+5]+2*d[R+8])/4],q=cd(w,U)-cd(w,W);return q>0?-1:0>q?1:0});for(var $=0;C>$;$++){var e=3*$,t=3*l[$];S[e]=t,S[e+1]=t+1,S[e+2]=t+2}return new Gn(S)},bp={obj:function(F,G){var H={mat:F.mat,s3:F.s3,r3:F.r3,rotationMode:F.rotationMode,t3:F.t3,cube:F.cube==I?!0:F.cube,center:F.center==I?!0:F.center,ignoreMtls:F.ignoreMtls,ignoreTransparent:F.ignoreTransparent,ignoreColor:F.ignoreColor,ignoreImage:F.ignoreImage,ignoreNormal:F.ignoreNormal,prefix:F.prefix,flipY:F.flipY,flipFace:F.flipFace,reverseFlipMtls:F.reverseFlipMtls,finishFunc:function(O,A){if(O){var A=[];
for(var s in O){var h=O[s];A.rawS3=h.rawS3,A.push(h),F.eachModel&&F.eachModel(s,h)}A.json=F,G(A)}else G()}};C.loadObj(F.obj,F.mtl,H)}};C.getModelTypeHandlers=function(){return bp},C.setModelTypeHandler=function(D,G){bp[D]=G},C.getModelTypeHandler=function(F){return bp[F]},C.handleModelLoaded=function(){},C.handleUnfoundModel=function(){};var Uo=I,Bl=I,Ij=function(o){Uo&&!o._loadingModelView_&&(Bl||(Bl={}),Bl[o._loadingModelView_=Md()]=o)},ck=function(e,U){Uo||(Uo={});var E=Uo[e];if(E){if(E.url===U)return;E.request.onload=kg,E.request.onerror=kg}var u=new xn;if(Uo[e]={request:u,url:U},U=C.beforeLoadURL(U),U.data){var v=C.parse(U.data);Tg(e,v,U)}else{u.onload=function(w){if(200===this.status||0===this.status){var f=C.parse(w.target.response||w.target.responseText);Tg(e,f,U)}else Nb(e,C.handleUnfoundModel(e,U)||I)},u.onerror=function(){Nb(e,C.handleUnfoundModel(e,U)||I)};var T={};T.url=encodeURI(U),T.sync=!1,u.send(T)}},Tg=function(j,Y,J){var m=Y.modelType;if(!m)return Nb(j,Y),C.handleModelLoaded(j,Y),void 0;var t=C.getModelTypeHandler(m);if(t){var f=function(k){k?(Nb(j,k),C.handleModelLoaded(j,k)):Nb(j,C.handleUnfoundModel(j,J)||I)};t(Y,f)}else Nb(j,C.handleUnfoundModel(j,J)||I)},Nb=function(S,N){if(Lq[S]=N,delete Uo[S],Nl(Uo)&&(Uo=I,Bl)){for(var H in Bl){var z=Bl[H];z._2O&&(z._2O={}),z.invalidateAll&&z.invalidateAll(Z,"modelLoaded",S),z.redraw&&z.redraw(),z.iv(),delete z._loadingModelView_}Bl=I}if(N&&Bl)for(var H in Bl){var z=Bl[H];z.invalidateAll&&z.invalidateAll(Z,"modelLoading",S),z.redraw&&z.redraw(),z.iv()}},fk=new zd([0,0,0,1,1,1,1,0]),Jh=new zd([0,0,1,0,0,1,0,0,1,0,0,1]),co=new Gn([0,1,2,2,3,0]),Wb=new zd([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),xk=new Gn([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Ug=new zd([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Mi=Dr(Wb,xk),rd=(new zd([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Gn([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[_h,Zp,De,_m,Rd,Yf]),kb=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Nn=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],pd=function(x,G,h,b,d,r){r=r||16,x=x||16,G=G||0,h=h||x;var A,D,Y,t,n,U,s,k,P=.5,f=[],B=[],S=i/x,$=E/r;for(A=0;r>A;A++)for(n=A+1,t=A*$,k=n*$,D=G;h>D;D++)U=D+1,Y=D*S,s=U*S,f.push(P*W(t)*T(Y),P*T(t),-P*W(t)*W(Y),P*W(k)*T(s),P*T(k),-P*W(k)*W(s),P*W(t)*T(s),P*T(t),-P*W(t)*W(s),P*W(t)*T(Y),P*T(t),-P*W(t)*W(Y),P*W(k)*T(Y),P*T(k),-P*W(k)*W(Y),P*W(k)*T(s),P*T(k),-P*W(k)*W(s)),B.push(D/x,A/r,U/x,n/r,U/x,A/r,D/x,A/r,D/x,n/r,U/x,n/r);if(b){var O=[],C=[];for(Y=G*S,A=0;r>A;A++)n=A+1,t=A*$,k=n*$,O.push(0,0,0,P*W(k)*T(Y),P*T(k),-P*W(k)*W(Y),P*W(t)*T(Y),P*T(t),-P*W(t)*W(Y)),C.push(0,.5,G/x,n/r,G/x,A/r)}if(d){var u=[],p=[];for(Y=h*S,A=0;r>A;A++)n=A+1,t=A*$,k=n*$,u.push(0,0,0,P*W(t)*T(Y),P*T(t),-P*W(t)*W(Y),P*W(k)*T(Y),P*T(k),-P*W(k)*W(Y)),p.push(1,.5,h/x,A/r,h/x,n/r)}return{vs:f,uv:B,from_vs:O,from_uv:C,to_vs:u,to_uv:p}},Xk=function(y,B,j){y=y||.17,B=B||12,j=j||18,0>y?y=0:y>.25&&(y=.25);var Z,I,n,P,r,M,d,Y=.5,F=[],O=[],R=[],Q=i/j,m=i/B,z=Y-y;for(I=0;B>=I;I++)for(P=-E+I*m,M=T(P),r=W(P),Z=0;j>=Z;Z++)n=Z*Q,d=z+y*M,F.push(T(n)*d,r*y,-W(n)*d),O.push(Z/j,1-I/B);for(I=0;B>I;I++){var X=I*(j+1),b=(I+1)*(j+1);for(Z=0;j>Z;Z++)R.push(X+Z,b+Z+1,b+Z,X+Z,X+Z+1,b+Z+1)}return{vs:F,uv:O,is:R}},Mn=function($,L,J,Q,G,y,Z){Z=Z||12,$=$||18,L=L||0,J=J||$,y=y||.17,0>y?y=0:y>.25&&(y=.25);var H,z,U,O,n,a,M,g,k,N,_=.5,u=[],l=[],F=i/$,B=i/Z,r=_-y;for(U=0;Z>U;U++)for(O=U+1,M=-E+U*B,g=-E+O*B,H=L;J>H;H++)z=H+1,n=H*F,a=z*F,k=r+y*T(M),N=r+y*T(g),u.push(T(n)*k,W(M)*y,-W(n)*k,T(a)*k,W(M)*y,-W(a)*k,T(a)*N,W(g)*y,-W(a)*N,T(n)*k,W(M)*y,-W(n)*k,T(a)*N,W(g)*y,-W(a)*N,T(n)*N,W(g)*y,-W(n)*N),l.push(H/$,1-U/Z,z/$,1-U/Z,z/$,1-O/Z,H/$,1-U/Z,z/$,1-O/Z,H/$,1-O/Z);if(Q){var f=[],K=[];for(U=0;Z>U;U++)O=U+1,M=-E+U*B,g=-E+O*B,n=L*F,k=r+y*T(M),N=r+y*T(g),f.push(T(n)*k,W(M)*y,-W(n)*k,T(n)*N,W(g)*y,-W(n)*N,T(n)*r,0,-W(n)*r),K.push(.5+.5*T(M),.5-.5*W(M),.5+.5*T(g),.5-.5*W(g),.5,.5)}if(G){var p=[],w=[];for(U=0;Z>U;U++)O=U+1,M=-E+U*B,g=-E+O*B,n=J*F,k=r+y*T(M),N=r+y*T(g),p.push(T(n)*k,W(M)*y,-W(n)*k,T(n)*r,0,-W(n)*r,T(n)*N,W(g)*y,-W(n)*N),w.push(.5-.5*T(M),.5-.5*W(M),.5,.5,.5-.5*T(g),.5-.5*W(g))}return{vs:u,uv:l,from_vs:f,from_uv:K,to_vs:p,to_uv:w}},zk=function(M,n){for(var A,e,K,c=.5,d=16,o=[],I=[],B=[],H=i/d,z=0;d>=z;z++)A=z*H,e=T(A)*c,K=W(A)*c,o.push(e,-c,K,e,c,K),I.push(1-z/d,1,1-z/d,0);for(z=0;d>z;z++)B.push(2*z,2*z+1,2*z+3,2*z,2*z+3,2*z+2);if(n){var b=[],P=[],E=[];for(b.push(0,-c,0),P.push(.5,.5),z=0;d>=z;z++)A=z*H,e=T(A),K=W(A),b.push(e*c,-c,-K*c),P.push(.5+.5*e,.5+.5*K);for(z=0;d>z;z++)E.push(0,z+2,z+1)}if(M){var D=[],g=[],f=[];for(D.push(0,c,0),g.push(.5,.5),z=0;d>=z;z++)A=z*H,e=T(A),K=W(A),D.push(e*c,c,-K*c),g.push(.5+.5*e,.5-.5*K);for(z=0;d>z;z++)f.push(0,z+1,z+2)}return{vs:o,uv:I,is:B,bottom_vs:b,bottom_uv:P,bottom_is:E,top_vs:D,top_uv:g,top_is:f}},gi=function(m,R,v,u,G,o,e){m=m||12,R=R||0,v=v||m;for(var _,X,M,Z,n,V,B,c,S=.5,N=[],H=[],E=i/m,K=R;v>K;K++)_=K+1,X=K*E,M=_*E,Z=T(X)*S,n=W(X)*S,V=T(M)*S,B=W(M)*S,N.push(Z,-S,-n,V,-S,-B,Z,S,-n,V,-S,-B,V,S,-B,Z,S,-n),H.push(K/m,1,_/m,1,K/m,0,_/m,1,_/m,0,K/m,0);if(e){var Y=[],O=[];for(K=R;v>K;K++)X=E*K,M=E*(K+1),Z=T(X),n=W(X),V=T(M),B=W(M),Y.push(Z*S,-S,-n*S,0,-S,0,V*S,-S,-B*S),O.push(.5+.5*Z,.5+.5*n,.5,.5,.5+.5*V,.5+.5*B)}if(o){var s=[],U=[];for(K=R;v>K;K++)X=E*K,M=E*(K+1),Z=T(X),n=W(X),V=T(M),B=W(M),s.push(Z*S,S,-n*S,V*S,S,-B*S,0,S,0),U.push(.5+.5*Z,.5-.5*n,.5+.5*V,.5-.5*B,.5,.5)}if(u){var $=[],L=[];X=E*R,Z=T(X)*S,n=W(X)*S,c=R/m,$.push(0,S,0,0,-S,0,Z,-S,-n,Z,-S,-n,Z,S,-n,0,S,0),L.push(0,0,0,1,c,1,c,1,c,0,0,0)}if(G){var F=[],p=[];X=E*v,Z=T(X)*S,n=W(X)*S,c=v/m,F.push(0,-S,0,0,S,0,Z,S,-n,Z,S,-n,Z,-S,-n,0,-S,0),p.push(1,1,1,0,c,0,c,0,c,1,1,1)}return{vs:N,uv:H,bottom_vs:Y,bottom_uv:O,top_vs:s,top_uv:U,from_vs:$,from_uv:L,to_vs:F,to_uv:p}},qp=function(F,x,m,s,B){x=x||18,m=m||0,s=s==I?i:s,B=B==I?.5:B;for(var v,S,e,f,d,L,A=[0,.5,.75,.875,.9375],X=[],C=[],j=[],a=s/x,V=0;V<A.length;V++){var o=0===V%2?0:.5;for(v=0;x>=v;v++)S=(v+o)*a+m,e=1-A[V],X.push(T(S)*B*e,-B+2*A[V]*B,-W(S)*B*e),C.push((v+o)/x,e)}for(V=0;V<A.length-1;V++){var u=V*(x+1),h=(V+1)*(x+1);for(v=0;x>v;v++)j.push(u+v,h+v+1,h+v,u+v,u+v+1,h+v+1)}for(L=X.length/3-(x+1),v=0;x>v;v++)X.push(0,B,0),C.push((v+.5)/x,0);for(v=0;x>v;v++)j.push(L+v,L+v+1,L+(x+1)+v);if(F){var z=[],n=[],r=[];for(z.push(0,-B,0),n.push(.5,.5),v=0;x>=v;v++)S=v*a+m,f=T(S),d=W(S),z.push(f*B,-B,-d*B),n.push(.5+.5*f,.5+.5*d);for(v=0;x>v;v++)r.push(0,v+2,v+1)}return{vs:X,uv:C,is:j,bottom_vs:z,bottom_uv:n,bottom_is:r}},tm=function(S,t,h,D,E,n){S=S||16,t=t||0,h=h||S;for(var G=.5,$=[],u=[],k=i/S,Z=t;h>Z;Z++){var R=Z+1,C=k*Z,f=k*R;$.push(T(C)*G,-G,-W(C)*G,T(f)*G,-G,-W(f)*G,0,G,0),u.push(Z/S,1,R/S,1,(Z+R)/2/S,0)}if(n){var I=[],L=[];for(Z=t;h>Z;Z++){C=k*Z,f=k*(Z+1);var l=T(C),x=W(C),B=T(f),w=W(f);I.push(l*G,-G,-x*G,0,-G,0,B*G,-G,-w*G),L.push(.5+.5*l,.5+.5*x,.5,.5,.5+.5*B,.5+.5*w)}}if(D){var j=[],Y=[];C=k*t,j.push(0,G,0,0,-G,0,T(C)*G,-G,-W(C)*G),Y.push(0,0,0,1,t/S,1)}if(E){var H=[],g=[];C=k*h,H.push(0,-G,0,0,G,0,T(C)*G,-G,-W(C)*G),g.push(1,1,1,0,h/S,1)}return{vs:$,uv:u,bottom_vs:I,bottom_uv:L,from_vs:j,from_uv:Y,to_vs:H,to_uv:g}},Sq=function(S,C,p,R,q,s,M,$){for(var n=[],e=0;e<S.length-1;e+=2)n.push({x:S[e],y:S[e+1]});return Oo(n,C,p,R,q,s,M,$,!1)},hq={roundRect:function(f,a){return Sq([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],f,a,3)},star:function(w,C){return Sq([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],w,C)},rect:function(E,k){return Sq([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],E,k)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(w,b){return Sq([0,-.5,.5,.5,-.5,.5],[1,2,2,5],w,b)},rightTriangle:function(m,J){return Sq([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],m,J)},parallelogram:function(t,h){return Sq([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],t,h)},trapezoid:function(m,k){return Sq([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],m,k)}},ng={sphere:1,cylinder:1,cone:1,torus:1},yn={torus:1,sphere:1},ig=hj(Tm(hq),{cylinder:1}),Vn=hj(Tm(hq),{cylinder:1,cone:1}),El=function(C,w,i){var p,x=Tq(C.anchor3d,i,w),K=Tq(C.mat,i,w),z=Tq(C.s3,i,w),q=Tq(C.t3,i,w),$=Tq(C.r3,i,w),P=z||$||q||K;if(x||P){p=dc(w._6O);var g=P?qq(K,z,$,Tq(C.rotationMode,i,w),q):Vd();x&&nq(g,[.5-x[0],.5-x[1],.5-x[2]]),ug(w,g)}return p},Ed=function(L,U,y,o,m,p,V){if(sk(y))y.forEach(function(A){Ed(L,U,A,o,m,p,V)});else if(hf(y))Ed(L,U,Ge(o,y),o,m,p,V);else if(Ui(y))if(y.shape3d){var l=El(y,L,U);Ed(L,U,y.shape3d,o,m,p,y),l&&wm(L,l)}else $p(L,U,y,o.s,m,p,V)},$p=function(e,r,t,b,J,i,M){if(M=M||Mg,!i||i(b("shape3d.transparent",t.transparent,M.transparent))){var y=El(t,e,r);er(t);var q=e._26I,k=e._prg,$=e._buffer,_=b("shape3d.color",t.color,M.color);J||(J=b("shape3d.blend",t.blend,M.blend));var D,o=t.opacity==I?M.opacity:t.opacity,m=b("shape3d.opacity");D=m!=I&&o!=I?o*m:o!=I?o:m,Tb(q,k,J,b("shape3d.light",t.light,M.light),D,b("shape3d.reverse.flip",t.reverseFlip,M.reverseFlip),b("shape3d.reverse.color",t.reverseColor,M.reverseColor),b("shape3d.reverse.cull",t.reverseCull,M.reverseCull)),t.vs&&b(Vf,t.visible,M.visible)&&Jg(q,k,$,_,e.getTexture(b("shape3d.image",t.image,M.image),r),b("shape3d.discard.selectable",t.discardSelectable,M.discardSelectable),t.vs,t.uv,t.ns,t.is,b("shape3d.uv.offset",t.uvOffset,M.uvOffset),b("shape3d.uv.scale",t.uvScale,M.uvScale),b("shape3d.polygonOffset",t.polygonOffset,M.polygonOffset)),t.top_vs&&b(Li,t.topVisible,M.topVisible)&&Jg(q,k,$,b("shape3d.top.color",t.topColor,M.topColor)||_,e.getTexture(b("shape3d.top.image",t.topImage,M.topImage),r),b("shape3d.top.discard.selectable",t.topDiscardSelectable,M.topDiscardSelectable),t.top_vs,t.top_uv,t.top_ns,t.top_is,b("shape3d.top.uv.offset",t.topUvOffset,M.topUvOffset),b("shape3d.top.uv.scale",t.topUvScale,M.topUvScale),b("shape3d.top.polygonOffset",t.topPolygonOffset,M.topPolygonOffset)),t.bottom_vs&&b(zl,t.bottomVisible,M.bottomVisible)&&Jg(q,k,$,b("shape3d.bottom.color",t.bottomColor,M.bottomColor)||_,e.getTexture(b("shape3d.bottom.image",t.bottomImage,M.bottomImage),r),b("shape3d.bottom.discard.selectable",t.bottomDiscardSelectable,M.bottomDiscardSelectable),t.bottom_vs,t.bottom_uv,t.bottom_ns,t.bottom_is,b("shape3d.bottom.uv.offset",t.bottomUvOffset,M.bottomUvOffset),b("shape3d.bottom.uv.scale",t.bottomUvScale,M.bottomUvScale),b("shape3d.bottom.polygonOffset",t.bottomPolygonOffset,M.bottomPolygonOffset)),t.from_vs&&b(eb,t.fromVisible,M.fromVisible)&&Jg(q,k,$,b("shape3d.from.color",t.fromColor,M.fromColor)||_,e.getTexture(b("shape3d.from.image",t.fromImage,M.fromImage),r),b("shape3d.from.discard.selectable",t.fromDiscardSelectable,M.fromDiscardSelectable),t.from_vs,t.from_uv,t.from_ns,t.from_is,b("shape3d.from.uv.offset",t.fromUvOffset,M.fromUvOffset),b("shape3d.from.uv.scale",t.fromUvScale,M.fromUvScale),b("shape3d.from.polygonOffset",t.fromPolygonOffset,M.fromPolygonOffset)),t.to_vs&&b(Uq,t.toVisible,M.toVisible)&&Jg(q,k,$,b("shape3d.to.color",t.toColor,M.toColor)||_,e.getTexture(b("shape3d.to.image",t.toImage,M.toImage),r),b("shape3d.to.discard.selectable",t.toDiscardSelectable,M.toDiscardSelectable),t.to_vs,t.to_uv,t.to_ns,t.to_is,b("shape3d.to.uv.offset",t.toUvOffset,M.toUvOffset),b("shape3d.to.uv.scale",t.toUvScale,M.toUvScale),b("shape3d.to.polygonOffset",t.toPolygonOffset,M.toPolygonOffset)),Wh(q,k),y&&wm(e,y)}},Jg=function(u,d,s,v,N,G,c,f,Q,K,e,I,l){c&&(l&&ue(u,l),Sc(u,d.uDiffuse,v),f?vq(u,d,N,G,s.uv,f,e,I):vq(u),Wk(u,s.vs,c,d.aPosition),Wk(u,s.ns,Q,d.aNormal),K?(ki(u,s.is,K),xo(u,0,K.length)):tn(u,0,c.length/3),f?tb(u,d,N):tb(u),l&&$c(u))},Ge=function(Y,F){var s=Y.s;if(F||(F=s(Ho)),!F)return I;var x=cg(F);if(x)return x;if("text"===F){var S={amount:s("shape3d.text.amount"),size:s("shape3d.text.size"),font:s("shape3d.text.font"),style:s("shape3d.text.style"),weight:s("shape3d.text.weight"),fill:s("shape3d.text.fill"),curveSegments:s("shape3d.text.curveSegments"),spacing:s("shape3d.text.spacing")},a=Y.gv.getShape3dText(Y.data),W=a;for(var P in S)W+="_"+(S[P]===Z?"U":S[P]);return Y._cachedTextKey===W?Y._cachedTextGeometry:(Y._cachedTextKey=W,Y._cachedTextGeometry=C.createTextGeometry(a,S))}var P=F;if(ng[F]){var N=s("shape3d.side"),V=s("shape3d.side.from"),R=s("shape3d.side.to"),T=s(eb),m=s(Uq);3>N?(N=0,V=0,R=0,T=!1,m=!1):((V==I||0>V)&&(V=0),(R==I||R>N)&&(R=N),0===V&&R===N&&(T=!1,m=!1)),P+="-"+N+"-"+V+"-"+R+"-"+T+"-"+m}if(ig[F]){var z=s(Li);P+="-"+z}if(Vn[F]){var u=s(zl);P+="-"+u}if("torus"===F){var j=s("shape3d.torus.radius");0>j?j=0:j>.25&&(j=.25),P+="-"+j}if(yn[F]){var L=s(fi);P+="-"+L}return x=Ue[P],x||("box"===F?x=C.createBoxModel():hq[F]?x=hq[F](z,u):"sphere"===F?x=C.createSphereModel(N,V,R,T,m,L):F===An?x=C.createCylinderModel(N,V,R,T,m,z,u):"cone"===F?x=C.createConeModel(N,V,R,T,m,u):"torus"===F&&(x=C.createTorusModel(N,V,R,T,m,j,L)),Ue[P]=x),x},er=function(){var j=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],E=["is","top_is","bottom_is","from_is","to_is"];return d=ao(Oi.substr(Oi.indexOf("^#")+2)),Il(C[zn(Vi+j[15]+"n"+j[16])]())&&qr()?function(U){U&&!U._complete_&&(U._complete_=!0,U.vs&&_o(U.ns)&&(U.ns=Dr(U.vs,U.is)),U.top_vs&&_o(U.top_ns)&&(U.top_ns=Dr(U.top_vs,U.top_is)),U.bottom_vs&&_o(U.bottom_ns)&&(U.bottom_ns=Dr(U.bottom_vs,U.bottom_is)),U.from_vs&&_o(U.from_ns)&&(U.from_ns=Dr(U.from_vs,U.from_is)),U.to_vs&&_o(U.to_ns)&&(U.to_ns=Dr(U.to_vs,U.to_is)),j.forEach(function(K){var m=U[K];sk(m)&&(U[K]=new zd(m))}),E.forEach(function(V){var I=U[V];sk(I)&&(U[V]=new Gn(I))}))}:void 0}(),ek=function($,Y){var B=$[Y];sk(B)&&($[Y]=new zd(B))};hj(Zl,{_25Q:function(g){g._16O=function(l,H,K,G,$,q,P,U,f){var C=this.info;if(C){var I,R,m,W,F,o,v=Vd();if(Hb[H]?(I=C.p3,R=C.c1,m=C.c2):Wj[H]?(R=C.s1||C.c1,m=C.s2||C.c2):(R=C.t1||C.c1,m=C.t2||C.c2),I)o=uj(H,Kb,K,G,U,f);else{var p=uq(m,R),h=cd(R,m);W=[0,-Y(p[2],p[0]),Q(p[1]/h)],F="zyx",I=[(R[0]+m[0])/2,(R[1]+m[1])/2,(R[2]+m[2])/2],o=uj(H,[h,0,0],K,G,U,f)}return re(v,o,I,G,$,q,P,l,W,F)}return Fk},g._80o=function(e,M,k){var t=this,p=t.shapeModel;if(p){var v=t.gv;ug(v),Ed(v,t.data,p,t,t.getBodyColor(),k)}},g.createLineModel=function(r,Z,M,w,F){for(var R=this,b=R.s,X=ih(r,Z,b(fi)),p=[],e=0;e<X.length;e++){var K=X[e],j=K.length;if(j>1){var n=K[0];p.push(n.x,n.y,n.z);for(var _=1;j-1>_;_++)n=K[_],p.push(n.x,n.y,n.z),p.push(n.x,n.y,n.z);n=K[j-1],p.push(n.x,n.y,n.z)}}var A,c,f,C=b(w+".color"),P=b(F),z=0;return P&&(c=b(F+".color"),A=b(F+".pattern"),z=b(F+".offset"),f=C),Sf(R.gv,R.data,p,c||C,f?I:b(w+".gradient.color"),M,A||b(w+".pattern"),z,f),X},g.createTubeModel=function(s,w,E,t){for(var e=this,P=e.s,x=P("shape3d.side")||Hj,L=P("shape3d.start.angle"),N=P("shape3d.sweep.angle"),n=P(Li)?P("shape3d.top.cap"):I,B=P(zl)?P("shape3d.bottom.cap"):I,d="flat"===n,j="flat"===B,y=d&&(t?t.uv:P("shape3d.top.image")),r=j&&(t?t.uv:P("shape3d.bottom.image")),$=t?t.uv:P("shape3d.image"),G={vs:[],uv:$?[]:I,top_vs:d?[]:I,top_uv:y?[]:I,bottom_vs:j?[]:I,bottom_uv:r?[]:I},S=ih(s,w,P(fi),E),M=0,Z=S.length;Z>M;M++)Ki(G,S[M],P(ui),E,x,L,N,n,B);if(t){var J=[];Rp(e.gv,e.data,G,e,e.getBodyColor(),[],t,J),J.length&&(sm(t.vs,J),sm(t.ns,Dr(J)))}else e.shapeModel=G;return S},g.getCache=function(){var U=this.info;if(U){var j=U.list;if(j){var W=U.cache;return W||(W=U.cache=Rc(j)),W}}return I}}});var ch=function(W,N){for(var y,S=0,G=W.length,l=0,u=G-1;u>=l;)if(S=B(l+(u-l)/2),y=W[S].length-N,0>y)l=S+1;else{if(!(y>0)){u=S;break}u=S-1}S=u;var $=W[S],e=$.point;return S===G-1||$.length===N||(e=(new Um).subVectors(W[S+1].point,e).normalize().multiplyScalar(N-$.length).add(e)),{point:e,tangent:$.tangent}},Rc=function(A){for(var D,r,t=[],v=0,k=0;k<A.length;k++){for(var T=A[k],J=0;J<T.length;J++){D=T[J],r&&(v+=r.distanceTo(D));var F=new Um,p=T[J+1];p?F.subVectors(p,D):r?F.subVectors(D,r):F.x=1,F.normalize(),t.push({point:D,length:v,tangent:F}),r=D}r=null}return t},ih=function(Q,n,g,u){g=g||Yo;for(var w=[],N=0,R=Q.size();R>N;N++){var s=Q.get(N);w.push(new Um(s.x,s.e||0,s.y))}n&&(xq(n)&&(n=n._as),n.length||(n=null));for(var F,f,S,t,E,P=[],o=0,y=0,$=n?n.length:R;$>y;y++)if(E=n?n[y]:0===y?1:2,1===E)P.push(S=[]),S.push(w[o++]);else if(2===E||5===E)if(t=2===E?w[o++]:S[0],u){var e=n?n[y+1]:$>y+1?2:I;if(2===e||5===e){var j=S[S.length-1],k=2===e?w[o]:S[0],d=(new Um).subVectors(j,t),Z=(new Um).subVectors(k,t),A=d.length(),D=Z.length();if(A&&D)if(u>A/2&&u>D/2)S.push(t);else for(d.multiplyScalar(m(u,A/2)/A).add(t),Z.multiplyScalar(m(u,D/2)/D).add(t),F=new Jb(d,t,Z).getPoints(g),f=0;g>=f;f++)S.push(F[f])}else S.push(t)}else S.push(t);else if(3===E)for(F=new Jb(S[S.length-1],w[o++],w[o++]).getPoints(g),f=1;g>=f;f++)S.push(F[f]);else if(4===E)for(F=new Bq(S[S.length-1],w[o++],w[o++],w[o++]).getPoints(g),f=1;g>=f;f++)S.push(F[f]);return P},Vq=function(z){for(var H,x,M=new Um,d=[],l=[],E=[],i=0,o=z.length;o>i;i++)H=z[i],x=z[i+1],x?M.subVectors(x,H):M.subVectors(H,z[i-1]),d.push(M.normalize().clone());var e,c,B,V,W=new Um,w=new Um,A=new dd,m=1e-4,s=Number.MAX_VALUE,R=d[0],g=l[0]=new Um,F=E[0]=new Um;for(c=f(R.x),B=f(R.y),V=f(R.z),s>=c&&(s=c,W.set(1,0,0)),s>=B&&(s=B,W.set(0,1,0)),s>=V&&W.set(0,0,1),w.crossVectors(R,W).normalize(),g.crossVectors(R,w),F.crossVectors(R,g),i=1;o>i;i++)l[i]=l[i-1].clone(),E[i]=E[i-1].clone(),w.crossVectors(d[i-1],d[i]),w.length()>m&&(w.normalize(),e=D(fc(d[i-1].dot(d[i]),-1,1)),l[i].applyMatrix4(A.makeRotationAxis(w,e))),E[i].crossVectors(d[i],l[i]);return{B:E,T:d,N:l}},Ki=function(){var $=function(u){for(var E=1;E<arguments.length;E++){var c=arguments[E];u.push(c.x,c.y,c.z)}},Q=function(M){for(var V=1;V<arguments.length;V++){var e=arguments[V].uv;M.push(e[0],e[1])}},j=function(Y,r,n,Z,e){var f=-Z*T(e),m=Z*W(e);return new Um(Y.x+f*n.x+m*r.x,Y.y+f*n.y+m*r.y,Y.z+f*n.z+m*r.z)},S=function(D,m,_,G,h,W,K,$){K=K||i;for(var g=[],O=K/h,k=0;h>=k;k++){var X=j(D,m,_,G,k*O+W);g.push(X),$!=I&&(X.uv=[$,k/h])}return g},M=function(L,f,v,U,Q,R,z,r,e){e=e||i;var B=f?L.top_vs:L.bottom_vs;if(B)for(var V=f?L.top_uv:L.bottom_uv,S=e/z,C=0;z>C;C++){var d,a;f?(d=C*S+r,a=(C+1)*S+r):(a=C*S+r,d=(C+1)*S+r),$(B,j(v,U,Q,R,d),j(v,U,Q,R,a),v),V&&V.push(.5-.5*T(d),.5-.5*W(d),.5-.5*T(a),.5-.5*W(a),.5,.5)}};return function(e,K,t,x,W,R,P,w,l){var B=K.length;if(B>1){var o,q,c,g,s,j,i,T=Vq(K),F=T.T,f=T.N,V=T.B;"flat"===w&&M(e,!0,K[0],V[0],f[0],x,W,R,P),"flat"===l&&M(e,!1,K[B-1],V[B-1],f[B-1],x,W,R,P);var b,H,N=[],y=h(W/2),d="round"===w,p="round"===l,J=K[0],X=F[0],Y=V[0],L=f[0],u=K[B-1],E=F[B-1],n=V[B-1],U=f[B-1];if(d){for(c=1;y>=c;c++)f.splice(0,0,L),V.splice(0,0,Y),F.splice(0,0,X),H=-c/y*x,K.splice(0,0,X.clone().multiplyScalar(H).add(J)),N[y-c]=v(x*x-H*H);B+=y}if(p){for(c=1;y>=c;c++)f.push(U),V.push(n),F.push(E),H=c/y*x,K.push(E.clone().multiplyScalar(H).add(u)),N[K.length-1]=v(x*x-H*H);B+=y}if(e.uv){var k=0,z=0,a=[];for(t&&(k=t),s=K[0],a[0]=0,c=1;B>c;c++)g=K[c],a[c]=s.distanceTo(g),s=g,t||(k+=a[c]);for(b=[],c=0;B>c;c++)z+=a[c],b[c]=k?z/k:0}for(c=0;B>c;c++){if(g=K[c],j=V[c],i=f[c],o=S(g,j,i,N[c]===Z?x:N[c],W,R,P,b?b[c]:I),q)for(var A=0;W>A;A++){var D=q[A],r=q[A+1]||q[0],C=o[A],O=o[A+1]||o[0];$(e.vs,r,D,C,C,O,r),e.uv&&Q(e.uv,r,D,C,C,O,r)}q=o}}}}();hj(C,{getLineLength:function(s){return s[s.length-1].length},getLineOffset:function(z,o){return ch(z,o)},getLineCacheInfo:function(v,C,G,A){return Rc(ih(v,C,G,A))}});var ro=o.Light=function(){lp(ro,this),this.s(Lc,R[Lc]),this.s(Ho,"sphere"),this.s3(20,20,20)};Sb("Light",Xp,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(R,$,s){ro.superClass.onStyleChanged.apply(this,arguments),R===Lc&&this.s("shape3d.color",s)}});var Jd=ns.Graph3dView=function(R,s){var y=this;y._attributes=s||C.graph3dViewAttributes,y._25I={},y._view=zg(1,y);var m=y._canvas=wo(y._view);m.addEventListener("webglcontextlost",function(W){W.preventDefault(),Te(y),y._26I&&y._doBufferGC(y._26I,!0),y._26I=I,y._1o.texture=I,y._35O=!0},q),m.addEventListener("webglcontextrestored",function(){y._35O=!1,y.iv()},q),y._batchIndexMap={},y._batchModelMap={},y._wireframeIndexMap={},y._wireframeModelMap={},y._wireframeIndexMapSwap={},y._wireframeModelMapSwap={},y._polylineIndexMap={},y._polylineIndexMap={},y._polylineIndexMapSwap={},y._polylineIndexMapSwap={},y._8O=[],y._7O=Vd(),y._6O=Vd(),y._1o=new Od(y),y._30O=new Ak(y),y._31O=new gf(y),y._32O=new Mb(y),y._raycaster=new Jn(y),y.vr=new Ah(y),y._33Q=!0,y._eye=Tm(C.graph3dViewEye),y._center=Tm(C.graph3dViewCenter),y._up=Tm(C.graph3dViewUp),y._lightChanged=!1,y._59O=[],y._spots=[],y._dirs=[],y._frameId=0,y.overlappingBox=new eg(y),y.dm(R?R:new Ve),y._coreInteractor=new Lb(this),y.setInteractors([new sl(y)])},xm={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Qg=0;_d("Graph3dView",V,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",$k,qh,"firstPersonMode",yd,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",xg,lr,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:C.graph3dViewEditHelperDisabled,_devicePixelRatio:Z,_boundaries:Z,_moveStep:C.graph3dViewMoveStep,_rotateStep:C.graph3dViewRotateStep,_pannable:C.graph3dViewPannable,_rotatable:C.graph3dViewRotatable,_walkable:C.graph3dViewWalkable,_resettable:C.graph3dViewResettable,_zoomable:C.graph3dViewZoomable,_firstPersonMode:C.graph3dViewFirstPersonMode,_mouseRoamable:C.graph3dViewMouseRoamable,_gridVisible:C.graph3dViewGridVisible,_gridSize:C.graph3dViewGridSize,_gridGap:C.graph3dViewGridGap,_gridColor:C.graph3dViewGridColor,_originAxisVisible:C.graph3dViewOriginAxisVisible,_centerAxisVisible:C.graph3dViewCenterAxisVisible,_axisXColor:C.graph3dViewAxisXColor,_axisYColor:C.graph3dViewAxisYColor,_axisZColor:C.graph3dViewAxisZColor,_ortho:C.graph3dViewOrtho,_orthoWidth:C.graph3dViewOrthoWidth,_fovy:C.graph3dViewFovy,_near:C.graph3dViewNear,_far:C.graph3dViewFar,_headlightColor:C.graph3dViewHeadlightColor,_headlightIntensity:C.graph3dViewHeadlightIntensity,_headlightRange:C.graph3dViewHeadlightRange,_headlightDisabled:C.graph3dViewHeadlightDisabled,_rectSelectable:C.graph3dViewRectSelectable,_rectSelectBackground:C.graph3dViewRectSelectBackground,_editSizeColor:C.graph3dViewEditSizeColor,_autoMakeVisible:qm,_fogDisabled:C.graph3dViewFogDisabled,_fogColor:C.graph3dViewFogColor,_fogNear:C.graph3dViewFogNear,_fogFar:C.graph3dViewFogFar,_dashDisabled:C.graph3dViewDashDisabled,_batchColorDisabled:C.graph3dViewBatchColorDisabled,_batchBlendDisabled:C.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:C.graph3dViewBatchBrightnessDisabled,setEye:function(C,s,v){1===arguments.length&&(s=C[1],v=C[2],C=C[0]);var K=this._eye;K[0]=C,K[1]=s,K[2]=v,this.fp(xg,I,K)},setCenter:function(Q,B,w){1===arguments.length&&(B=Q[1],w=Q[2],Q=Q[0]);var V=this._center;V[0]=Q,V[1]=B,V[2]=w,this.fp(lr,I,V)},setUp:function(i,T,V){1===arguments.length&&(T=i[1],V=i[2],i=i[0]);var L=this._up;L[0]=i,L[1]=T,L[2]=V,this.fp("up",I,L)},getDevicePixelRatio:function(){return this._devicePixelRatio||kp},isTransparentMask:function(U){return U.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getAspect:function(){var O=this,z=O._aspect;return z?z:(z=O.getWidth()/O.getHeight(),z||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(M){var y=this,g=y._dataModel,v=y._selectionModel;g!==M&&(g&&(g.ump(y.handleDataModelPropertyChange,y),g.umm(y.handleDataModelChange,y),g.umd(y.handleDataPropertyChange,y),v||g.sm().ums(y.handleSelectionChange,y)),y._dataModel=M,M.mp(y.handleDataModelPropertyChange,y),M.mm(y.handleDataModelChange,y),M.md(y.handleDataPropertyChange,y),v?v._21I(M):M.sm().ms(y.handleSelectionChange,y),y.invalidateAll(!0),y.invalidateLight(),y.fp(xp,g,M),y._canvas.style.background=M.getBackground()||"")},handleDataModelPropertyChange:function(Q){if("background"===Q.property){var U=this._canvas.style.background,m=Q.newValue||"";this._canvas.style.background=m,this.fp("canvasBackground",U,m)}},handleDataPropertyChange:function(o){var i=o.data;this.invalidateData(i),Ph(i)&&"s:light.type"===o.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(G){var L=this,d=G.property;L.iv(),L._18Q=I,"eye"===d?L._33Q=!0:"devicePixelRatio"===d?L._42(I,L.getDevicePixelRatio()):xm[d]&&Te(L)},_5O:function(X){var O=X._22Q();return O?new O(this,X):I},getData3dUI:function(b){var C=this._25I[b._id];return C===Z&&(C=this._5O(b),this._25I[b._id]=C),C},invalidateAll:function(R){var U=this;if(R){for(var w in U._25I){var t=U._25I[w];t&&t.dispose()}U._25I={},U.iv(),hd(U)}else hd(U),U.dm().each(function(F){U.invalidateData(F)})},invalidateSelection:function(){var X=this;X.sm().each(function(S){X.invalidateData(S)})},invalidateData:function(Q){var n=this,v=n.getData3dUI(Q);v&&(v.iv(),n.iv()),hd(n,Q)},getShape3dText:function(W){return W.getStyle("shape3d.text")||this.getLabel(W)},invalidateBatch:function(g){var e=this,c=e._batchModelMap,v=c[g],j=[],E={};if(v){v.ds.forEach(function(f){var c=e.getData3dUI(f);c&&c.iv(),delete e._batchIndexMap[f._id],j.push(f._id)}),delete c[g];for(var H,A,R,M,l,V,I,u,f,J=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],Q=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],w=0;w<J.length;w++){var T=e[J[w]],F=e[Q[w]];for(E={},u=0;u<j.length;u++){var o=F[j[u]];if(o){delete F[j[u]],f=o.batch,H=T[f];var h=o.begin,L=o.size,S=3*h,N=3*L,G=4*h,r=4*L;for(A=H.ds,R=H.vs,M=H.cs,l=H.ps,V=H.ls,I=o.index,H.invalidate=!0,A[I]=Z,I=S;S+N>I;I++)R[I]=Z;for(I=G;G+r>I;I++)M[I]=Z;for(I=G;G+r>I;I++)l[I]=Z;if(V)for(I=S;S+N>I;I++)V[I]=Z;E[f]=!0}}for(f in E){H=T[f],A=H.ds,R=H.vs,M=H.cs,l=H.ps,V=H.ls;var Y=[];for(I=0;I<A.length;I++)A[I]!==Z&&Y.push(A[I]);if(0===Y.length)delete T[f];else{for(H.ds=Y,Y=[],I=0;I<R.length;I++)R[I]!==Z&&Y.push(R[I]);for(H.vs=Y,Y=[],I=0;I<M.length;I++)M[I]!==Z&&Y.push(M[I]);for(H.cs=Y,Y=[],I=0;I<l.length;I++)l[I]!==Z&&Y.push(l[I]);if(H.ps=Y,V){for(Y=[],I=0;I<V.length;I++)V[I]!==Z&&Y.push(V[I]);H.ls=Y}}}}e.iv()}},handleDataModelChange:function(O){var B=this,c=O.kind,o=O.data;if("add"===c)B.invalidateData(o),eq(o)&&o.getEdgeGroup()&&o.getEdgeGroup().eachSiblingEdge(B.invalidateData,B),Ph(o)&&B.invalidateLight();else if(c===Wg){var J=o._id,i=B._25I[J];i&&(i.dispose(),delete B._25I[J],B.iv()),o===B._currentSubGraph&&B.setCurrentSubGraph(I),hd(B,o),Ph(o)&&B.invalidateLight()}else c===kf&&(B.invalidateAll(!0),B.setCurrentSubGraph(I),hd(B),B.invalidateLight())},toCanvas:function(G,M,Y){var F=this,R=F.getGL();if(F.validate(),G){var b=R.getParameter(R.COLOR_CLEAR_VALUE);Sn(R,G)}F._42(I,1);var P=F.getWidth(),t=F.getHeight(),$=new Uint8Array(4*P*t),S=wo(),E=S.getContext("2d");R.readPixels(0,0,P,t,R.RGBA,R.UNSIGNED_BYTE,$),sg(S,P,t,1);for(var v=E.getImageData(0,0,P,t),l=v.data,N=0;N<l.length;N+=4){var y=N/4,i=B(y/P),w=y-i*P;y=4*((t-1-i)*P+w),l[y]=$[N],l[y+1]=$[N+1],l[y+2]=$[N+2],l[y+3]=$[N+3]}if(E.putImageData(v,0,0),G&&Sn(R,b),F._42(I,F.getDevicePixelRatio()),M&&Y){var U=wo(),L=U.getContext("2d");return M=M,Y=Y,sg(U,M,Y,1),C.drawImage(L,S,0,0,M,Y),U}return S},toDataURL:function($,c){var _=this,P=_.getGL();if(_.validate(),$){var O=P.getParameter(P.COLOR_CLEAR_VALUE);Sn(P,$)}_._42(I,1);var q=_._canvas.toDataURL(c||"image/png",1);return $&&Sn(P,O),_._42(I,_.getDevicePixelRatio()),q},getGL:function(){var i=this,A=i._26I,B=i._prg;if(!A)try{i._2O={},A=i._26I=i._canvas.getContext("webgl",i._attributes)||i._canvas.getContext("experimental-webgl",i._attributes),A._emptyTexture=Bj(A),A._emptyBlendTexture=Bj(A),A._bufPool={},A._id=++Qg,i._buffer={vs:hn(A),ns:hn(A),is:hn(A),uv:hn(A),batchColor:hn(A),batchBlend:hn(A),batchBrightness:hn(A),lineDistance:hn(A)},i._1O=Lp(A);var c=i._cube={vs:hn(A),ns:hn(A),is:hn(A),uv:hn(A)};Kq(A,c.vs,Wb),Kq(A,c.ns,Mi),Kq(A,c.uv,Ug),xl(A,c.is,xk)}catch(V){}if(A&&!B){if(B=i._prg=A.createProgram(),!B)return I;var Q=i._dirs.length,x=i._spots.length,e=i._59O.length,y=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];Q&&y.push("uDirColor","uDirDirection"),x&&y.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),e&&y.push("uPointColor","uPointRange","uPointPosition"),Sn(A,[0,0,0,0]),A.clearDepth(1),A.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL),A.enable(A.BLEND),A.blendFuncSeparate(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA),Ul||(Oi=ao(Oi.substring(0,Oi.indexOf("^#"))),md=ao(md),Ul=!0);var C=["#define MAX_DIR "+Q,"#define MAX_SPOT "+x,"#define MAX_POINT "+e,i._fogDisabled?"":"#define FOG",i._dashDisabled?"":"#define DASH",i._batchColorDisabled?"":"#define BATCHCOLOR",i._batchBlendDisabled?"":"#define BATCHBLEND",i._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),q=cs(A,B,A.VERTEX_SHADER,Oi.replace("PREFIX",C)),w=cs(A,B,A.FRAGMENT_SHADER,md.replace("PREFIX",C));$?y.push("aPosition"):(B.aPosition=0,A.bindAttribLocation(B,0,"aPosition")),A.linkProgram(B),y.forEach(function(m){B[m]=/^u/.test(m)?A.getUniformLocation(B,m):A.getAttribLocation(B,m)}),A.useProgram(B),A.deleteShader(q),A.deleteShader(w)}return A},getBrightness:function(Q){var J=Q.s("brightness"),A=this.isSelected(Q)?Q.s("select.brightness"):I;return J==I?A:A==I?J:J*A},getWireframe:function($){var Q=$.s("wf.visible"),k=$.s("wf.width");return Q===!0||k>0&&"selected"===Q&&this.isSelected($)?{color:$.s("wf.color"),width:k,"short":$.s("wf.short"),mat:$.s("wf.mat")}:void 0},_transformPointToViewSpace:function(t){var q=[t[0],t[1],t[2]];return $f(q,this._viewMatrix),q},_transformDirectionToViewSpace:function(p,f){var Q=[p[0],p[1],p[2]];$f(Q,this._viewMatrix);var e=f?[f[0],f[1],f[2]]:[0,0,0];$f(e,this._viewMatrix);var t=e[0]-Q[0],c=e[1]-Q[1],y=e[2]-Q[2],M=Math.sqrt(t*t+c*c+y*y);
return M?[t/M,c/M,y/M]:[t,c,y]},getWireframeGeometry:function(n){return n.s("wf.geometry")?{color:n.s("wf.color"),width:n.s("wf.width"),mat:n.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(Z){return Z.s("body.color")},getMat:function(u){return u.getMat?u.getMat():u.s("mat")},getFaceMat:function(W,p){return W.getFaceMat?W.getFaceMat(p):W.s(p+".mat")},getFaceBlend:function(B,m){return B.s(m+".blend")||B.s("all.blend")},getFaceColor:function(D,u){return D.s(u+".color")||D.s("all.color")},getFaceImage:function(w,b){return w.s(b+".image")||w.s("all.image")},getFaceBlendImage:function($,P){return $.s(P+".blend.image")||$.s("all.blend.image")},getFaceDiscardSelectable:function(W,V){var g=W.s(V+".discard.selectable");return g==I?W.s("all.discard.selectable"):g},getFaceUv:function(x,t){return x.s(t+".uv")||x.s("all.uv")},getFaceUvOffset:function(I,g){return I.s(g+".uv.offset")||I.s("all.uv.offset")},getFaceUvScale:function(g,W){return g.s(W+".uv.scale")||g.s("all.uv.scale")},getFaceLight:function(V,Q){var m=V.s(Q+".light");return m==I?V.s("all.light"):m},getFaceVisible:function(c,L){var O=c.s(L+".visible");return O==I?c.s("all.visible"):O},getFaceOpacity:function(k,t){var f=k.s(t+".opacity");return f==I?k.s("all.opacity"):f},getFaceTransparent:function(J,C){var o=J.s(C+".transparent");return o==I?J.s("all.transparent"):o},getFaceReverseColor:function(L,o){return L.s(o+".reverse.color")||L.s("all.reverse.color")},getFaceReverseFlip:function(T,e){var X=T.s(e+".reverse.flip");return X==I?T.s("all.reverse.flip"):X},getFaceReverseCull:function(_,e){var X=_.s(e+".reverse.cull");return X==I?_.s("all.reverse.cull"):X},getTextureMap:function(){return this._2O},deleteTexture:function(f){var h=this,n=h._2O[f];n&&(delete h._2O[f],h.getGL().deleteTexture(n))},invalidateShape3dCachedImage:function(m){var n=this.getData3dUI(m);n.invalidateCachedTexture(this.getGL())},isInteractive:function(b){return b.s("interactive")},getTexture:function(t,x){if(!t)return I;var R=this,V=R.getGL(),b=R._2O[t];if(!b){var N=wc(t);if(N)if(N.tagName){if(N.dynamic)return Lp(V,N,R._1O);b=R._2O[t]=Lp(V,N)}else{var e,G=x&&x.s("shape3d.image.cache")&&!R.isInteractive(x),m=R.vr.isPresenting();if(m&&(x._textureUpdateFrame===V._renderInfo.frame?G=!0:x._textureUpdateFrame=V._renderInfo.frame),G&&(e=R.getData3dUI(x),b=e.getCachedTexture()),!b){var f=x&&x.s("shape3d.fixSizeOnScreen"),j=f?V.NEAREST:V.LINEAR;if(!f&&x&&x.s("shape3d.vector.dynamic")&&(e||(e=R.getData3dUI(x)),f=e.getVectorDynamicSize())){var $=R.getDevicePixelRatio();f[0]*=$,f[1]*=$}var P=x&&x.s("shape3d.texture.scale")||1,q=f&&f[0]>0?f[0]:P*Rn(N,x),Z=f&&f[1]>0?f[1]:P*si(N,x);if(q>=1&&Z>=1){var h=_j(q,Z);if(!e&&x&&(e=R.getData3dUI(x)),e&&e.interactiveInfo){var v=e.interactiveInfo[t]={};h.interactiveInfo=v.bodyInfo={compInfos:[],matrix:new Kj,rect:{x:0,y:0,width:q,height:Z}}}gl(h,N,0,0,q,Z,x,R),h.interactiveInfo&&(h.interactiveInfo=null),h.restore(),(G||m)&&Qb(N,x)?(b=Lp(V,il,null,j),e.setCachedTexture(b),il=null):b=Lp(V,il,R._1O,j)}}}}return b},redraw:function(){this.iv()},validateImpl:function(){var h=this;if(h._lightChanged){h._lightChanged=!1;var _=[],I=[],a=[];h.dm().each(function(y){if(Ph(y)){var e=y.s("light.type");e===mi?_.push(y):e===gb?I.push(y):e===wn&&a.push(y)}}),(_.length!==h._59O.length||I.length!==h._spots.length||a.length!==h._dirs.length)&&Te(h),h._59O=_,h._spots=I,h._dirs=a}h._42(),h._1o.iv()},getRenderInfo:function(){var Y=this.getGL();return Y?Y._renderInfo:void 0},showDebugTip:function(){var x=this,O=x._debugDiv;if(!O){O=x._debugDiv=z.createElement("div"),O.style.position="absolute",O.style.overflow="hidden",O.style.backgroundColor="white",O.style.color="black";var L=x.getView();x._79O?L.insertBefore(O,x._79O):L.appendChild(O),x._debugTipTimerId=setInterval(function(){var m=x.getRenderInfo();if(m){var E=x.getGL()._validBufCount||0,D="Draw Calls: "+m.calls+"<br/>"+"Vertices: "+m.vertices+"<br/>"+"Faces: "+m.faces+"<br/>"+"Lines: "+m.lines+"<br/>"+"Buffer Count: "+E;O.innerHTML=D}},10)}},hideDebugTip:function(){var e=this,C=e._debugDiv;C&&(delete e._debugDiv,cancelAnimationFrame(e._debugTipTimerId),delete e._debugTipTimerId,e.getView().removeChild(C))},_42:function(D,j){var h=this;if(!h._35O&&(!Bk||Re(Bk))){var l,m;D&&(D instanceof Xp?m=D:l=D);var t=h._canvas,X=h.getGL(),z=h._prg;if(X){var $=h.getWidth(),B=h.getHeight();j?D||sg(t,$,B,j):(j=h.getDevicePixelRatio(),D||$===t.clientWidth&&B===t.clientHeight||sg(t,$,B,j)),X.clear(X.COLOR_BUFFER_BIT),X._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:D?h._frameId:++h._frameId};var r=function(){if(h.overlappingBox.clear(),h._81O=I,X.clear(X.DEPTH_BUFFER_BIT),Sc(X,z.uBrightness,1),Sc(X,z.uOpacity,1),Sc(X,z.uPartOpacity,1),X._picking=!!D,Sc(X,z.uPick,!!D),Sc(X,z.uTexture,!1),Sc(X,z.uBlendTexture,!1),Sc(X,z.uAlphaTest,R.alphaTest),Sc(X,z.uTransparent,!1),Sc(X,z.uFix,!1),Sc(X,z.uBatchColor,!1),Sc(X,z.uBatchBlend,!1),Sc(X,z.uBatchBrightness,!1),Sc(X,z.uPMatrix,h._projectMatrix=mg(h)),Sc(X,z.uViewMatrix,Sj(h,h._7O)),h._viewMatrix=dc(h._7O),D||(Pk(h,X,z),h._fogDisabled||(Sc(X,z.uFogColor,h._fogColor),Sc(X,z.uFogNear,h._fogNear),Sc(X,z.uFogFar,h._fogFar))),Qp(X,z.aPosition),Qp(X,z.aNormal),Zd(X,z.aUv),Zd(X,z.aBatchColor),Zd(X,z.aBatchBlend),Zd(X,z.aBatchBrightness),Zd(X,z.aLineDistance),m){var C=X.getParameter(X.COLOR_CLEAR_VALUE);X.clearColor(0,0,0,0),X.disable(X.BLEND),Zd(X,z.aNormal),Kq(X,h._cube.vs,I,z.aPosition),xl(X,h._cube.is),cn(m,h,_h,0),cn(m,h,Zp,6),cn(m,h,De,12),cn(m,h,_m,18),cn(m,h,Rd,24),cn(m,h,Yf,30),Qp(X,z.aNormal),Sn(X,C)}else if(l){l.value=2;var C=X.getParameter(X.COLOR_CLEAR_VALUE);X.clearColor(0,0,0,0),X.disable(X.BLEND),h._95I(X,z,l),If(h,l),Ud(h,h._polylineModelMap,l),Ud(h,h._wireframeModelMap,l),Sc(X,z.uTransparent,!0),h._95I(X,z,l,!0),If(h,l,!0),Ud(h,h._polylineModelMap,l,!0),Ud(h,h._wireframeModelMap,l,!0),Sc(X,z.uTransparent,!1),X.clear(X.DEPTH_BUFFER_BIT),h._swapLineMap(),h._95I(X,z,l,!1,!0),Ud(h,h._polylineModelMap,l),Ud(h,h._wireframeModelMap,l),h._swapLineMap(),X.disable(X.DEPTH_TEST),h._30O._42(X,z,l),X.enable(X.DEPTH_TEST),Sn(X,C)}else X.disable(X.BLEND),h.drawSky(X,z),h._31O._42(X,z),h._95I(X,z),If(h),Ud(h,h._polylineModelMap),Ud(h,h._wireframeModelMap),X.enable(X.BLEND),Sc(X,z.uTransparent,!0),X.depthMask(!1),h._95I(X,z,I,!0),If(h,I,!0),Ud(h,h._polylineModelMap,I,!0),Ud(h,h._wireframeModelMap,I,!0),X.depthMask(!0),Sc(X,z.uTransparent,!1),X.clear(X.DEPTH_BUFFER_BIT),h._swapLineMap(),h._95I(X,z,I,!1,!0),Ud(h,h._polylineModelMap),Ud(h,h._wireframeModelMap),h._swapLineMap(),X.disable(X.DEPTH_TEST),X.disable(X.BLEND),h._32O._42(X,z),h._30O._42(X,z),X.enable(X.DEPTH_TEST);Kq(X,I),xl(X,I)},U=!1,v=$*j,O=B*j,C=h.vr;C.enable&&C._42(X,v,O,r)&&(U=!0);var Y=h.envRenderer;Y&&Y.enable&&Y._42(X,v,O,r)&&(U=!0),U||(X.viewport(0,0,$*j,B*j),r()),h._33Q=!1,h._doBufferGC(X)}}},setBufferGCInterval:function(l){this._bufferGCInterval=l},_doBufferGC:function(W,g){var Z,h,p=W._bufPool,Y=0,P=0,V=W._renderInfo.frame,n=this._bufferGCInterval||10;for(Z in p)Y++,h=p[Z],h&&(g||V-h._fid>n?(W.deleteBuffer(h._buf),h._buf=null,p[Z]=null):P++);if(Y/2>P&&Y>128){var s={};for(Z in p)p[Z]&&(s[Z]=p[Z]);W._bufPool=s}W._validBufCount=P},_swapLineMap:function(){var A=this;J=A._polylineModelMap,A._polylineModelMap=A._polylineModelMapSwap,A._polylineModelMapSwap=J,J=A._wireframeModelMap,A._wireframeModelMap=A._wireframeModelMapSwap,A._wireframeModelMapSwap=J,J=A._polylineIndexMap,A._polylineIndexMap=A._polylineIndexMapSwap,A._polylineIndexMapSwap=J,J=A._wireframeIndexMap,A._wireframeIndexMap=A._wireframeIndexMapSwap,A._wireframeIndexMapSwap=J},_updateSkyBoxPosition:function(E){if(this._skyBox&&E&&"eye"===E.property){var G=E.newValue;this._skyBox.p3(G[0],G[1],G[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(d){var f=this._skyBox;f&&this._skyBoxStyleMap&&(f.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null),this._skyBox=d,this.ump(this._updateSkyBoxPosition,this),d&&(d.dm()&&d.dm().remove(d),this._skyBoxStyleMap=o.Default.clone(d.getStyleMap()),d.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition({property:"eye",newValue:this.getEye()})),this.fp("skyBox",f,d)},drawSky:function(A,m,K){var r=this,e=r._skyBox;if(e){var J=r._headlightIntensity,V=fh(r._headlightColor),m=r._prg;1!==J&&(V=[V[0]*J,V[1]*J,V[2]*J]),Sc(A,m.uHeadlightColor,[V[0],V[1],V[2],1]);var M=r.getData3dUI(e);M&&M._42(A,m,K,function(){return!0}),A.clear(A.DEPTH_BUFFER_BIT),Sc(A,m.uHeadlightColor,[V[0],V[1],V[2],r._headlightDisabled?1:0])}},_95I:function(g,x,Y,f,N){function T(L){if(!!L.s("shape3d.alwaysOnTop")==!!N&&B.isVisible(L)&&(!k||P)){if(!Y&&B.isTransparentMask(L))return;var w=B.getData3dUI(L);w&&w._42(g,x,Y,j)}}var B=this,j=function(Y){return f?Y:!Y};B.sky&&g.clear(g.DEPTH_BUFFER_BIT),B.dm().each(T)},getLogicalPoint:function(N){return $r(N,this._canvas)},isRectOverlapping:function(A){var V=this.getData3dUI(A);return V._rectOverlapping},getHitFaceInfo:function(W){W.target&&(W=this.lp(W));var s=this.getDataInfoAt(W);if(s){var t=this._1o.face(s.data,kl(W.x,W.y));if(t)return{data:s.data,face:t}}return I},unproject:function(k,N){var e=this,d=e.getWidth(),q=e.getHeight(),j=k.target?e.lp(k):k,U=j.x-d/2,J=j.y-q/2,n=2*(U/d),Y=2*(-1*J/q);N=N||0;var C=Vd(),A=mg(e),w=Sj(e);vl(C,A,w),lq(C);var v=Go([n,Y,N,1],C);return[v[0]/v[3],v[1]/v[3],v[2]/v[3]]},getDataAt:function(U){var m=this.getDataInfoAt(U);return m?m.data:I},getDataInfoAt:function(h,l){return h.target&&(h=this.lp(h)),this._1o.get(kl(h.x,h.y,l),!0)},getDatasInRect:function(H){return this._1o.get(H)},setEditable:function(Q){var B=this,a=B._editable;B._editable=Q,this.fp(ur,a,Q)},isEditable:function(N){var k=this;return k._editable?Cd(N)?N.s("3d.editable")?k._editableFunc?k._editableFunc(N):!0:!1:!1:!1},isSelectable:function(M){return M.s("3d.selectable")&&this.sm().isSelectable(M)},isMovable:function(b){var V=this;return eq(b)&&b.getStyle(pj)!==Rl?!1:b.s("3d.movable")?V._movableFunc?V._movableFunc(b):!0:!1},isSizeEditable:function(O){return Cd(O)?this._sizeEditableFunc?this._sizeEditableFunc(O):!0:!1},isRotationEditable:function(w){return Cd(w)&&w.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(w):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(k){this.setZoom(vf,k)},zoomOut:function(R){this.setZoom(1/vf,R)},setZoom:function(P,r){if(1!==P){var O=this;if(O._ortho)return O.setOrthoZoom(P,r),void 0;O._14o&&O._14o.stop(!0);var t=1/P,H=O._eye,Y=O._center,C=Y[0]+(H[0]-Y[0])*t-H[0],p=Y[1]+(H[1]-Y[1])*t-H[1],W=Y[2]+(H[2]-Y[2])*t-H[2];if(!(cd(H,Y)<O._moveStep&&1>t)){if(r=Ld(r)){var G=Tm(H);return r.action=function(Y){O.fi({kind:O._zooming?"betweenZoom":"beginZoom"}),O._zooming=1,H[0]=G[0]+C*Y,H[1]=G[1]+p*Y,H[2]=G[2]+W*Y,O.fp(xg,I,H)},r._37o=function(){delete O._14o,delete O._zooming,O.fi({kind:"endZoom"}),O.onZoomEnded()},O._14o=Wo(r)}H[0]+=C,H[1]+=p,H[2]+=W,O.fp(xg,I,H)}}},setOrthoZoom:function(G,b){if(1!==G){var g=this;g._14o&&g._14o.stop(!0);var z=g._orthoWidth,Q=z/G-z;if(!(z<g._moveStep&&G>1))return(b=Ld(b))?(b.action=function(I){g.fi({kind:g._zooming?"betweenZoom":"beginZoom"}),g._zooming=1,g.setOrthoWidth(z+Q*I)},b._37o=function(){delete g._14o,delete g._zooming,g.fi({kind:"endZoom"}),g.onZoomEnded()},g._14o=Wo(b)):(g.setOrthoWidth(z/G),void 0)}},getPositionInfo:function(W){var q=this,o=q._eye,L=q._center,O=q.getAspect(),b=W?nf(uq(L,o,!0),uq(W,o)):cd(o,L);if(q._ortho){var E=q._orthoWidth;return{length:b,height:E/O,width:E}}var T=2*e(q._fovy/2)*b;return{length:b,height:T,width:T*O}},getCenterInfo:function(){var g=this;return g._81O||(g._81O=g.getPositionInfo()),Tm(g._81O)},rotate:function(S,x,Z,g){var t=this;if(S||x){g==I&&(g=t._firstPersonMode),t._88O&&t._88O.stop(!0);var J=t._center,p=t._eye,k=t.getCenterInfo().length,U=g?J:p,e=g?p:J,d=uq(U,e),P=Y(d[0],d[2]),f=Y(v(d[0]*d[0]+d[2]*d[2]),d[1]),m=g?lr:xg;return g&&(x=-x),(Z=Ld(Z))?(Z.action=function(Z){t.fi({kind:t._rotating?"betweenRotate":"beginRotate"}),t._rotating=1;var F=P+S*Z,w=f+x*Z;w=Ur(w),d[0]=k*W(w)*W(F),d[1]=k*T(w),d[2]=k*W(w)*T(F),U[0]=e[0]+d[0],U[1]=e[1]+d[1],U[2]=e[2]+d[2],t.fp(m,I,U)},Z._37o=function(){delete t._88O,delete t._rotating,t.fi({kind:"endRotate"}),t.onRotateEnded()},t._88O=Wo(Z)):(P+=S,f+=x,f=Ur(f),d[0]=k*W(f)*W(P),d[1]=k*T(f),d[2]=k*W(f)*T(P),U[0]=e[0]+d[0],U[1]=e[1]+d[1],U[2]=e[2]+d[2],t.fp(m,I,U),void 0)}},pan:function(Z,g,B,e){if(Z||g){var H=this;e==I&&(e=H._firstPersonMode),H._89O&&H._89O.stop(!0);var x=Sj(H),N=[x[0]*Z,x[4]*Z,x[8]*Z],u=[x[1]*g,x[5]*g,x[9]*g],l=N[0]+u[0],T=N[1]+u[1],D=N[2]+u[2],o=H._center,R=H._eye;if(e){var p=Xe(H.getBoundaries(),R[0],R[2],R[0]+l,R[2]+D,v(l*l+D*D));l=p[0],D=p[1]}if(B=Ld(B)){var t=Tm(R),h=Tm(o);return B.action=function(f){H.fi({kind:H._panning?"betweenPan":"beginPan"}),H._panning=1,o[0]=h[0]+l*f,o[1]=h[1]+T*f,o[2]=h[2]+D*f,R[0]=t[0]+l*f,R[1]=t[1]+T*f,R[2]=t[2]+D*f,H.fp(xg,I,R),H.fp(lr,I,o)},B._37o=function(){delete H._89O,delete H._panning,H.fi({kind:"endPan"}),H.onPanEnded()},H._89O=Wo(B)}o[0]+=l,o[1]+=T,o[2]+=D,R[0]+=l,R[1]+=T,R[2]+=D,H.fp(xg,I,R),H.fp(lr,I,o)}},walk:function(S,V,C){if(S){var R=this;C==I&&(C=R._firstPersonMode),R._90O&&R._90O.stop(!0);var $=R._center,A=R._eye,E=uq($,A,!0);if(C){var o=Xe(R.getBoundaries(),A[0],A[2],A[0]+E[0]*S,A[2]+E[2]*S,f(S));if(S=cd(o),!S)return;E=[o[0]/S,0,o[1]/S]}if(V=Ld(V)){var J=Tm(A),p=Tm($);return V.action=function(n){R.fi({kind:R._walking?"betweenWalk":"beginWalk"}),R._walking=1;var Y=S*n;A[0]=J[0]+E[0]*Y,A[1]=J[1]+E[1]*Y,A[2]=J[2]+E[2]*Y,$[0]=p[0]+E[0]*Y,$[1]=p[1]+E[1]*Y,$[2]=p[2]+E[2]*Y,R.fp(xg,I,A),R.fp(lr,I,$)},V._37o=function(){delete R._90O,delete R._walking,R.fi({kind:"endWalk"}),R.onWalkEnded()},R._90O=Wo(V)}A[0]+=E[0]*S,A[1]+=E[1]*S,A[2]+=E[2]*S,$[0]+=E[0]*S,$[1]+=E[1]*S,$[2]+=E[2]*S,R.fp(xg,I,A),R.fp(lr,I,$)}},handleScroll:function(W,z){W.preventDefault();var P=this,y=P._moveStep;P.isFirstPersonMode()?P.isPannable()&&P.pan(0,z>0?y:-y):P.isZoomable()&&P.setZoom(0>z?1/Lk:Lk)},handlePinch:function(r,D){this.isZoomable()&&this.setZoom(D>r?1/fg:fg)},reset:function(){this.setCenter(C.graph3dViewCenter),this.setEye(C.graph3dViewEye),this.setUp(C.graph3dViewUp)},moveSelection:function(J,i,v){var s=this;s.dm().beginTransaction(),Vh(this.sm().toSelection(this.isMovable,this),J,i,v),s.dm().endTransaction()},getMoveMode:function(s,m){var w=m.s("3d.move.mode");if(w)return w;var H="88",V="89",$="90";return _g(s)||Tj[H]&&Tj[V]&&Tj[$]?"xyz":Tj[H]&&Tj[V]?"xy":Tj[H]&&Tj[$]?"xz":Tj[V]&&Tj[$]?"yz":Tj[H]?"x":Tj[V]?"y":Tj[$]?"z":"xz"},handleTick:function(){var c=this,v=!1,l=c._moveStep,L=l,h=!1,k=!0,C=c._rotateStep*(k?-1:1);if(c.isWalkable()||(L=0),c.isPannable()||(l=0),c.isRotatable()||(C=0),c._32Q){var m=(Xc()-c._32Q)/50;L*=m,l*=m,C*=m}c._31Q&&(Og(c._31Q),delete c._31Q,delete c._32Q),ym()&&(v=!0,c.pan(-l,0,h,k)),vc()&&(v=!0,c.pan(l,0,h,k)),pq()&&(v=!0,_g()?c.pan(0,l,h,k):c.walk(L,h,k)),xd()&&(v=!0,_g()?c.pan(0,-l,h,k):c.walk(-L,h,k)),Fp()&&(v=!0,c.rotate(-C,0,h,k)),vd()&&(v=!0,c.rotate(C,0,h,k)),sh()&&(v=!0,c.rotate(0,-C/2,h,k)),qc()&&(v=!0,c.rotate(0,C/2,h,k)),v&&(c._32Q=Xc(),c._31Q=jr(c.handleTick,c))},handleKeyDown:function(Z){var t=this;!Hg(Z)&&Un[Z.keyCode]?t.handleTick():Kn(Z)?t.selectAll():as(Z)?t.handleDelete(Z):ci(Z)&&this.isResettable()&&t.reset()},checkDoubleClickOnNote:function(v,X,x){var z=this;if(x===Ub){if(X.s("note.toggleable"))return X.s(Je,!X.s(Je)),z.fi({kind:"toggleNote",event:v,data:X,part:x}),!0}else if(x===tp&&X.s("note2.toggleable"))return X.s(Dc,!X.s(Dc)),z.fi({kind:"toggleNote2",event:v,data:X,part:x}),!0;return!1},checkDoubleClickOnRotation:function(H,W,m){return m===Cn?(W.setRotationX(0),!0):m===Fr?(W.setRotationY(0),!0):m===bg?(W.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(h){var G=this;if(G.isOrtho())return G.getWidth()/G.getOrthoWidth();var U=G.getCenter(),Z=G.getHeight(),q=G.getEye(),A=[U[0]-q[0],U[1]-q[1],U[2]-q[2]],H=[h[0]-q[0],h[1]-q[1],h[2]-q[2]],J=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]),X=1/Math.tan(G.getFovy()/2);return Z*J*X/(H[0]*A[0]+H[1]*A[1]+H[2]*A[2])},inViewSpace:function(r){var K,q=this,g=q._transformPointToViewSpace(r),k=q.getAspect(),E=q.getNear(),b=q.getFar();return-g[2]<E||-g[2]>b?!1:q.isOrtho()?(K=q.getOrthoWidth()/2,Math.abs(g[0])<=K&&Math.abs(g[1]*k)<=K):(K=Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*Math.tan(q.getFovy()/2),Math.abs(g[1]<=K)&&Math.abs(g[0])<=K*k)},toViewPosition:function(c){var H=this,q=H.getWidth()/2,Y=H.getHeight()/2,r=H._18Q;return r&&r._wh===q/Y||(r=mg(H),H._18Q=vl(r,r,Sj(H)),H._18Q._wh=q/Y),c=Go([c[0],c[1],c[2],1],r),{x:q+q*c[0]/c[3],y:Y-Y*c[1]/c[3]}},getHitPosition:function(C,M,b){var m=this,q=m.getWidth(),u=m.getHeight(),X=C.target?m.lp(C):C,l=X.x-q/2,H=X.y-u/2,R=m.getCenterInfo(),v=Sj(m);M=M?M:[0,0,0],b=b?b:[0,1,0],l=l/q*R.width,H=-1*H/u*R.height;var x=[v[0]*l,v[4]*l,v[8]*l],z=[v[1]*H,v[5]*H,v[9]*H],Y=[x[0]+z[0],x[1]+z[1],x[2]+z[2]],a=m.getCenter(),e=ik(m,M,b,[Y[0]+a[0],Y[1]+a[1],Y[2]+a[2]]);return e?e:[0,0,0]},intersectObject:function(F,m){return this._raycaster.intersectObject(F,m)},intersectObjects:function(_,j,q){return this._raycaster.intersectObjects(_,j,q)},getLineLength:function(m){this.validate();var X=this.getData3dUI(m);if(X&&X.getCache){var w=X.getCache();if(w)return w[w.length-1].length}return 0},getLineOffset:function(d,z){var y=this.getData3dUI(d);if(y&&y.getCache){var X=y.getCache();if(X)return ch(X,z)}return I},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function P(b,Y,R){if(R instanceof o.Node){U.fromArray(Vl(R,Y.getMat(R)));var v=R.getAnchor3d();b.push((new be).set(0-v.x,0-v.y,0-v.z).applyMatrix4(U)),b.push((new be).set(0-v.x,0-v.y,1-v.z).applyMatrix4(U)),b.push((new be).set(0-v.x,1-v.y,0-v.z).applyMatrix4(U)),b.push((new be).set(0-v.x,1-v.y,1-v.z).applyMatrix4(U)),b.push((new be).set(1-v.x,0-v.y,0-v.z).applyMatrix4(U)),b.push((new be).set(1-v.x,0-v.y,1-v.z).applyMatrix4(U)),b.push((new be).set(1-v.x,1-v.y,0-v.z).applyMatrix4(U)),b.push((new be).set(1-v.x,1-v.y,1-v.z).applyMatrix4(U))}}var I=new be,W=new be,N=new be,t=new be,U=new mj,h=new o.Math.Quaternion,e=new Zh;return function(m,U,v){var Y=this;if(v!==Z)U={animation:U,ratio:v};else{var c=typeof U;("boolean"===c||"object"===c&&U.duration)&&(U={animation:U})}U=U||{},I.fromArray(Y.getEye()),W.fromArray(Y.getCenter());var D,R,u=[],x=U.center,V=U.distance===Z;if(x&&N.fromArray(x),m instanceof o.Node)x||N.fromArray(m.p3()),V&&(P(u,Y,m),D=u.length);else{if(m||(m=Y.dm().getDatas()),!m.length)return;if((V||!x)&&(u=[],m.forEach(function(V){P(u,Y,V)}),D=u.length),!D)return;if(!x){for(N.set(0,0,0),R=0;D>R;R++)N.add(u[R]);N.multiplyScalar(1/D)}}if(Y.setCenter(N.x,N.y,N.z),t.subVectors(I,W),U.direction||U.worldDirection){!U.worldDirection&&m instanceof o.Node?h.setFromEuler(e.set(m.r3(),m.getRotationMode(),!0)):h.set(0,0,0,1);var S=t.length();t.fromArray(U.worldDirection||U.direction).applyQuaternion(h).setLength(S)}if(V){for(var y,f,E,A,M,X=Y.getNear(),T=10,v=U.ratio||.8;T--;){for(Y._eye[0]=t.x+N.x,Y._eye[1]=t.y+N.y,Y._eye[2]=t.z+N.z,y=mg(Y),vl(y,y,Sj(Y)),A=!0,M=-1/0,R=0;D>R;R++){if(E=u[R],f=Go([E.x,E.y,E.z,1],y),f[3]<X&&T){t.multiplyScalar(2),A=!1;break}M=Math.max(M,Math.max(Math.abs(f[0]),Math.abs(f[1]))/v-f[3])}if(A)break}t.setLength(M+t.length()).add(N)}else t.setLength(U.distance).add(N);Y._flyAnim&&Y._flyAnim.stop(!0);var g=Ld(U.animation);if(g){Y.setEye(I.x,I.y,I.z),Y.setCenter(W.x,W.y,W.z);var j=(new be).subVectors(t,I),l=(new be).subVectors(N,W),O=new be,b=new be;return g.action=function(J){O.copy(I).addScaledVector(j,J),b.copy(W).addScaledVector(l,J),Y.setCenter(b.x,b.y,b.z),Y.setEye(O.x,O.y,O.z)},g._37o=function(){delete Y._flyAnim},{lastEye:I,lastCenter:W,eye:t,center:N,animation:Y._flyAnim=Wo(g)}}return Y.setEye(t.x,t.y,t.z),{lastEye:I,lastCenter:W,eye:t,center:N}}}(),getBoundingBox:function(){function r(V,u,D){y.fromArray(Vl(D,u.getMat(D)));var Z=D.getAnchor3d();V.push((new be).set(0-Z.x,0-Z.y,0-Z.z).applyMatrix4(y)),V.push((new be).set(0-Z.x,0-Z.y,1-Z.z).applyMatrix4(y)),V.push((new be).set(0-Z.x,1-Z.y,0-Z.z).applyMatrix4(y)),V.push((new be).set(0-Z.x,1-Z.y,1-Z.z).applyMatrix4(y)),V.push((new be).set(1-Z.x,0-Z.y,0-Z.z).applyMatrix4(y)),V.push((new be).set(1-Z.x,0-Z.y,1-Z.z).applyMatrix4(y)),V.push((new be).set(1-Z.x,1-Z.y,0-Z.z).applyMatrix4(y)),V.push((new be).set(1-Z.x,1-Z.y,1-Z.z).applyMatrix4(y))}var y=new mj;return function(y){if(y=y||this.sm().getSelection(),y instanceof o.Node&&(y=[y]),0===y.length)return I;var P=[];y.forEach(function(E){r(P,this,E)},this);var B=[1/0,1/0,1/0],H=[-1/0,-1/0,-1/0];return P.forEach(function(h){B[0]=Math.min(h.x,B[0]),B[1]=Math.min(h.y,B[1]),B[2]=Math.min(h.z,B[2]),H[0]=Math.max(h.x,H[0]),H[1]=Math.max(h.y,H[1]),H[2]=Math.max(h.z,H[2])}),{min:B,max:H}}}()}),ns.RenderEnv=function(S){this.gv=S,this.enable=!1},V.defineProperties(ns.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(R){this._debugOn=R,this.capture&&this.capture()}}}),V.assign(ns.RenderEnv.prototype,{renderEnvToCube:function(n,F,b,V){var X=this,K=X.gv;if(!n||!F||!b)return X.enable=!1,X._42=null,void 0;X.enable=!0;var o=Math.floor(V/n*F),p=K.getGL(),j=X._renderTargets;j?j.length<b&&(j=X._renderTargets=j.concat(new Array(b-j.length))):j=X._renderTargets=new Array(b);for(var B=0;b>B;B++)j[B]?j[B].setSize(p,V,o):j[B]=new ns.RenderTarget(K,p,V,o);var g=!1;X.capture=function(){g=!0,K._42(),g=!1};var $=new be,d=new be,y=new be,G=new be,e=(new be).setY(0),L=2*Math.PI/b,N=n/2/Math.tan(Math.PI/b),Z=2*Math.atan2(F/2,N),O=n/F;X._42=function(s,H,a,q){var W=X._debugOn;if(!g&&!W)return!1;$.copy(K.getEye()),G.copy(K.getCenter()).sub($);var o=Math.atan2(G.z,G.x),Q=K.getNear(),f=K.getFovy(),k=K.getAspect();d.copy(K.getCenter());for(var P,n=0;b>n;n++)if(P=j[n],e.setZ(Math.cos(o)).setX(Math.sin(o)).multiplyScalar(N),o-=L,y.addVectors($,e),K.setNear(N),K.setCenter([y.x,y.y,y.z]),K.setFovy(Z),K.setAspect(O),W){var B=Math.round(H/b);s.viewport(B*n,0,B,a),q()}else Gh(s,P.frame),s.viewport(0,0,P.width,P.height),s.clear(s.COLOR_BUFFER_BIT),q(),Gh(s,I),P.assureTexture();return K.setNear(Q),K.setCenter([d.x,d.y,d.z]),K.setFovy(f),K.setAspect(k),!0},X.capture()},getTextureInfo:function(V){var o=this._renderTargets;if(!o)return null;var q=this._renderTargets[V];return q?{index:V,texture:q.texture,textureName:q.uuid}:null}}),V.assign(ns.Graph3dView.prototype,{renderEnvToCube:function(Q,$,I,z){var i=this;i.envRenderer||(i.envRenderer=new ns.RenderEnv(i)),i.envRenderer.renderEnvToCube(Q,$,I,z)}}),ns.RenderTarget=function(s,u,C,i){var p=this;p.uuid=o.Math.generateUUID(),p.gv=s,p.init(s,u),p.setSize(u,C,i)},V.assign(ns.RenderTarget.prototype,{init:function(A,x){var f=this,r=f.texture=x.createTexture();x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,r),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.NEAREST),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.NEAREST),x.bindTexture(x.TEXTURE_2D,null),f.render=x.createRenderbuffer(),f.frame=x.createFramebuffer(),A._2O[f.uuid]=r},assureTexture:function(){var x=this,k=x.uuid,w=x.gv._2O;w[k]||(w[k]=x.texture)},setSize:function(U,m,C){var g=this;if(g.width!==m||g.height!==C){var E=U.RGBA,p=U.TEXTURE_2D,s=U.RENDERBUFFER,B=U.FRAMEBUFFER;As(U,g.texture),U.texImage2D(p,0,E,m,C,0,E,U.UNSIGNED_BYTE,I),lb(U,U.TEXTURE_MIN_FILTER,U.LINEAR),U.bindRenderbuffer(s,g.render),U.renderbufferStorage(s,U.DEPTH_COMPONENT16,m,C),Gh(U,g.frame),U.framebufferTexture2D(B,U.COLOR_ATTACHMENT0,p,g.texture,0),U.framebufferRenderbuffer(B,U.DEPTH_ATTACHMENT,s,g.render),As(U,I),U.bindRenderbuffer(s,I),Gh(U,I),g.width=m,g.height=C}},toCanvas:function(){var d=this,I=d.gv.getGL();I.bindFramebuffer(I.FRAMEBUFFER,d.frame);var t=d.width,l=d.height,v=new Uint8Array(4*t*l);I.readPixels(0,0,t,l,I.RGBA,I.UNSIGNED_BYTE,v),I.bindFramebuffer(I.FRAMEBUFFER,null);var L=z.createElement("canvas");L.width=t,L.height=l;var H=L.getContext("2d"),m=H.createImageData(t,l);return m.data.set(v),H.putImageData(m,0,0),L}});var Pb=ns.Interactor=function(S){this.gv=S};_d("Interactor",V,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var sl=ns.DefaultInteractor=function(P){lp(sl,this,[P])};_d("DefaultInteractor",Pb,{handle_contextmenu:function(E){Pd(E)},handle_mousewheel:function($){this.gv.handleScroll($,$.wheelDelta/40)},handle_DOMMouseScroll:function(x){2===x.axis&&this.gv.handleScroll(x,-x.detail)},handle_keydown:function(N){this.gv.handleKeyDown(N)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(a){Pd(a);var N=this,O=N.gv,X=Ei(a),f=O.getDataInfoAt(a),h=f?f.data:I,D=f?f.part:I,M=O.sm(),r=Jr(a),R=lg(a);O.setFocus(a)&&(N._62O=I,N._57I=I,h?Hg(a)?M.co(h)?M.rs(h):M.as(h):M.co(h)||M.ss(h):X&&(Hg(a)?O.isRectSelectable()&&(N._62O=ud):N._57I=ad(a)),N._31Q&&(Og(N._31Q),delete N._31Q,delete N._32Q),N._62O||(O.isFirstPersonMode()&&(_g(a)||R>2?N._62O="pan":O.isMouseRoamable()||Xm?(N._62O="roaming",N.foward=r&&Ei(a),N._32Q=Xc(),N._31Q=jr(N.tick,N)):X||(N._62O="roaming")),N._62O||(X&&r&&om[D]?(N._62O=D,N.p3=h.p3()):X&&r&&Cd(h)&&O.isSelected(h)?O.isMovable(h)?(N._62O="move",N.p3=h.p3(),N.movedata=h):O.isInteractive(h)&&(N._62O="none"):Xm&&(R>2?N._62O="pan":2===R&&(N.dist=em(a),N._62O="pinch")))),N.point=O.lp(a),Bf(N,a),Ro(a)?O.handleDoubleClick(a,h,D):O.handleClick(a,h,D))},tick:function(){var A=this,w=A.gv,_=w._moveStep;A.point&&w.isWalkable()&&(A._32Q&&(_*=(Xc()-A._32Q)/50),w.walk(A.foward?_:-_),A._32Q=Xc(),A._31Q=jr(A.tick,A))},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(C){var g=this._57I;g&&(cd(g,ad(C))<=1&&this.gv.sm().cs(),this._57I=I)},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(W){var G,h,q=this,o=q.gv,R=q._62O,$=q.point,O=o.dm(),l=o.lp(W),p=l.x-$.x,P=l.y-$.y,s=o.getWidth(),w=o.getHeight();if(s&&w){var M=-i*p/s,b=-i*P/w;if("roaming"===R)q.rotate(W,M/2,b/2);else if(R===Cn||R===Fr||R===bg)o._86O||O.beginTransaction(),o.fi({kind:o._86O?"betweenEditRotation":"beginEditRotation",event:W}),o._86O=1,o.sm().each(function(l){if(Cd(l)&&o.isRotationEditable(l)){var C=f(M)>f(b)?M:b;R===Cn?l.setRotationX(l.getRotationX()+C):R===Fr?l.setRotationY(l.getRotationY()+C):R===bg&&l.setRotationZ(l.getRotationZ()+C)}});else if("move"===R||om[R]){R===ai||R===ic||R===Zg?(o._87O||O.beginTransaction(),o.fi({kind:o._87O?"betweenEditScale":"beginEditScale",event:W}),o._87O=1):(o._moving||O.beginTransaction(),o.fi({kind:o._moving?"betweenMove":"beginMove",event:W}),o._moving=1);var z,I=q.p3,L=o.getPositionInfo(I),Q=Sj(o);z=R===zq?"x":R===Kr?"y":R===Se?"z":R===ai?"sx":R===ic?"sy":R===Zg?"sz":o.getMoveMode(W,q.movedata),p=p/s*L.width,P=-1*P/w*L.height;var A,r,S=[Q[0]*p,Q[4]*p,Q[8]*p],E=[Q[1]*P,Q[5]*P,Q[9]*P],_=S[0]+E[0],F=S[1]+E[1],g=S[2]+E[2],B=[I[0]+_,I[1]+F,I[2]+g],n=uq(o.getEye(),B,!0);if("xyz"===z?(A=B,o.moveSelection(_,F,g)):"xz"===z?(A=ik(o,I,[0,1,0],B),A&&o.moveSelection(A[0]-I[0],0,A[2]-I[2])):"xy"===z?(A=ik(o,I,[0,0,1],B),A&&o.moveSelection(A[0]-I[0],A[1]-I[1],0)):"yz"===z?(A=ik(o,I,[1,0,0],B),A&&o.moveSelection(0,A[1]-I[1],A[2]-I[2])):"x"===z||"sx"===z?(n[0]=0,A=ik(o,I,n,B),A&&(r=A[0]-I[0],"x"===z?o.moveSelection(r,0,0):o.sm().each(function(f){Cd(f)&&o.isSizeEditable(f)&&(G=f.getScaleX()+r/100,h=G/f.getScaleX(),f.setScaleX(G),_g(W)&&(f.setScaleY(f.getScaleY()*h),f.setScaleTall(f.getScaleTall()*h)))}))):"y"===z||"sy"===z?(n[1]=0,A=ik(o,I,n,B),A&&(r=A[1]-I[1],"y"===z?o.moveSelection(0,r,0):o.sm().each(function(J){Cd(J)&&o.isSizeEditable(J)&&(G=J.getScaleTall()+r/100,h=G/J.getScaleTall(),J.setScaleTall(G),_g(W)&&(J.setScaleY(J.getScaleY()*h),J.setScaleX(J.getScaleX()*h)))}))):("z"===z||"sz"===z)&&(n[2]=0,A=ik(o,I,n,B),A&&(r=A[2]-I[2],"z"===z?o.moveSelection(0,0,r):o.sm().each(function(q){Cd(q)&&o.isSizeEditable(q)&&(G=q.getScaleY()+r/100,h=G/q.getScaleY(),q.setScaleY(G),_g(W)&&(q.setScaleX(q.getScaleX()*h),q.setScaleTall(q.getScaleTall()*h)))}))),!A)return;q.p3=A}else if(R===ud){var H=q.div;H||(H=q.div=jd(),yj(q.getView(),H),H.op=$,H.style.background=o.getRectSelectBackground()),o.fi({kind:o._rectSelecting?"betweenRectSelect":"beginRectSelect",event:W}),o._rectSelecting=1,H.rect=we(H.op,l),Pi(H,H.rect)}else if("pinch"===R&&2===lg(W)){o.fi({kind:o._pinching?"betweenPinch":"beginPinch",event:W}),o._pinching=1;var r=em(W);o.handlePinch(r,q.dist),q.dist=r}else"pan"===R||_g(W)?q.pan(W,p,P):"none"===R||o.isFirstPersonMode()||(Ei(W)?q.rotate(W,M,b):(q.pan(W,p,0),o.isWalkable()&&(o.fi({kind:o._walking?"betweenWalk":"beginWalk",event:W}),o._walking=1,o.walk(P/o.getHeight()*o.getCenterInfo().height))));q.point=l}},pan:function(c,a,X){var h=this.gv;if(h.isPannable()){var n=h.getWidth(),O=h.getHeight();if(!n||!O)return;var y=h.getCenterInfo(),p=a/n*y.width,M=-1*X/O*y.height;h.fi({kind:h._panning?"betweenPan":"beginPan",event:c}),h._panning=1,h.pan(-p,-M)}},rotate:function(s,k,a){var R=this.gv;R.isRotatable()&&(R.fi({kind:R._rotating?"betweenRotate":"beginRotate",event:s}),R._rotating=1,R.rotate(k,a))},handleWindowMouseUp:function(Z){this.handleWindowTouchEnd(Z)},handleWindowTouchEnd:function(w){var v=this,l=v.gv,x=l.dm(),U=v.div;if(U){var O=l.getDatasInRect(U.rect);if(!O.isEmpty()){var S=l.sm(),N=S.toSelection();O.each(function(e){S.co(e)?N.remove(e):N.add(e)}),S.ss(N)}gg(U)}l._moving&&(delete l._moving,l.fi({kind:"endMove",event:w}),l.onMoveEnded(),x.endTransaction()),l._panning&&(delete l._panning,l.fi({kind:"endPan",event:w}),l.onPanEnded()),l._rotating&&(delete l._rotating,l.fi({kind:"endRotate",event:w}),l.onRotateEnded()),l._86O&&(delete l._86O,l.fi({kind:"endEditRotation",event:w}),x.endTransaction()),l._87O&&(delete l._87O,l.fi({kind:"endEditScale",event:w}),x.endTransaction()),l._pinching&&(delete l._pinching,l.fi({kind:"endPinch",event:w}),l.onPinchEnded()),l._rectSelecting&&(delete l._rectSelecting,l.fi({kind:"endRectSelect",event:w}),l.onRectSelectEnded()),l._walking&&(delete l._walking,l.fi({kind:"endWalk",event:w}),l.onWalkEnded()),v.dist=v.point=v._62O=v.p3=v.movedata=v.div=v._57I=v._32Q=v._31Q=v.foward=I}});var oq=ns.MapInteractor=function(L){lp(oq,this,[L]),this._minPhi=0,this._maxPhi=5*E/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};_d("MapInteractor",Pb,{handle_contextmenu:function(z){Pd(z)},handle_mousewheel:function(h){this.gv.handleScroll(h,h.wheelDelta/40)},handle_DOMMouseScroll:function(y){2===y.axis&&this.gv.handleScroll(y,-y.detail)},handle_keydown:function(Q){this.gv.handleKeyDown(Q)},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(w){Pd(w);var W=this,J=W.gv;if(J.setFocus(w)){J.lp(w);var v=J.getDataInfoAt(w),A=v?v.data:I,U=v?v.part:I;if(!A||!J.isInteractive(A)){var c=W.editing={point:J.lp(w)};Xm?c.touch=!0:(c.touch=!1,c.pan=Ei(w)),Bf(W,w)}Ro(w)?J.handleDoubleClick(w,A,U):J.handleClick(w,A,U)}},handle_mouseup:function(M){this.handle_touchend(M)},handle_touchend:function(){},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(X){var W=this,D=W.gv,p=W.editing;if(p){var A=D.lp(X),m=p.point,$=A.x-m.x,C=A.y-m.y;if(!p.moved){if(Math.abs($)<W.threshold&&Math.abs(C)<W.threshold&&!(X.touches&&X.touches.length>1))return;p.moved=!0}if(p.point=A,p.touch){var M=X.touches.length;if(2!==M)W.pan(X,$,C);else{if(1>=M)return;var Z=X.touches,d={x:Z[0].clientX,y:Z[0].clientY},c={x:Z[1].clientX,y:Z[1].clientY},P={x:c.x-d.x,y:c.y-d.y},g=p.lastCenter,j=Math.atan2(P.y,P.x),F=p.theta,b=0;F==I?F=p.theta=j:(b=j-F,p.thetaStarted||Math.abs(b)>W.touchRotateThreshold?(p.thetaStarted=!0,p.theta=j):b=0);var J=E*(d.y+c.y)/2/D.getHeight(),Q=p.phi,x=0;
Q==I?Q=p.phi=J:(x=J-Q,p.phiStarted||Math.abs(x)>W.touchRotateThreshold?(p.phiStarted=!0,p.phi=J):x=0);var a,q=Math.sqrt(P.x*P.x+P.y*P.y),s=p.vlen;if(s){var O=d.x-g.x,V=d.y-g.y,w=c.x-g.x,S=c.y-g.y,z=Math.sqrt(O*O+V*V),T=Math.sqrt(w*w+S*S),k=s/2,f=W._sign2(z-k),L=W._sign2(T-k);0>f*L||0===f&&0===L?(a=1,p.vlen=q):(a||(a=q/s),p.scaleStarted||Math.abs(a-1)>W.touchScaleThreshold?(p.vlen=q,p.scaleStarted=!0):a=1)}else s=p.vlen=q,a=1;1!==a&&D.setZoom(a),(x||b)&&W.rotate(X,b,-x),p.lastCenter={x:(c.x+d.x)/2,y:(c.y+d.y)/2}}}else if(p.pan)W.pan(X,$,C);else{var h=D.getWidth(),u=D.getHeight();if(!h||!u)return;var B=-i*$/h,e=-i*C/u;W.rotate(X,B,e)}}},_sign2:function(V){return Math.abs(V)<this._touchScaleCheckAccuracy?0:V>0?1:-1},handleWindowMouseUp:function(F){this.handleWindowTouchEnd(F)},handleWindowTouchEnd:function(x){var N=this,k=N.editing;if(N.editing=null,k){var q=N.gv;if(!k.moved&&k.pan){var V=q.getDataAt(x);V?q.sm().setSelection([V]):q.sm().clearSelection()}else q._panning=null,q._rotating=null,q.fi({kind:k.pan?"endPan":"endRotate",event:x})}},pan:function(Z,h,c){var f=this,g=f.gv;if(g.isPannable()){var K=g.getWidth(),e=g.getHeight();if(K&&e){var t=g.getCenterInfo(),Y=-h/K*t.width,m=1*c/e*t.height;g.fi({kind:g._panning?"betweenPan":"beginPan",event:Z}),g._panning=1;var G=f.keepHorizon,r=f.editing.touch;if((r&&Z.touches&&Z.touches.length>1||!r&&_g(Z))&&(G=!G),!G)return g.pan(Y,m);if(Y||m){var V=Sj(g),v=[V[0]*Y,V[4]*Y,V[8]*Y],O=[V[1],0,V[9]],C=Math.sqrt(O[0]*O[0]+O[2]*O[2]);C&&(O=[O[0]/C*m,0,O[2]/C*m]);var u=v[0]+O[0],P=v[1]+O[1],E=v[2]+O[2],d=g._center,n=g._eye;d[0]+=u,d[1]+=P,d[2]+=E,n[0]+=u,n[1]+=P,n[2]+=E,g.fp(xg,I,n),g.fp(lr,I,d)}}}},rotate:function(T,O,F){var H=this,n=H.gv;if(n.isRotatable()){var A=n._center,e=n._eye,x=uq(e,A),K=Y(v(x[0]*x[0]+x[2]*x[2]),x[1]),$=K+F;$=Math.max(H.minPhi,Math.min(H.maxPhi,$)),F=$-K,n.fi({kind:n._rotating?"betweenRotate":"beginRotate",event:T}),n._rotating=1,n.rotate(O,F)}}}),V.defineProperties(oq.prototype,{minPhi:{get:function(){return this._minPhi},set:function(I){this._minPhi=I}},maxPhi:{get:function(){return this._maxPhi},set:function(z){this._maxPhi=z}},keepHorizon:{get:function(){return this._keepHorizon},set:function(o){this._keepHorizon=o}},threshold:{get:function(){return this._threshold},set:function(w){this._threshold=w}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(p){this._touchScaleThreshold=p}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(u){this._touchRotateThreshold=u}}});var Od=function(x){this.gv=x};lf(Od,V,{_iv:!0,iv:function(){this._iv=!0},face:function(Z,V){var P=this,f=P.gv.getGL();if(!f||!Cd(Z))return I;var q=V.x,D=V.width,y=V.height,S=P.height-V.y-y,z=B(D/2),W=new Uint8Array(4*D*y),E=0;for(P.iv(),P.validate(Z),Gh(f,P.frame),f.readPixels(q,S,D,y,f.RGBA,f.UNSIGNED_BYTE,W),Gh(f,I),P.iv();z>=E;E++)for(var a=z-E,g=z+E,H=a;g>=H;H++)for(var i=a;g>=i;i++)if(H===a||H===g||i===a||i===g){var G=Jo.m[W[4*(H*D+i)]];if(G)return G}},get:function(C,u){this.validate();var m=this,p=m.gv.getGL();if(!p)return I;var T,t,e=C.x,G=C.width,F=C.height,V=m.height-C.y-F,P=B(G/2),a=new Uint8Array(4*G*F),W=0,y=a.length,R=u?I:new mk,q=u?I:{};if(Gh(p,m.frame),p.readPixels(e,V,G,F,p.RGBA,p.UNSIGNED_BYTE,a),Gh(p,I),u){for(;P>=W;W++)for(var z=P-W,U=P+W,k=z;U>=k;k++)for(var v=z;U>=v;v++)if((k===z||k===U||v===z||v===U)&&(T=m.info(a,4*(k*G+v))))return T}else for(;y>W;W+=4)T=m.info(a,W),T&&(t=T.data,q[t._id]||(R.add(t),q[t._id]=t));return R},info:function(J,w){return this.colorMap[(J[w]<<16)+(J[w+1]<<8)+J[w+2]+((127&J[w+3])<<24)]},validate:function(T){var n=this,N=n.gv,i=N.getGL();if(i){var q=N.getWidth(),f=N.getHeight(),B=i.RGBA,c=i.TEXTURE_2D,_=i.RENDERBUFFER,L=i.FRAMEBUFFER;n.texture||(n.texture=Lp(i),n.render=i.createRenderbuffer(),n.frame=i.createFramebuffer()),(n.width!==q||n.height!==f)&&(As(i,n.texture),i.texImage2D(c,0,B,q,f,0,B,i.UNSIGNED_BYTE,I),lb(i,i.TEXTURE_MIN_FILTER,i.LINEAR),i.bindRenderbuffer(_,n.render),i.renderbufferStorage(_,i.DEPTH_COMPONENT16,q,f),Gh(i,n.frame),i.framebufferTexture2D(L,i.COLOR_ATTACHMENT0,c,n.texture,0),i.framebufferRenderbuffer(L,i.DEPTH_ATTACHMENT,_,n.render),As(i,I),i.bindRenderbuffer(_,I),Gh(i,I),n.width=q,n.height=f),n._iv&&(n._iv=!1,Gh(i,n.frame),N._42(T||(n.colorMap={}),1),Gh(i,I))}}});var gf=function(S){this.gv=S};lf(gf,V,{gap:0,size:0,_42:function(E,v){var R=this,c=R.gv,$=c._gridGap,n=c._gridSize;if(c._gridVisible){if(R.gap!==$||R.size!==n){for(var g=[],z=c._gridSize/2,J=$*z,b=0;2*z+1>b;b++){var a=6*b,q=6*(2*z+1)+a;g[a]=-J,g[a+1]=0,g[a+2]=-J+b*$,g[a+3]=J,g[a+4]=0,g[a+5]=-J+b*$,g[q]=-J+b*$,g[q+1]=0,g[q+2]=-J,g[q+3]=-J+b*$,g[q+4]=0,g[q+5]=J}R.vs=new zd(g),R.gap=$,R.size=n}ug(c),qg(E,v),vq(E),Ek(E,v,1,c._gridColor,c._buffer.vs,R.vs),tn(E,0,R.vs.length/3,E.LINES),tb(E),rp(E,v)}else R.vs=R.gap=R.size=I}});var Mb=function(x){this.gv=x};lf(Mb,V,{_42:function(M,v){var B=this.gv,J=B._buffer.vs,k=B._axisXColor,A=B._axisYColor,V=B._axisZColor,g=B._originAxisVisible,i=B._centerAxisVisible;if(g||i){var h=$?M.TRIANGLES:M.TRIANGLE_FAN,P=M.LINES;if(ug(B),qg(M,v),vq(M),g){var Q=B.getCenterInfo(),e=m(Q.width,Q.height)/5,Y=.8*e,X=.05*e;Ek(M,v,1.5,k,J,new zd([0,0,0,e,0,0,Y,X,0,Y,0,X,Y,-X,0,Y,0,-X,Y,X,0,0,0,0,0,e,0,X,Y,0,0,Y,X,-X,Y,0,0,Y,-X,X,Y,0,0,0,0,0,0,e,X,0,Y,0,X,Y,-X,0,Y,0,-X,Y,X,0,Y])),tn(M,0,2,P),tn(M,1,6,h),Ek(M,v,I,A),tn(M,7,2,P),tn(M,8,6,h),Ek(M,v,I,V),tn(M,14,2,P),tn(M,15,6,h)}if(i){var C=B._center,_=C[0],s=C[1],O=C[2],Q=B.getPositionInfo(C);e=m(Q.width,Q.height)/20,Ek(M,v,1.5,k,J,new zd([_,s,O,_+e,s,O,_,s,O,_,s+e,O,_,s,O,_,s,O+e])),tn(M,0,2,P),Ek(M,v,I,A),tn(M,2,2,P),Ek(M,v,I,V),tn(M,4,2,P)}tb(M),rp(M,v)}}});var Ak=function(X){this.gv=X},zq="edit_tx",Kr="edit_ty",Se="edit_tz",Cn="edit_rx",Fr="edit_ry",bg="edit_rz",ai="edit_sx",ic="edit_sy",Zg="edit_sz",om={};om[zq]=1,om[Kr]=1,om[Se]=1,om[Cn]=1,om[Fr]=1,om[bg]=1,om[ai]=1,om[ic]=1,om[Zg]=1,lf(Ak,V,{_42:function(k,I,d){var L=this,$=L.gv,Q=$.sm().ld();if($.isEditable(Q)&&!$.isEditHelperDisabled()&&Cd(Q)&&(!$.isFirstPersonMode()||!$.isMouseRoamable()&&!Xm)){ug($);var _,g,X=$.isMovable(Q),o=$.isRotationEditable(Q),O=$.isSizeEditable(Q),l=$._axisXColor,c=$._axisYColor,P=$._axisZColor,q=$._editSizeColor,M=Q.p3(),W=cd($.getEye(),M)/10,N=W/(d?5:10),v=.7*W,F=.4*v,h=M[0],Z=M[1],H=M[2];_=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],X&&L._17O(k,I,Q,d,zq,l,_,[h,Z-N,H,h+v,Z-N,H,h+v,Z,H,h+v,Z,H,h,Z,H,h,Z-N,H,h,Z-N,H+N,h+v,Z-N,H+N,h+v,Z-N,H,h+v,Z-N,H,h,Z-N,H,h,Z-N,H+N]),g=h+v,O&&L._17O(k,I,Q,d,ai,q,_,[g,Z-N,H,g+F,Z-N,H,g+F,Z,H,g+F,Z,H,g,Z,H,g,Z-N,H,g,Z-N,H+N,g+F,Z-N,H+N,g+F,Z-N,H,g+F,Z-N,H,g,Z-N,H,g,Z-N,H+N]),g+=F,o&&L._17O(k,I,Q,d,Cn,l,_,[g,Z-N,H,g+F,Z-N,H,g+F,Z,H,g+F,Z,H,g,Z,H,g,Z-N,H,g,Z-N,H+N,g+F,Z-N,H+N,g+F,Z-N,H,g+F,Z-N,H,g,Z-N,H,g,Z-N,H+N]),_=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],X&&L._17O(k,I,Q,d,Kr,c,_,[h,Z,H,h,Z+v,H,h-N,Z+v,H,h-N,Z+v,H,h-N,Z,H,h,Z,H,h,Z,H,h,Z,H-N,h,Z+v,H-N,h,Z+v,H-N,h,Z+v,H,h,Z,H]),g=Z+v,O&&L._17O(k,I,Q,d,ic,q,_,[h,g,H,h,g+F,H,h-N,g+F,H,h-N,g+F,H,h-N,g,H,h,g,H,h,g,H,h,g,H-N,h,g+F,H-N,h,g+F,H-N,h,g+F,H,h,g,H]),g+=F,o&&L._17O(k,I,Q,d,Fr,c,_,[h,g,H,h,g+F,H,h-N,g+F,H,h-N,g+F,H,h-N,g,H,h,g,H,h,g,H,h,g,H-N,h,g+F,H-N,h,g+F,H-N,h,g+F,H,h,g,H]),_=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],X&&L._17O(k,I,Q,d,Se,P,_,[h,Z,H,h,Z,H+v,h,Z-N,H+v,h,Z-N,H+v,h,Z-N,H,h,Z,H,h,Z-N,H,h-N,Z-N,H,h-N,Z-N,H+v,h-N,Z-N,H+v,h,Z-N,H+v,h,Z-N,H]),g=H+v,O&&L._17O(k,I,Q,d,Zg,q,_,[h,Z,g,h,Z,g+F,h,Z-N,g+F,h,Z-N,g+F,h,Z-N,g,h,Z,g,h,Z-N,g,h-N,Z-N,g,h-N,Z-N,g+F,h-N,Z-N,g+F,h,Z-N,g+F,h,Z-N,g]),g+=F,o&&L._17O(k,I,Q,d,bg,P,_,[h,Z,g,h,Z,g+F,h,Z-N,g+F,h,Z-N,g+F,h,Z-N,g,h,Z,g,h,Z-N,g,h-N,Z-N,g,h-N,Z-N,g+F,h-N,Z-N,g+F,h,Z-N,g+F,h,Z-N,g])}},_17O:function(a,x,F,S,n,t,s,C){var w=this.gv._buffer;Bp(a,x,S,!0,F,n),Tb(a,x,I,!0,I,!0,I,!1),Sc(a,x.uDiffuse,t),Kq(a,w.vs,new zd(C),x.aPosition),Kq(a,w.ns,new zd(s),x.aNormal),vq(a),tn(a,0,12),tb(a),Wh(a,x)}});var Jn=o.Raycaster=function(W){this.gv=W};Sb("Raycaster",V,{intersect:function(M){var S=this,k=S.gv,D=k.getDataAt(M);return D?S.intersectObject(M,D):null},intersectObjects:function(z,A,V){var Q,X,f,x,Y=this,k=1/0,G=z.origin||(new be).fromArray(Y.gv.getEye());return A.forEach(function(y){V&&V(y)===!1||y.s("intersect")!==!1&&(Q=Y.intersectObject(z,y),Q&&(X=G.distanceToSquared(Q.world),k>X&&(f=y,x=Q,k=X)))}),{data:f,intersect:x}},intersectObject:function(S,p){if(S instanceof ee)return this._intersectObjectImpl(S,p);var g,Q,I=this,U=I.gv;Q=U.unproject(S);var L=U.getEye();U.isOrtho()?(g=uq(U.getCenter(),L),g[0]+=g[0],g[1]+=g[1],g[2]+=g[2]):g=L,g=new be(g);var n=new be(Q).sub(g).normalize(),J=new o.Math.Ray(g,n);return I._intersectObjectImpl(J,p)},_intersectObjectImpl:function(){function v(){var i=new be;return i.subVectors(k,D),a.subVectors(C,D),i.cross(a).normalize(),i}function B(v,X,Z,w,u,z,n){return yr.barycoordFromPoint(v,X,Z,w,d),u.multiplyScalar(d.x),z.multiplyScalar(d.y),n.multiplyScalar(d.z),u.add(z).add(n),u.clone()}var e=new mj,y=new mj,l=new ee,L=new be,p=new be,h=new be,m=new be,M=new be,C=new be,D=new be,k=new be,N=new Ib,g=new Ib,T=new Ib,a=new be,z={vs:Wb,is:xk,uv:Ug},d=new be;return function(a,s){var H=this.gv.getData3dUI(s),G=s.mat||H.mat;if(G){e.fromArray(G),y.getInverse(e),l.copy(a).applyMatrix4(y);var d,Y,w="body",X=H.shapeModel;if(X||(X=Ge(H)),X||(s instanceof o.Node&&!(s instanceof o.Shape)?(d=!0,X=z):(Y=!0,X=[H.left,H.front,H.right,H.back,H.top,H.bottom])),!X)return console.log("Can not find shape model."),null;sk(X)||(X=[X]);var $,A,r,f,j,E,F,W,i,Z,u,b,J,c,P=1/0,O=["","top_","bottom_"],t=!1;for($=0,A=X.length;A>$;$++)if(b=X[$])for(r=0,f=O.length;f>r;r++)if(J=O[r],F=b[J+"vs"],W=b[J+"is"],i=b[J+"uv"]||b[J+"tuv"],F){if(c=b[J+"boundingBox"]){if(!l.intersectBox(c))continue}else b[J+"boundingBox"]=c=new o.Math.Box3;for(j=0,E=W?W.length:F.length/3;E>j;j+=3)W?(p.fromArray(F,3*W[j]),h.fromArray(F,3*W[j+1]),m.fromArray(F,3*W[j+2])):(p.fromArray(F,3*j),h.fromArray(F,3*(j+1)),m.fromArray(F,3*(j+2))),c.expandByPoint(p),c.expandByPoint(h),c.expandByPoint(m),Z=l.intersectTriangle(p,h,m,!1,L),Z&&(u=l.origin.distanceTo(Z),P>u&&(P=u,M.copy(Z),C.copy(p),D.copy(h),k.copy(m),""!==J?w=J.slice(0,-1):d?w=rd[Math.floor(j/6)]:Y&&(w=rd[$]),i&&(t=!0,W?(N.fromArray(i,2*W[j]),g.fromArray(i,2*W[j+1]),T.fromArray(i,2*W[j+2])):(N.fromArray(i,2*j),g.fromArray(i,2*(j+1)),T.fromArray(i,2*(j+2))))))}if(!isFinite(P))return null;var S,I=M.clone().applyMatrix4(e);t&&(S=B(M,C,D,k,N,g,T));var V=v(C,D,k),n=v(C.applyMatrix4(e),D.applyMatrix4(e),k.applyMatrix4(e)),K=l.direction.dot(V);return K>0&&(V.multiplyScalar(-1),n.multiplyScalar(-1)),{world:I,local:M.clone(),worldNormal:n,normal:V,uv:S,part:w}}}}()});var zc=function(V,Y){this.gv=V,this.s=function(W,T,C){return T==I&&(T=C),T==I?Y.getStyle(W):Tq(T,Y,V)},this.data=Y};lf(zc,V,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(e,K,i,Q){var A=this,C=A.data;if(!(C instanceof lj)){var h,D,J,t,r,B,H,m=A.gv,Z=C._id,V=A.s("shape3d.alwaysOnTop")?null:A.s("batch"),y=m._batchIndexMap,a=m._batchModelMap,W=m.isSelectable(C),k=m.getBrightness(C),g=k!=I&&1!==k;if(A.needValidate(e)){if(J=vb(y,a,C,V),A.validate(J,V?Wm[V]||Mg:I),J&&(t=y[Z],r=t.size=J.vs.length/3-t.begin,H=J.rs))for(k=g?k:1,B=0;r>B;B++)H.push(k);if(Cd(C)){var l=m.getWireframeGeometry(C);if(l)el(m,C,l);else{var d=m.getWireframe(C);d&&el(m,C,d)}}A.labelInfo=A.label2Info=A.noteInfo=A.note2Info=A._38o=I,A._24O(Ko,"getLabel"),A._24O(ir,"getLabel2"),A._26O(Ub,"getNote"),A._26O(tp,"getNote2"),A._15O(),A.interactiveInfo=m.isInteractive(C)?{}:I,A._iv=!1}g&&Sc(e,K.uBrightness,k),Sc(e,K.uAlphaTest,A.s("alphaTest")),D=Bp(e,K,i,W,C,fp),D&&(xc(D,y[Z],a),xc(D,m._polylineIndexMap[Z],m._polylineModelMap),xc(D,m._wireframeIndexMap[Z],m._wireframeModelMap)),y[Z]||A._80o(e,K,Q),m.isLabelVisible(C)&&((h=A.labelInfo)&&(Bp(e,K,i,W,C,Ko),A._28O(h,Ko,Q)),(h=A.label2Info)&&(Bp(e,K,i,W,C,ir),A._28O(h,ir,Q))),m.isNoteVisible(C)&&((h=A.noteInfo)&&(Bp(e,K,i,W,C,Ub),A._29O(h,Ub,Q)),(h=A.note2Info)&&(Bp(e,K,i,W,C,tp),A._29O(h,tp,Q))),(h=A._38o)&&A._99O(e,K,h,i,W,Q),g&&Sc(e,K.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Fk},_80o:function(){},dispose:function(){},_calcAnchorMat:function(L){if(L.hasOwnProperty("_anchor")||L.hasOwnProperty("_anchorElevation")){var v=L.getAnchor3d(),G={x:v.x-.5,y:v.y-.5,z:v.z-.5},K=Vd();return nq(K,[-G.x,-G.y,-G.z]),K}},getBodyColor:function(P){var U=this.data,E=this.gv.getBodyColor(U);return E?E:P?U.getStyle(P):I},_24O:function(l,i){var Q=this,V=Q.data,f=Q.gv,k=Q.s,x=f[i](V);if(x!=I){var W=k(l+".scale"),j=k(l+".max"),w=Q[l+"Info"]={label:x,textureScale:k(l+".texture.scale"),color:f[i+"Color"](V),font:k(l+".font"),align:k(l+".align"),background:f[i+"Background"](V)},h=w.rect=js(w,x);j>0&&j<h.width&&(w.labelWidth=h.width,h.width=j),h.x=h.y=0,h.width*=W,h.height*=W,w.mat=Q._16O(k(l+".autorotate"),k(l+".position"),h,k(l+".face"),k(l+".t3"),k(l+".r3"),k(l+".rotationMode"));var H=h.width/2,a=h.height/2;w.vs=new zd([-H,a,0,-H,-a,0,H,-a,0,H,a,0]),h.width/=W,h.height/=W}},_26O:function(D,V){var J=this,f=J.data,Y=J.gv,S=J.s,s=Y[V](f);if(s!=I){var C=S(D+".scale"),G=this[D+"Info"]={note:s,textureScale:S(D+".texture.scale"),expanded:S(D+".expanded"),font:S(D+".font"),color:S(D+".color"),align:S(D+".align"),borderWidth:S(D+".border.width"),borderColor:S(D+".border.color"),background:Y[V+"Background"](f)};if(G.expanded){var X=S(D+".max"),k=js(G,s);k.width+=6,k.height+=2,X>0&&X<k.width&&(G.labelWidth=k.width,k.width=X);var v={x:-k.width/2,y:-8-k.height,width:k.width,height:k.height+8}}else v={x:-6,y:-18,width:12,height:18};G.mat=J._16O(S(D+".autorotate"),S(D+".position"),I,S(D+".face"),S(D+".t3"),S(D+".r3"),S(D+".rotationMode")),G.rect=v,1!==C&&(v=Tm(v),v.x*=C,v.height*=C,v.y=-v.height,v.width*=C);var o=v.x,y=v.y,E=v.width,Z=v.height;G.vs=new zd([o,-y,0,o,-y-Z,0,o+E,-y-Z,0,o+E,-y,0])}},_28O:function(L,A,m){if(m(this.s(A+".transparent"))){var F=L.rect,M=L.textureScale,r=F.width*M,s=F.height*M;if(r>=1&&s>=1){var n=_j(r,s);1!==M&&(n.translate(n,F.x,F.y),n.scale(M,M),n.translate(n,-F.x,-F.y)),Qm(n,L),n.restore(),Yb(this,A,L.mat,L.vs,!0)}}},_29O:function(B,x,$){if($(this.s(x+".transparent"))){var L=B.rect,n=B.textureScale,Z=L.x,z=L.y,l=L.width*n,U=L.height*n;if(l>=1&&U>=1){L.x=L.y=0;var R=_j(l,U);1!==n&&R.scale(n,n),_l(R,B),R.restore(),L.x=Z,L.y=z,Yb(this,x,B.mat,B.vs,!1)}}},_99O:function(j,k,P,V,f,A){if(P){var l=this,R=l.gv,O=l.data,n=R._buffer,N=R._1O,w=P.icons;for(var Y in w){var r=w[Y],K=P.rects[Y];if(K&&A(Tq(r.transparent,O,R))){Bp(j,k,V,f,O,Y);var p=Tq(r.shape3d,O,R),y=p?[p]:Tq(r.names,O,R),U=y?y.length:0,o=Tq(r.textureScale,O,R)||1,X=Tq(r.light,O,R);X==I&&(X=p?!0:!1),Tb(j,k,Tq(r.blend,O,R),X,Tq(r.opacity,O,R),Tq(r.reverseFlip,O,R),Tq(r.reverseColor,O,R),Tq(r.reverseCull,O,R));for(var F=0;U>F;F++){var b=y[F],s=K[F];if(Eq(l,s.mat),p)Ed(R,O,Ge(l,p),l);else{var L=wc(b);if(L){var v=s.width*o,d=s.height*o;if(v>=1&&d>=1){var W=_j(v,d);Do(W,L,Tq(r.stretch,O,R),0,0,v,d,O,R),W.restore(),Lp(j,il,N),vq(j,k,N,Tq(r.discardSelectable,O,R),n.uv,fk),Kq(j,n.vs,s.vs,k.aPosition),Wk(j,n.ns,Jh,k.aNormal),ki(j,n.is,co),xo(j,0,co.length),tb(j,k,N)}}}wm(R)}Wh(j,k)}}}}});var $n=function(f,V){lp($n,this,[f,V])};lf($n,zc,{_16O:function(d,z,g,M,P,Q,L,S,s){var r=this.data,j=r.getFinalScale3d(),n=uj(z,j,g,M,S,s);if(r.hasOwnProperty("_anchor")||r.hasOwnProperty("_anchorElevation")){var U=r.getAnchor3d();n[0]-=(U.x-.5)*j[0],n[1]-=(U.y-.5)*j[1],n[2]-=(U.z-.5)*j[2]}return re(Vd(),n,r.p3(),M,P,Q,L,d,r.getFinalRotation3d(),r.getRotationMode())},clear:function(){var R=this;R.faceMat=R.mat=R.shapeModel=R.left=R.right=R.front=R.back=R.top=R.bottom=R.csg=I},needValidate:function(L){if(this._iv)return this._validateFrameId=L._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var J=L._renderInfo.frame;if(this._validateFrameId!==J)return this._validateFrameId=J,!0}return!1},validate:function(n,Y){var o=this,D=o.gv,j=o.data,v=Ge(o);o._updateAutoRotation(),o._updateFixSize2d(),o._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(gr(D,j,"_wireframeModelMap","_wireframeIndexMap"),gr(D,j,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var x=Vl(j,D.getMat(j),v?o.s("shape3d.scaleable"):!0),d=o._calcAnchorMat(j);if(d&&vl(x,x,d),j.mat=x,o.clear(),n){var w=[];v?Rp(D,j,v,o,o.getBodyColor(),[x],n,w):(Mq(D,j,n,Y,x,_h,w,Sh),Mq(D,j,n,Y,x,De,w,Ml),Mq(D,j,n,Y,x,Rd,w,bh),Mq(D,j,n,Y,x,Yf,w,Oe),Mq(D,j,n,Y,x,Zp,w,Rf),Mq(D,j,n,Y,x,_m,w,Op)),w.length&&(sm(n.vs,w),sm(n.ns,Dr(w)))}else o.mat=x,(o.shapeModel=v)||(o._cubeUvs=null,o.vf(_h,0),o.vf(De,16),o.vf(Zp,8),o.vf(_m,24),o.vf(Rd,32),o.vf(Yf,40))},_updateAutoRotation:function(){var X=new Zh;return function(){var M=this,n=M.data,x=M.s("shape3d.autorotate");if(!x)return n._dynamicRotation&&delete n._dynamicRotation,void 0;var i,I=M.gv;i="string"==typeof x?[x.indexOf("x")<0?I._eye[0]:I._center[0],x.indexOf("y")<0?I._eye[1]:I._center[1],x.indexOf("z")<0?I._eye[2]:I._center[2]]:I._eye;var u=I._center,B=n.p3(),a=Qn([B[0]+i[0]-u[0],B[1]+i[1]-u[1],B[2]+i[2]-u[2]],B,I._up),y=n.r3();X.set(0,0,0,n.getRotationMode(),!0).setFromRotationMatrix(a),Math.abs(y[0]-X.x)<1e-5&&Math.abs(y[1]-X.y)<1e-5&&Math.abs(y[2]-X.z)<1e-5||(n._dynamicRotation=[X.x,X.y,X.z])}}(),_updateFixSize2d:function(){var u=this,J=u.data,F=u.s("shape3d.fixSizeOnScreen");if(!F)return J._dynamicScale3d&&delete J._dynamicScale3d,void 0;var _=u.gv;J.getFinalScale3d();var g=Vl(J,_.getMat(J)),$=$f([0,0,0],g),i=_.toViewPosition($);if(!isNaN(i.x)&&!isNaN(i.y)){var s=$f([1,0,0],g),G=_.toViewPosition(s),A=$f([0,1,0],g),z=_.toViewPosition(A),d=G.x-i.x,Y=z.y-i.y,a=J._dynamicScale3d||[1,1,1],m=wc(J.s("shape3d.image")),o=F[0]>0?F[0]:m?Rn(m,u):20,C=F[1]>0?F[1]:m?si(m,u):20,b=Math.abs(d/o),L=Math.abs(Y/C);Math.abs(b-1)<.001&&Math.abs(L-1)<.001||(J._dynamicScale3d=[a[0]/b,a[1]/L,a[2]])}},_updateOverlapping:function(){var Q=this,l=Q.s("hide.overlapping.group");if(!l)return Q._rectOverlapping&&(Q._rectOverlapping=Z),void 0;var r,s,J,W=Q.gv,X=Q.data,L=Vl(X,W.getMat(X)),h=1/0,p=1/0,d=-1/0,F=-1/0,y=X.getAnchor3d(),g=y.x,C=y.y,Y=y.z;for(r=0;8>r;r++){if(s=$f([(r>>2)-g,(1&r>>1)-C,(1&r)-Y],L),J=W.toViewPosition(s),isNaN(J.x)||isNaN(J.y))return;h=Math.min(h,J.x),d=Math.max(d,J.x),p=Math.min(p,J.y),F=Math.max(F,J.y)}var G={x:h,y:p,w:d-h,h:F-p};Q._rectOverlapping=W.overlappingBox.isOverlapping(l,G)},getVectorDynamicSize:function(){var L,c=this,m=c.s("shape3d"),T=c.data;if("billboard"===m||"plane"===m||(L=T._currentCubeElementId)!=I){var k,y,J=c.gv,r=Vl(T,J.getMat(T)),a=function(u,i){var h=J.toViewPosition($f(u,r)),n=J.toViewPosition($f(i,r)),z=h.x-n.x,p=h.y-n.y;return Math.min(2048,Math.sqrt(z*z+p*p))};if("billboard"===m)k=a([-.5,0,0],[.5,0,0]),y=a([0,-.5,0],[0,.5,0]);else if("plane"===m)k=a([-.5,0,0],[.5,0,0]),y=a([0,0,-.5],[0,0,.5]);else if(T._currentCubeElementId!=I){var j=3*xk[L+1],z=3*xk[L],P=3*xk[L+2];k=a([Wb[j],Wb[j+1],Wb[j+2]],[Wb[P],Wb[P+1],Wb[P+2]]),y=a([Wb[j],Wb[j+1],Wb[j+2]],[Wb[z],Wb[z+1],Wb[z+2]])}return[k,y]}},getCachedTexture:function(){var _=this,C=_.data,p=C._currentCubeElementId;return p!=I?_._cubeCachedImage?_._cubeCachedImage[p]:null:_._shape3dCachedImage},setCachedTexture:function(C){var z=this,H=z.data,r=H._currentCubeElementId;if(r!=I){if(!z._cubeCachedImage)return z._cubeCachedImage={};z._cubeCachedImage[r]=C}else z._shape3dCachedImage=C},invalidateCachedTexture:function(_){var z,o,e,X=this;if((e=X._shape3dCachedImage)&&(_.deleteTexture(e),X._shape3dCachedImage=null),o=X._cubeCachedImage){for(z in o)_.deleteTexture(o[z]);X._cubeCachedImage=null}},vf:function(_,Q){var N=this;if(N.gv.getFaceVisible(N.data,_)){var t=Hk(N,_);t.mat&&(N.faceMat=!0);var O=t.uv;if(O){var c=N._cubeUvs;c||(c=N._cubeUvs=new zd([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var U=0;8>U;U++)c[Q+U]=O[U]}return t}},_80o:function(C,p,V){var O=this;if(O._rectOverlapping)return!0;var n=O.gv,Z=O.data,b=n._cube,k=O.shapeModel;ug(n,O.mat),k?Ed(n,Z,k,O,O.getBodyColor(),V):(Kq(C,b.vs,I,p.aPosition),Kq(C,b.ns,I,p.aNormal),xl(C,b.is),O._18O(C,p,O.left,0,V),O._18O(C,p,O.front,6,V),O._18O(C,p,O.right,12,V),O._18O(C,p,O.back,18,V),O._18O(C,p,O.top,24,V),O._18O(C,p,O.bottom,30,V)),wm(n),O.faceMat&&(O._18O(C,p,O.left,0,V,!0),O._18O(C,p,O.front,6,V,!0),O._18O(C,p,O.right,12,V,!0),O._18O(C,p,O.back,18,V,!0),O._18O(C,p,O.top,24,V,!0),O._18O(C,p,O.bottom,30,V,!0))},_18O:function(O,u,l,$,F,r){if(l){if(!F(l.transparent))return;if(r&&!l.mat||!r&&l.mat)return;r&&ug(this.gv,l.mat);var Z=this,g=Z.data;g._currentCubeElementId=$;var z=Z.gv,C=z.getTexture(l.texture,g),f=l.uv,M=l.uvScale,n=l.uvOffset,X=l.discardSelectable;C?f?vq(O,u,C,X,z._buffer.uv,Z._cubeUvs,n,M):vq(O,u,C,X,z._cube.uv,I,n,M):vq(O),Tb(O,u,l.blend,l.light,l.opacity,l.reverseFlip,l.reverseColor,l.reverseCull),Sc(O,u.uDiffuse,l.color),xo(O,$,6),Wh(O,u),tb(O,u,C),r&&wm(z),g._currentCubeElementId=null}}});var Nq=function(E,f){lp(Nq,this,[E,f])};lf(Nq,zc,{_25Q:1,validate:function(v){var c=this,K=c.gv,A=c.data,S=c.s,g=S("edge.width"),t=A._40I,$=A._41I;if(c.shapeModel=c.info=I,t&&$){var F,h,_,y,r,G,o,E,P,Z,f=A.isLooped(),x=S(pj),p=C.getEdgeType(x);if(p){var M=p(A,sb(c,K,A,f,x),K,c._19Q);if(!M.points||M.points.isEmpty())return;G=c.info={},o=M.segments,r=M.points,E=r.size();for(var q=t.getElevation(),e=$.getElevation(),d=0;E>d;d++){var Q=r.get(d);Q.e==I&&(Q.e=q+(e-q)*d/(E-1))}P=ms(r.get(0)),Z=ms(r.get(E-1));var i=E%2;0===i?(G.c1=ms(r.get(E/2-1)),G.c2=ms(r.get(E/2))):G.p3=ms(r.get((E-i)/2)),G.s1=P,G.s2=ms(r.get(1)),G.t1=ms(r.get(E-2)),G.t2=Z}else{r=new mk,G=c.info={};var b=S("edge.offset"),R=S("edge.center"),N=S("edge.source.t3"),u=S("edge.target.t3"),n=t.p3(),w=$.p3();if(N&&(n[0]+=N[0],n[1]+=N[1],n[2]+=N[2]),u&&(w[0]+=u[0],w[1]+=u[1],w[2]+=u[2]),x===Rl){o=S("edge.segments");var D=G.points=S(qn)||ze;if(E=D.size()){P=ms(D.get(0)),Z=ms(D.get(E-1)),!R&&b&&(_=uq(P,n,!0),b=m(b,cd(n,P)),n=[n[0]+_[0]*b,n[1]+_[1]*b,n[2]+_[2]*b],_=uq(w,Z,!0),b=m(b,cd(Z,w)),w=[w[0]-_[0]*b,w[1]-_[1]*b,w[2]-_[2]*b]);var i=E%2;0===i?(F=ms(D.get(E/2-1)),h=ms(D.get(E/2))):G.p3=ms(D.get((E-i)/2)),G.s1=n,G.s2=P,G.t1=Z,G.t2=w}else!R&&b&&(_=uq(w,n,!0),y=cd(n,w),b=bs(b,y),n=[n[0]+_[0]*b,n[1]+_[1]*b,n[2]+_[2]*b],w=[w[0]-_[0]*b,w[1]-_[1]*b,w[2]-_[2]*b]),F=n,h=w;r.add({x:n[0],y:n[2],e:n[1]}),r.addAll(D),r.add({x:w[0],y:w[2],e:w[1]})}else{var s=sb(c,K,A,f,x);if(c._19Q||(s=-s),f){var z=n[0],V=n[1],T=n[2],k=t.getTall()/2+s;F=[z-s,V+k,T],h=[z+s,V+k,T],r.add({x:z-s,y:T,e:V}),r.add({x:z-s,y:T,e:V+k}),r.add({x:z+s,y:T,e:V+k}),r.add({x:z+s,y:T,e:V})}else{_=uq(w,n,!0),y=cd(n,w);var X={x:n[0],y:n[2]},l={x:w[0],y:w[2]},a=me(I,X,l,s),U=a.x-X.x,W=a.y-X.y;b=bs(b,y),_[0]*=b,_[1]*=b,_[2]*=b,F=[n[0]+_[0]+U,n[1]+_[1],n[2]+_[2]+W],h=[w[0]-_[0]+U,w[1]-_[1],w[2]-_[2]+W],R?(r.add({x:n[0],y:n[2],e:n[1]}),r.add({x:F[0],y:F[2],e:F[1]}),r.add({x:h[0],y:h[2],e:h[1]}),r.add({x:w[0],y:w[2],e:w[1]})):(r.add({x:F[0],y:F[2],e:F[1]}),r.add({x:h[0],y:h[2],e:h[1]}))}}G.c1=F,G.c2=h}G.list=S(Ho)===An?c.createTubeModel(r,o,g/2,v):c.createLineModel(r,o,g,"edge","edge.dash")}}});var Zk=function(S,m){lp(Zk,this,[S,m])};lf(Zk,$n,{_80o:function(d,n,L){var m=this,Q=m.gv,_=m.shapeModel;ug(Q,m.mat),_?Ed(Q,m.data,_,m,m.getBodyColor(),L):(Eg(m,d,n,m.left,L),Eg(m,d,n,m.front,L),Eg(m,d,n,m.right,L),Eg(m,d,n,m.back,L),Eg(m,d,n,m.top,L),Eg(m,d,n,m.bottom,L)),wm(Q)},validate:function(J,x){var n,$,b=this,S=b.s,Q=b.data,P=Q.p3(),j=Q._thickness/2,E=Q.isClosePath(),r=Q.getPoints(),G=Q.getSegments(),Z=S(fi),D=J&&J.uv;if(b.clear(),0>j)$=b.shapeModel=Oo(r,G,S(Li),S(zl),Z,S(ui),Q.getTall(),Q.getShapeElevation(),E),S(Vf)?S("shape3d.image")||delete $.uv:(delete $.vs,delete $.ns,delete $.uv),S("shape3d.top.image")||delete $.top_uv,S("shape3d.bottom.image")||delete $.bottom_uv;else if(S(Ho)===An)n=hk(r,G,Z,E),$=b.shapeModel={vs:[]},S("shape3d.image")&&($.uv=[],$.sum=S(ui)||Cg(n)||1,$.len=0),S(Li)&&!E&&($.top_vs=[],S("shape3d.top.image")&&($.top_uv=[])),S(zl)&&!E&&($.bottom_vs=[],S("shape3d.bottom.image")&&($.bottom_uv=[])),b._12O(n,j);else{var l,t,K,u,d,M,a,p,Y,o;if(n=hk(r,G,Z,E),d=b.vf(Zp,D,!1,x),j&&(M=b.vf(_m,D,!1,x),a=E?I:b.vf(_h,D,!1,x),p=E?I:b.vf(De,D,!1,x),Y=b.vf(Rd,D,!1,x),o=b.vf(Yf,D,!1,x)),j){for(var z=0,w=n.length;w>z;z++)n[z]=b._tryRemoveBezierPoints(n[z],j);b._12O(n,j)}else d&&n.forEach(function(g){if(u=g.length,u>0)for(l=g[0],K=1;u>K;K++)t=g[K],b.addV(d.vs,l,t),l=t});b._20Q(n),J||(d&&(d.ns=Dr(d.vs),ek(d,"vs"),ek(d,wb)),j&&(M&&(M.ns=Dr(M.vs),ek(M,"vs"),ek(M,wb)),a&&(a.ns=Dr(a.vs),ek(a,"vs"),ek(a,wb)),p&&(p.ns=Dr(p.vs),ek(p,"vs"),ek(p,wb)),Y&&(Y.ns=Dr(Y.vs),ek(Y,"vs"),ek(Y,wb)),o&&(o.ns=Dr(o.vs),ek(o,"vs"),ek(o,wb))))}var i=b.mat=Vd();nq(i,P),kc(i,Q.getFinalRotation3d(),Q.getRotationMode());var g=Q.getScale3d(),F=Q._dynamicScale3d;F&&(g[0]*=F[0],g[1]*=F[1],g[2]*=F[2]),xh(i,g),nq(i,lk(P)),J&&(Iq(b,i,J,$),b.clear())},_20Q:function(X){var K,j,E,V,P,c,B,M=this,L=M.front,i=M.back,p=M.top,H=M.bottom,x=L?L.tuv:I,Z=i?i.tuv:I,g=p?p.tuv:I,T=H?H.tuv:I,D=0;(x||Z||g||T)&&(K=M.s(ui)||Cg(X)||1,X.forEach(function(G){if(j=G.length,j>0)for(c=G[0],E=1;j>E;E++)B=G[E],V=D/K,D+=cd(c,B),P=D/K,M._14O(L,V,P),M._14O(i,1-P,1-V),M._14O(p,V,P),M._14O(H,V,P),c=B}))},_14O:function(k,c,N){if(k){var w=k.uv,e=k.tuv;if(e){if(w)var q=w[0]+(w[6]-w[0])*c,C=w[1]+(w[7]-w[1])*c,f=w[2]+(w[4]-w[2])*c,b=w[3]+(w[5]-w[3])*c,M=w[2]+(w[4]-w[2])*N,Z=w[3]+(w[5]-w[3])*N,W=w[0]+(w[6]-w[0])*N,m=w[1]+(w[7]-w[1])*N;else q=c,C=0,f=c,b=1,M=N,Z=1,W=N,m=0;e.push(f,b,M,Z,W,m,W,m,q,C,f,b)}}},_13O:function(C){var e=C.uv,o=C.tuv;o&&(e?o.push(e[2],e[3],e[4],e[5],e[6],e[7],e[6],e[7],e[0],e[1],e[2],e[3]):o.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(E,d){var Q=E.length;if(4>Q)return E;var D,J,z,x,h,g,y=!1,H=function(X){return E[X]},B=function(W){return E[Q-1-W]};for(h=0;1>=h;h++)for(g=h?B:H,J=g(0),z=g(1),D=2;Q-1>D;D++)if(x=g(D),!x.remove)if(x.b){var C=me(J,z,x,d);C.adjust?(x.remove=!0,y=!0):(J=z,z=x)}else J=z,z=x;if(!y)return E;var e=[];for(D=0;Q>D;D++)E[D].remove||e.push(E[D]);return e},_12O:function($,d){var F,P,f,M,S,D=this;$.forEach(function(q){if(S=q.length,S>0)for(F={p:q[0],n:!0},M=1;S>M;M++)P=q[M],f=S-1>M?q[M+1]:I,D.addPoint(F,P,f,d,q)})},addPoint:function(S,j,G,R,q){var l,W,V,M,u,a,o,c,J,X=this,g=S.p,_=S.f,K=S.b,b=X.s("shape3d.side")||Hj,e=X.s("shape3d.start.angle"),B=X.s("shape3d.sweep.angle"),s=X.shapeModel,m=X.data.isClosePath();if(S.n&&(S.n=!1,_=m&&q.length>2?me(q[q.length-2],g,j,R):me(I,g,j,R),K=yq(g,_),s?s.top_vs&&X._10O(K,_,b,e,B,s.top_vs,s.top_uv):(l=X.left)&&(X.addV(l.vs,K,_),X._13O(l))),W=G?me(g,j,G,R):m&&q.length>2?me(g,j,q[1],R):me(g,j,I,R),V=yq(j,W),s){var A,n,h=s.vs,Q=s.uv,D=s.sum;for(Q&&(A=s.len/D,s.len+=cd(g,j),n=s.len/D),a=X._9O(K,_,b,e,B),o=X._9O(V,W,b,e,B),c=0;b>c;c++)J=c+1,sm(h,a[J]),sm(h,o[c]),sm(h,a[c]),sm(h,o[c]),sm(h,a[J]),sm(h,o[J]),Q&&(M=c/b,u=J/b,Q.push(A,u,n,M,A,M,n,M,A,u,n,u));!G&&s.bottom_vs&&X._10O(V,W,b,e,B,s.bottom_vs,s.bottom_uv,!0)}else!G&&(l=X.right)&&(X.addV(l.vs,W,V),X._13O(l)),(l=X.front)&&X.addV(l.vs,_,W),(l=X.back)&&X.addV(l.vs,V,K),(l=X.top)&&X.addH(l.vs,_,W,V,K,!0),(l=X.bottom)&&X.addH(l.vs,K,V,W,_);S.p=j,S.f=W,S.b=V},_10O:function(J,O,k,t,a,H,z,f){var M,x,e=this,C=e.data,w=e._9O(J,O,k,t,a),V=(J.x+O.x)/2,K=(J.y+O.y)/2,s=C.getShapeElevation(),B=0;for(B=0;k>B;B++)f?(sm(H,w[B]),sm(H,w[B+1])):(sm(H,w[B+1]),sm(H,w[B])),sm(H,[V,s,K]),z&&(f?(M=i*(B+1)/k+t,x=i*B/k+t):(M=i*B/k+t,x=i*(B+1)/k+t),z.push(.5-.5*T(x),.5-.5*W(x),.5-.5*T(M),.5-.5*W(M),.5,.5))},_9O:function(j,f,r,D,c){var F,b,X=this,x=X.data,J=[],M=(j.x+f.x)/2,V=(j.y+f.y)/2,H=x.getTall()/2,N=x.getShapeElevation(),A=0;for(c=c||i;r>=A;A++)F=c*A/r+D,b=T(F),J.push([M+(j.x-M)*b,N+H*W(F),V+(j.y-V)*b]);return J},addV:function(X,O,I){var F=O.x,t=O.y,N=I.x,U=I.y,q=this.data,f=q.getShapeElevation(),E=q.getTall()/2;X.push(F,f-E,t,N,f-E,U,N,f+E,U,N,f+E,U,F,f+E,t,F,f-E,t)},addH:function(s,g,H,D,u,f){var X=this.data,k=X.getTall()/2,w=X.getShapeElevation()+(f?k:-k);s.push(g.x,w,g.y,H.x,w,H.y,D.x,w,D.y,D.x,w,D.y,u.x,w,u.y,g.x,w,g.y)},vf:function(_,V,R,G){var f,H=this,K=H.gv.getFaceVisible(H.data,_);return(R||K)&&(f=Hk(H,_,G),f.vs=[],f.tuv=K&&(f.texture||V)?[]:I,f.visible=K),f}});var Yr=function(h,i){lp(Yr,this,[h,i])};lf(Yr,zc,{_25Q:1,validate:function(z){var u=this,k=u.data,U=u.s,B=k.getPoints(),i=B.size();if(u.shapeModel=u.info=I,i>1){var P=u.info={},r=k.getSegments(),f=k.getThickness(),M=ms(B.get(0)),j=ms(B.get(i-1)),s=i%2;0===s?(P.c1=ms(B.get(i/2-1)),P.c2=ms(B.get(i/2))):P.p3=ms(B.get((i-s)/2)),P.s1=M,P.s2=ms(B.get(1)),P.t1=ms(B.get(i-2)),P.t2=j,P.list=U(Ho)===An?u.createTubeModel(B,r,f/2,z):u.createLineModel(B,r,f,"shape.border","shape.dash")}var V=k.p3(),d=u.mat=Vd();nq(d,V),kc(d,k.getFinalRotation3d(),k.getRotationMode());var E=k.getScale3d(),S=k._dynamicScale3d;S&&(E[0]*=S[0],E[1]*=S[1],E[2]*=S[2]),xh(d,E),nq(d,lk(V))},_80o:function(V,y,X){var E=this,o=E.shapeModel;if(o){var R=E.gv;ug(R,E.mat),Ed(R,E.data,o,E,E.getBodyColor(),X),wm(R)}}});var Ah=o.graph3d.VR=function(D){var z=this;z.gv=D,z._controllers=[],z.switch=new Ie(z),z._enable=!1,z._defaultCallLater=o.Default.callLater,"undefined"!=typeof _&&"VRFrameData"in _&&(z._frameData=new _.VRFrameData),z.measureOflength=1,z.eyesOffset=[0,0,0],z._orientation=new o.Math.Quaternion,z._lastHeadPose=[0,0,0],z._offsetToBeAdd=[0,0,0]};lf(Ah,V,{ms_fire:!0,_42:function(B,e,M,L){var s=this,z=s.gv;if(s._deviceInAction){var O=s._device;if(O){var c=s._measureOflength;O.depthNear=z.getNear()*c,O.depthFar=z.getFar()*c;var l=s._offsetToBeAdd;if(s.eyesOffset[0]+=l[0],s.eyesOffset[1]+=l[1],s.eyesOffset[2]+=l[2],l[0]=0,l[1]=0,l[2]=0,O.isPresenting===!1)return s._controllers.forEach(function(D){D&&D.update()}),z.iv(),!1;var U=s._frameData;O.getFrameData(U);var k=U.pose.position;return k&&(z.setEye(s.toViewPosition(k)),s._orientation.fromArray(U.pose.orientation)),s._controllers.forEach(function(l){l&&l.update()}),B.viewport(0,0,e/2,M),s._viewMatrix=s._copyViewMatrix(U.leftViewMatrix),s._projectMatrix=s._copyProjectMatrix(U.leftProjectionMatrix),L(),B.viewport(e/2,0,e/2,M),s._viewMatrix=s._copyViewMatrix(U.rightViewMatrix),s._projectMatrix=s._copyProjectMatrix(U.rightProjectionMatrix),L(),s._lastViewMatrix=s._viewMatrix,s._lastProjectMatrix=s._projectMatrix,s._viewMatrix=null,s._projectMatrix=null,s.submitFrame(),!0}}},onVRDisplayPresentChange:function(){var j=this.isPresenting();this._injectGraphView(j),this.fp("present",!j,j)},getOrientation:function(){return this._orientation},addController:function(n){n=n||0;var M=this,D=M.getController(n);return D?D:(D=new Sl(M,n),M._controllers.push(D),D)},getController:function(F){F=F||0;for(var w=this._controllers,m=0,o=w.length;o>m;m++)if(w[m]&&w[m].id===F)return w[m];return null},removeController:function(X){X=X||0;for(var T=this._controllers,n=0,v=T.length;v>n;n++)if(T[n]&&T[n].id===X)return T.splice(n,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(e,P){var Z=this,d=Z._scaleFactor,x=Z._eyesOffset,p=Z._lastHeadPose;return p[0]=e[0]*d,p[1]=e[1]*d,p[2]=e[2]*d,P?(P[0]=p[0]+x[0],P[1]=p[1]+x[1],P[2]=p[2]+x[2],P):[p[0]+x[0],p[1]+x[1],p[2]+x[2]]},addEyesOffset:function(r,S,G){var u=this._offsetToBeAdd;u[0]+=r,u[1]+=S,u[2]+=G},_copyViewMatrix:function(X){var z=this.dup(X),F=this._scaleFactor;z[12]*=F,z[13]*=F,z[14]*=F;var G=this._eyesOffset;if(G&&(G[0]||G[1]||G[2])){var l=G[0],M=G[1],V=G[2];z[12]-=z[0]*l+z[4]*M+z[8]*V,z[13]-=z[1]*l+z[5]*M+z[9]*V,z[14]-=z[2]*l+z[6]*M+z[10]*V}return z},shutdown:function(){var v=this._device;v&&v.isPresenting&&v.exitPresent()},isPresenting:function(){var z=this._device;return z&&z.isPresenting},_copyProjectMatrix:function(s){var p=this.dup(s),Y=this._scaleFactor;return p[14]*=Y,p},dup:function(P,B){for(var Y=P.length,A=B||new Array(Y);Y--;)A[Y]=P[Y];return A},getViewMatrix:function(d){var V=this._viewMatrix;return V?this.dup(V,d):void 0},getProjectMatrix:function(){var a=this._projectMatrix;return a?this.dup(a):void 0},submitFrame:function(){var g=this;if(g._enable&&g._deviceInAction){var T=g._device;T&&T.isPresenting&&(T.submitFrame(),g.gv.iv())}},intersectWorld:function(m){var b=this.gv;
return b.intersectObjects(m,b.dm().getDatas())},setDevice:function(T){var l=this;l._device=T},_injectGraphView:function(){var y,A,x;return function($){var I=this.gv;if(!$)return y&&(I.getWidth=y,I.getHeight=A,I.getDevicePixelRatio=x),void 0;var k=this._device,K=k.getEyeParameters("left"),U=K.renderWidth,e=K.renderHeight;y=I.getWidth,A=I.getHeight,x=I.getDevicePixelRatio,I.getWidth=function(){return 2*U},I.getHeight=function(){return e},I.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(M){var n=this;if(!M)return jr=o.Default.callLater=n._defaultCallLater,void 0;var n=this;jr=o.Default.callLater=function(o,K,H,V){var W=n._device;return W&&W.isPresenting?V?w(function(){jr(o,K,H)},V):W.requestAnimationFrame(function(){n._deviceInAction=!0,o.apply(K,H),n._deviceInAction=!1}):n._defaultCallLater(o,K,H,H)}}}),V.defineProperties(Ah.prototype,{enable:{get:function(){return this._enable},set:function(n){var x=this;x._enable!==n&&(x._enable=n,n?(x.switch.showButton(),x._injectCallLaterFunc(!0)):(x.shutdown(),x.switch.hideButton(),x._injectCallLaterFunc(!1)),x.fp("enable",!n,n))}},measureOflength:{get:function(){return this._measureOflength},set:function(B){this._measureOflength=B;var m=this._scaleFactor=1/B;this._controllers.forEach(function(z){z&&z._setScaleFactor(m)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(r){this._eyesOffset=r}},controllerModel:{get:function(){return this._controllerModel},set:function(y){var W;"object"==typeof y?(W=y.mtl,y=y.obj):(W=y+".mtl",y+=".obj");var e=this,Z=e._controllerModel;Z&&Z.obj===y&&Z.mtl===W||(Z=e._controllerModel={obj:y,mtl:W},C.loadObj(y,W,{finishFunc:function(b,U){e._controllerModel===Z&&C.setShape3dModel("vrControllerModel",U)}}))}},interactive:{get:function(){return!!this._interactive},set:function(g){!!g!=!!this._interactive&&(this._interactive=g,g&&this.addController(0),this.gv.getCoreInteractor().enableVR(g))}}});var Sl=function(a,t){function d(v){var o=navigator.getGamepads&&navigator.getGamepads();if(o)for(var H=0,y=0,x=o.length;x>H;H++){var J=o[H];if(J){var q=J.id;if("OpenVR Gamepad"===q||"OpenVR Controller"===q||0===q.indexOf("Oculus Touch")||0===q.indexOf("Spatial Controller")){if(y===v)return J;y++}}}}function W(g,L,Z){return Math.abs(g[0]-L[0])<Z&&Math.abs(g[1]-L[1])<Z&&Math.abs(g[2]-L[2])<Z?!0:!1}var w=this;w.vr=a,w.id=t;var s,T,H=[0,0],q=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],e=new Xp;e.s("shape3d","vrControllerModel"),e.isController=!0,e.s("intersect",!1),w.getGamepad=function(){return T},w.getButtonState=function(g){q.forEach(function(y){return y.id===g?y.pressed:void 0})},w.getNode=function(){return e};var Y=.003;w.setRotationEpsilon=function(K){Y=K};var b=5e-4,r=b;w.setPositionEpsilon=function(z){b=z,r=z*w.vr._scaleFactor},w._setScaleFactor=function(V){e.s3(V,V,V),r=b*V},w._setScaleFactor(w.vr._scaleFactor);var D,E=new un,L=new mj,I=[0,0,0],$=[0,0,0],A=new Zh,o=new be,g=new ee;w.getRay=function(){return D?(g.origin.fromArray(I),g.direction.copy(o),D=!1,g):g},w.update=function(){if(s=T,T=d(t),s!=T&&console.log("gamepad changed",T),!T||T.pose===Z)return T=null,e.s("3d.visible",!1),void 0;if(C.getShape3dModel("vrControllerModel")){e.dm()||a.gv.dm().add(e),e.s("3d.visible",!0);var h=T.pose;if(null!==h){h.position&&(w.vr.toViewPosition(h.position,I),W(e.p3(),I,r)||(D=!0,e.p3(I))),h.orientation&&(E.fromArray(h.orientation),o.set(0,0,-1).applyQuaternion(E).normalize(),L.makeRotationFromQuaternion(E),A.set(0,0,0,e.getRotationMode(),!0).setFromRotationMatrix(L),$[0]=A.x,$[1]=A.y,$[2]=A.z,W(e.r3(),$,Y)||(D=!0,e.r3($))),D&&a.fp("gamepad.pose",null,{position:I,rotation:$,id:t});var J=T.axes;(H[0]!==J[0]||H[1]!==J[1])&&(H=[J[0],J[1]],a.fp("gamepad.axes",null,{id:t,axes:H}));var X,u,N,S,g=T.buttons;for(X=0,u=g.length;u>X;X++)N=g[X],S=N.pressed,S!==q[X].pressed&&(q[X].pressed=S,a.fp("gamepad.button."+q[X].id,null,{id:t,_62O:S?"down":"up"}))}}}},Ie=function(p){this.vr=p,this._button=null};lf(Ie,V,{showButton:function(){var v=this.assureButton();if(!v.parentNode){var R=this.vr.gv,m=R.getView();R._79O?m.insertBefore(v,R._79O):m.appendChild(v)}},hideButton:function(){var e=this._button;e&&e.parentNode&&e.parentNode.removeChild(e)},assureButton:function(){var k=this._button;return k?k:this._button=this.createButton(this.vr.gv)},createButton:function(V){function C(_,C){_.textContent=C&&C.isPresenting?" VR ":" VR "}function I(X){T.style.display="",T.style.cursor="pointer",T.style.left="calc(50% - 50px)",T.style.width="100px",C(T,X),T.onmouseenter=function(){T.style.opacity="1.0"},T.onmouseleave=function(){T.style.opacity="0.5"},T.onclick=function(){X.isPresenting?X.exitPresent():X.requestPresent([{source:V.getCanvas()}])},V.vr.setDevice(X)}function O(){T.style.display="",T.style.cursor="auto",T.style.left="calc(50% - 75px)",T.style.width="150px",C(T,null),T.onmouseenter=null,T.onmouseleave=null,T.onclick=null,V.vr.setDevice(null)}function m(Y){Y.style.position="absolute",Y.style.bottom="20px",Y.style.padding="12px 6px",Y.style.border="1px solid #fff",Y.style.borderRadius="4px",Y.style.color="#000",Y.style.font="normal 13px sans-serif",Y.style.textAlign="center",Y.style.opacity="0.5",Y.style.outline="none",Y.style.zIndex="999"}if("getVRDisplays"in navigator){var T=this._button=z.createElement("button");return T.style.display="none",m(T),_.addEventListener("vrdisplayconnect",function(j){I(j.display)},q),_.addEventListener("vrdisplaydisconnect",function(){O()},q),_.addEventListener("vrdisplaypresentchange",function(c){C(T,c.display),V.vr.onVRDisplayPresentChange()},q),navigator.getVRDisplays().then(function(C){C.length>0?I(C[0]):O()}),T}var g=z.createElement("a");return g.href="https://webvr.info",g.innerHTML=" webvr",g.style.left="calc(50% - 90px)",g.style.width="180px",g.style.textDecoration="none",m(g),g}}),V.defineProperties(Ie.prototype,{}),hj(C,{accordionViewExpandIcon:Kf(Zc),accordionViewCollapseIcon:Kf(Zc,!0),accordionViewLabelColor:Qf,accordionViewLabelFont:Km,accordionViewTitleBackground:Em,accordionViewSelectBackground:Ag,accordionViewSelectWidth:3,accordionViewSeparatorColor:Z,splitViewDividerSize:1,splitViewDividerBackground:Em,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:ph,rect:[2,2,12,12],background:Zc}]},propertyViewLabelColor:Dd,propertyViewLabelSelectColor:Qf,propertyViewLabelFont:Km,propertyViewExpandIcon:Kf(_c),propertyViewCollapseIcon:Kf(_c,!0),propertyViewBackground:uo,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Fm,propertyViewColumnLineColor:Fm,propertyViewSelectBackground:Ag,listViewLabelColor:Dd,listViewLabelSelectColor:Qf,listViewLabelFont:Km,listViewRowLineVisible:!1,listViewRowLineColor:Fm,listViewSelectBackground:Ag,treeViewLabelColor:Dd,treeViewLabelSelectColor:Qf,treeViewLabelFont:Km,treeViewExpandIcon:Kf(wl),treeViewCollapseIcon:Kf(wl,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Fm,treeViewSelectBackground:Ag,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Dd,tableViewLabelSelectColor:Qf,tableViewLabelFont:Km,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Fm,tableViewColumnLineColor:Fm,tableViewSelectBackground:Ag,treeTableViewLabelColor:Dd,treeTableViewLabelSelectColor:Qf,treeTableViewLabelFont:Km,treeTableViewExpandIcon:Kf(wl),treeTableViewCollapseIcon:Kf(wl,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Fm,treeTableViewColumnLineColor:Fm,treeTableViewSelectBackground:Ag,tableHeaderLabelColor:Dd,tableHeaderLabelFont:Km,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:ve,tableHeaderBackground:uo,tableHeaderMoveBackground:fd,tableHeaderInsertColor:Ag,tableHeaderSortDescIcon:Pn(_c,!0),tableHeaderSortAscIcon:Pn(_c),tabViewTabGap:1,tabViewLabelColor:Qf,tabViewLabelFont:Km,tabViewTabBackground:Em,tabViewSelectWidth:3,tabViewSelectBackground:Ag,tabViewMoveBackground:fd,tabViewInsertColor:Ag,toolbarLabelColor:Dd,toolbarLabelSelectColor:Qf,toolbarLabelFont:Km,toolbarBackground:uo,toolbarSelectBackground:Ag,toolbarItemGap:8,toolbarSeparatorColor:yo},!0);var qf={translateX:1,sortColumn:1},xi={sortable:1,sortOrder:1,sortFunc:1},Kl={focusData:1},di={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},nj={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},mo=function(_,Q){Q.add(_),_.hasChildren()&&_.eachChild(function(f){mo(f,Q)})},ql=function(p,T,A,y,b,n,h,Y,V,Q,$){var l,J=A.getValueType(Q),w=A.getAlign(Q);if(A.getEnumValues(Q)){var N=A.toEnumLabel(T,Q),O=Cj||0,k=0,v=n,s=C.getTextSize(y,N).width;return l=wc(A.toEnumIcon(T,Q)),l&&(k=n+Cj/2,"center"===w?k+=(Y-(O+s))/2:"right"===w&&(k=k+Y-(O+s)),od(p,l,k,h+V/2,Q,$),v=k+Cj/2),N!=I&&(l?Ni(p,N,y,b,v,h,Y-(v-n),V):Ni(p,N,y,b,n,h,Y,V,w)),void 0}return T=A.formatValue(T),T!=I?J===hs?(Uc(p,n,h,Y,V,T),void 0):J===jj||!J&&Ep(T)?(l=wc(T?ke:Np),od(p,l,n+Y/2,h+V/2,Q,$),void 0):(Ni(p,T,y,b,n,h,Y,V,w),void 0):void 0},no=function(u,x){var j=x.view,s=hi(u),k=x.column||x.property;j.getDataModel().beginTransaction(),x.editor=u,u.info=x,j.setCurrentEditor(u),j.getView().insertBefore(s,j._79O),Pi(u,x.editorRect),u.setFocus?u.setFocus():mr(u),u.commitValue=function(B,r){u._17Q&&(u=u._17Q),r||j.setValue(x.data,k,u.getValue?u.getValue():u.value),u.close&&u.close(),gg(s)},k.onEditorCreated&&k.onEditorCreated(x)},Hr=function(U,_,y,g,M){var t=ps(U,y),d=_.value,F=_.view,B=M.getValueType(_.data);return t.onblur=t.onchange=function(){F.endEditing()},"input"===U?(d=M.formatValue(d),d!=I&&(t.value=d),t.onkeydown=function(P){Bo(P)?F.endEditing():br(P)&&F.endEditing(!0)},(B===Vi||B===Ej)&&t.addEventListener(zr,C.numberListener,q)):U===ud&&g.forEach(function(j){var v=z.createElement("option");v.innerHTML=M.toEnumLabel(j),v.value=j,M.isEnumEqual(d,j)&&(v.selected=!0),yj(t,v)}),no(t,_),t},Mh=o.widget={},iq=function(z,q,b){lf(j+".widget."+z,q,b)};hj(Zl,{ms_value:function(J){J.getValue=function(N){var X=this.getItemById(N),U=X.element;return hf(U)?U:U?U.getValue?U.getValue():U.value:X.selected},J.setValue=function(Q,K){var $=this.getItemById(Q);if($){var g=$.element;g&&!hf(g)?g.setValue?g.setValue(K):g.value=K:Ep(K)?($.selected=K,this.iv()):($.element=K,this.iv())}},J.v=function(S,X){var k=this;if(2===arguments.length)k.setValue(S,X);else{if(!Ui(S))return k.getValue(S);for(var I in S)k.setValue(I,S[I])}return k}},_46o:function(t){t._icon=I,t._accessType=I,t._valueType=I,t._editable=!1,t._batchEditable=!0,t._align=_h,t._nullable=!0,t._emptiable=!1,t.setParent=ak,t.formatValue=function(K){var p=this,V=p._valueType;return p.getEnumValues()?p.toEnumLabel(K):V===jj?!!K:K!=I&&V===Vi?u(K):K},t.setEnum=function(w,d,q,E,p,A,Y){var o=this;w&&!sk(w)&&w.values&&(E=w.editable,q=w.icons,d=w.labels,p=w.strict,A=w.maxHeight,Y=w.dropDownWidth,w=w.values),xq(w)&&(w=w._as),xq(d)&&(d=d._as),xq(q)&&(q=q._as),o._enumValues=w,o._enumLabels=d,o._enumIcons=q,o._enumEditable=E,o._enumStrict=p==I?!0:p,o._enumMaxHeight=A,o._enumDropDownWidth=Y,w&&w.length&&ip(w[0])&&(o._valueType=Ej),o.fp("enum",!1,!0)},t.getEnumDropDownWidth=function(){return this._enumDropDownWidth},t.getEnumMaxHeight=function(){return this._enumMaxHeight},t.isEnumEditable=function(){return this._enumEditable},t.getEnumValues=function(){return this._enumValues},t.getEnumLabels=function(){return this._enumLabels},t.getEnumIcons=function(){return this._enumIcons},t.isEnumStrict=function(){return this._enumStrict},t.isEnumEqual=function(J,G){return this._enumStrict?J===G:J==G},t.toEnumLabel=function(A,O){var m=this,X=m.getEnumValues(O),_=m.getEnumLabels(O);if(X&&_)for(var Y=0;Y<X.length;Y++)if(m.isEnumEqual(A,X[Y]))return _[Y];return A},t.toEnumIcon=function(n,h){var r=this,M=r.getEnumValues(h),W=r.getEnumIcons(h);if(M&&W)for(var j=0;j<M.length;j++)if(r.isEnumEqual(n,M[j]))return W[j];return Z}},_45o:function(m){m._87o=function(V,O,E,X,T,y){if(V){var F=this,u=F._90I,g=jd(1);F._columnLineVisible&&(T-=1),F._rowLineVisible&&(y-=1),0>=T||0>=y||(F._90I||(u=F._90I={}),u[O]||(u[O]=new mk),Pi(g,F.tx()+E,F.ty()+X,T,y),yj(g,V),F._view.insertBefore(g,F._79O),V.onParentAdded&&V.onParentAdded(g),u[O].add(g))}},m._76o=function(){var N=this,d=N._90I;if(d){for(var i in d)d[i].each(function(M){gg(M)});delete N._90I}},m._77o=function(S){var X=this;if(X._90I){var F=X._90I[S];F&&(F.each(function(o){gg(o)}),delete X._90I[S])}}},_47o:function(M){M.getValue=function(u,S){return S.getValue?S.getValue(u,S,this):mb(u,S.getAccessType(),S.getName())},M.setValue=function(N,H,K){if(H.isEmptiable(N)||""!==K||(K=Z),H.isNullable(N)||K!=I){var x=this,r=H.getName(N),$=H.getAccessType(N),h=H.getValueType(N);h===Vi&&hf(K)?K=a(K):h===Ej&&hf(K)?K=parseFloat(K):h===jj&&hf(K)&&(K="true"===K),x._batchEditable&&H._batchEditable&&x.isSelected(N)?x.sm().each(function(v){H.setValue?H.setValue(v,H,K,x):Nj(v,$,r,K)}):H.setValue?H.setValue(N,H,K,x):Nj(N,$,r,K)}},M.setCurrentEditor=function(X){this.endEditing(),this._currentEditor=X,this.redraw()},M.isEditing=function(g,Z){var p=this,B=p._currentEditor;if(!B)return!1;if(Z){var i=B.info;return i?(i.column||i.property)===Z&&i.data===g:!1}return!0},M.endEditing=function(E){var y=this,q=y._currentEditor;q&&(delete y._currentEditor,q.commitValue&&q.commitValue(q.info,E),y.redraw(),y.getDataModel().endTransaction())},M.beginEditing=function(M){this.endEditing();var d=this,A=M.column||M.property;if(A.beginEditing)A.beginEditing(M);else{var Z=M.data,l=M.value,s=d.getSelectBackground(Z),m=A.getEnumValues(Z),W=A.getSlider(Z),b=A.getColorPicker(Z);if(W){var K=ll(Mh.Slider,W);return K.setValue(l),K.getView().onblur=function(){d.endEditing()},K.isInstant()&&(K.onValueChanged=function(){d.setValue(Z,A,K.getValue())}),no(K,M),void 0}if(b||A.getValueType(Z)===hs){var N=ll(Mh.ColorPicker,b);return N.setValue(l),N.onClosed=function(){d.endEditing()},N.isInstant()&&(N.onValueChanged=function(F,j){d.setValue(Z,A,j)}),no(N,M),N.open(),void 0}if(m){if(Mh.ComboBox){var h=new Mh.ComboBox;h.setValue(l),h.setValues(m),h.setLabels(A.getEnumLabels(Z)),h.setIcons(A.getEnumIcons(Z)),h.setEditable(A.isEnumEditable(Z)),h.setStrict(A.isEnumStrict(Z)),h.setMaxHeight(A.getEnumMaxHeight(Z)),h.setDropDownWidth(A.getEnumDropDownWidth(Z)),h.onClosed=function(){d.endEditing()},no(h,M),h.open()}else Hr(ud,M,s,m,A);return}var P=A.getValueType(Z);if(P===jj||Ep(l))return d.setValue(Z,A,!l),void 0;if(A.getItemEditor(Z)){var t=tf(A.getItemEditor(Z)),U=new t(Z,A,d,M),X=U.getView();return X._17Q=U,U.setValue(l),Qq(X),no(X,M),U.editBeginning&&U.editBeginning(),void 0}Hr("input",M,s,I,A)}}},_44o:function(Z){Z.init=function(b){var p=this,q=p.th=new en(b),a=p._view=zg(1,p);p.tv=p._tableView=b,yj(a,q.getView()),yj(a,b.getView()),q.mp(function(y){y.property===wi&&p.iv()}),p.iv()},Z.getTableView=function(){return this.tv},Z.getTableHeader=function(){return this.th},Z.getDataModel=function(){return this.tv.dm()},Z.getColumnModel=function(){return this.tv.getColumnModel()},Z.setColumns=function(E){this.tv.setColumns(E)},Z.addColumns=function(G){this.tv.addColumns(G)},Z.endEditing=function(){this.tv.endEditing()},Z.validateImpl=function(){var h=this,E=h.th,$=Wc(E),A={x:0,y:0,width:h.getWidth(),height:$};Pi(E,A),A.y=$,A.height=K(0,h.getHeight()-$),Pi(h.tv,A)}},ms_vs:function(A){A._41o=function(){return this._29I.height<this._59I},A._43o=function(){var f=this;f._41o()&&(f._58I||(w(function(){f._94O()},Qo),f.iv()),f._58I=new Date)},A._94O=function(){var t=this;if(t._58I){var y=new Date;y.getTime()-t._58I.getTime()>=Qo?(delete t._58I,t.iv()):w(function(){t._94O()},Qo)}},A._93I=function(){var S=this,v=S._27I;if(S._58I||!S._autoHideScrollBar){v||yj(S._79O,v=S._27I=jd());var h=S._29I,r=h.height,b=S._59I,Q=S.getScrollBarSize(),t=h.width-Q-2,f=r*(-S.ty()/b),k=r*(r/b),H=v.style;b>r?(je>k&&(f=f+k/2-je/2,0>f&&(f=0),f+je>r&&(f=r-je),k=je),H.visibility=qs,H.background=S.getScrollBarColor(),H.borderRadius=Q/2+hr,Pi(v,t,f,Q,k)):H.visibility=Co}else v&&(v.style.visibility=Co)}},ms_hs:function(T){T._40o=function(){return this._29I.width<this._91I},T._42o=function(){var $=this;$._40o()&&($._95O||(w(function(){$._94I()},Qo),$.iv()),$._95O=new Date)},T._94I=function(){var Z=this;if(Z._95O){var h=new Date;h.getTime()-Z._95O.getTime()>=Qo?(delete Z._95O,Z.iv()):w(function(){Z._94I()},Qo)}},T._92I=function(){var C=this,j=C._28I;if(C._95O||!C._autoHideScrollBar){j||yj(C._79O,j=C._28I=jd());var S=C._29I,l=S.width,A=C._91I,k=C.getScrollBarSize(),X=S.height-k-2,q=l*(-C.tx()/A),Q=l*(l/A),W=j.style;A>l?(je>Q&&(q=q+Q/2-je/2,0>q&&(q=0),q+je>l&&(q=l-je),Q=je),W.visibility=qs,W.background=C.getScrollBarColor(),W.borderRadius=k/2+hr,Pi(j,q,X,Q,k)):W.visibility=Co}else j&&(j.style.visibility=Co)}}}),Fe(ke,Bg(16,16,[{type:am,rect:[1,1,14,14],background:Ag},{type:nm,rect:[1,1,14,14],width:1,color:aj},{type:Be,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Fe(Np,Bg(16,16,{type:nm,rect:[1,1,14,14],width:1,color:aj})),Fe(Ck,Bg(16,16,[{type:Xr,rect:[2,2,12,12],borderWidth:1,borderColor:aj,background:"#FFF"},{type:Xr,rect:[4,4,8,8],background:Ag}])),Fe(ab,Bg(16,16,{type:Xr,rect:[2,2,12,12],borderWidth:1,borderColor:aj})),Zl._15Q=function(T){T._29I=Lg,T._59I=0,T._91I=0,T._5o=function(S){var D=this;D._30I=new mk,D._rows=new mk,D._rowMap={},D._31I=0,D._14I=0,D._view=zg(1,D),D._canvas=wo(D._view),yj(D._view,D._79O=jd()),D.dm(S?S:new Ve)},T.getCheckIcon=function(S){var y=this.sm(),F=y.co(S);return y.sg()?wc(F?Ck:ab):wc(F?ke:Np)},T.checkData=function(H){var P=this.sm(),k=P.co(H);P.sg()&&k||(this._32o=1,k?P.rs(H):P.as(H),delete this._32o)},T.getDataAt=function(Z){Z.target&&(Z=this.lp(Z));var r=B(Z.y/this._rowHeight),N=this._rows;return 0>r||r>=N.size()?I:N.get(r)},T.onDataDoubleClicked=function(){},T.onDataClicked=function(){},T.adjustTranslateX=function(){return 0},T.adjustTranslateY=function(O){var v=this.getHeight()-this._59I;return v>O&&(O=v),O>0?0:u(O)},T.onPropertyChanged=function(X){var F=this,H=X.property;di[H]?F.ivm():Kl[H]||F.redraw(),H===Bi?F._42o():H===Bc&&F._43o()},T.getLabel=function(Z){return Z.toLabel()},T.getLabelFont=function(){return this._labelFont},T.getLabelColor=function(E){var c=this;if(c.isCheckMode()){if(c._focusData===E)return c._labelSelectColor}else if(c.isSelected(E))return c._labelSelectColor;return c._labelColor},T.getStartRowIndex=function(){return this._31I},T.getEndRowIndex=function(){return this._14I},T.getRowDatas=function(){return this._rows},T.getRowIndex=function(S){return this._rowMap[S._id]},T.getRowSize=function(){return this._rows.size()},T.getViewRect=function(){return Tm(this._29I)},T.isVisible=function(x){return this._visibleFunc?this._visibleFunc(x):!0},T.getCurrentSortFunc=function(){return this._sortFunc},T.setDataModel=function(s){var O=this,c=O._dataModel,v=O._selectionModel;c!==s&&(c&&(c.umm(O.handleDataModelChange,O),c.umd(O.handleDataPropertyChange,O),c.umh(O.handleHierarchyChange,O),v||c.sm().ums(O.handleSelectionChange,O)),O._dataModel=s,s.mm(O.handleDataModelChange,O),s.md(O.handleDataPropertyChange,O),s.mh(O.handleHierarchyChange,O),v?v._21I(s):s.sm().ms(O.handleSelectionChange,O),O.fp("dataModel",c,s))},T.validateModel=function(){var L=this;L._rows.clear(),L._rowMap={},L.buildChildren(L._dataModel._roots);var h=L._rows=L._rows.toList(L.isVisible,L),w=0,W=L.getCurrentSortFunc(),m=h.size();for(W&&h.sort(W);m>w;w++)L._rowMap[h.get(w)._id]=w},T.buildChildren=function(o){var V=this;o.each(function(l){V._rows.add(l),V.buildChildren(l._children)})},T.handleDataModelChange=function(){this.ivm()},T.handleDataPropertyChange=function(Z){"parent"===Z.property?this.ivm():this.invalidateData(Z.data)},T.handleHierarchyChange=function(){this.ivm()},T.handleSelectionChange=function(O){O.datas.each(this.invalidateData,this),this.onSelectionChanged(O)},T.onSelectionChanged=function(_){var b=this,n=b.sm();!b.isAutoMakeVisible()||1!==n.size()||"set"!==_.kind&&"append"!==_.kind||b._32o||b.makeVisible(n.ld())},T.handleBackgroundClick=function(k){Ei(k)&&!this.isCheckMode()&&this.sm().cs()},T.makeVisible=function(R){R&&(this._23I=R,this.iv())},T.scrollToIndex=function(O){var q=this,b=q._29I,h=b.height,k=q._rowHeight,y=k*O;O>=0&&O<q._rows.size()&&h>0&&(y+k>b.y+h?q.ty(-y+h-k):y<b.y&&q.ty(-y))},T.autoScroll=function(G,D){var w=this,u=w._rowHeight,t=u,H=u/4,C=w._29I,d=w.lp(G),U={x:w.tx(),y:w.ty()};return u>0&&C&&(d.x-C.x<t?w.translate(H,0):C.x+C.width-d.x<t&&w.translate(-H,0),d.y-C.y<t?w.translate(0,H):C.y+C.height-d.y<t&&w.translate(0,-H)),U.x=w.tx()-U.x,U.y=w.ty()-U.y,D&&(D.x+=U.x,D.y+=U.y),U},T.getTopRowOrderSelection=function(){var Z=this.sm().getTopSelection(),a={},t=new mk;return Z.each(function(k){a[k._id]=k}),this._rows.each(function($){a[$._id]&&t.add($)}),t},T.getRowOrderSelection=function(){var N=new mk;return this._rows.each(function(K){this.isSelected(K)&&N.add(K)},this),N},T.ivm=function(){this.invalidateModel()},T.invalidateModel=function(){var U=this;U._96I||(U._96I=1,U._32I=1,delete U._24I),U.iv()},T.redraw=function(){var x=this;x._32I||(x._32I=1,delete x._24I,x.iv())},T.invalidateData=function(h){var o=this;p?o.redraw():o._32I||(o._24I||(o._24I={}),o._24I[h._id]=h,o.iv())},T.getFocusData=function(){return this._focusData},T.setFocusDataById=function(t){this.setFocusData(this.dm().getDataById(t))},T.setFocusData=function(j){var k=this,A=k._focusData;A!==j&&(k._focusData=j,k.fp("focusData",A,j),A&&k.invalidateData(A),j&&(k.invalidateData(j),k.isAutoMakeVisible()&&k.makeVisible(j)))},T.drawRowBackground=function(Z,I,v,X,i,u,S){var T=this,q=T.isCheckMode();(I===T._focusData&&q||v&&!q)&&Uc(Z,X,i,u,S,T.getSelectBackground(I))},T.drawData=function(c,f,m){var L=this,W=L._rowHeight,z=W*m,n=L._29I,X=n.x,O=n.width;c.save(),c.beginPath(),c.rect(X,z,O,W),c.clip(),L._87o(L.drawRow(c,f,L.isSelected(f),X,z,O,W),m,X,z,O,W),c.restore(),L._rowLineVisible&&Uc(c,X,z+W-1,O,1,L._rowLineColor)},T._12I=function(O){var q=this,i=q._31I,B=q._29I,G=B.x,S=B.y,F=B.width,V=B.height;for(O.beginPath(),O.rect(G,S,F,V),O.clip(),O.clearRect(G,S,F,V),q._76o(),q._93db(O);i<q._14I;i++)q.drawData(O,q._rows.get(i),i);q._92db(O)},T._13I=function($){for(var m,X=this,o=X._rowHeight,P=X._29I,l=P.x,Z=P.width,e=X._31I,G=X._30I;e<X._14I;e++)m=X._rows.get(e),X._24I[m._id]&&G.add({data:m,index:e});G.isEmpty()||($.beginPath(),G.each(function(A){$.rect(l,A.index*o,Z,o)}),$.clip(),G.each(function(S){$.clearRect(l,S.index*o,Z,o)}),G.each(function(Z){X._77o(Z.index)}),X._93db($),G.each(function(E){X.drawData($,E.data,E.index)}),X._92db($),G.clear())},T.preValidateModel=function(){this.endEditing&&this.endEditing()},T.validateImpl=function(){var z=this,Z=z._canvas,T=z.getWidth(),E=z.getHeight(),x=z._rowHeight,w=z._32I;(T!==Z.clientWidth||E!==Z.clientHeight)&&(sg(Z,T,E),w=1);var R=k&&!P;z._96I&&!R&&(z.preValidateModel(),z.validateModel());var q=z._29I,c={x:-z.tx(),y:-z.ty(),width:T,height:E},e=z._rows.size(),o=Yl(Z),u=z._23I;w||Ff(c,q)||(w=1),z._29I=c,z._59I=e*x,z._31I=B(c.y/x),z._14I=h((c.y+c.height)/x),z._31I<0&&(z._31I=0),z._14I>e&&(z._14I=e),z._99I&&w&&z._99I(),Fb(o,z.tx(),z.ty(),1),w?z._12I(o):z._24I&&z._13I(o),z._93I(),z._92I(),o.restore(),z._32I=z._24I=z._96I=I,u&&(z.scrollToIndex(z.getRowIndex(u)),delete z._23I),z.tx(z.tx()),z.ty(z.ty())}},Zl._48o=function(o){o._rootVisible=!0,o._rootData=I,o._35o=function(){this._expandMap={},this._levelMap={}},o.validateModel=function(){var q=this,R=q._rootData;q._rows.clear(),q._levelMap={},q._rowMap={},q._currentLevel=0,R?q._rootVisible?q.isVisible(R)&&q.buildData(R):q.buildChildren(R):q.buildChildren(),delete q._currentLevel},o.buildData=function(q){var n=this,S=q._id,z=n._rows;n._rowMap[S]=z.size(),z.add(q),n._levelMap[S]=n._currentLevel,n.isExpanded(q)&&(n._currentLevel++,n.buildChildren(q),n._currentLevel--)},o.buildChildren=function(A){var y=this,P=A?A._children:y._dataModel._roots,d=y.getCurrentSortFunc();d&&y.isChildrenSortable(A)?P.toList(y.isVisible,y).sort(d).each(y.buildData,y):P.each(function(n){y.isVisible(n)&&y.buildData(n)})},o.getLevel=function(e){return this._levelMap[e._id]},o.getToggleIcon=function(_){var P=this,D=P._loader,o=P._collapseIcon;return D&&!D.isLoaded(_)?o:_.hasChildren()?P.isExpanded(_)?P._expandIcon:o:I},o.isCheckMode=function(){return this._checkMode!=I},o.isChildrenSortable=function(){return!0},o.handleDataModelChange=function(T){var H=this;T.kind===Wg?delete H._expandMap[T.data._id]:T.kind===kf&&(H._expandMap={}),H.ivm()},o.toggle=function(N){var x=this;x.isExpanded(N)?x.collapse(N):x.expand(N)},o.isExpanded=function(m){return 1===this._expandMap[m._id]},o.expand=function(B){var i=this,b=i._loader;i.isExpanded(B)||(b&&!b.isLoaded(B)&&b.load(B),i._expandMap[B._id]=1,i.ivm(),i.onExpanded(B))},o.onExpanded=function(){},o.collapse=function(L){var G=this;G.isExpanded(L)&&(delete G._expandMap[L._id],G.ivm(),G.onCollapsed(L))},o.onCollapsed=function(){},o.expandAll=function(Z){if(Z)this.expand(Z),Z.eachChild(function(W){this.expandAll(W)},this);else{var i=this;i._dataModel.each(function(h){h.hasChildren()&&(i._expandMap[h._id]=1)}),i.ivm()}},o.collapseAll=function(){this._expandMap={},this.ivm()},o.makeVisible=function(W){if(W){var z=this;if(!z._rootData||W.isDescendantOf(z._rootData)){for(var p=W._parent;p;)z.expand(p),p=p._parent;z._23I=W,z.iv()}}},o.checkData=function(_){var n,b=this,A=b._checkMode,p=b.sm(),d=p.co(_);if(!p.sg()||!d){if(b._32o=1,A===wr)d?p.rs(_):p.as(_);else if(A===Jq)n=new mk(_),n.addAll(_._children);else if("descendant"===A)n=new mk,mo(_,n);else if("all"===A&&(n=new mk,mo(_,n),!d))for(var j=_._parent;j;)n.add(j),j=j._parent;n&&(d?p.rs(n):p.as(n)),delete b._32o}},o._97I=function(V,j,m,v,t,F,n){var K=this,o=K._indent,C=K._levelMap[j._id],d=K.getIconWidth(j),x=wc(K.getToggleIcon(j));x?(v+=o*C,od(V,x,v+o/2,t+n/2,j,K),v+=o):v+=o*(C+1),K._checkMode&&(od(V,K.getCheckIcon(j),v+o/2,t+n/2,j,K),v+=o),K.drawIcon(V,j,v,t,d,n),K.drawLabel(V,j,v+d,t,n)}},Zl._14Q=function(I){I.getIcon=function(l){return l.getIcon()},I.getIconWidth=function(z){return this.getIcon(z)?this._indent:0},I.drawIcon=function(F,o,R,b,T,q){if(T){var I=this,s=I.getBodyColor(o),h=wc(I.getIcon(o),s);h&&(q-=I.isRowLineVisible()?1:0,Do(F,h,Rb,R,b,T,q,o,I,s),Qe(F,I.getBorderColor(o),R,b,T,q))}},I.drawLabel=function(l,H,s,Y,g){var z=this;Ni(l,z.getLabel(H),z.getLabelFont(H),z.getLabelColor(H),s,Y,0,g)}},Zl._50o=function(s){s._98I=function(){var j=this,b=j._39o=new Ve;j._60I=new mk,b.mm(j._17o,j),b.md(j._18o,j),b.mh(j._19o,j)},s.setColumns=function(W){this._39o.clear(),this.addColumns(W)},s.addColumns=function(O){var U=this._39o;O.forEach(function(x){if(!(x instanceof Vc)){var z=tf(x.className);x=ll(z?z:Vc,x)}U.add(x)})},s.onColumnClicked=function(){},s.onCheckColumnClicked=function(){},s._3Q=function(C){for(var n,j=0,A=this._60I,$=A.size();$>j;j++)if(n=A.get(j),n.column===C)return n;return I},s.getColumnAt=function(u){var D=this._4Q(u);return D?D.column:I},s._4Q=function(y){for(var T=this,$=y.target?T.lp(y).x:y.x,l=T._60I,k=0;k<l.size();k++){var Q=l.get(k),w=Q.startX;if($>=w&&$<w+Q.column.getWidth())return Q}return I},s.getToolTip=function(i){var U=this,P=U.getDataAt(i),G=U.getColumnAt(i);return P&&G?G.getToolTip(P,U):I},s.adjustTranslateX=function(r){var n=this.getWidth()-this._91I;return n>r&&(r=n),r>0?0:u(r)},s._99I=function(){var U=this,X=U._29I,n=U._60I;n.clear(),U._91I=0,U._39o._roots.each(function(T){if(T.isVisible()){var e=U._91I+T.getWidth();U._91I<=X.x+X.width&&e>=X.x&&n.add({column:T,startX:U._91I}),U._91I=e}})},s.drawData=function(J,O,o){var f=this,x=f._rowHeight,D=x*o,X=f.isSelected(O),m=f._29I,q=m.x,T=m.width;f.drawRowBackground(J,O,X,q,D,T,x),f._60I.each(function(T){var $=T.column,w=T.startX,C=$.getWidth();C>0&&!f.isEditing(O,$)&&(J.save(),J.beginPath(),J.rect(w,D,C,x),J.clip(),f._87o(f.drawCell(J,O,X,$,w,D,C,x),o,w,D,C,x),f._columnLineVisible&&Uc(J,w+C-1,D,1,x,f._columnLineColor),J.restore())}),f._rowLineVisible&&Uc(J,q,D+x-1,T,1,f._rowLineColor)},s.drawCell=function(P,O,L,M,I,c,G,v){var Z=this;if(M.drawCell)return M.drawCell(P,O,L,M,I,c,G,v,Z);var z=Z.getValue(O,M);ql(P,z,M,Z.getLabelFont(O,M,z),Z.getLabelColor(O,M,z),I,c,G,v,O,Z)},s.getColumnModel=function(){return this._39o},s._17o=function(){this.redraw()},s._18o=function(f){var $=this;f.data===$._sortColumn&&xi[f.property]?$.ivm():($._42o(),$.redraw())},s._19o=function(){this.redraw()},s.getCurrentSortFunc=function(){var i=this,v=i._sortColumn;if(v&&v.isSortable()){var U=v.getSortFunc(),V=rj===v.getSortOrder()?1:-1;return U||(U=Ok),function(R,d){return U.call(i,i.getValue(R,v),i.getValue(d,v),R,d)*V}}return i._sortFunc},s.isCellEditable=function(e,H,l){return H.isEditable()&&this.isEditable()?H.isCellEditable?H.isCellEditable(e,H,l,this):!0:!1},s._37O=function(P,t){if(Ei(t))for(var D=this,Y=D.lp(t),C=D._60I,V=D._rowHeight,u=D._29I,Z=u.x,q=u.y,L=u.width,g=u.height,X=0;X<C.size();X++){var U=C.get(X),l=U.startX,E=U.column,H=E.getWidth();if(E!==D._31o&&E!==D._4o&&Y.x>=l&&Y.x<l+H&&D.isCellEditable(P,E,t)){var O={x:l,y:D.getRowIndex(P)*V,width:H,height:V},s={x:O.x+D.tx(),y:O.y+D.ty(),width:O.width,height:O.height},v=0,k=0;return O.x<Z?v=O.x-Z:O.x+O.width>Z+L&&(v=O.x+O.width-Z-L),v&&(D.tx(D.tx()-v),s.x-=v),O.y<q?k=O.y-q:O.y+V>q+g&&(k=O.y+V-q-g),k&&(D.ty(D.ty()-k),s.y-=k),D.beginEditing({data:P,column:E,value:D.getValue(P,E),event:t,rect:O,editorRect:s,view:D}),void 0}}}},Mh.BaseItemEditor=function(H,r,P,b){this._data=H,this._column=r,this._master=P,this._editInfo=b},iq("BaseItemEditor",V,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var sn=o.Tab=function(){lp(sn,this)};Sb("Tab",Tn,{ms_ac:["view","closable","disabled"],_icon:I,_closable:!1,_disabled:!1,setParent:ak});var Vc=o.Column=function(){lp(Vc,this)};Sb("Column",Tn,{_46o:1,ms_ac:["accessType","valueType",qs,ur,ie,Qd,"align",hs,"sortOrder",zf,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:rj,_sortFunc:I,_sortable:!0,_clickable:!0,setWidth:function(D){16>D&&(D=16);var H=this._width;this._width=D,this.fp(Qd,H,D)},getToolTip:function(z,x){return this.formatValue(x.getValue(z,this))}});var ii=o.Property=function(){lp(ii,this)};Sb("Property",Tn,{_46o:1,ms_ac:["accessType","valueType",ur,ie,"categoryName",hs,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:I,getToolTip:function(Q,O,f){var K=this;return O?K.formatValue(f.getValue(Q,K)):f.getPropertyName(K)}}),Mh.AccordionView=function(){var i=this;i._20o={},i._21o=new mk,i._10o=I,i._9o=I,i._11o=I,i._view=zg(0,i),i.iv()},iq("AccordionView",V,{ms_v:1,ms_fire:1,ms_ac:[Td,Eb,"titleHeight",bq,ce,"titleBackground","selectWidth",Dh,"orientation","separatorColor"],_expandIcon:C.accordionViewExpandIcon,_collapseIcon:C.accordionViewCollapseIcon,_titleHeight:Vr,_labelColor:C.accordionViewLabelColor,_labelFont:C.accordionViewLabelFont,_titleBackground:C.accordionViewTitleBackground,_selectBackground:C.accordionViewSelectBackground,_selectWidth:C.accordionViewSelectWidth,_orientation:"v",_separatorColor:C.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(l,x,s,v){var t=this,V=jd();if(t._20o[l])throw l+" already exists";V.onmousedown=Pd,V.style.cursor=hc,V.addEventListener(Xm?gn:sd,function(A){Pd(A)},q),V.addEventListener(Xm?pg:Fj,function(N){Pd(N),Ei(N)&&(t._10o===l?t.collapse():t.expand(l))},q),yj(t._view,V),t._20o[l]={content:x,div:V,canvas:wo(V),icon:v},t._21o.add(l),s&&t.expand(l),t.iv()},remove:function(J){var F=this,m=F._20o[J];m&&(gg(m.div),delete F._20o[J],F._21o.remove(J),F.iv())},clear:function(){var k=this;k._21o.toArray().forEach(k.remove,k),k._20o={},k._21o.clear(),k.iv()},isExpanded:function(q){return this._10o===q},expand:function(Y){var D=this;D._20o[Y]&&D._10o!==Y&&(D._10o=Y,D.onExpanded(Y),D.iv())},onExpanded:function(){},collapse:function(){var T=this;T._10o&&(T.onCollapsed(T._10o),delete T._10o,T.iv())},onCollapsed:function(){},initCanvas:function(J,b,j){sg(J,b,j);var D=Yl(J);return Fb(D,0,0,1),D.clearRect(0,0,b,j),D
},drawTitle:function(l,O,j,n,H){var i=this,x=wc(H.icon),C=i.isExpanded(O),o=i._titleHeight,e=i._titleBackground,r=i._selectWidth,c=i._separatorColor,p=wc(C?i._expandIcon:i._collapseIcon),G=r+4;Uc(l,0,0,j,n,e),C&&r&&Uc(l,0,0,r,n,i._selectBackground),(C||i._21o.get(i._21o.size()-1)!==O)&&Uc(l,0,n-1,j,1,c?c:he(e)),x&&(od(l,x,G+Rn(x)/2,o/2),G+=Rn(x)+2),Ni(l,O,i.getLabelFont(O),i.getLabelColor(O),G,0,0,o),p&&od(l,p,j-Rn(p)/2-4,o/2)},validateImpl:function(){var h=this,P=h._view,m=0,w=0,n=h.getWidth(),g=h.getHeight(),d=h._titleHeight,q=h._21o.size()*d,k=h._11o,$=h._9o;delete h._11o,delete h._9o,h._21o.each(function(c){var v,U,I=h._20o[c],B=I.content,P=h._10o===c;tj(h)?(Pi(I.div,m,0,d,g),v=h.initCanvas(I.canvas,d,g),Uf(v,0,g),Fq(v,-b),h.drawTitle(v,c,g,d,I),v.restore(),P?(U=K(0,n-q),B&&(h._11o=B,h._9o=hi(B),Pi(B,m+d,0,U,g)),m+=d+U):m+=d):(Pi(I.div,0,w,n,d),v=h.initCanvas(I.canvas,n,d),h.drawTitle(v,c,n,d,I),v.restore(),P?(U=K(0,g-q),B&&(h._11o=B,h._9o=hi(B),Pi(B,0,w+d,n,U)),w+=d+U):w+=d)});var f=h._9o;k&&k!==h._11o&&k.endEditing&&k.endEditing(),f&&f!==$&&yj(P,f),$&&$!==f&&gg($)}}),Mh.SplitView=function(a,T,p,N){var S=this,O=S._dividerDiv=jd(),R=S._60O=wo(),Y=S._61O=wo(),y=R.style,r=Y.style;S._view=zg(1,S),yj(S._view,O),y.msTouchAction=of,y.pointerEvents=of,y.cursor=hc,r.msTouchAction=of,r.pointerEvents=of,r.cursor=hc,a&&S.setLeftView(a),T&&S.setRightView(T),p&&S.setOrientation(p),N!=I&&S.setPosition(N),S.setStatus(ge),new nh(S)},iq("SplitView",V,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:C.splitViewDividerSize,_dividerBackground:C.splitViewDividerBackground,_dragOpacity:C.splitViewDragOpacity,_toggleIcon:C.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(w,M){var G=this,d=G._position;isNaN(w)||(M||(G._82O=0>w?-1:w>1?1:0),G._position=w,G.fp(ob,d,w))},getLeftView:function(){return this._leftView},setLeftView:function(F){var D=this,L=D._leftView,d=D._view;if(D._leftView!==F){if(L&&L!==D._rightView){var v=hi(L);v.parentNode===d&&gg(v)}if(D._leftView=F,F){var a=hi(F);a.parentNode!==d&&d.insertBefore(a,D._dividerDiv)}D.fp("leftView",L,F)}},getRightView:function(){return this._rightView},setRightView:function(q){var y=this,K=y._rightView,H=y._view;if(y._rightView!==q){if(K&&K!==y._leftView){var E=hi(K);E.parentNode===H&&gg(E)}if(y._rightView=q,q){var D=hi(q);D.parentNode!==H&&H.insertBefore(D,y._dividerDiv)}y.fp("rightView",K,q)}},validateImpl:function(){var U=this,B=U._draggable,j=U._position,W=U.getWidth(),S=U.getHeight(),L=U._dividerSize,A=U._dividerBackground,p=Xm?18:8,v=U._dividerDiv,O=U._82O,I=U._60O,q=U._61O,s=U._toggleIcon,M=U._status,P=v.style,J=null,R=Xm?20:4,V=s.comps[0];L>=p||0===L?U._coverDiv&&(gg(U._coverDiv),delete U._coverDiv):U._coverDiv||(U._coverDiv=jd(),$&&(U._coverDiv.style.background=wq),yj(v,U._coverDiv)),U._togglable?I.parentNode||(yj(v,I),yj(v,q)):(gg(I),gg(q));var y=U._coverDiv,T=U._leftView,k=U._rightView;if(tj(U)){if(L>W&&(L=W),M===ge)if(1===O)var N=m(j,W),r=K(0,W-L-N);else-1===O?(r=m(-j,W),N=K(0,W-L-r)):(N=u((W-L)*j),r=K(0,W-L-N));else"cl"===M?(N=0,r=K(0,W-L)):"cr"===M&&(r=0,N=K(0,W-L));T&&Pi(T,0,0,N,S),k&&Pi(k,N+L,0,r,S),Pi(v,N,0,L,S),U._22o=N,y&&(Pi(y,L/2-p/2,0,p,S),y.style.cursor=B?Bm:""),v.style.cursor=B?Bm:"";var X=v.clientHeight/2,n=v.clientWidth;sg(I,n,n),Pi(I,0,X-n-R,n,n),J=Yl(I),Fb(J,0,0,1),V.rotation=-b,gl(J,s,0,0,n,n),J.restore(),sg(q,n,n),Pi(q,0,X+R,n,n),J=Yl(q),Fb(J,0,0,1),V.rotation=b,gl(J,s,0,0,n,n),J.restore()}else{if(L>S&&(L=S),M===ge)if(1===O)var e=m(j,S),Z=K(0,S-L-e);else-1===O?(Z=m(-j,S),e=K(0,S-L-Z)):(e=u((S-L)*j),Z=K(0,S-L-e));else"cl"===M?(e=0,Z=K(0,S-L)):"cr"===M&&(Z=0,e=K(0,S-L));T&&Pi(T,0,0,W,e),k&&Pi(k,0,e+L,W,Z),Pi(v,0,e,W,L),U._22o=e,y&&(Pi(y,0,L/2-p/2,W,p),y.style.cursor=B?Ip:""),P.cursor=B?Ip:"";var w=v.clientWidth/2,n=v.clientHeight;sg(I,n,n),Pi(I,w-n-R,0,n,n),J=Yl(I),Fb(J,0,0,1),V.rotation=0,gl(J,s,0,0,n,n),J.restore(),sg(q,n,n),Pi(q,w+R,0,n,n),J=Yl(q),Fb(J,0,0,1),V.rotation=E,gl(J,s,0,0,n,n),J.restore()}P.background=A}});var nh=function(s){this.sv=s,this.addListeners()};lf(nh,V,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(G){var F=this,D=F.sv,g=D._dividerDiv,A=D._60O,t=D._61O,w=D._status,j=G.target;if(j===A)w===ge?D.setStatus("cl"):"cr"===w&&D.setStatus(ge);else if(j===t)w===ge?D.setStatus("cr"):"cl"===w&&D.setStatus(ge);else if(Jr(G)&&(j===g||j===D._coverDiv)&&(Pd(G),D.isDraggable())){D.getLeftView(),D.getRightView();var o=F.maskDiv=jd();if(o.style.left=0,o.style.top=0,o.style.width=D.getWidth()+"px",o.style.height=D.getHeight()+"px",D.getView().appendChild(o),!D.isContinuousLayout()){var s=F.resizeDiv=jd();s.style.left=g.style.left,s.style.top=g.style.top,s.style.width=g.style.width,s.style.height=g.style.height,s.style.opacity=D.getDragOpacity(),s.style.background=D.getDividerBackground(),yj(F.getView(),s)}F._lastAbsPosition=D._22o,F._86o=tj(D)?ad(G).x:ad(G).y,Bf(F,G)}},handleWindowTouchMove:function(F){Jr(F)&&this.update(F,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(d){var B=this;B.update(d,!0),B.sv.setStatus(ge),B.maskDiv&&gg(B.maskDiv),B.resizeDiv&&gg(B.resizeDiv),B.maskDiv=B.resizeDiv=I},handle_mousedown:function(f){Ei(f)&&this.handle_touchstart(f)},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowMouseUp:function(Z){this.handleWindowTouchEnd(Z)},update:function(K,m){var w=this,$=w.sv,U=tj($)?$.getWidth():$.getHeight(),M=$._dividerSize,B=w._lastAbsPosition-w._86o;tj($)?(B+=ad(K).x,B>U-M&&(B=U-M),0>B&&(B=0),w.resizeDiv&&(w.resizeDiv.style.left=B+hr)):(B+=ad(K).y,B>U-M&&(B=U-M),0>B&&(B=0),w.resizeDiv&&(w.resizeDiv.style.top=B+hr)),m&&U!==M&&(1===$._82O?$.setPosition(B,1):-1===$._82O?$.setPosition(B-U+M,1):$.setPosition(B/(U-M),1))}}),Mh.TabView=function(){var D=this,u=D._view=zg(1,D),b=D._91O=jd(1),Z=D._tabModel=new Ve,O=Z.sm(),h=D.invalidate;D._7o=new mk,D._canvas=wo(b),yj(u,b),yj(u,D._92O=jd(1)),O.setSelectionMode($h),O.ms(D.handleSelectionChange,D),Z.mm(h,D),Z.md(h,D),Z.mh(h,D),D._interactor=new gj(D),D.iv()},iq("TabView",V,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",bq,ce,"tabBackground","selectWidth",Dh,"moveBackground","insertColor"],_tabPosition:Rd,_tabHeight:Vr,_tabGap:C.tabViewTabGap,_labelColor:C.tabViewLabelColor,_labelFont:C.tabViewLabelFont,_tabBackground:C.tabViewTabBackground,_selectWidth:C.tabViewSelectWidth,_selectBackground:C.tabViewSelectBackground,_moveBackground:C.tabViewMoveBackground,_insertColor:C.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(X,W,i){var j=new sn,r=this._tabModel;return j.setName(X),j.setView(W),r.add(j),i&&r.sm().ss(j),j},getLabel:function(E){return E.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(H){this._23o=H,this.iv()},get:function(R){var S=this,t=S._tabModel;if(ip(R))return t._roots.get(R);if(hf(R)){var G;return t.each(function(Z){R===S.getLabel(Z)&&(G=Z)}),G}return R instanceof sn?R:I},select:function(Y){this._tabModel.sm().ss(this.get(Y))},remove:function(w){var J=this;if(w=J.get(w)){var A=J._tabModel,h=A._roots.indexOf(w);J._tabModel.remove(w),J.selectByIndex(--h)}},getCurrentTab:function(){return this._8o},hideTabView:function(V,y){y.parentNode===this._92O&&(Sr(y)?(y.style.display=Fo,y._tab_=V):gg(y),zh())},showTabView:function(x,s){Sr(s)&&(s.style.display="block",s._tab_=x),s.parentNode!==this._92O&&(yj(this._92O,s),zh())},_24o:function(){var P,B=this,s=B._8o,T=B._9o,z=B._tabModel.sm().ld();z&&(P=hi(z.getView())),P!==T&&(T&&(s.getView()&&s.getView().endEditing&&s.getView().endEditing(),B.hideTabView(s,T)),P&&B.showTabView(z,P)),B._8o=z,B._9o=P,s!==z&&B.onTabChanged(s,z)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Z,I){this.selectByIndex(--I)},selectByIndex:function(M){var R=this,i=R._tabModel,y=i.size();if(y&&!i.sm().ld()){M==I&&(M=0),M>=y&&(M=y-1),0>M&&(M=0);for(var b=M;b>=0;b--){var D=R.get(b);if(!D.isDisabled())return R.select(D),D}for(b=M+1;y>b;b++)if(D=R.get(b),!D.isDisabled())return R.select(D),D}},getTabWidth:function(Q){var _=4,W=wc(Q.getIcon());W&&(_+=Rn(W,Q)+4);var x=this.getLabel(Q);return x&&(_+=ho(this.getLabelFont(Q),x).width+4),Q.isClosable()&&(_+=10),_},drawTab:function(A,B,n,H,j,v,p){var O,W=this,x=W._tabPosition,f=n+4,i=W._selectWidth,I=wc(B.getIcon()),S=B.isDisabled(),q=W.getLabelColor(B),Y=W.getLabelFont(B),l=W.getLabel(B),z=W._selectBackground,L=x===_h+"-vertical",P=x===De+"-vertical";(L||P)&&(f=H+4),S&&(A.globalAlpha=Bd),Uc(A,n,H,j,v,p),B===W._8o&&i&&(x===Rd?Uc(A,n,H+v-i,j,i,z):x===_h?Uc(A,n+j-i,H,i,v,z):x===De?Uc(A,n,H,i,v,z):L?Uc(A,n+j-i,H,i,v,z):P?Uc(A,n,H,i,v,z):Uc(A,n,H,j,i,z));var w=j/2;if(L&&(Uf(A,w,H+v/2),Fq(A,E),Uf(A,-w,-H-v/2)),I){var U=si(I,B),Z=Rn(I,B);if(L||P){var T=n+j/2,u=f+U/2;Uf(A,T,u),Fq(A,b),Uf(A,-T,-u),od(A,I,n+j/2,f+U/2,B,W),Uf(A,T,u),Fq(A,-b),Uf(A,-T,-u),f+=U+4}else od(A,I,f+Z/2,H+v/2,B,W),f+=Z+4}return L||P?(Uf(A,j/2,f+j/2),Fq(A,b),Uf(A,-j/2,-f-j/2),Ni(A,l,Y,q,n,f,v,j),Uf(A,j/2,f+j/2),Fq(A,-b),Uf(A,-j/2,-f-j/2)):Ni(A,l,Y,q,f,H,j,v),L&&(Uf(A,w,H+v/2),Fq(A,-E),Uf(A,-w,-H-v/2)),B.isClosable()&&(O=P?{x:n+j-12,y:H+v-12,width:12,height:12}:{x:n+j-12,y:H+2,width:12,height:12},this.drawCloseIcon(B,A,q,O)),S&&(A.globalAlpha=1),O},drawCloseIcon:function($,y,v,G){var r=G.x,x=G.y;y.strokeStyle=v,y.lineWidth=1,y.beginPath(),y.moveTo(r+2,x+8),y.lineTo(r+8,x+2),y.moveTo(r+8,x+8),y.lineTo(r+2,x+2),y.stroke()},getTabAt:function(B){var M=this._interactor._8Q(B);return M?M.tab:null},validateImpl:function(){var n=this;n._24o();var i,B=n._canvas,d=n._tabPosition,R=n._91O,g=n._92O,L=n._tabModel,M=n.getWidth(),x=n.getHeight(),o=n._tabHeight,G=n._7o,$=n._tabGap,k=d===Rd,v=d===_h,c=d===De,r=d===_h+"-vertical",s=d===De+"-vertical",_=n._23o,S=0;if((v||c)&&L._roots.each(function(C){S=K(n.getTabWidth(C),S)}),k?(Pi(R,0,0,M,o),i={x:0,y:o,width:M,height:K(0,x-o)}):v?(Pi(R,0,0,S,x),i={x:S,y:0,width:K(0,M-S),height:x}):c?(Pi(R,M-S,0,S,x),i={x:0,y:0,width:K(0,M-S),height:x}):r?(Pi(R,0,0,o,x),i={x:o,y:0,width:K(0,M-o),height:x}):s?(Pi(R,M-o,0,o,x),i={x:0,y:0,width:K(0,M-o),height:x}):(Pi(R,0,x-o,M,o),i={x:0,y:0,width:M,height:K(0,x-o)}),Pi(g,i),r||s){n._9o&&(i.x=0,Pi(n._8o.getView(),i)),sg(B,o,x);var U=Yl(B),Q=0;if(Fb(U,0,n.ty(),1),U.clearRect(0,0,o,x),G.clear(),L._roots.each(function(m){var S,f=n.getTabWidth(m);_&&_.tab===m||(S=n.drawTab(U,m,0,Q,o,f,n._tabBackground)),G.add({_75o:S,tab:m,startY:Q,endY:Q+f,height:f}),Q+=f+$}),n._23Q=K(0,Q-$),_){var Y=_.position;n.drawTab(U,_.tab,0,_.startY,o,_.height,n._moveBackground),Uc(U,0,Y,o,1,n._insertColor)}if(U.restore(),n._selectionChanged){n._selectionChanged=!1;for(var I=n.ty(),w=0;w<G.size();w++){var H=G.get(w);if(H.tab===n._8o){if(H.endY+I<0){n.ty(-H.startY);break}if(H.startY+I>x){n.ty(x-H.endY);break}}}}n.ty(n.ty())}else if(v||c){n._9o&&(i.x=0,Pi(n._8o.getView(),i)),sg(B,S,x);var U=Yl(B),Q=0;if(Fb(U,0,n.ty(),1),U.clearRect(0,0,S,x),G.clear(),L._roots.each(function(m){var W;_&&_.tab===m||(W=n.drawTab(U,m,0,Q,S,o,n._tabBackground)),G.add({_75o:W,tab:m,startY:Q,endY:Q+o,height:o}),Q+=o+$}),n._23Q=K(0,Q-$),_){var Y=_.position;n.drawTab(U,_.tab,0,_.startY,S,_.height,n._moveBackground),Uc(U,0,Y,S,1,n._insertColor)}if(U.restore(),n._selectionChanged){n._selectionChanged=!1;for(var I=n.ty(),w=0;w<G.size();w++){var H=G.get(w);if(H.tab===n._8o){if(H.endY+I<0){n.ty(-H.startY);break}if(H.startY+I>x){n.ty(x-H.endY);break}}}}n.ty(n.ty())}else{n._9o&&(i.y=0,Pi(n._8o.getView(),i)),sg(B,M,o);var U=Yl(B),O=0;if(Fb(U,n.tx(),0,1),U.clearRect(0,0,M,o),G.clear(),L._roots.each(function(F){var M,X=n.getTabWidth(F);_&&_.tab===F||(M=n.drawTab(U,F,O,0,X,o,n._tabBackground)),G.add({_75o:M,tab:F,startX:O,endX:O+X,width:X}),O+=X+$}),n._64I=K(0,O-$),_){var Y=_.position;n.drawTab(U,_.tab,_.startX,0,_.width,o,n._moveBackground),up(U,n._insertColor,Y,0,o)}if(U.restore(),n._selectionChanged){n._selectionChanged=!1;for(var e=n.tx(),w=0;w<G.size();w++){var H=G.get(w);if(H.tab===n._8o){if(H.endX+e<0){n.tx(-H.startX);break}if(H.startX+e>M){n.tx(M-H.endX);break}}}}n.tx(n.tx())}for(var a=[],z=g.children,w=0;w<z.length;w++){var C=z[w],E=C._tab_;E&&!L.contains(E)&&a.push(C)}a.forEach(function(i){g.removeChild(i)})}});var gj=function(Z){this.tv=Z,this.addListeners()};lf(gj,V,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(e){this.handleScroll(e,10*(e.wheelDelta/40))},handle_DOMMouseScroll:function(D){this.handleScroll(D,10*-D.detail)},handleScroll:function(W,t){Pd(W);var J=this.tv,w=J._tabPosition;!J._40o()||w!==Rd&&w!==Yf||J.tx(this.tv.tx()+t),!J._41o()||w!==_h&&w!==De&&w!==_h+"-vertical"&&w!==De+"-vertical"||J.ty(this.tv.ty()+t)},_8Q:function(l){var G,z,B=this.tv,N=B._tabPosition,k=B._7o;if(N===Rd||N===Yf){var v=B.lp(l).x;for(G=0;G<k.size();G++)if(z=k.get(G),z.startX<=v&&v<=z.endX)return z}else if(N===_h||N===De||N===_h+"-vertical"||N===De+"-vertical"){var x=B.lp(l).y;for(G=0;G<k.size();G++)if(z=k.get(G),z.startY<=x&&x<=z.endY)return z}return I},isClickable:function(l){var F=this.tv,O=F._tabPosition,s=this._73o=this._8Q(l);return!F._40o()||O!==Rd&&O!==Yf?!F._41o()||O!==_h&&O!==De&&O!==_h+"-vertical"&&O!==De+"-vertical"?s&&(!s.tab.isDisabled()||F.isMovable()):!0:!0},handle_mousemove:function(j){var n=this;Vo?n._74o=n._8Q(j):n.getView().style.cursor=n.isClickable(j)?hc:""},handle_mousedown:function(t){this.handle_mousemove(t),this.handle_touchstart(t)},handle_touchstart:function(o){var L=this,C=L.tv,f=C._tabPosition;Pd(o),Ei(o)&&L.isClickable(o)&&(f===Rd||f===Yf?(L.x=ad(o).x,L.lp=C.lp(o),L.tx=C.tx()):(L.y=ad(o).y,L.lp=C.lp(o),L.ty=C.ty()),Bf(L,o))},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(n){var $,P=this,j=P.tv,J=j._tabPosition,I=P._73o;if(J===Rd||J===Yf){if($=ad(n).x-P.x,!P._25o&&!P.moving&&f($)>2&&(j._40o()&&!Hg(n)?P._25o=1:I&&j.isMovable()&&(P.moving=1)),P._25o)j.tx(P.tx+$);else if(P.moving){var d=P.lp.x+$,h=j._tabGap/2;j._7o.each(function(q){var H=q.endX,M=d-q.startX<H-d;d>=q.startX&&H>=d&&j._7Q({tab:I.tab,startX:I.startX+$,width:I.width,front:M,insertTab:q.tab,position:M?K(0,q.startX-h):m(j._64I,H+h)})})}}else if($=ad(n).y-P.y,!P._25o&&!P.moving&&f($)>2&&(j._41o()&&!Hg(n)?P._25o=1:I&&j.isMovable()&&(P.moving=1)),P._25o)j.ty(P.ty+$);else if(P.moving){var s=P.lp.y+$,h=j._tabGap/2;j._7o.each(function(d){var M=d.endY,w=s-d.startY<M-s;s>=d.startY&&M>=s&&j._7Q({tab:I.tab,startY:I.startY+$,height:I.height,front:w,insertTab:d.tab,position:w?K(0,d.startY-h):m(j._23Q,M+h)})})}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(){var u=this,L=u.tv,o=L._tabPosition,G=L.getTabModel(),E=G._roots,c=u._73o;if(u.moving){var p=L._23o;if(p&&p.insertTab!==p.tab){var w=p.tab,Q=E.remove(w),$=E.indexOf(p.insertTab);$>=0&&(p.front||$++,$<=E.size()&&(E.add(w,$),G._38I(w,Q,$)))}L._7Q(I),delete u.moving}else if(!u._25o&&c){w=c.tab;var b=u._74o;if(!b||b.tab===w)if(!w.isDisabled()&&Hd(c._75o,u.lp)){var A=function(){var C=E.indexOf(w);G.remove(w),L.onTabClosed(w,C)};L.onTabClosing(w,A)&&A()}else w.isDisabled()||L._8o===w||G.sm().ss(w)}u._25o=u._73o=u._74o=o===Rd||o===Yf?u.x=u.lp=u.tx=I:u.y=u.lp=u.ty=I}}),Mh.PropertyView=function(y){var X=this;X._view=zg(1,X),X._canvas=wo(X._view),yj(X._view,X._79O=jd()),X._rows=new mk,X._28o=new mk,X._26o={},X._26Q={};var s=X._propertyModel=new Ve,Y=X.ivm;s.mm(Y,X),s.md(Y,X),s.mh(Y,X),X.dm(y?y:new Ve),new Dk(X)},iq("PropertyView",V,{ms_ac:[bq,cm,ce,ur,ie,"categorizable",mq,zf,yd,Td,Eb,vo,Zb,fb,"selectRowIndex",Dh,"background",yc,fr,vj,tg,Oq],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Lg,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Cj,_background:C.propertyViewBackground,_expandIcon:C.propertyViewExpandIcon,_collapseIcon:C.propertyViewCollapseIcon,_scrollBarColor:wp,_scrollBarSize:Mr,_autoHideScrollBar:Dg,_selectBackground:C.propertyViewSelectBackground,_rowHeight:Sp,_rowLineVisible:C.propertyViewRowLineVisible,_rowLineColor:C.propertyViewRowLineColor,_10I:.5,_columnLineVisible:C.propertyViewColumnLineVisible,_columnLineColor:C.propertyViewColumnLineColor,_labelColor:C.propertyViewLabelColor,_labelSelectColor:C.propertyViewLabelSelectColor,_labelFont:C.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(S){0>S&&(S=0),S>1&&(S=1);var p=this,Y=p._10I;p._10I=S,p.fp("columnPosition",Y,S)},getPropertyName:function(U){return U.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(L,K,I){return I===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(e,O){return O===this._selectRowIndex?this._labelSelectColor:e.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(Y){var R=this.getHeight()-this._59I;return R>Y&&(Y=R),Y>0?0:u(Y)},isExpanded:function(P){if(!P)return!0;var d=this._26o[P];return d?d.isExpanded:!(this._26Q[P]===!1)},toggle:function(_){var v=this;v.isExpanded(_)?v.collapse(_):v.expand(_)},expandAll:function(){this.validate();for(var x in this._26o)this.expand(x)},expand:function(U){if(U&&U!==Fo){var x=this,t=x._26o[U];t&&!t.isExpanded&&(t.isExpanded=!0,x.onExpanded(U),x.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var c in this._26o)this.collapse(c)},collapse:function($){if($&&$!==Fo){var n=this,v=n._26o[$];v&&v.isExpanded&&(v.isExpanded=!1,n.onCollapsed($),n.ivm())}},onCollapsed:function(){},getCategoryName:function(z){if(!this.isCategorizable())return Fo;var j=z.getCategoryName();return j?j:Fo},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(R){var $=this,x=$._dataModel;x!==R&&(x&&(x.umd($.handlePropertyChange,$),$._selectionModel||x.sm().ums($.handleSelectionChange,$)),$._dataModel=R,R.md($.handlePropertyChange,$),$._selectionModel?$._selectionModel._21I(R):R.sm().ms($.handleSelectionChange,$),$.fp(xp,x,R))},isVisible:function(P){return this._visibleFunc?this._visibleFunc(P):!0},onPropertyChanged:function(F){var g=this,M=F.property;nj[M]?g.ivm():g.iv(),M===Bc&&g._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:ze},handlePropertyChange:function(W){this._27o===W.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var w=this;w._96I||(w.setSelectRowIndex(-1),w._96I=1,w.iv())},redraw:function(){this.iv()},validateModel:function(){var O=this,N=O._rows,K=O._28o,H={},c=new mk,a=O._27o;O.updateCurrentData(),a!==O._27o&&O.endEditing(),N.clear(),K.clear(),O.getRawProperties().each(function(P){if(O.isVisible(P)){c.add(P);var U=O.getCategoryName(P);H[U]||(K.add(U,U===Fo?0:Z),H[U]={isExpanded:O.isExpanded(U),properties:new mk})}}),O._sortFunc&&c.sort(O._sortFunc);for(var F in O._26o)O._26Q[F]=O.isExpanded(F);O._26o=H,K.each(function(q){q!==Fo&&N.add(q);var e=H[q];e.isExpanded&&c.each(function(r){O.getCategoryName(r)===q&&(e.properties.add(r),N.add({property:r,data:O._27o}))},O)})},validateImpl:function(){var e=this;e._76o(),e._96I&&(e.validateModel(),delete e._96I);var y=e._canvas,T=e.getWidth(),X=e.getHeight(),m=-e.ty(),G=e._rowHeight,Z=e._indent,P=T-Z,D=e._rows,n=D.size(),w=e._9I=Z+P*e._10I,i=e._59I=n*G;sg(y,T,X),e._29I={x:0,y:m,width:T,height:X},e._31I=B(m/G),e._14I=h((m+X)/G),e._31I<0&&(e._31I=0),e._14I>n&&(e._14I=n);var Q,H=Yl(y),W=e._background;Fb(H,0,-m,1),H.beginPath(),H.rect(0,m,T,X),H.clip(),H.clearRect(0,m,T,X),e._93db(H),W&&Uc(H,0,0,Z,i,W);for(var R=e._31I;R<e._14I;R++){var M=D.get(R),m=G*R;if(hf(M))W&&Uc(H,Z,m,P,G,W),Q=wc(e.isExpanded(M)?e._expandIcon:e._collapseIcon),Q&&Do(H,Q,Rb,0,m,Z,G),H.save(),H.beginPath(),H.rect(Z,m,P,G),H.clip(),e.drawCategoryName(H,M,R,Z,m,P,G),H.restore();else{var _=M.property,L=M.data,Q=wc(_.getIcon()),u=e._selectRowIndex===R?e.getSelectBackground():I;if(Q&&Do(H,Q,Rb,0,m,Z,G),u&&Uc(H,Z,m,P,G,u),H.save(),H.beginPath(),H.rect(Z,m,w-Z,G),H.clip(),e.drawPropertyName(H,_,R,Z,m,w-Z,G),H.restore(),!e.isEditing(L,_)){var V=w+1,a=T-w-1;H.save(),H.beginPath(),H.rect(V,m,a,G),H.clip(),e._87o(e.drawPropertyValue(H,_,e.getValue(L,_),R,V,m,a,G,L),R,V,m,a,G),H.restore()}}e._rowLineVisible&&Uc(H,Z,m+G-1,P,1,e._rowLineColor)}e._columnLineVisible&&(Uc(H,w,0,1,i,e._columnLineColor),Uc(H,T-1,0,1,i)),e._92db(H),e._93I(),H.restore(),e.ty(e.ty())},drawCategoryName:function(R,h,d,Y,K,M,a){Ni(R,h,this.getCategoryFont(h),this.getCategoryColor(h),Y,K,M,a)},drawPropertyName:function(A,g,K,O,L,W,X){return g.drawPropertyName?(g.drawPropertyName(A,g,K,O,L,W,X,this),void 0):(Ni(A,this.getPropertyName(g),this.getPropertyFont(g,K),this.getPropertyColor(g,K),O,L,W,X),void 0)},drawPropertyValue:function(m,W,l,y,H,g,X,T,E){return W.drawPropertyValue?W.drawPropertyValue(m,W,l,y,H,g,X,T,E,this):(ql(m,l,W,this.getLabelFont(W,l,y),this.getLabelColor(W,l,y),H,g,X,T,E,this),void 0)},isPropertyEditable:function(q){return q.isEditable()&&this.isEditable()},setProperties:function(o){this._propertyModel.clear(),this.addProperties(o)},addProperties:function(d){if(d){var l=this._propertyModel;d.forEach(function(O){if(!(O instanceof ii)){var Z=tf(O.className);O=ll(Z?Z:ii,O)}l.add(O)})}},getRowIndexAt:function(H){var j=this,a=B(j.lp(H).y/j._rowHeight);return a>=0&&a<j._rows.size()?a:-1},getPropertyAt:function(b){var W=this,g=W.getRowIndexAt(b);return g>=0?W._rows.get(g).property:I},getToolTip:function(i){var l=this,A=l.getPropertyAt(i),X=l._27o;return A&&X?A.getToolTip(X,l._9I<l.lp(i).x,l):I}});var Dk=function(L){this.pv=L,this.addListeners()};lf(Dk,V,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(Z){this.getView().style.cursor=Z},clear:function(){var q=this;q._62O=q.cp=q.ty=q.p=I,q.setCursor(wr)},handle_mousedown:function(_){this.handle_touchstart(_)},handle_touchstart:function(D){var b=this,E=b.pv;Pd(D),E.setFocus(D)&&(Ei(D)?(b.cp=ad(D),b.ty=E.ty(),b.p=E.getColumnPosition(),b.handle_touchmove(D)):E.setSelectRowIndex(E.getRowIndexAt(D)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(l){var n=this;if(n.cp&&!n._62O){var Z=n.pv,D=Z.lp(l),v=D.x,O=D.y,b=Z._indent,y=Z.getRowIndexAt(l),x=Z._9I;if(y>=0){var a=Z._rowHeight,S=a*y,f=Z._rows.get(y),z=f.property;if(hf(f))wc(Z.isExpanded(f)?Z._expandIcon:Z._collapseIcon)&&v>=0&&b>=v&&O>=S&&S+a>=O?Z.toggle(f):Ro(l)&&Z.toggle(f);else if(v>x&&Z.isPropertyEditable(z,l)){var e={x:x+1,y:S,width:Z.getWidth()-x-1,height:a},k={x:e.x+Z.tx(),y:e.y+Z.ty(),width:e.width,height:e.height},U=0,M=Z._29I;e.y<M.y?U=e.y-M.y:e.y+a>M.y+M.height&&(U=e.y+a-M.y-M.height),U&&(Z.ty(Z.ty()-U),k.y-=U),Z.beginEditing({data:f.data,property:z,value:Z.getValue(f.data,z),event:l,rect:e,editorRect:k,view:Z})}}Z.setSelectRowIndex(y)}n.clear()},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(a){var B=this,f=B.pv,m=B.ty,P=B.cp,x=ad(a),E=B._62O;if("p"===E)f.setTranslateY(m+x.y-P.y);else if("c"===E){var j=f.getWidth()-f._indent;if(j>16){var u=B.p-(P.x-x.x)/j,t=16/j;t>u&&(u=t),u>1-t&&(u=1-t),f.setColumnPosition(u)}}else"s"===E&&f.setTranslateY(m+(P.y-x.y)*f._59I/f._29I.height)},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(O){if(!Vo&&Ei(O)){var R=this,l=R.pv,k=f(l.lp(O).x-l._9I)<=(Xm?8:3);R.cp?R._62O||(k?(R._62O="c",Bf(R)):f(ad(O).y-R.cp.y)>=2&&(R._62O=R.isV(O)?"s":"p",Bf(R))):(k?R.setCursor(Bm):R.setCursor(wr),R.isV(O)&&l._43o())}},isV:function(Y){var F=this.pv,z=F._29I;return F._41o()&&z.x+z.width-F.lp(Y).x<Ee},handle_mousewheel:function(V){this.handleScroll(V,V.wheelDelta/40)},handle_DOMMouseScroll:function(C){2===C.axis&&this.handleScroll(C,-C.detail)},handleScroll:function(C,D){var P=this.pv;Pd(C),P.endEditing(),P.translate(0,D*P.getRowHeight())},handle_keydown:function(B){var F=this.pv,x=F._rows.size(),s=F._selectRowIndex+(sh(B)?-1:1);(sh(B)||qc(B))&&(0>s&&(s=0),s>=x&&(s=x-1),F.setSelectRowIndex(s))}}),Mh.ListView=function(J){this._5o(J),new xb(this)},iq("ListView",V,{ms_ac:[bq,cm,ce,yc,mq,fr,vj,zf,yd,vo,Zb,fb,qh,Dh],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Cj,_rowHeight:Sp,_rowLineVisible:C.listViewRowLineVisible,_rowLineColor:C.listViewRowLineColor,_scrollBarColor:wp,_scrollBarSize:Mr,_autoMakeVisible:qm,_autoHideScrollBar:Dg,_selectBackground:C.listViewSelectBackground,_labelColor:C.listViewLabelColor,_labelSelectColor:C.listViewLabelSelectColor,_labelFont:C.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(y){var M=this,c=M._checkMode;M._checkMode=y,M.fp(mm,c,y)},drawRow:function(f,b,j,Q,v,S,J){var C=this,d=0,D=C._indent,e=C.getIconWidth(b);C.drawRowBackground(f,b,j,Q,v,S,J),C._checkMode&&(od(f,wc(C.getCheckIcon(b)),d+D/2,v+J/2,b,C),d+=D),C.drawIcon(f,b,d,v,e,J),C.drawLabel(f,b,d+e,v,J)}});var xb=function(r){this.list=r,this._lastSelectDataTime=Xc(),this.addListeners()};lf(xb,V,{ms_listener:1,getView:function(){return this.list._view},clear:function(t){var i=this,j=i.list;t&&"d"===i._62O&&!i.dragCancel&&j.handleDragAndDrop(t,"end"),j.draggingData&&(j.draggingData=null,j.redraw()),i.dragCancel=i._62O=i._isV=i._isH=i.cp=i.tx=i.ty=I},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(D){var d=this,q=d.list;if(Pd(D),q.setFocus(D)){var F=q.getDataAt(D);d.cp=ad(D),d.tx=q.tx(),d.ty=q.ty(),Ei(D)?F&&q.handleDragAndDrop&&!d.isV(D)&&!d.isH(D)&&(q.draggingData=F,q.redraw(),q.handleDragAndDrop(D,"prepare")):(F&&d._33o(D,F),d.clear(D))}},handleWindowMouseUp:function(C){this.clear(C)},handleWindowTouchEnd:function(u){this.clear(u)},handle_mouseup:function(M){this.handle_touchend(M)},handle_touchend:function(M){var r=this,B=r.list;if(!r._isV&&!r._isH&&r.cp&&!r._62O){var v=B.getDataAt(M);v?(B.isCheckMode()?r._34o(M,v):r._33o(M,v),Ro(M)?B.onDataDoubleClicked(v,M):B.onDataClicked(v,M)):B.handleBackgroundClick(M)}r.clear(M)},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(h){var w=this,j=w.list,m=w._62O,e=w.tx,s=w.ty,l=w.cp,V=ad(h),v=j._29I;"p"===m?j.setTranslate(e+V.x-l.x,s+V.y-l.y):"v"===m?j.ty(s+(l.y-V.y)*j._59I/v.height):"h"===m?j.tx(e+(l.x-V.x)*j._91I/v.width):"d"===m&&(w.dragCancel||j.handleDragAndDrop(h,"between"))},handle_mousemove:function($){this.handle_touchmove($)},handle_touchmove:function(h){if(!Vo&&Ei(h)){var N=this,S=N.list;if(N._isV=N.isV(h),N._isH=N.isH(h),N.cp){if(!N._62O){if(cd(ad(h),N.cp)<2)return;N._isV?N._62O="v":N._isH?N._62O="h":S.draggingData&&!this.dragCancel?(N._62O="d",S.handleDragAndDrop(h,"begin")):N._62O="p",N._62O&&"d"!==N._62O&&S.draggingData&&(S.draggingData=null,S.redraw()),Bf(N)}}else N._isV&&S._43o(),N._isH&&S._42o()}},isV:function(L){var E=this.list,R=E._29I;return E._41o()&&R.x+R.width-E.lp(L).x<Ee},isH:function(L){var i=this.list,H=i._29I;return i._40o()&&H.y+H.height-i.lp(L).y<Ee},handle_mousewheel:function(T){this.handleScroll(T,T.wheelDelta/40,T.wheelDelta!==T.wheelDeltaX)},handle_DOMMouseScroll:function(n){this.handleScroll(n,-n.detail,1)},handleScroll:function(U,t,w){var a=this.list;Pd(U),a.endEditing&&a.endEditing(),w&&a._41o()?a.translate(0,t*a.getRowHeight()):a._40o()&&a.translate(10*t,0)},handle_keydown:function(f){if(!C.isInput(f.target)){var A,b=this.list,v=b.sm(),u=b._rows,I=u.size();if(Kn(f))b.selectAll();else if(as(f))b.handleDelete&&b.handleDelete(f);else if(br(f))"d"!==this._62O||this.dragCancel||(b.handleDragAndDrop(f,"cancel"),this.dragCancel=!0);else if(ci(f))b.isCheckMode()&&(A=b.getFocusData(),A&&b.checkData(A));else if(sh(f)||qc(f)){var h=b.isCheckMode();if(A=h?b.getFocusData():v.ld()){var s=b.getRowIndex(A);s>=0&&(sh(f)?0!==s&&(A=u.get(s-1),h?b.setFocusData(A):v.ss(A)):s!==I-1&&(A=u.get(s+1),h?b.setFocusData(A):v.ss(A)))}else I>0&&(A=u.get(0),h?b.setFocusData(A):v.ss(A))}}},_34o:function(M,n){var G=this.list,R=G.lp(M).x;return R>=0&&R<=G._indent?(G.checkData(n),void 0):(G.setFocusData(n),void 0)},_33o:function(Y,H){var y=this.list,j=y.sm(),X=j.ld();if(Hg(Y))y.isSelected(H)?j.rs(H):j.as(H);else if(_g(Y))if(X)for(var u=y.getRowIndex(X),t=y.getRowIndex(H);u!==t;)u+=t>u?1:-1,j.as(y._rows.get(u));else j.ss(H);else if(Ei(Y)){var c=Xc();if(j.contains(H)){var F=c-this._lastSelectDataTime;y.handleDataDoubleSelect&&F>500&&1500>F&&y.handleDataDoubleSelect(Y,H)}j.ss(H),this._lastSelectDataTime=c}else j.contains(H)||j.ss(H)}}),Mh.TreeView=function(x){var I=this;I._35o(),I._5o(x),new ij(I)},iq("TreeView",V,{ms_ac:[bq,cm,ce,"rootVisible",mm,"rootData",zf,yd,vo,Zb,fb,mq,yc,fr,vj,Td,Eb,qh,Dh,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:I,_indent:Cj,_rowHeight:Sp,_rowLineVisible:C.treeViewRowLineVisible,_rowLineColor:C.treeViewRowLineColor,_scrollBarColor:wp,_scrollBarSize:Mr,_autoHideScrollBar:Dg,_expandIcon:C.treeViewExpandIcon,_collapseIcon:C.treeViewCollapseIcon,_autoMakeVisible:qm,_selectBackground:C.treeViewSelectBackground,_labelColor:C.treeViewLabelColor,_labelSelectColor:C.treeViewLabelSelectColor,_labelFont:C.treeViewLabelFont,_doubleClickToToggle:C.treeViewDoubleClickToToggle,drawRow:function(f,W,A,P,M,h,u){var w=this;w.drawRowBackground(f,W,A,P,M,h,u),w._97I(f,W,A,0,M,h,u)},isOnToggleIcon:function($){var B=this.getDataAt($);if(B){var I=this.getIndent(),F=this.lp($).x;if(wc(this.getToggleIcon(B))){var y=I*this.getLevel(B);if(F>=y&&y+I>=F)return!0}}return!1}});var ij=function(H){lp(ij,this,[H])};lf(ij,xb,{toggle:function(T,E,q,V){var i=this.list,s=i.lp(T).x;if(wc(i.getToggleIcon(E))){var a=q*V;if(s>=a&&a+q>=s)return i.toggle(E),!0}return i.isDoubleClickToToggle()&&Ro(T)?(i.toggle(E),!0):!1},_34o:function(V,T){var y=this.list,z=y.lp(V).x,w=y._levelMap[T._id],i=y._indent,Q=i*(w+1);return z>=Q&&Q+i>=z?(y.checkData(T),void 0):(this.toggle(V,T,i,w)||y.setFocusData(T),void 0)},_33o:function(M,t){var Y=this,h=Y.list;Y.toggle(M,t,h._indent,h.getLevel(t))||ij.superClass._33o.call(Y,M,t)},handle_keydown:function(H){if(Fp(H)||vd(H)){var k=this.list,v=k._rows,K=k.isCheckMode(),M=k.sm(),R=K?k.getFocusData():M.ld();R?R.hasChildren()&&(Fp(H)?k.collapse(R):k.expand(R)):v.size()>0&&(R=v.get(0),K?k.setFocusData(R):M.ss(R))}else ij.superClass.handle_keydown.call(this,H)}});var bj=Mh.TableView=function(R){this._98I(),this._5o(R),new jb(this)};iq("TableView",V,{ms_ac:[bq,cm,ce,"sortMode",ur,ie,yc,fr,vj,tg,Oq,"sortColumn",zf,yd,vo,Zb,fb,qh,Dh],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Jm,_editable:!0,_batchEditable:!1,_rowHeight:Sp,_rowLineVisible:C.tableViewRowLineVisible,_rowLineColor:C.tableViewRowLineColor,_columnLineVisible:C.tableViewColumnLineVisible,_columnLineColor:C.tableViewColumnLineColor,_scrollBarColor:wp,_scrollBarSize:Mr,_autoHideScrollBar:Dg,_autoMakeVisible:qm,_selectBackground:C.tableViewSelectBackground,_labelColor:C.tableViewLabelColor,_labelSelectColor:C.tableViewLabelSelectColor,_labelFont:C.tableViewLabelFont,getCheckColumn:function(){var g=this;if(!g._31o){var v=g._31o=new Vc;v.setEditable(!0),v.setWidth(40),v.getValue=g.getCheckColumValue,v.drawCell=g.drawCheckColumnCell}return g._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(J){var R=this,c=R._39o,G=R.getCheckColumn();
J!==R.isCheckMode()&&(J?c.add(G,0):c.remove(G),R.fp(mm,!J,J))},getCheckColumValue:function($,r,Y){return Y.isSelected($)},drawCheckColumnCell:function(Q,G,B,f,v,A,M,O,V){od(Q,V.getCheckIcon(G),v+M/2,A+O/2,G,V)}});var jb=function(Y){lp(jb,this,[Y])};lf(jb,xb,{_34o:function(I,v){var n=this.list,B=n._31o;if(n.isCellEditable(v,B,I)){var S=n._3Q(B),Q=n.lp(I).x;if(S&&Q>=S.startX&&Q<S.startX+B.getWidth())return n.checkData(v),void 0}n._37O(v,I),n.setFocusData(v)},_33o:function(N,y){this.list._37O(y,N),jb.superClass._33o.apply(this,arguments)}});var Fl=Mh.TreeTableView=function(l){var R=this,w=R._4o=new Vc;R._35o(),R._98I(),R._5o(l),w.setDisplayName("Name"),w.setEditable(!0),w.setWidth(180),w.drawCell=Me,w.getValue=ye,R._39o.add(w),new No(R)},Me=function(p,z,y,h,i,J,x,F,G){G._97I(p,z,y,i,J,x,F)},ye=function(f,r,m){return m.getLabel(f)};iq("TreeTableView",V,{ms_ac:[bq,cm,ce,"sortMode",ur,ie,mq,mm,"rootData","rootVisible",zf,yd,"sortColumn",Td,Eb,vo,Zb,fb,qh,vj,yc,fr,tg,Oq,Dh,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Jm,_checkMode:I,_editable:!0,_batchEditable:!1,_indent:Cj,_rowHeight:Sp,_rowLineVisible:C.treeTableViewRowLineVisible,_rowLineColor:C.treeTableViewRowLineColor,_columnLineVisible:C.treeTableViewColumnLineVisible,_columnLineColor:C.treeTableViewColumnLineColor,_expandIcon:C.treeTableViewExpandIcon,_collapseIcon:C.treeTableViewCollapseIcon,_scrollBarColor:wp,_scrollBarSize:Mr,_autoHideScrollBar:Dg,_autoMakeVisible:qm,_selectBackground:C.treeTableViewSelectBackground,_labelColor:C.treeTableViewLabelColor,_labelSelectColor:C.treeTableViewLabelSelectColor,_labelFont:C.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var No=function(o){lp(No,this,[o])};lf(No,xb,{_34o:function(Y,l){var p=this.list,u=p._4o,N=p._3Q(u),z=p.lp(Y).x;if(N){var j=p._indent,v=N.startX+j*p.getLevel(l);if(wc(p.getToggleIcon(l))&&z>=v&&v+j>=z)return p.toggle(l),void 0;if(p.isCellEditable(l,u)&&(v+=j,z>=v&&v+j>=z))return p.checkData(l),void 0}p._37O(l,Y),p.setFocusData(l)},_33o:function($,Y){var X=this.list,G=X.lp($).x;if(wc(X.getToggleIcon(Y))){var N=X._3Q(X._4o);if(N){var M=X._indent,j=N.startX+M*X.getLevel(Y);if(G>=j&&j+M>=G)return X.toggle(Y),void 0}}X._37O(Y,$),No.superClass._33o.apply(this,arguments)}});var en=Mh.TableHeader=function(s){var J=this,D=J._view=zg(1,J),B=J._39o=s.getColumnModel(),w=J.iv;J.tv=J._tableView=s,J._60I=new mk,J._canvas=wo(D),D.style.background=C.tableHeaderBackground||"",D.style.height=dl+hr,B.mm(w,J),B.md(w,J),B.mh(w,J),s.mp(function(A){qf[A.property]&&J.iv()},J),new Ke(J),J.iv()};iq("TableHeader",V,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",bq,ce,mq,"moveBackground","insertColor",tg,Oq,"resizable","movable"],_checkIcon:Np,_movable:!0,_resizable:!0,_labelColor:C.tableHeaderLabelColor,_labelFont:C.tableHeaderLabelFont,_columnLineColor:C.tableHeaderColumnLineColor,_columnLineVisible:C.tableHeaderColumnLineVisible,_sortDescIcon:C.tableHeaderSortDescIcon,_sortAscIcon:C.tableHeaderSortAscIcon,_moveBackground:C.tableHeaderMoveBackground,_insertColor:C.tableHeaderInsertColor,_indent:Cj,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(x){return x.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(N){return N.getColor()||this._labelColor},getLabelAlign:function(t){return t._align},onPropertyChanged:function(){this.iv()},_5Q:function(a){this._61I=a,this.iv()},getLogicalPoint:function(K){return $r(K,this._canvas,this.tv.tx())},validateImpl:function(){var x=this,_=x._canvas,H=x.getWidth(),O=x.getHeight(),g=x.tv,V=x._60I,C=x._61I,U=-g.tx(),w=0;(H!==_.clientWidth||O!==_.clientHeight)&&sg(_,H,O),V.clear(),x._39o._roots.each(function(p){if(p.isVisible()){var C=w+p.getWidth();U+H>=w&&C>=U&&V.add({column:p,startX:w}),w=C}});var D=Yl(_);if(Fb(D,-U,0,1),D.beginPath(),D.rect(U,0,H,O),D.clip(),D.clearRect(U,0,H,O),V.each(function(t){var h=t.column,c=t.startX,X=h.getWidth();X>0&&(D.save(),D.beginPath(),D.rect(c,0,X,O),D.clip(),C&&C.column===h||x.drawColumn(D,h,c,0,X,O),x._columnLineVisible&&Uc(D,c+X-1,0,1,O,x._columnLineColor),D.restore())}),C){var S=C.column,w=C.startX,R=C.position,L=S.getWidth();D.save(),D.beginPath(),D.rect(w,0,L,O),D.clip(),D.fillStyle=x._moveBackground,D.fill(),x.drawColumn(D,S,w,0,L,O),D.restore(),up(D,x._insertColor,R,0,O)}D.restore()},_6Q:function(j){var V=this.tv;return V._31o===j&&V.sm().getSelectionMode()===Gr},drawColumn:function(z,q,A,C,b,P){var V=this,w=V.tv,a=wc(q.getIcon()),B=V.getLabelAlign(q);if(V._6Q(q)){var R=wc(V._checkIcon);od(z,R,A+b/2,C+P/2,q,V)}else{var T=V.getLabel(q),U=V.getLabelFont(q),Z=V.getLabelColor(q),i=ho(U,T).width,x=a?V._indent:0;B===_h?(a&&Do(z,a,Rb,A,C,x,P),Ni(z,T,U,Z,A+x,C,b,P,_h)):B===De?(a&&Do(z,a,Rb,A+b-i-x,C,x,P),Ni(z,T,U,Z,A,C,b,P,De)):(a&&Do(z,a,Rb,A+(b-i-x)/2,C,x,P),Ni(z,T,U,Z,A+(b-i+x)/2,C,0,P,_h))}if(q.isSortable()&&w.getSortColumn()===q&&(a=wc(q.getSortOrder()===rj?V._sortAscIcon:V._sortDescIcon))){var H=Rn(a,q)/2+2;od(z,a,B===De?A+H:A+b-H,C+P/2,q,w)}}});var Ke=function(F){var U=this;U.th=F,U.tv=F._tableView,U.addListeners()};lf(Ke,V,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(i){this.getView().style.cursor=i},handle_mousemove:function(T){if(!Vo){var Z=this;delete Z._29o,Z.setCursor(wr);for(var n=Z.th,E=n._60I,h=n.lp(T).x,C=E.size()-1;C>=0;C--){var w=E.get(C),p=w.column,v=w.startX+p.getWidth();if(n.isResizable()&&f(v-h)<=(Xm?10:3))return Z._29o=w,Z.setCursor(Bm),void 0;h>w.startX&&v>h&&(Z._29o=w),(p.isClickable()||p.isSortable()||n.isMovable()||Z.tv.getCheckColumn&&p===Z.tv.getCheckColumn())&&h>w.startX&&v>h&&Z.setCursor(hc)}}},handle_mousedown:function(K){this.handle_touchstart(K)},handle_touchstart:function(i){var K=this;Pd(i),K.tv.endEditing(),K.handle_mousemove(i),K._29o&&(K.x=ad(i).x,K.lx=K.th.lp(i).x,K.w=K._29o.column.getWidth(),Bf(K,i))},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(N){var b=this,h=b.th,o=b.getView().style.cursor,Q=b._29o,S=ad(N).x-b.x;if(b.resizing||b.moving||(o===Bm?b.resizing=1:h.isMovable()&&o===hc&&f(S)>2&&(b.moving=1)),b.resizing)Q.column.setWidth(b.w+S);else if(b.moving){var W=b.lx+S;h._60I.each(function(l){var J=l.startX,p=J+l.column.getWidth();if(W>=J&&p>=W){var E={column:Q.column,startX:Q.startX+S,front:p-W>W-J,insertColumn:l.column};E.position=E.front?J:p,h._5Q(E)}})}},_16Q:function(f,r){var X=this,x=X.tv,E=X.th,L=E._checkIcon;if(E._6Q(f)){var K=wc(L),b=X.lx,S=f.getWidth(),l=Rn(K,f);if(b>=r+S/2-l&&r+S/2+l>=b){E.setCheckIcon(L===ke?Np:ke);var t=x.sm(),j=x._rows;return L===ke?t.rs(j):t.ss(j),x.onCheckColumnClicked(f),!0}}return!1},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(g){var o=this,f=o.tv,t=o.th,W=o._29o;if(o.moving){var S=t._61I;if(S&&S.insertColumn!==S.column){var u=S.column,c=f.getColumnModel()._roots,e=c.remove(u),n=c.indexOf(S.insertColumn);n>=0&&(S.front||n++,n<=c.size()&&(c.add(u,n),f.getColumnModel()._38I(u,e,n)))}t._5Q(I),delete o.moving}else if(!o.resizing&&W){u=W.column;var m=t.lp(g).x,x=W.startX,O=!0;if(t.onColumnClicked){var B=t.onColumnClicked(u,g,x);B===!1&&(O=!1)}if(O&&m>=x&&m<=x+u.getWidth()&&!o._16Q(u,x)){if(u.isSortable()){var H=f.getSortMode(),C=u.getSortOrder();H===Jm?f.getSortColumn()===u?(C===He&&f.setSortColumn(I),u.setSortOrder(C===rj?He:rj)):f.setSortColumn(u):"bistate"===H&&(f.getSortColumn()===u?u.setSortOrder(C===rj?He:rj):f.setSortColumn(u))}f.onColumnClicked(u,g,x)}}o._29o=o.resizing=o.x=o.lx=o.w=I}}),Mh.TablePane=function(q){this.init(new bj(q))},iq("TablePane",V,{ms_v:1,_44o:1}),Mh.TreeTablePane=function(r){this.init(new Fl(r))},iq("TreeTablePane",V,{ms_v:1,_44o:1}),Mh.Toolbar=function(N){var O=this,u=O._view=zg(1,O),M=u.style;M.background=C.toolbarBackground||"",M.height=Vr+hr,O._canvas=wo(u),O._30o=new mk,O._90I=new mk,O.setItems(N||[]),u.handleGroupSelectedChanged=function(W){if(W.isSelected()){var U=W.getGroupId();null!=U&&O._items.forEach(function(M){var X=M.element;X&&X!==W&&X.setSelected&&X.getGroupId&&X.getGroupId()===U&&X.setSelected(!1)})}},new rl(O)},iq("Toolbar",V,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Ir,bq,ce,cm,Dh,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:C.toolbarLabelColor,_labelSelectColor:C.toolbarLabelSelectColor,_labelFont:C.toolbarLabelFont,_selectBackground:C.toolbarSelectBackground,_itemGap:C.toolbarItemGap,_separatorColor:C.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(j){var o=this.getItemInfoAt(j);return o?o.item.toolTip:I},getLabelColor:function(f){return f&&f.selected&&f.type!==ke&&f.type!==sp?this._labelSelectColor:this._labelColor},onPropertyChanged:function(k){this.iv(),k.property===Ir&&this._items.forEach(function(T){Hi(T)})},redraw:function(){this.iv()},addItem:function(O,Z){var e=this._items;Z==I?e.push(O):e.splice(Z,0,O),this.fp(Ir,I,e)},removeItem:function(R){if(R)for(var U=this._items,Z=0;Z<U.length;Z++)R===U[Z]&&(U.splice(Z,1),this.fp(Ir,I,U))},removeItemById:function(H){if(H!=I)for(var B=this._items,q=0;q<B.length;q++)if(H===B[q].id){var L=B.splice(q,1)[0];return this.fp(Ir,I,B),L}},getItemById:function(t){if(t!=I)for(var J=this._items,h=0;h<J.length;h++){var Q=J[h];if(t===Q.id)return Q}},setItemVisible:function(R,V){var w=this.getItemById(R);w&&(w.visible=V)},getItemInfos:function(){return this._30o},getItemInfoAt:function(x){var N=this,r=0,_=N._30o,T=N.lp(x),A=T.x,j=T.y;if(j>=0&&j<=N.getHeight())for(;r<_.size();r++){var E=_.get(r);if(E.startX<=A&&A<=E.endX)return E}return I},drawItem:function(P,$,n,C,f){if($.visible===!1)return 0;if(rn($.visible)&&!$.visible())return 0;var v=this,k=$.disabled;k&&(P.globalAlpha=Bd);var V=v.drawItemImpl(P,$,n,C,f),j=v._itemGap;return k&&(P.globalAlpha=1),this._currentItem!==$||"separator"===$||$.separator===!0||$.unfocusable||Qe(P,v._separatorColor,n-j/2,0,V+j,C),V},drawItemImpl:function(D,H,R,Z,y){var a=this,c=a._view,e=a._itemGap,w=Z/2,V=H.type,x=H.element,o=H.label;hf(x)&&(o=x,x=I);var t,m=a.getLabelFont(H),Y=a.getLabelColor(H),u=H.selected,E=wc(H.icon),d=Rn(E,H),k=0,M=d+(o?ho(m,o).width:0);if("separator"===H||H.separator===!0)return up(D,a._separatorColor,R,Z/4,w),1;if(x){E&&od(D,E,R+d/2,w,H,a),Ni(D,o,m,Y,R+d,0,0,Z);var P=hi(x);y||a._90I.add(P),P.parentNode!==c&&yj(c,P),x.iv&&x.iv(),x.validate&&x.validate();var n=P.getBoundingClientRect(),b=n.width,i=P.style;return Qq(P),i.left=a.tx()+R+M+hr,i.top=(Z-n.height)/2+hr,M+b}return V===sp?t=wc(u?Ck:ab):V===ke&&(t=wc(u?ke:Np)),t?(k=Rn(t,H),od(D,t,R+k/2,w,H,a),R+=k,M+=k):u&&Uc(D,R-e/2,0,M+e,Z,a.getSelectBackground(H)),E&&od(D,E,R+d/2,w,H,a),Ni(D,o,m,Y,R+d,0,0,Z),M},validateImpl:function(){var c=this,n=c._canvas,$=c.getWidth(),S=c.getHeight(),k=c._30o,d=c._items;sg(n,$,S);var q=Yl(n),g=c._itemGap,L=g/2;Fb(q,c.tx(),0,1),q.clearRect(0,0,$,S);var P=c._90I;c._90I=new mk,k.clear(),d.forEach(function(M){var i=c.drawItem(q,M,L,S);k.add({item:M,startX:L,endX:L+i,width:i}),i&&(L+=i+g)}),P.each(function(J){c._90I.contains(J)||gg(J)});var V=c._64I;c._64I=K(0,L),q.restore(),c._stickToRight?(c._65O=0,q=Yl(n),L=$-c._64I+g,Fb(q,0,0,1),q.clearRect(0,0,$,S),k.clear(),d.forEach(function(r){var v=c.drawItem(q,r,L,S,!0);k.add({item:r,startX:L,endX:L+v,width:v}),v&&(L+=v+g)}),q.restore()):c.tx(c.tx()),V!==c._64I&&c.onSumWidthChanged(V,c._64I)},onSumWidthChanged:function(){},handleClick:function(f,x){var J=this,Z=f.type,l=f.action,A=f.groupId,u=f.selected;f.disabled||(A!=I?u||(f.selected=!0,this._items.forEach(function(L){L.groupId===A&&f!==L&&(L.selected=!1)}),l&&f.action(f,J,x)):Z===ke||"toggle"===Z?(f.selected=!u,l&&f.action(f,J,x)):l&&f.action(f,J,x)),zh(),J.iv()}});var rl=function(P){this.tb=P,this.addListeners()};lf(rl,V,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(V){this.handleScroll(V,10*(V.wheelDelta/40))},handle_DOMMouseScroll:function(V){this.handleScroll(V,10*-V.detail)},handleScroll:function(E,H){Pd(E);var u=this.tb;u.isScrollable()&&!u._stickToRight&&(u.tx(u.tx()+H),Fn())},handle_mousemove:function(A){var x=this;Vo||x.setItem(A)},handle_mouseout:function(H){var i=this;H.target===i.getView()?i.tb.setCurrentItem(I):i.handle_mousemove(H)},handle_mousedown:function(d){this.handle_mousemove(d),this.handle_touchstart(d)},handle_touchstart:function(N){var r=this,P=r.tb,T=N.target;Ei(N)&&(T===r.getView()||T===P._canvas)&&(Pd(N),P.setFocus(N)&&(this.setItem(N,!0),(P.isScrollable()||r.info&&!r.info.item.disabled)&&(r.x=ad(N).x,r.tx=P.tx(),Bf(r,N))))},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(A){var B=this,u=B.tb;if(!u._stickToRight){var t=ad(A).x-B.x;!B._25o&&f(t)>2&&u.isScrollable()&&(B._25o=1),B._25o&&u.tx(B.tx+t)}},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(T){var $=this,D=$.tb,l=$.info,y=$.tb.getItemInfoAt(T);if(!$._25o&&l){var C=l.item;y&&y.item===C&&D.handleClick(C,T)}$._25o=$.x=$.tx=I,$.setItem()},setItem:function(L,p){var P=this,o=P.tb,l=P.info=L?o.getItemInfoAt(L):I,B=l?l.item:I;o.setCurrentItem(B),p&&B&&rn(B.onDown)&&B.onDown(L)}}),Mh.BorderPane=function(){this._view=zg(1,this),this.iv()},iq("BorderPane",V,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(Z,P){this._12o("leftView",Z),P!=I&&this.setLeftWidth(P)},getRightView:function(){return this._rightView},setRightView:function(E,o){this._12o("rightView",E),o!=I&&this.setRightWidth(o)},getTopView:function(){return this._topView},setTopView:function(b,A){this._12o("topView",b),A!=I&&this.setTopHeight(A)},getBottomView:function(){return this._bottomView},setBottomView:function(p,C){this._12o("bottomView",p),C!=I&&this.setBottomHeight(C)},getCenterView:function(){return this._centerView},setCenterView:function(i){this._12o("centerView",i)},_12o:function(E,q){var D=this,$="_"+E,p=D._view,r=D[$];r!==q&&(r&&(r.getView?gg(r.getView()):gg(r)),D[$]=q,q&&(q.getView?yj(p,q.getView(),1):yj(p,q,1)),D.fp(E,r,q))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var Q=this,q=Q._topView,T=Q._bottomView,o=Q._leftView,j=Q._rightView,t=Q._centerView,Z=Q.getWidth(),P=Q.getHeight(),V=0,R=0,k=Z,g=P,A=0,c=0,$=0,d=0;q&&(A=Q._topHeight==I?Wc(q):Q._topHeight,R=A),T&&(c=Q._bottomHeight==I?Wc(T):Q._bottomHeight,g=P-c),o&&($=Q._leftWidth==I?Up(o):Q._leftWidth,V=$),j&&(d=Q._rightWidth==I?Up(j):Q._rightWidth,k=Z-d);var H=K(0,k-V),m=K(0,g-R);q&&Pi(q,0,0,Z,A),T&&Pi(T,0,g,Z,c),o&&Pi(o,0,R,$,m),j&&Pi(j,k,R,d,m),t&&Pi(t,V,R,H,m)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
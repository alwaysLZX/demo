!function(N,m,r){"use strict";var H="ht";if(!N[H]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),N.performance&&N.performance.now||function(){var D=Date.now();N.performance||(N.performance={}),N.performance.now=function(){return Date.now()-D}}();for(var C=Date.now(),P=16,i=["ms","moz","webkit","o"],V=0;V<i.length&&!N.requestAnimationFrame;++V)N.requestAnimationFrame=N[i[V]+"RequestAnimationFrame"],N.cancelAnimationFrame=N[i[V]+"CancelAnimationFrame"]||N[i[V]+"CancelRequestAnimationFrame"];N.requestAnimationFrame||(N.requestAnimationFrame=function(v){var O=Date.now(),a=P+C-O;return 0>a&&(a=0),C=O,N.setTimeout(function(){C=Date.now(),v(performance.now())},a)}),N.cancelAnimationFrame||(N.cancelAnimationFrame=function(K){return N.clearTimeout(K)}),m.assign===r&&(m.assign=function(z){if(z===r||null===z)throw new TypeError("Cannot convert undefined or null to object");for(var D=m(z),E=1;E<arguments.length;E++){var g=arguments[E];if(g!==r&&null!==g)for(var Z in g)m.prototype.hasOwnProperty.call(g,Z)&&(D[Z]=g[Z])}return D})}();var K,$,U,J,p=N.document,C=null,u=N[H]={},P=N[H+"config"],v=u.Default=P&&P.Default||{},w=u.Style=P&&P.Style||{},e=u.Attr=P&&P.Attr||{},D=u.Color=P&&P.Color||{},V=u.IsGetter=P&&P.IsGetter||{},z=Math,t=z.round,b=z.floor,k=z.ceil,c=z.sqrt,F=z.max,x=z.min,M=z.abs,h=z.cos,T=z.acos,Q=z.sin,Y=z.pow,y=z.asin,I=z.PI,R=2*I,f=I/2,o=z.tan,W=z.atan2,E=z.random,l=z.log,B=!1,n=!1,Z=N.parseInt||global.parseInt,g="2018-11-15",S=N.navigator?N.navigator.platform.indexOf("Win")>-1:!1,s=function(r){return r*r},i=N.setTimeout,A=N.clearTimeout,q=N.location,G=N.navigator?N.navigator.userAgent.toLowerCase():"",X=function(e){return e.test(G)},j=X(/msie/),d=X(/msie/)||X(/trident/),_=X(/msie 10/),L=X(/edge/),O=X(/firefox/),a=X(/mac/),_n=v.isTouchable===r?S?!1:p?"ontouchend"in p:!1:v.isTouchable,lr="default",So="single",yl="multiple",Nb="front",Eg="back",en="left",lg="right",al="top",rb="bottom",ne="center",bh="eye",ih="middle",Ed="east",Jq="west",qm="north",um="none",bi="px",Jg="absolute",Tb="border",Om="triangle",Lg="rect",Mh="circle",bo="cylinder",Dr="shape",Kk="items",Td="normal",uc="remove",Hl="clear",Qn="width",$g="height",Vj="ingroup",to="check",Db="uncheck",Dj="radio",_i="radioOn",mo="radioOff",lk="points",ik="values",jb="series",zc="body",Xh="label",be="label2",Qb="note",kb="note2",Gl="icons",Wk="labelFont",wo="labelColor",Yp="labelSelectColor",Dl="note.expanded",xd="note2.expanded",Vc="edge.expanded",Am="edge.points",yq="edge.type",Zo="rotation",Fr="getRotation",oq="setRotation",Cs="hidden",gk="visible",_f="tuv",wm="no",_h="draw",xb="select",mf="currentSubGraph",rk="selectBackground",Bc="autoMakeVisible",$j="autoHideScrollBar",Qk="scrollBarColor",vp="scrollBarSize",Go="indent",Ro="rowHeight",am="columnLineColor",mc="rowLineColor",Ge="columnLineVisible",Lr="rowLineVisible",df="visibleFunc",bq="expandIcon",aj="collapseIcon",cc="checkMode",Sq="sortFunc",Hc="editable",Ho="batchEditable",bj="tristate",Cr="asc",xs="desc",Aj="position",lc="elevation",jl="children",vc="translateX",td="translateY",Hi="dataModel",ri="maxSize",ts="shape3d",pk="shape3d.resolution",Zd="shape3d.visible",Yb="shape3d.from.visible",Dc="shape3d.to.visible",te="shape3d.top.visible",Fm="shape3d.bottom.visible",Rj="repeat.uv.length",ki="serializeValue",fk="deserializeValue",Ur="centerUniform",so="uniform",Qq="rgba(255,255,255,0)",mi="style",el="attr",bp="field",Mm="string",Ef="boolean",$e="color",vn="int",jr="number",ul="ew-resize",Sn="ns-resize",rd="pointer",Wc="auto",Hm="mousedown",wb="mousemove",hg="mouseup",iq="mouseout",dl="touchstart",Wi="touchmove",Qc="touchend",pg="keydown",dn="keyup",mp=["DOMMouseScroll","mousewheel"],Fl=O?mp[0]:mp[1],Kl=_n?[dl,Wi,Qc,pg,dn,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[pg,dn,"keypress","input",Hm,wb,hg,iq,Fl,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],ph=C,bg=C,Wo=C,cr=hg.length,bf=function(){Wo&&(A(Wo.timeout),Wo=C)},gq=function(){Wo&&oi(Wo.e,Wo.info)};N.addEventListener&&(_n||(N.addEventListener(iq,function(){bf()},!1),N.addEventListener(Fl,function(){zf()},!1)),N.addEventListener(dn,function(S){91===S.keyCode?yp={}:delete yp[S.keyCode]},!0),N.addEventListener(pg,function(j){yp[j.keyCode]=!0},!0),N.addEventListener("blur",function(){yp={}}));var Ao,Fi,Dk,Zr=0,Ih=C,Ri=function(n,A){var k=i(function(){delete Ih[k],Ye(Ih)&&(Ih=C),n()},A);return k},kc=C,qe=C,yn={},bb={},He={},Bn={},tk={},yp={},ll={},sd={},Jm={},Nk={},Vq=/.json$/,xp=/^data:image\/svg\+xml/,ab={},Ze=[],Vf={},mr=C,Sc=C,eo=function(){},bc=function(){throw"Oops!"},ls=[0,0,0],$c=[0,0,0,0],Hk={x:0,y:0,width:0,height:0},zo=C,ec=C,eh=C,mh=function(i){ec&&!i._72O&&(eh||(eh={}),eh[i._72O=As()]=i),Ao!=C?gi()<.05&&J&&!Fi&&(sg=bf):sg=Yi},lo=function(D,_,e,T){ec||(ec={});var S=ec[D];if(S){if(S.url===_)return;S.image?(S.image.onload=eo,S.image.onerror=eo):S.request&&(S.request.onload=eo,S.request.onerror=eo)}if(Vq.test(_)){var x=new XMLHttpRequest;if(ec[D]={request:x,url:_},x.overrideMimeType&&x.overrideMimeType("text/plain"),_=v.beforeLoadURL(_),_.data){var Q=v.parse(_.data);Cq(D,Q),v.handleImageLoaded(D,Q)}else x.open("GET",encodeURI(_),!0),x.onload=function(r){if(200===this.status||0===this.status){var H=v.parse(r.target.response||r.target.responseText);Cq(D,H),v.handleImageLoaded(D,H)}else Cq(D,v.handleUnfoundImage(D,_)||C)},x.onerror=function(){Cq(D,v.handleUnfoundImage(D,_)||C)},x.send(null)}else{var Q=new Image;ec[D]={image:Q,url:_},d&&(_.toLowerCase().indexOf(".svg")>0||xp.test(_))?(p.body.appendChild(Q),Q.style.visibility="hidden",Q.onload=function(){i(function(){if(e&&(Q.width=e),T&&(Q.height=T),!Q.width||!Q.height){var l=Q.width||Q.clientWidth,M=Q.height||Q.clientHeight;Q.width=l,Q.height=M}v.handleImageLoaded(D,Q),Cq(D,Q),p.body.removeChild(Q),Q.style.visibility=""},180)},Q.onerror=function(){Cq(D,v.handleUnfoundImage(D,_)||C),p.body.removeChild(Q),Q.style.visibility=""}):(Q.onload=function(){e&&(Q.width=e),T&&(Q.height=T),v.handleImageLoaded(D,Q),Cq(D,Q)},Q.onerror=function(){Cq(D,v.handleUnfoundImage(D,_)||C)}),/^data:image/.test(_)||(_=v.beforeLoadURL(_),/^data:image/.test(_)||(_=v.appendTimeStamp(_),_=encodeURI(_),Q.crossOrigin=v.crossOrigin)),Q.src=_}},Cq=function(a,t){if(bb[a]=t,delete ec[a],Ye(ec)&&(ec=C,eh)){for(var u in eh){var d=eh[u];d._2O&&(d._2O={}),d.invalidateAll&&d.invalidateAll(r,"imageLoaded",a),d.redraw&&d.redraw(),d.iv(),delete d._72O}eh=C}if(t&&eh)for(var u in eh){var d=eh[u];d.invalidateAll&&d.invalidateAll(r,"imageLoading",a),d.redraw&&d.redraw(),d.iv()}},de=function(){return l=z&&Date,function(){return N.performance&&N.performance.now?N.performance.now():Date.now()}}(),ge=function(B,I){I?A(B):N.cancelAnimationFrame(B)},Yf=function(E,l,X){return{width:E,height:l,comps:ij(X)?X:[X]}},_g=function(h,w){return{type:Mh,rect:[h,w,1.6,1.6],borderWidth:1,borderColor:Pc,gradient:Br,gradientColor:Vh,background:Pc}},vb=function(L,h){return Yf(16,16,{type:Om,rect:[4,4,10,8],background:L,rotation:h?1.57:3.14})},Fj=function(r,L){return Yf(16,16,{type:Om,rect:[4,4,8,7],background:r,rotation:L?3.14:0})},lq=function(s){var n=s._orientation;return"horizontal"===n||"h"===n},Pe=function(T){var B=C||4,p=C||1,V=C||1;0>B?B=0:B>.25&&(B=.25);var D,M,b,F,c,o,q,K=.5,f=[],y=[],k=[],t=R/V,P=R/p,l=K-B;for(M=0;p>=M;M++)for(F=-I+M*P,o=h(F),c=Q(F),D=0;V>=D;D++)b=D*t,q=l+B*o,f.push(h(b)*q,c*B,-Q(b)*q),($=T)&&y.push(D/V,1-M/p);for(M=0;p>M;M++){var L=M*(V+1),W=(M+1)*(V+1);for(D=0;V>D;D++)k.push(L+D,W+D+1,W+D,L+D,L+D+1,W+D+1),Th.z=ep.z=T}},vg=function(k){var m=2,u=0;for(var f in k)f.length===m&&Z(f,32)===Mj&&(mr=Sc=k[f]),u++;return u},om=function(Z,p,S,q){return S||(S=_n?5:3,S/=q||1),{x:Z-S,y:p-S,width:2*S,height:2*S}},Of=function(W,c,R,z){var $=this;c||(c=_n?5:3,R=20,z=20);var C={x:W,y:c,width:R,height:z};if(R)for(var g=0;R>g;g++)if(3===R)z=20;else for(var F=0;z>F;F++)$=N?N:R;var o={x:I,y:2*I};if(Ng(C,o)){var M=$g[0]+al[0]+Hl[1]+(Cr.length-1);Zf[bh]=$[M],$[M]=Qp[bh]}},wh=function(a){return(/ble$/.test(a)||/ed$/.test(a)||V[a]?"is":"get")+a.charAt(0).toUpperCase()+a.slice(1)},Qp=function(j){return"set"+j.charAt(0).toUpperCase()+j.slice(1)},Ai=function(E){return typeof E===Mm||E instanceof String},gl=function(t){return typeof t===jr},Yi=function(p){return typeof p===Ef},vl=function(c){return c&&"object"==typeof c},bk=function(M){return"function"==typeof M},ij=function(f){return f instanceof Array},Sb=function(b){return b instanceof Oh},Gi=function(w){return ij(w)?new Oh(w):w},Cp=function(H){return H instanceof dg},Uk=function(R){return R instanceof Wb},Pq=function(Y){return Y instanceof ag},nh=function(g,t){if(!(g instanceof u.Group))return!1;if(!t)return g.isExpanded();var _=t.getDataUI(g);return _&&_._88I?!0:!1},oo=function(u){return u instanceof vi},Ci=function(e){return e&&"IFRAME"===e.tagName},lf=function(L){return L==C||v.numberDigits==C?L:parseFloat(L.toFixed(v.numberDigits))},km=function(i,f,V){var x,$=f.length;if(V)for(var w=0;V>w;w++)if(3===$)i.push(f[0]),i.push(f[1]),i.push(f[2]);else for(x=0;$>x;x++)i.push(f[x]);else if(3===$)i.push(f[0]),i.push(f[1]),i.push(f[2]);else for(x=0;$>x;x++)i.push(f[x])},_r=function(V){return V?vl(V)?V:{}:!1},xj=function(K,s,R){var e,T=vl(K)?K:K.prototype;for(e in s)R&&T[e]!==r||(T[e]=s[e]);return K},Gg=function(y){return String.fromCharCode(y)},Pf=function($){for(var J,L=0,i="";L<$.length;L++)J=$[$.length-1-L],"%"===J?J="'":"a"===J?J='"':"]"===J&&(J="\\"),i+=Gg(J.charCodeAt(0)-1);return i},Nm=function(Y,V,O){Y.superClass.constructor.apply(V,O)},Ye=function($){for(var J in $)return!1;return!0},ci=function(s){return s?0===s.length:!0},eb=function(){var w="";return[Db[0],mc[0],Xh[0]].forEach(function(J){w+=Qp(J).slice(3)}),so=p&&p[w]||Ur,function(z,U){return z===U?!0:z.x===U.x&&z.y===U.y&&z.width===U.width&&z.height===U.height}}(),pd=function(t,y,s){return y>t?y:t>s?s:t},Ld=function(y){return 0>y?-1:y>0?1:0},gi=function(){var W=1e4*Q(cr++);return W-b(W)},an=function(t,i,z){return Fp(t.x,t.y,i.x,i.y,z.x,z.y,z.x+z.width,z.y,!0)||Fp(t.x,t.y,i.x,i.y,z.x+z.width,z.y,z.x+z.width,z.y+z.height,!0)||Fp(t.x,t.y,i.x,i.y,z.x+z.width,z.y+z.height,z.x,z.y+z.height,!0)||Fp(t.x,t.y,i.x,i.y,z.x,z.y+z.height,z.x,z.y,!0)},Fp=function(N,o,w,U,G,Y,a,j,R){var q=(a-G)*(o-Y)-(j-Y)*(N-G),S=(j-Y)*(w-N)-(a-G)*(U-o);if(0!==S){var y=q/S,V=N+y*(w-N),b=o+y*(U-o);return R&&(V+eg<x(N,w)||V-eg>F(N,w)||V+eg<x(G,a)||V-eg>F(G,a)||b+eg<x(o,U)||b-eg>F(o,U)||b+eg<x(Y,j)||b-eg>F(Y,j))?C:[V,b]}return C},Ul=function(V,H,u){if(V&&u)if(H){if(H===mi)return V.getStyle(u);if(H===el)return V.getAttr(u);if(H===bp)return V[u]}else if(u=wh(u),V[u])return V[u]();return r},_o=function(D,C,G,P){if(D&&G)if(C){if(C===mi)D.s(G,P);else if(C===el)D.a(G,P);else if(C===bp){var r=D[G];D[G]=P,D.fp("f:"+G,r,P)}}else G=Qp(G),D[G]&&D[G](P)},Jf=function(I,U,i){return U&&"top"!==U?"bottom"===U?{x:I.x,y:I.y,width:I.width,height:I.height*i}:"right"===U?{x:I.x,y:I.y,width:I.width*i,height:I.height}:"left"===U?{x:I.x+I.width*(1-i),y:I.y,width:I.width*i,height:I.height}:void 0:{x:I.x,y:I.y+I.height*(1-i),width:I.width,height:I.height*i}},Cb=function(I,r,z,c,W){r&&Qh(I,z,c,1,W,r)},Wm=function(G,$,K,p){var F=1-G;return F*F*$+2*G*F*K+G*G*p},Th=function(R,m,j,r,h){var o=1-R;return o*o*o*m+3*o*o*R*j+3*o*R*R*r+R*R*R*h},Cl=function(m){var G,K,E,M,O=0;return m.forEach(function(N){if(G=N.length,G>0)for(K=N[0],M=1;G>M;M++)E=N[M],O+=Xo(K,E),K=E}),O},uo=function(T,W,H){var D="__"+T,x=function(P){H.disabled||H["handle_"+T](P)};H[D]||(H[D]=x,W.addEventListener(T,x,!1))},jf=function(X,E,J){var Q="__"+X,v=J[Q];v&&(E.removeEventListener(X,v,!1),delete J[Q])},Qf=function(Z,R){var W="_"+R;Z[wh(R)]=function(){return this[W]},Z[Qp(R)]=function(X){var b=this[W];this[W]=X,this.fp(R,b,X)}},Zm=function(w){return m.create(w)},$b=function(c){if(!c.element){var C,q;(C=c.textField)?q=fn(tq.TextField,C):(C=c.textArea)?q=fn(tq.TextArea,C):(C=c.button)?q=fn(tq.Button,C):(C=c.comboBox)?q=fn(tq.ComboBox,C):(C=c.checkBox)?q=fn(tq.CheckBox,C):(C=c.radioButton)?q=fn(tq.RadioButton,C):(C=c.slider)?q=fn(tq.Slider,C):(C=c.colorPicker)?q=fn(tq.ColorPicker,C):(C=c.image)&&(q=fn(tq.Image,C)),q&&(c.element=q)}},ei=function(I,r){var R=gh(I);return R._ht=r,R},gh=function(j,S){var G=p.createElement("div"),n=G.style;return G.tabIndex=-1,G.onkeydown=Ib,n.msTouchAction=um,Tl(G,C,0),_n&&n.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",C),j&&(n.overflow=Cs),S&&Ap(S,G),G},tc=function(U,P){var q=p.createElement("canvas"),K=q.style;return K.msTouchAction=um,P||(K.pointerEvents=um),Tl(q,C,0),U&&Ap(U,q),q},Tl=function(m,Q,a){var R=m.style;R.border=Q?Q+" solid 1px":0,R.outline=0,R.padding=a?"0 "+a+bi:0,gn(m)},gn=function(G){var P=G.style;P.position=Jg,P.margin=0,P.setProperty("box-sizing","border-box",C),P.setProperty("-moz-box-sizing","border-box",C)},Rn=function(p,M,u,j){j||(j=Kb),M!=C&&(p.width=M*j,p.style.width=M+bi),u!=C&&(p.height=u*j,p.style.height=u+bi)},Ap=function(j,C,K){j.appendChild(C),K&&(C.style.position=Jg)},Uf=function(R,i){i.split||(i+="");for(var J,m=i.split("\n"),r=0,V=m.length,O=0;V>O;O++){var B=On(R.font,m[O]);B.width>r&&(r=B.width),J||(J=B.height)}return R.ss=m,{width:r,height:J*V}},ze=function(h,t,T,y,P,x){var X=t.length;if(1===X)ro(h,t[0],T,y,P);else for(var A=T.height/X,d={x:T.x,y:T.y,width:T.width,height:A},s=0;s<t.length;s++)x?hs(h,t[s],y,P,d.x,d.y,d.width,d.height,x):ro(h,t[s],d,y,P),d.y+=A},ro=function(L,y,R,I,N){L.font=I?I:kn,L.fillStyle=N?N:ib,L.textAlign=ne,L.textBaseline=ih;var W,G;R?R.width===r?(W=R.x,G=R.y):(W=R.x+R.width/2,G=R.y+R.height/2):(W=0,G=0),L.fillText(y,t(W),t(G))},tb=function(r){r.getView&&(r=r.getView());var D=r.offsetWidth||r.scrollWidth;return!D&&r.style.width&&(D=Z(r.style.width)),D},ld=function(L){L.getView&&(L=L.getView());var e=L.offsetHeight||L.scrollHeight;return!e&&L.style.height&&(e=Z(L.style.height)),e},Dq=function(i,Z,U){var x=Z[0].toUpperCase()+Z.substring(1,Z.length);i["webkit"+x]=U,i["moz"+x]=U,i["ms"+x]=U,i["o"+x]=U,i[Z]=U},Kq=function(){var _=function(w){Ib(w),w.stopPropagation()},Z=_n?[dl]:[pg,Hm];return function(L){var A=gh(),T=A.style;return T.backgroundColor=v.disabledBackground,L&&(T.backgroundImage="url("+L+")",T.backgroundPosition="50% 50%",T.backgroundRepeat="no-repeat no-repeat"),Z.forEach(function(M){A.addEventListener(M,_)}),A}}(),Tp=function(j){var K=j.getContext("2d");return K.save(),K.lineCap=hm,K.lineJoin=Le,K},sg=function(d,k,f,t){of(d,k*Kb,f*Kb),t*=Kb,1!==t&&d.scale(t,t)},of=function(B,F,P){B.translate(F,P)},Bh=function(i,x){x&&i.rotate(x)},ig=function(x,q,X){q===r&&(q=1),X===r&&(X=1),(1!==q||1!==X)&&x.scale(q,X)},Kf=!1,Je=function(R){var l=p.activeElement;if(p.activeElement!==R){l&&l.forceOnblur&&l.forceOnblur();for(var W=[],P=R.parentNode;P;)W.push([P,P.scrollLeft,P.scrollTop]),P=P.parentNode;if(!Kf){var Q=[],C=[];try{for(var E=N.parent,n=N;E!==n;)Q.push([E,E.scrollX,E.scrollY]),n=E,E=N.parent;var r=N.frameElement;if(r)for(var J=r.parentNode;J;)C.push([J,J.scrollLeft,J.scrollTop]),J=J.parentNode}catch(X){Kf=!0}}if(_n)R.focus();else{var w=Rl(),V=w.target;R.focus(),V.scrollLeft=w.left,V.scrollTop=w.top}W.forEach(function(g){g[0].scrollLeft=g[1],g[0].scrollTop=g[2]}),Kf||(Q.forEach(function(n){n[0].scrollTo(n[1],n[2])}),C.forEach(function(Q){Q[0].scrollLeft=Q[1],Q[0].scrollTop=Q[2]}))}},as=function(u){return u&&u.getView?u.getView():u},re=function(q,L,z,j,V){if(2===arguments.length&&(z=L.y,j=L.width,V=L.height,L=L.x),q.isSelfViewEvent)q.setX(L),q.setY(z),q.setWidth(j),q.setHeight(V);else{var D=as(q),W=D.style;if((p.fullscreenElement||p.mozFullScreenElement||p.webkitFullscreenElement||p.msFullscreenElement)!==D)L!==r&&(W.left=L+bi),z!==r&&(W.top=z+bi),j!==r&&(W.width=j+bi),V!==r&&(W.height=V+bi);else{var F=v.getWindowInfo();W.left=(L=F.left)+bi,W.top=(z=F.top)+bi,W.width=(j=F.width)+bi,W.height=(V=F.height)+bi}q.endEditing&&!_n&&q.endEditing(),q.redraw&&q.redraw(),q.invalidate&&q.invalidate(),q.onLayouted&&q.onLayouted(L,z,j,V),q.fireViewEvent&&q.fireViewEvent("layout")}},Xk=function(i){if(!i.touches)return i;var e=i.touches[0];return e?e:i.changedTouches[0]},Rh=function(I){return _n?Xk(I).target:I.target},hi=function(M){v.popup&&v.popup.close(),v.popup=M},Mc=C,np=function(O){Mc.handleWindowTouchMove(O)},ym=function(a){Mc.handleWindowTouchEnd(a),N.removeEventListener(Wi,np,!1),N.removeEventListener(Qc,ym,!1),Mc=C},hh=function(X){Mc.handleWindowMouseMove(X)},Di=function(G){Mc.handleWindowMouseUp(G),N.removeEventListener(wb,hh,!1),N.removeEventListener(hg,Di,!1),Mc=C},ok=function(C){return 1===vm(C)},ej=function(U,C){return C?C.keyCode===U:yp[U]},_q=function(u){return md(u)&&ej(65,u)},ud=function(A){return ej(46,A)||ej(8,A)},Lc=function(D){return function(o){return o?o.keyCode===D:yp[D]}},Mj=573,Gd=[65,83,68,87,37,38,39,40,32,13,27],os=Lc(Gd[0]),Sl=Lc(Gd[1]),Rc=Lc(Gd[2]),Sj=Lc(Gd[3]),Ab=Lc(Gd[4]),Ad=Lc(Gd[5]),Cj=Lc(Gd[6]),hk=Lc(Gd[7]),Nf=Lc(Gd[8]),Zh=Lc(Gd[9]),Rp=Lc(Gd[10]),Vb={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},bl=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,5,5,7,17],tf=C,qq=C,kg=function(X,O){tf||(tf=tc()),Rn(tf,X,O,1);var L=Tp(tf);return L.clearRect(0,0,X,O),L},Lo=function(){var k,j={};for(var G in N){var V=yl.length;if(G.length==V&&G[0]===yl[2]&&G[1]===um[1]&&G[4]===yl[3]&&G[5]===yl[4]&&G.substr(V-2)===um[1]+um[2]){var z=N[G];for(var I in z)I.length===V&&I.substr(0,3)===lg[3]+uc[3]+xb[0]&&I.substr(V-2)===yl[0]+Qb[3]&&(mp=z[I])}}return function(l){var d,E=j[l];return E||(k||(k=tc(),Rn(k,1,1,1)),d=k.getContext("2d"),d.clearRect(0,0,1,1),Qh(d,0,0,1,1,l),E=d.getImageData(0,0,1,1).data,E=j[l]=[E[0],E[1],E[2],E[3]]),E}}(),Jn=function(F){if(!Ai(F))return F;var v=Lo(F);return v.CA||(v.CA=[v[0]/255,v[1]/255,v[2]/255,v[3]/255]),v.CA},jq=function(N,x,I,G,f){var M=tc();M.width=I,M.height=G;var d=M.getContext("2d");d.drawImage(N,0,0,I,G);try{for(var t=d.getImageData(0,0,I,G),i=t.data,v=0,o=i.length;o>v;v+=4){var h=i[v+0],S=i[v+1],H=i[v+2],Y=i[v+3];"override_a"===f?i[v+3]=255*x[3]:"override_rgb"===f?(i[v+0]=255*x[0],i[v+1]=255*x[1],i[v+2]=255*x[2]):"override"===f?(i[v+0]=255*x[0],i[v+1]=255*x[1],i[v+2]=255*x[2],i[v+3]=255*x[3]):(i[v+0]=x[0]*h,i[v+1]=x[1]*S,i[v+2]=x[2]*H,i[v+3]=x[3]*Y)}d.putImageData(t,0,0)}catch(C){return N}return M},Zf=function(g,U,I){return U&&(U="miter"===I?8*U+20:U+1,g&&Ud(g,U)),U},ql=function(H,z){if(z){var m=new Aq(z),j=H.width/2,x=H.height/2,J=xo([m.tf(-j,-x),m.tf(j,-x),m.tf(j,x),m.tf(-j,x)]);return J.x+=H.x+j,J.y+=H.y+x,J}return H},sh=function(A,Q,_,F,k,C,q,H){F*=Math.PI/180;var I={x:Math.cos(F)*(A.x-q.x)/2+Math.sin(F)*(A.y-q.y)/2,y:-Math.sin(F)*(A.x-q.x)/2+Math.cos(F)*(A.y-q.y)/2},G=Math.pow(I.x,2)/Math.pow(Q,2)+Math.pow(I.y,2)/Math.pow(_,2);G>1&&(Q*=Math.sqrt(G),_*=Math.sqrt(G));var B=(k==C?-1:1)*Math.sqrt((Math.pow(Q,2)*Math.pow(_,2)-Math.pow(Q,2)*Math.pow(I.y,2)-Math.pow(_,2)*Math.pow(I.x,2))/(Math.pow(Q,2)*Math.pow(I.y,2)+Math.pow(_,2)*Math.pow(I.x,2)));isNaN(B)&&(B=0);var D={x:B*Q*I.y/_,y:B*-_*I.x/Q},y={x:(A.x+q.x)/2+Math.cos(F)*D.x-Math.sin(F)*D.y,y:(A.y+q.y)/2+Math.sin(F)*D.x+Math.cos(F)*D.y},e=function(L){return Math.sqrt(Math.pow(L[0],2)+Math.pow(L[1],2))},E=function(O,n){return(O[0]*n[0]+O[1]*n[1])/(e(O)*e(n))},f=function(W,w){return(W[0]*w[1]<W[1]*w[0]?-1:1)*Math.acos(E(W,w))},m=f([1,0],[(I.x-D.x)/Q,(I.y-D.y)/_]),l=[(I.x-D.x)/Q,(I.y-D.y)/_],O=[(-I.x-D.x)/Q,(-I.y-D.y)/_],R=f(l,O);E(l,O)<=-1&&(R=Math.PI),E(l,O)>=1&&(R=0);var E=Q>_?Q:_,M=Q>_?1:Q/_,w=Q>_?_/Q:1;if(null==H){var n={x:0,y:0,width:0,height:0};Ud(n,E),n.x*=M,n.width*=M,n.y*=w,n.height*=w;var j=new Aq(F);return n=xo([j.tf(n.x,n.y),j.tf(n.x+n.width,n.y),j.tf(n.x+n.width,n.y+n.height),j.tf(n.x,n.y+n.height)]),n.x+=y.x,n.y+=y.y,[{x:n.x,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width,y:n.y+n.height},{x:n.x,y:n.y+n.height}]}H.translate(y.x,y.y),H.rotate(F),H.scale(M,w),H.arc(0,0,E,m,m+R,1-C),H.scale(1/M,1/w),H.rotate(-F),H.translate(-y.x,-y.y)},nb=function(G,l){G&&G.beginPath();for(var U,X,o,Q=[],w=function(j){for(var N,M=/(\-{0,1}[\d\.]+)/gi,d=[];N=M.exec(j);)d.push(parseFloat(N[0]));return d},Z=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,F={x:0,y:0};U=Z.exec(l);){var D=U[0],n=D.substr(0,1);if("M"===n||"m"===n){for(var $=w(D),m=0;m<$.length;m+=2){var C=$[m],j=$[m+1];"m"===n&&(C+=F.x,j+=F.y),G&&G.moveTo(C,j),Q.push({x:C,y:j}),F.x=C,F.y=j}X=o=null}else if("H"===n||"h"===n){for(var $=w(D),m=0;m<$.length;m+=1){var C=$[m];"h"===n&&(C+=F.x),G&&G.lineTo(C,F.y),Q.push({x:C,y:F.y}),F.x=C}X=o=null}else if("C"===n||"c"===n){for(var $=w(D),m=0;m<$.length;m+=6){var S=$[m],d=$[m+1],r=$[m+2],a=$[m+3],C=$[m+4],j=$[m+5];"c"===n&&(S+=F.x,d+=F.y,r+=F.x,a+=F.y,C+=F.x,j+=F.y),G&&G.bezierCurveTo(S,d,r,a,C,j),Q.push({x:S,y:d}),Q.push({x:r,y:a}),Q.push({x:C,y:j}),F.x=C,F.y=j}X=[S,d,r,a,C,j],o=null}else if("S"===n||"s"===n){for(var $=w(D),m=0;m<$.length;m+=4){var S,d;X?(S=2*X[4]-X[2],d=2*X[5]-X[3]):(S=F.x,d=F.y);var r=$[m],a=$[m+1],C=$[m+2],j=$[m+3];"s"===n&&(r+=F.x,a+=F.y,C+=F.x,j+=F.y),G&&G.bezierCurveTo(S,d,r,a,C,j),Q.push({x:S,y:d}),Q.push({x:r,y:a}),Q.push({x:C,y:j}),F.x=C,F.y=j}X=[S,d,r,a,C,j],o=null}else if("Q"===n||"q"===n){for(var $=w(D),m=0;m<$.length;m+=4){var S=$[m],d=$[m+1],C=$[m+2],j=$[m+3];"q"===n&&(S+=F.x,d+=F.y,C+=F.x,j+=F.y),G&&G.quadraticCurveTo(S,d,C,j),Q.push({x:S,y:d}),Q.push({x:C,y:j}),F.x=C,F.y=j}X=null,o=[S,d,C,j]}else if("T"===n||"t"===n){for(var $=w(D),m=0;m<$.length;m+=2){var S,d;o?(S=2*o[2]-o[0],d=2*o[3]-o[1]):(S=F.x,d=F.y);var C=$[m],j=$[m+1];"t"===n&&(C+=F.x,j+=F.y),G&&G.quadraticCurveTo(S,d,C,j),Q.push({x:S,y:d}),Q.push({x:C,y:j}),F.x=C,F.y=j}X=null,o=[S,d,C,j]}else if("V"===n||"v"===n){for(var $=w(D),m=0;m<$.length;m+=1){var j=$[m];"v"===n&&(j+=F.y),G&&G.lineTo(F.x,j),Q.push({x:F.x,y:j}),F.y=j}X=o=null}else if("L"===n||"l"===n){for(var $=w(D),m=0;m<$.length;m+=2){var C=$[m],j=$[m+1];"l"===n&&(C+=F.x,j+=F.y),G&&G.lineTo(C,j),Q.push({x:C,y:j}),F.x=C,F.y=j}X=o=null}else if("A"===n||"a"===n){for(var $=w(D),m=0;m<$.length;m+=7){var I=$[m],M=$[m+1],E=$[m+2],L=$[m+3],H=$[m+4],C=$[m+5],j=$[m+6];"a"===n&&(C+=F.x,j+=F.y);var q=sh(F,I,M,E,L,H,{x:C,y:j},G);q&&(Q=Q.concat(q)),F.x=C,F.y=j}X=o=null}var W=D.substr(D.length-1);("z"===W||"Z"===W)&&G&&G.closePath()}return Q},sl=function(Y,g){var q,P,M="L"===g[0],R=g.length;for(Y.save(),M?(Y.transform(g[5],g[6],g[7],g[8],g[9],g[10]),q=Y.createLinearGradient(g[1],g[2],g[3],g[4]),P=11):(Y.transform(g[7],g[8],g[9],g[10],g[11],g[12]),q=Y.createRadialGradient(g[1],g[2],g[3],g[4],g[5],g[6]),P=13);R>P;)q.addColorStop(g[P],g[P+1]),P+=2;Y.fillStyle=q},ep=function(K,g){var I=K.s("shape.gradient.pack");if(I){for(var o=I.length,U=new Array(o),O=0;o>O;O++)U[O]=I[O];var m,p,G,y,t,b,T,M,q,z,i,P,e,$="L"===U[0];m=$?5:7,p=U[m],G=U[m+1],y=U[m+2],t=U[m+3],b=U[m+4],T=U[m+5],M=g[0],q=g[1],z=g[2],i=g[3],P=g[4],e=g[5],U[m]=M*p+z*G,U[m+1]=q*p+i*G,U[m+2]=M*y+z*t,U[m+3]=q*y+i*t,U[m+4]=M*b+z*T+P,U[m+5]=q*b+i*T+e,K.s("shape.gradient.pack",U)}},cd=function(h,D,U,m){var E=!1;if(h.beginPath?h.beginPath():E=!0,Sb(D)&&(D=D._as),Sb(U)&&(U=U._as),U&&U.length){for(var r,y,G,W,C=0,p=0,t=U.length;t>p;p++)r=U[p],1===r?(y=D[C++],h.moveTo(y.x,E?-y.y:y.y)):2===r?(y=D[C++],h.lineTo(y.x,E?-y.y:y.y)):3===r?(y=D[C++],G=D[C++],h.quadraticCurveTo(y.x,E?-y.y:y.y,G.x,E?-G.y:G.y)):4===r?(y=D[C++],G=D[C++],W=D[C++],h.bezierCurveTo(y.x,E?-y.y:y.y,G.x,E?-G.y:G.y,W.x,E?-W.y:W.y)):5===r&&h.closePath();m&&5!==r&&h.closePath()}else{var q,Y,g,x=D.length;if(x>0){for(q=D[0],h.moveTo(q.x,E?-q.y:q.y),Y=1;x>Y;Y++)g=D[Y],h.lineTo(g.x,E?-g.y:g.y);m&&h.closePath()}}},kk=function(j,E,f,F){if(Sb(j)&&(j=j._as),Sb(E)&&(E=E._as),E&&E.length){f=f||Se;for(var x,h,Y,l,H,g,R,e,K=[],S=C,o=0,Z=0,i=E.length;i>Z;Z++)if(x=E[Z],1===x)K.push(S=[]),S.push(j[o++]);else if(2===x)S.push(j[o++]);else if(3===x){for(h=S[S.length-1],Y=j[o++],l=j[o++],g=1;f>g;g++)R=Wm(g/f,h.x,Y.x,l.x),e=Wm(g/f,h.y,Y.y,l.y),S.push({x:R,y:e,b:!0});S.push(l)}else if(4===x){for(h=S[S.length-1],Y=j[o++],l=j[o++],H=j[o++],g=1;f>g;g++)R=Th(g/f,h.x,Y.x,l.x,H.x),e=Th(g/f,h.y,Y.y,l.y,H.y),S.push({x:R,y:e,b:!0});S.push(H)}else 5===x&&S.push(S[0]);return F&&5!==x&&S&&S.length>2&&S.push(S[0]),K}return F&&j.length>2&&(j=j.slice(),j.push(j[0])),j?[j]:[]},Zn=function(Q,W,z,i,I,s){var M,P,H,a=Lo(W),U=i,C=a[0],G=a[1],t=a[2];if(z){var F=Lo(z);M=F[0]-C,P=F[1]-G,H=F[2]-t}else M=255-C,P=255-G,H=255-t;for(s||(s=i>10?1:.5,s=1>I?x(s/I,2):s);(i-=s)>0;){var T=1-i/U,p=C+M*T,V=G+P*T,g=t+H*T;p=x(k(p),255),V=x(k(V),255),g=x(k(g),255),Q.strokeStyle="rgb("+p+","+V+","+g+")",Q.lineWidth=i,Q.stroke()}},Mo=function(){var A={};return function(H,h){var N=H+"-"+h,G=A[N];if(G)return G;var Y,y,p,n=Lo(H);return 0>h?(h=(100+h)/100,Y=k(n[0]*h),y=k(n[1]*h),p=k(n[2]*h)):(h/=100,Y=n[0],y=n[1],p=n[2],Y+=(255-Y)*h,y+=(255-y)*h,p+=(255-p)*h,Y=x(k(Y),255),y=x(k(y),255),p=x(k(p),255)),A[N]="rgb("+Y+","+y+","+p+")"}}(),Qh=function(Z,S,A,l,P,G){G&&(Z.fillStyle=G),Z.beginPath(),Z.rect(S,A,l,P),Z.fill()},Ll=function(G,z,Z,a,y,Y,D){G.beginPath(),qr[z](G,Z.x,Z.y,Z.width,Z.height,a,y,Y,D)},Sp=function(R,F,P,C,h){var B=qr[P];R.fillStyle=B?B(R,F,C?C:Vh,h.x,h.y,h.width,h.height):F},Bl=function(L,K,q,G,R,E){try{if(!K.tagName&&K.comps){K._cacheImage_||(K._cacheImage_={});var g;g="override"===G?"colors_override":"override_rgb"===G?"colors_override_rgb":"override_a"===G?"colors_override_a":"colors",K._cacheImage_[g]||(K._cacheImage_[g]={__count__:0});var N=K._cacheImage_[g][q];N||(K._cacheImage_[g].__count__>v.imageCacheThreshold&&(K._cacheImage_[g]={__count__:0}),N=u.Default.toCanvas(K,Ml(K),Zj(K),null,R,E,q,null,G),K._cacheImage_[g][q]=N,K._cacheImage_[g].__count__++),K=N}L.fillStyle=L.createPattern(K,"repeat")}catch(s){L.fillStyle="black"}},Ui=function(k,T,O,d,G,f,l){k.save(),k.translate(T,O),k.scale(1,l/f),k.arc(0,0,f,d,G),k.restore()},Un=function(P,R,A,z,m,p,V,_){var s,a,X,d,f,v,E,r,q,g,y;if(M(m)>2*I&&(m=2*I),f=k(M(m)/(I/4)),s=m/f,a=-s,X=-z,f>0){v=R+h(z)*p,E=A+Q(-z)*V,_?P.lineTo(v,E):P.moveTo(v,E);for(var W=0;f>W;W++)X+=a,d=X-a/2,r=R+h(X)*p,q=A+Q(X)*V,g=R+h(d)*(p/h(a/2)),y=A+Q(d)*(V/h(a/2)),P.quadraticCurveTo(g,y,r,q)}},Fn=function(l,M,f,n,S,K,b,p,e){6===arguments.length&&(b=K,p=K,e=K);var $=M+n,P=f+S,T=S>n?2*n:2*S;K=T>K?K:T,b=T>b?b:T,p=T>p?p:T,e=T>e?e:T;var G=.29*e,L=.58*e;l.moveTo($,P-e),l.quadraticCurveTo($,P-L,$-G,P-G),l.quadraticCurveTo($-L,P,$-e,P),G=.29*p,L=.58*p,l.lineTo(M+p,P),l.quadraticCurveTo(M+L,P,M+G,P-G),l.quadraticCurveTo(M,P-L,M,P-p),G=.29*K,L=.58*K,l.lineTo(M,f+K),l.quadraticCurveTo(M,f+L,M+G,f+G),l.quadraticCurveTo(M+L,f,M+K,f),G=.29*b,L=.58*b,l.lineTo($-b,f),l.quadraticCurveTo($-L,f,$-G,f+G),l.quadraticCurveTo($,f+L,$,f+b),l.lineTo($,P-e)},jc=function(w,v,M,C,R,Y,b){v&&(M=t(M),C=t(C),b||(b=1),w.fillStyle=v,w.beginPath(),w.rect(M,C,b,Y),w.rect(M,C,R,b),Y-b>0&&w.rect(M,C+Y-b,R,b),R-b>0&&w.rect(M+R-b,C,b,Y),w.fill())},ie=function(U,J,O,y){var n=y.x,Z=y.y,I=y.width,K=y.height;if(!(!J||!O||0>=I||0>=K)){var c,W=Lj(J),f=id(J),R=O>0;1===O||-1===O?(U.fillStyle=R?W:f,U.beginPath(),U.rect(n,Z,1,K),U.rect(n,Z,I,1),U.fill(),U.fillStyle=R?f:W,U.beginPath(),U.rect(n,Z+K-1,I,1),U.rect(n+I-1,Z,1,K),U.fill()):(O=x(M(O),x(I/2,K/2)),c=U.createLinearGradient(n,Z,n+O,Z),c.addColorStop(0,R?W:f),c.addColorStop(1,J),U.fillStyle=c,U.beginPath(),U.moveTo(n,Z),U.lineTo(n+O,Z+O),U.lineTo(n+O,Z+K-O),U.lineTo(n,Z+K),U.lineTo(n,Z),U.fill(),c=U.createLinearGradient(n,Z,n,Z+O),c.addColorStop(0,R?W:f),c.addColorStop(1,J),U.fillStyle=c,U.beginPath(),U.moveTo(n,Z),U.lineTo(n+O,Z+O),U.lineTo(n+I-O,Z+O),U.lineTo(n+I,Z),U.lineTo(n,Z),U.fill(),c=U.createLinearGradient(n,Z+K,n,Z+K-O),c.addColorStop(0,R?f:W),c.addColorStop(1,J),U.fillStyle=c,U.beginPath(),U.moveTo(n,Z+K),U.lineTo(n+O,Z+K-O),U.lineTo(n+I-O,Z+K-O),U.lineTo(n+I,Z+K),U.lineTo(n,Z+K),U.fill(),c=U.createLinearGradient(n+I,Z,n+I-O,Z),c.addColorStop(0,R?f:W),c.addColorStop(1,J),U.fillStyle=c,U.beginPath(),U.moveTo(n+I,Z),U.lineTo(n+I-O,Z+O),U.lineTo(n+I-O,Z+K-O),U.lineTo(n+I,Z+K),U.lineTo(n+I,Z),U.fill())}},Or=function(K,A,B,l,V,v,g){var z=K.createLinearGradient(l,V,v,g);return z.addColorStop(0,B),z.addColorStop(1,A),z},Qm=function(E,w,M,v,X,D,L){var Z=E.createLinearGradient(v,X,D,L);return Z.addColorStop(0,w),Z.addColorStop(.5,M),Z.addColorStop(1,w),Z},ai=function(I,h,t,P,S,q,b){var o=I.createLinearGradient(P,S,q,b);return o.addColorStop(0,h),o.addColorStop(1/3,t),o.addColorStop(2/3,h),o.addColorStop(1,t),o},zi=function(E,S,M,y,o,n,g,c,e){var k=E.createRadialGradient(y+n*c,o+g*e,x(n,g)/24,y+n/2,o+g/2,F(n,g)/2);return k.addColorStop(0,M),k.addColorStop(1,S),k},qr={polygon:function(a,d,$,K,p,g){(g==C||3>g)&&(g=6);for(var t,L,N=x(K,p)/2,T=d+K/2,S=$+p/2,B=0,q=2*I/g,u=0;g>u;u++)t=T+h(B)*N,L=S+Q(B)*N,0===u?a.moveTo(t,L):a.lineTo(t,L),B+=q;a.closePath()},arc:function(u,f,j,$,r,P,_,l,s){P==C&&(P=I),_==C&&(_=R),l==C&&(l=!0);var D=f+$/2,K=j+r/2;l&&u.moveTo(D,K),s?Ui(u,D,K,P,_,$/2,r/2):u.arc(D,K,x($,r)/2,P,_),l&&u.closePath()},rect:function(F,s,g,f,r){F.rect(s,g,f,r)},circle:function(b,q,D,A,o){b.arc(q+A/2,D+o/2,x(A,o)/2,0,R,!0)},oval:function(v,T,i,X,U){Ui(v,T+X/2,i+U/2,0,R,X/2,U/2)},roundRect:function(p,e,r,L,I,l){l==C&&(l=x(x(L,I)/4,8)),Fn(p,e,r,L,I,l)},star:function(k,y,g,i,o){var w=2*i,f=2*o,v=y+i/2,Y=g+o/2;k.moveTo(v-w/4,Y-f/12),k.lineTo(y+.306*i,g+.579*o),k.lineTo(v-w/6,Y+f/4),k.lineTo(y+i/2,g+.733*o),k.lineTo(v+w/6,Y+f/4),k.lineTo(y+.693*i,g+.579*o),k.lineTo(v+w/4,Y-f/12),k.lineTo(y+.611*i,g+.332*o),k.lineTo(v+0,Y-f/4),k.lineTo(y+.388*i,g+.332*o),k.closePath()},triangle:function(W,C,a,K,s){W.moveTo(C+K/2,a),W.lineTo(C+K,a+s),W.lineTo(C,a+s),W.closePath()},hexagon:function(R,f,Y,C,k){R.moveTo(f,Y+k/2),R.lineTo(f+C/4,Y+k),R.lineTo(f+3*C/4,+Y+k),R.lineTo(f+C,Y+k/2),R.lineTo(f+3*C/4,Y),R.lineTo(f+C/4,Y),R.closePath()},pentagon:function(Z,C,N,x,J){var E=2*x,j=2*J,K=C+x/2,q=N+J/2;Z.moveTo(K-E/4,q-j/12),Z.lineTo(K-E/6,q+j/4),Z.lineTo(K+E/6,q+j/4),Z.lineTo(K+E/4,q-j/12),Z.lineTo(K+0,q-j/4),Z.closePath()},diamond:function(Y,h,U,t,D){Y.moveTo(h+t/2,U),Y.lineTo(h,U+D/2),Y.lineTo(h+t/2,U+D),Y.lineTo(h+t,U+D/2),Y.closePath()},rightTriangle:function(i,N,o,H,c){i.moveTo(N,o),i.lineTo(N+H,o+c),i.lineTo(N,o+c),i.closePath()},parallelogram:function(K,W,z,y,i){var R=y/4;K.moveTo(W+R,z),K.lineTo(W+y,z),K.lineTo(W+y-R,z+i),K.lineTo(W,z+i),K.closePath()},trapezoid:function(P,v,N,A,d){var n=A/4;P.moveTo(v+n,N),P.lineTo(v+A-n,N),P.lineTo(v+A,N+d),P.lineTo(v,N+d),P.closePath()},"linear.southwest":function(n,Y,a,P,C,s,S){return Or(n,Y,a,P,C+S,P+s,C)},"linear.southeast":function(C,T,N,o,u,S,f){return Or(C,T,N,o+S,u+f,o,u)},"linear.northwest":function(S,x,W,G,h,w,D){return Or(S,x,W,G,h,G+w,h+D)},"linear.northeast":function(R,F,Y,y,h,c,p){return Or(R,F,Y,y+c,h,y,h+p)},"linear.north":function(o,H,k,B,v,m,D){return Or(o,H,k,B,v,B,v+D)},"linear.south":function(n,g,v,Z,u,B,l){return Or(n,g,v,Z,u+l,Z,u)},"linear.west":function(r,h,p,k,Z,V){return Or(r,h,p,k,Z,k+V,Z)},"linear.east":function(n,c,$,K,S,k){return Or(n,c,$,K+k,S,K,S)},"radial.center":function(f,Y,j,B,F,z,W){return zi(f,Y,j,B,F,z,W,.5,.5)},"radial.southwest":function(p,V,z,F,Z,T,J){return zi(p,V,z,F,Z,T,J,.25,.75)},"radial.southeast":function(p,Y,L,J,K,I,r){return zi(p,Y,L,J,K,I,r,.75,.75)},"radial.northwest":function(B,x,H,P,i,M,J){return zi(B,x,H,P,i,M,J,.25,.25)},"radial.northeast":function(m,C,L,V,k,g,t){return zi(m,C,L,V,k,g,t,.75,.25)},"radial.north":function(R,V,I,_,N,E,M){return zi(R,V,I,_,N,E,M,.5,.25)},"radial.south":function(F,C,q,w,G,L,B){return zi(F,C,q,w,G,L,B,.5,.75)},"radial.west":function(P,y,h,o,k,l,S){return zi(P,y,h,o,k,l,S,.25,.5)},"radial.east":function(t,A,l,O,y,V,N){return zi(t,A,l,O,y,V,N,.75,.5)},"spread.horizontal":function(p,q,B,Q,L,f){return Qm(p,q,B,Q,L,Q+f,L)},"spread.vertical":function(D,d,Z,$,R,j,I){return Qm(D,d,Z,$,R,$,R+I)},"spread.diagonal":function(T,p,x,n,R,b,X){return Qm(T,p,x,n+b,R,n,R+X)},"spread.antidiagonal":function(y,b,r,F,v,J,o){return Qm(y,b,r,F,v,F+J,v+o)},"spread.north":function(v,w,V,S,H,K,g){return ai(v,w,V,S,H-g/4,S,H+g+g/4)},"spread.south":function(i,B,N,r,Z,G,$){return ai(i,N,B,r,Z-$/4,r,Z+$+$/4)},"spread.west":function(t,P,q,D,N,I){return ai(t,P,q,D-I/4,N,D+I+I/4,N)},"spread.east":function(x,f,c,D,u,X){return ai(x,c,f,D-X/4,u,D+X+X/4,u)}},ck=function(g,S,z){return new Aq(g).tf(S,z)},An=function(v){var x=v.touches[0],e=v.touches[1],Z=x.clientX,n=x.clientY,A=e.clientX,S=e.clientY;
return c((Z-A)*(Z-A)+(n-S)*(n-S))},tj=(function(){for(var n=0,t=xs.split(""),F=0;F<t.length;F++)n=10*Z(t[F])+n;return Pe(N[Mj.toString(8*F)+Xh.substr(F)+2]),n}(),function(S,W,P){for(var T=0;T<P.size();T++){var l=P.get(T);S.co(l)&&W.add(l)}for(T=0;T<P.size();T++)l=P.get(T),tj(S,W,l._children)}),Hf=function(k,Q,K){for(var m=0;m<K.size();m++){var P=K.get(K.size()-1-m);k.co(P)&&Q.add(P)}for(m=0;m<K.size();m++)P=K.get(m),Hf(k,Q,P._children)},Re=function(R,q,e){for(var j=!1,T=0;T<e.size();T++){var K=e.get(T);R.co(K)?j&&q.add(K):j=1}for(T=0;T<e.size();T++)K=e.get(T),Re(R,q,K._children)},cq=function(z,g,V){for(var i=!1,v=0;v<V.size();v++){var F=V.get(V.size()-1-v);z.co(F)?i&&g.add(F):i=!0}for(v=0;v<V.size();v++)F=V.get(v),cq(z,g,F._children)},wr=function(G,T,E,l){var F=l==C;if(0!==T||0!==E||!F&&0!==l){var r,D,J,q,I,g=new Oh;G.each(function(f){if(Cp(f)){var A=!0;if(J)for(r=0;r<J.size();r++)D=J.get(r),D.isHostOn(f)?(J.removeAt(r),r--,g.remove(D)):A&&(f.isHostOn(D)||f.isLoopedHostOn(D))&&(A=!1);if(q)for(r=0;r<q.size();r++)D=q.get(r),Fg(D,f)?(q.removeAt(r),r--,g.remove(D)):A&&Fg(f,D)&&(A=!1);if(I)for(r=0;r<I.size();r++)D=I.get(r),Gp(D,f)?(I.removeAt(r),r--,g.remove(D)):A&&Gp(f,D)&&(A=!1);A&&(g.add(f),(f._host||f._69O)&&(J||(J=new Oh),J.add(f)),(Pq(f)||Pq(f._parent))&&(q||(q=new Oh),q.add(f)),(oo(f)||oo(f._parent))&&(I||(I=new Oh),I.add(f)))}else if(Uk(f)&&f.s(yq)===lk){var _=f.s(Am);if(_&&!_.isEmpty()){var Z=new Oh;_.each(function(g){g=Io(g),F?(g.x+=T,g.y+=E):(g.x+=T,g.y+=l,g.e==C?g.e=E:g.e+=E),Z.add(g)}),f.s(Am,Z)}}}),g.each(function(J){F?J.translate(T,E):J.translate3d(T,E,l)})}},fp=function(T,U){for(;T&&!T.hasOwnProperty(U);)T=m.getPrototypeOf(T);return T&&m.getOwnPropertyDescriptor(T,U)},yd=m.getPrototypeOf?function(Z,A,z){var G=fp(A,z);G&&m.defineProperty(Z,z,G)}:function(h,y,Z){h[Z]=y[Z]},gm={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},vh=function(){var k={1:function(_,B){return{x:_.x-B.width/2,y:_.y-B.height/2}},2:function(h,A){return{x:h.x+A.width/2,y:h.y-A.height/2}},3:function(x,L){return{x:x.x+x.width/2,y:x.y-L.height/2}},4:function(U,W){return{x:U.x+U.width-W.width/2,y:U.y-W.height/2}},5:function(A,$){return{x:A.x+A.width+$.width/2,y:A.y-$.height/2}},6:function(k){return{x:k.x,y:k.y}},7:function(M){return{x:M.x+M.width/2,y:M.y}},8:function(z){return{x:z.x+z.width,y:z.y}},9:function(T,s){return{x:T.x-s.width/2,y:T.y+s.height/2}},10:function(f,W){return{x:f.x+W.width/2,y:f.y+W.height/2}},11:function(j,v){return{x:j.x+j.width/2,y:j.y+v.height/2}},12:function(r,B){return{x:r.x-B.width/2+r.width,y:r.y+B.height/2}},13:function(G,t){return{x:G.x+G.width+t.width/2,y:G.y+t.height/2}},14:function(V,$){return{x:V.x-$.width/2,y:V.y+V.height/2}},15:function(S){return{x:S.x,y:S.y+S.height/2}},16:function(g,b){return{x:g.x+b.width/2,y:g.y+g.height/2}},17:function(M){return{x:M.x+M.width/2,y:M.y+M.height/2}},18:function(w,p){return{x:w.x+w.width-p.width/2,y:w.y+w.height/2}},19:function(r){return{x:r.x+r.width,y:r.y+r.height/2}},20:function(m,w){return{x:m.x+m.width+w.width/2,y:m.y+m.height/2}},21:function(q,G){return{x:q.x-G.width/2,y:q.y+q.height-G.height/2}},22:function(t,M){return{x:t.x+M.width/2,y:t.y+t.height-M.height/2}},23:function(C,x){return{x:C.x+C.width/2,y:C.y+C.height-x.height/2}},24:function(G,p){return{x:G.x+G.width-p.width/2,y:G.y+G.height-p.height/2}},25:function(M,Y){return{x:M.x+M.width+Y.width/2,y:M.y+M.height-Y.height/2}},26:function(Z){return{x:Z.x,y:Z.y+Z.height}},27:function(g){return{x:g.x+g.width/2,y:g.y+g.height}},28:function(V){return{x:V.x+V.width,y:V.y+V.height}},29:function(x,Z){return{x:x.x-Z.width/2,y:x.y+x.height+Z.height/2}},30:function(P,f){return{x:P.x+f.width/2,y:P.y+P.height+f.height/2}},31:function(x,q){return{x:x.x+x.width/2,y:x.y+x.height+q.height/2}},32:function(a,d){return{x:a.x+a.width-d.width/2,y:a.y+a.height+d.height/2}},33:function(f,x){return{x:f.x+f.width+x.width/2,y:f.y+f.height+x.height/2}},34:function(F,w){return{x:F.x,y:F.y-w.height/2}},35:function(r,H){return{x:r.x+r.width,y:r.y-H.height/2}},36:function(w,Y){return{x:w.x,y:w.y+w.height+Y.height/2}},37:function(f,m){return{x:f.x+f.width,y:f.y+f.height+m.height/2}},38:function(Y,G){return{x:Y.x+Y.width/4,y:Y.y-G.height/2}},39:function(f,p){return{x:f.x+3*f.width/4,y:f.y-p.height/2}},40:function(B){return{x:B.x+B.width/4,y:B.y}},41:function(n){return{x:n.x+3*n.width/4,y:n.y}},42:function(A,K){return{x:A.x+A.width/4,y:A.y+K.height/2}},43:function(G,n){return{x:G.x+3*G.width/4,y:G.y+n.height/2}},44:function(A,S){return{x:A.x+A.width/2,y:A.y+A.height/2-S.height/2}},45:function(t){return{x:t.x+t.width/4,y:t.y+t.height/2}},46:function(A,k){return{x:A.x+A.width/2-k.width/2,y:A.y+A.height/2}},47:function(U,b){return{x:U.x+U.width/2+b.width/2,y:U.y+U.height/2}},48:function(g){return{x:g.x+3*g.width/4,y:g.y+g.height/2}},49:function(h,c){return{x:h.x+h.width/2,y:h.y+h.height/2+c.height/2}},50:function(q,l){return{x:q.x+q.width/4,y:q.y+q.height-l.height/2}},51:function(U,E){return{x:U.x+3*U.width/4,y:U.y+U.height-E.height/2}},52:function(K){return{x:K.x+K.width/4,y:K.y+K.height}},53:function(Q){return{x:Q.x+3*Q.width/4,y:Q.y+Q.height}},54:function(n,i){return{x:n.x+n.width/4,y:n.y+n.height+i.height/2}},55:function(c,T){return{x:c.x+3*c.width/4,y:c.y+c.height+T.height/2}}};return vg(N)?function(m,Z,j){return k[m](Z,j?j:Hk)}:void 0}();xj(D,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Gk=D.reverse,xc=D.transparent,un=D.rectSelectBackground,nj=D.dash,hb=D.titleBackground,Qo=D.titleIconBackground,pn=D.headerBackground,ws=D.headerIconBackground,Bo=D.headerSeparator,nn=D.headerLine,gf=D.contentIconBackground,rn=D.contentLine,ef=(D.widgetIconHighlight,D.widgetIconBorder),Pc=(D.widgetIconGradient,D.imageBackground),Vh=D.imageGradient,Sf=D.highlight,Bb=D.label,Tg=D.labelSelect;if(g&&!N.shutAlert){var Wf=new Date,Ig=g.split("-"),Rq=new Date(Wf.getFullYear(),Wf.getMonth(),Wf.getDate()),g=new Date(Z(Ig[0],10),Z(Ig[1],10)-1,Z(Ig[2],10)),Ac=Rq.getTime(),Kg=g.getTime(),vo=H+"_try",_j=N.alert;try{var $n=N.localStorage;if($n&&_j)if(Kg>Ac&&1728e6>Kg-Ac){var sk=(Kg-Ac)/864e5;$n&&$n[vo]!=sk&&($n[vo]=sk,_j("HT for Web free trial license will expire in "+sk+" days, please apply for a new license!"))}else Ac>=Kg&&_j("Your free trial of HT for Web has expired!"),$n&&delete $n[vo]}catch(cn){}}var _p={ms_ac:function(G,r){for(var b=r.ms_ac,N=0;N<b.length;N++)Qf(G,b[N])},ms_listener:function(S){S.addListeners=function(){for(var I=this,D=0;D<Kl.length;D++)I["handle_"+Kl[D]]&&uo(Kl[D],I.getView(),I)},S.removeListeners=function(){for(var p=this,o=0;o<Kl.length;o++)p["handle_"+Kl[o]]&&jf(Kl[o],p.getView(),p)}},ms_fire:function(m){m.mp=function(c,U,d){this.addPropertyChangeListener(c,U,d)},m.ump=function(d,I){this.removePropertyChangeListener(d,I)},m.fp=function(i,z,s,U,Y){return this.firePropertyChange(i,z,s,U,Y)},m.addPropertyChangeListener=function(X,j,L){var t=this;t._62I||(t._62I=new ae),t._62I.add(X,j,L)},m.removePropertyChangeListener=function(v,S){this._62I&&this._62I.remove(v,S)},m.firePropertyChange=function(r,B,Y,q,k){if(q){if(q(B,Y))return!1}else if(B===Y)return!1;var X=this,K=k||{};return K.property=r,K.oldValue=B,K.newValue=Y,K.source=X,K.data=X,X._62I&&X._62I.fire(K),X.onPropertyChanged&&X.onPropertyChanged(K),!0}},ms_attr:function(d){d.a=function(L,u){var S=this;if(2===arguments.length)S.setAttr(L,u);else{if(!vl(L))return S.getAttr(L);for(var s in L)S.setAttr(s,L[s])}return S},d.getAttr=function(W,d){if(d===r&&(d=1),this._attrObject&&W in this._attrObject)return this._attrObject[W];if(this.getImage){var q=this.getImage();if(Ai(q)&&(q=bb[q]),vl(q)&&"dataBindings"in q)for(var I=q.dataBindings,c=I.length-1;c>=0;c--){var i=I[c];if(i.attr===W){if("defaultValue"in i)return i.defaultValue;break}}}return d?e[W]:r},d.setAttr=function(w,n){var V=this;V._attrObject||(V._attrObject={});var B=V._attrObject[w];n===r?delete V._attrObject[w]:V._attrObject[w]=n,V.fp&&V.fp("a:"+w,B,n)&&V.onAttrChanged&&V.onAttrChanged(w,B,n)},d.getSerializableAttrs=function(){var o,W={};for(o in this._attrObject)W[o]=1;return W}},ms_bnb:function(k){k.getBodyColor=function(f){return f.s("body.color")},k.getBorderColor=function(a){return a.s("border.color")}},_51o:function(V){V.mi=function(j,g,J){this.addInteractorListener(j,g,J)},V.umi=function(u,Y){this.removeInteractorListener(u,Y)},V.fi=function(X){this.fireInteractorEvent(X)},V.addInteractorListener=function(e,l,B){var t=this;t._63I||(t._63I=new ae),t._63I.add(e,l,B)},V.removeInteractorListener=function(B,p){this._63I.remove(B,p)},V.fireInteractorEvent=function(W){this._63I&&this._63I.fire(W)},V.setInteractors=function(Z){var b=this,m=b._interactors;m&&m.each(function(_){_.tearDown()}),ij(Z)&&(Z=new Oh(Z)),b._interactors=Z,Z&&Z.each(function(p){p.setUp()}),b.fp("interactors",m,Z),b.invalidateSelection()},V.getInteractors=function(){return this._interactors}},_49o:function(E){E._44O=C,E._45O=C,E.getTopPainters=function(){return this._44O},E.getBottomPainters=function(){return this._45O},E.addTopPainter=function(N){var a=this;a._44O||(a._44O=new Oh),a._44O.contains(N)||(a._44O.add(N),a.redraw&&a.redraw())},E.removeTopPainter=function(F){var Z=this;Z._44O&&(Z._44O.remove(F),Z.redraw&&Z.redraw())},E.addBottomPainter=function(g){var Q=this;Q._45O||(Q._45O=new Oh),Q._45O.contains(g)||(Q._45O.add(g),Q.redraw&&Q.redraw())},E.removeBottomPainter=function(q){var g=this;g._45O&&(g._45O.remove(q),g.redraw&&g.redraw())},E._93db=function(z,T){var A=this;A._45O&&A._45O.each(function(Z){Z.draw?Z.draw(z,T):Z.call(A,z,T)})},E._92db=function(p,e){var B=this;B._44O&&B._44O.each(function(k){k.draw?k.draw(p,e):k.call(B,p,e)})}},ms_sm:function(Y){Y.sm=function(){return this.getSelectionModel()},Y.setSelectableFunc=function(i){this.sm().setFilterFunc(i)},Y.getSelectableFunc=function(){return this.sm().getFilterFunc()},Y.getSelectionModel=function(){var F=this;return F._selectionModel?F._selectionModel:F.dm().sm()},Y.isSelectionModelShared=function(){return!this._selectionModel},Y.setSelectionModelShared=function(t){var P=this,r=!P._selectionModel,B=P.handleSelectionChange,i=P.dm();r!==t&&(P.invalidateSelection&&P.invalidateSelection(),t?(i.sm().ms(B,P),P._selectionModel.ums(B,P),P._selectionModel.dispose(),P._selectionModel=C):(i.sm().ums(B,P),P._selectionModel=new Sd(i),P._selectionModel.ms(B,P)),P.onSelectionModelSharedChanged(),P.fp("selectionModelShared",r,t))},Y.onSelectionModelSharedChanged=function(){var f=this;f.redraw(),f.invalidateSelection&&f.invalidateSelection()},Y.removeSelection=function(){var h=this.dm();h.beginTransaction(),this.sm().toSelection().each(h.remove,h),h.endTransaction()},Y.selectAll=function(){var u=this;u.sm().ss(u.dm().toDatas(function(D){return u.isVisible(D)&&u.isSelectable(D)}))},Y.isSelected=function(I){return this.sm().co(I)},Y.isSelectedById=function(I){var D=this.dm().getDataById(I);return D?this.isSelected(D):!1},Y.isSelectable=function(p){return this.sm().isSelectable(p)}},ms_tx:function(l){l._64I=0,l._65O=0,l.isScrollable=function(){return this.getWidth()<this._64I},l._40o=function(){return this.isScrollable()},l.getLogicalPoint=function(w){return Al(w,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},l.tx=function(V){return V===r?this.getTranslateX():(this.setTranslateX(V),void 0)},l.getTranslateX=function(){return this._65O},l.setTranslateX=function(N){var o=this,K=o.getWidth()-o._64I;K>N&&(N=K),N>0&&(N=0),N=t(N);var E=o._65O;o._65O=N,o.fp(vc,E,N)}},ms_ty:function(S){S._23Q=0,S._66O=0,S._41o=function(){return this.getHeight()<this._23Q},S.getLogicalPoint=function(q){return Al(q,this._canvas||this._view,this.tx?this.tx():0,this.ty())},S.ty=function(P){return P===r?this.getTranslateY():(this.setTranslateY(P),void 0)},S.getTranslateY=function(){return this._66O},S.setTranslateY=function(B){var w=this,X=w.getHeight()-w._23Q;X>B&&(B=X),B>0&&(B=0),B=t(B);var o=w._66O;w._66O=B,w.fp(td,o,B)}},ms_txy:function(m){m._65O=0,m._66O=0,m.tx=function(F){return F===r?this.getTranslateX():(this.setTranslateX(F),void 0)},m.ty=function(z){return z===r?this.getTranslateY():(this.setTranslateY(z),void 0)},m.onTranslateEnded=function(){},m.setTranslate=function(D,k,i){var x=this;if(i=_r(i)){x._65I&&x._65I.stop(!0);var F=x.tx(),g=x.ty();i.action=function(M){x.setTranslate(F+(D-F)*M,g+(k-g)*M)},i._37o=function(){delete x._66I,delete x._65I,x.onTranslateEnded()},x._66I=1,x._65I=zk(i)}else x.tx(D),x.ty(k)},m.getTranslateX=function(){return this._65O},m.setTranslateX=function(t){var a=this;t=a.adjustTranslateX(t);var y=a._65O;a._65O=t,a.fp(vc,y,t)},m.getTranslateY=function(){return this._66O},m.setTranslateY=function(G){var S=this;G=S.adjustTranslateY(G);var m=S._66O;S._66O=G,S.fp(td,m,G)},m.adjustTranslateX=function(P){return t(P)},m.adjustTranslateY=function(i){return t(i)},m.translate=function(D,Z,X){this.setTranslate(this.tx()+D,this.ty()+Z,X)},m.getLogicalPoint=function(E){var o=this;return Al(E,this._canvas||o._view,o.tx(),o.ty())}},ms_dm:function(F){F.dm=function(l){return l?(this.setDataModel(l),void 0):this.getDataModel()},F.getDataModel=function(){return this._dataModel}},ms_lp:function(D){D.lp=function(g){return this.getLogicalPoint(g)}},ms_v:function(_){_._disabled=!1,_.setDisabled=function(o,J){var g=this,E=g._disabled;E!==o&&(E&&(ks(g._63O),delete g._63O),o&&(Ap(g._view,g._63O=Kq(J)),g.iv()),g._disabled=o,g.fp("disabled",E,o))},_.isDisabled=function(){return this._disabled},_.getDisabledDiv=function(){return this._63O},_.getView=function(){return this._view},_.addToDOM=function(Z){var i=this,y=i.getView(),B=y.style;Z=Z||p.body,Z.appendChild(y),B.left="0",B.right="0",B.top="0",B.bottom="0",N.addEventListener("resize",function(){i.iv()},!1),i.iv()},_.getWidth=function(){return this._view.clientWidth},_.getHeight=function(){return this._view.clientHeight},_.setWidth=function(t){var E=this;E._view.style.width=t+bi,E.iv(),E.fp&&E.fp(Qn,C,t)},_.setHeight=function(O){var b=this;b._view.style.height=O+bi,b.iv(),b.fp&&b.fp($g,C,O)},_.setFocus=function(T){var R=this,t=R._currentEditor;return T&&t&&(t.getView&&(t=t.getView()),t.contains(T.target))?!1:(Je(R._view),R.endEditing&&R.endEditing(),R.fireViewEvent("focus"),!0)},_.iv=function(M){this.invalidate(M)},_.invalidate=function(j){var K=this;K._68I||(K._68I=1,pp(K.validate,K,C,j),K.onInvalidated&&K.onInvalidated(),K.fireViewEvent("invalidate"))},_.validate=function(){var V=this,N=V._view;if(V._68I&&(delete V._68I,N.parentNode))if(0===N.offsetWidth&&0===N.offsetHeight&&V._67I!==C)V._67I===r&&(V._67I=v.reinvalidateCount),V._67I>0?V._67I--:V._67I=C,V.iv();else{V.fireViewEvent("beginValidate"),V.validateImpl(),V.onValidated&&V.onValidated(),V.fireViewEvent("validate");var B=V._63O;B&&(N.lastChild!==B&&(ks(B),Ap(N,B)),re(B,0,0,V.getWidth(),V.getHeight())),mh(V),nl(V),Zp(V)}},_.layout=function(W,t,K,f){1===arguments.length?re(this,W):re(this,W,t,K,f)},_.addViewListener=function(F,$,S){var d=this;d._67O||(d._67O=new ae),d._67O.add(F,$,S)},_.removeViewListener=function(_,Y){this._67O.remove(_,Y)},_.fireViewEvent=function(r){var X=this;X._67O&&(Ai(r)&&(r={kind:r}),X._67O.fire(r)),v.viewListener&&v.viewListener(X,r)}},ms_tip:function(u){u.setToolTipEnabled=function(K){var U=this;K?_n||U._13o||(U.enableToolTip(),U.fp("toolTipEnabled",!1,!0)):U._13o&&(U.disableToolTip(),U.fp("toolTipEnabled",!0,!1))},u.isToolTipEnabled=function(){return!!this._13o},u.enableToolTip=function(){var _=this;_n||_._13o||(_._13o=function(I){var m=_.getToolTip(I);m!=C?v.toolTipContinual&&v.isToolTipShowing()?oi(I,m):(zf(),Wo={timeout:i(gq,Il),e:I,info:m}):zf()},_.getView().addEventListener(wb,_._13o,!1),_.getView().addEventListener("mouseleave",v.hideToolTip,!1))},u.disableToolTip=function(){var w=this;w._13o&&(w.getView().removeEventListener(wb,w._13o,!1),w.getView().removeEventListener("mouseleave",v.hideToolTip,!1),delete w._13o)},u.getToolTip=function(N){var n=this;if(n.getDataAt){var e=n.getDataAt(N);return e?e.getToolTip():C}return n.getValue?n.getValue():void 0}},_52o:function(V){V._zoom=1,V._29I=Hk,V.zoomIn=function(J,l){this.setZoom(this._zoom*wp,J,l)},V.zoomOut=function(G,B){this.setZoom(this._zoom/wp,G,B)},V.zoomReset=function(u,o){this.setZoom(1,u,o)},V.scrollZoomIn=function(G){this.setZoom(this._zoom*Xp,C,G)},V.scrollZoomOut=function(A){this.setZoom(this._zoom/Xp,C,A)},V.pinchZoomIn=function(k){this.setZoom(this._zoom*se,C,k)},V.pinchZoomOut=function(P){this.setZoom(this._zoom/se,C,P)},V.adjustZoom=function(w){return $q>w?$q:w>Dn?Dn:w},V.getZoom=function(){return this._zoom},V.setZoom=function(K,E,D){var R=this;if(E=_r(E)){R._14o&&R._14o.stop(!0);var X=R._zoom;E.action=function(U){R._96O(X+(K-X)*U,D)},E._37o=function(){delete R._zooming,delete R._14o,R.onZoomEnded()},R._zooming=1,R._14o=zk(E)}else R._96O(K,D)},V._96O=function(B,D){var L=this;if(B=L.adjustZoom(B),B!==L._zoom){L.validate();var w=L._29I,k=L._zoom;0!==w.width&&0!==w.height&&(D=D?D:{x:w.x+w.width/2,y:w.y+w.height/2},L.tx((D.x-w.x)*k-D.x*B),L.ty((D.y-w.y)*k-D.y*B)),L._zoom=B,L.fp("zoom",k,B)}}}};xj(v,{numberDigits:5,crossOrigin:"",baseZIndex:r,isTouchable:_n,devicePixelRatio:N.devicePixelRatio?N.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:D.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Mc},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:_n?20:1,animDuration:200,animEasing:function(Z){return Z*Z},labelColor:Bb,labelSelectColor:Tg,labelFont:(_n?"15":"12")+"px arial, sans-serif",widgetIndent:_n?30:20,widgetRowHeight:_n?30:20,widgetHeaderHeight:_n?32:22,widgetTitleHeight:_n?34:24,scrollBarColor:xc,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:_n?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:an,intersectionLineLine:Fp,isEnter:Zh,isEsc:Rp,isDelete:ud,isSpace:Nf,isLeft:Ab,isUp:Ad,isRight:Cj,isDown:hk,getTarget:Rh,isString:Ai,isNumber:gl,isBoolean:Yi,isArray:ij,isSelectAll:_q,isFunction:bk,isObject:vl,getPropertyValue:Ul,setPropertyValue:_o,addMethod:xj,getVersion:function(){return"6.2.5"},appendToScreen:function(y){y=y.getView?y.getView():y,(p.fullscreenElement||p.mozFullScreenElement||p.webkitFullscreenElement||p.msFullscreenElement||p.body).appendChild(y)},toggleFullscreen:function(R){var Q=R.getView();if(p.fullscreenElement||p.mozFullScreenElement||p.webkitFullscreenElement||p.msFullscreenElement)p.exitFullscreen?p.exitFullscreen():p.msExitFullscreen?p.msExitFullscreen():p.mozCancelFullScreen?p.mozCancelFullScreen():p.webkitExitFullscreen&&p.webkitExitFullscreen();else{var r=!0;if(R.isSelfViewEvent){var J=R.getX(),$=R.getY(),b=R.getWidth(),X=R.getHeight(),z=Q.style.background;z||(Q.style.background="white"),Q.requestFullscreen?Q.requestFullscreen():Q.msRequestFullscreen?Q.msRequestFullscreen():Q.mozRequestFullScreen?Q.mozRequestFullScreen():Q.webkitRequestFullscreen&&Q.webkitRequestFullscreen();var f=setInterval(function(){if(Q!==(p.fullscreenElement||p.mozFullScreenElement||p.webkitFullscreenElement||p.msFullscreenElement))clearInterval(f),R.setX(J),R.setY($),R.setWidth(b),R.setHeight(X),R._fullscreen=!1,Q.style.background=z,R.iv();else{var T=u.Default.getWindowInfo();(r||T.width!==R.getWidth()||T.height!==R.getHeight())&&(R.setX(T.left),R.setY(T.top),R.setWidth(T.width),R.setHeight(T.height),R._fullscreen=!0,R.iv(),r=!1)}},500)}else{var l=Q.style.left,d=Q.style.top,b=Q.style.width,X=Q.style.height,z=Q.style.background;z||(Q.style.background="white"),Q.requestFullscreen?Q.requestFullscreen():Q.msRequestFullscreen?Q.msRequestFullscreen():Q.mozRequestFullScreen?Q.mozRequestFullScreen():Q.webkitRequestFullscreen&&Q.webkitRequestFullscreen();var f=setInterval(function(){if(Q!==(p.fullscreenElement||p.mozFullScreenElement||p.webkitFullscreenElement||p.msFullscreenElement))clearInterval(f),Q.style.left=l,Q.style.top=d,Q.style.width=b,Q.style.height=X,Q.style.background=z,R.iv();else{var a=u.Default.getWindowInfo();(r||a.width!==R.getWidth()||a.height!==R.getHeight())&&(re(R),r=!1)}},500)}}},appendTimeStamp:function(s){return s},setCompType:function(X,H){bk(H)||vl(H)?ll[X]=H:Rr(X)},getCompType:function(u){var a=ll[u];return a===r&&Vq.test(u)&&Rr(u),a},getCompTypeMap:function(){return ll},drawCompType:function(q,r,C,J,$,Y){q(r,C,J,$,Y)},numberListener:function(){var B={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(A){var Q=A.keyCode;B[Q]||65===Q&&v.isCtrlDown(A)||86===Q&&v.isCtrlDown(A)||67===Q&&v.isCtrlDown(A)||88===Q&&v.isCtrlDown(A)||Q>=35&&40>=Q||(A.shiftKey||48>Q||Q>57)&&(96>Q||Q>105)&&A.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(k){var q=k.target.tagName;("DIV"===q||"CANVAS"===q)&&!(v.ignoreKeyCodes.indexOf(k.keyCode)>=0)&&("keydown"!==k.type||Ab(k)||Cj(k)||Ad(k)||hk(k)||ud(k)||65===k.keyCode&&(k.metaKey||k.ctrlKey))&&(k.preventDefault(),k.preventManipulation&&k.preventManipulation())},getWindowInfo:function(){var i=p.documentElement,b=i&&(i.scrollLeft||i.scrollTop)?i:p.body;return{target:b,left:b.scrollLeft,top:b.scrollTop,width:N.innerWidth||b.clientWidth,height:N.innerHeight||b.clientHeight}},isDragging:function(){return!!Mc},isLeftButton:function(P){return _n?!0:0===P.button},isInput:function(U){if(!U)return!1;var Q=U.tagName;return"INPUT"===Q||"TEXTAREA"===Q||"SELECT"===Q},getTouchCount:function(p){return _n?p.touches.length:1},isDoubleClick:function(){function x(b){b.details=0,b.timeout=null,b.lastPoint=null}var E={};return kc=new l,qe=kc.getTime(),function(V){if(V.touches&&V.touches.length>1)return!1;var o=V.button==C?"":V.button,j=V.type+o,p=j+"_isDoubleClick",J=E[j];if(J||(J=E[j]={details:0,timeout:null,lastPoint:null}),V[p]===r){V[p]=!0;var m=vq(V);J.timeout&&(A(J.timeout),J.timeout=null),J.lastPoint&&Xo(J.lastPoint,m)>v.doubleClickRange&&x(J),J.lastPoint=m,J.details++,J.timeout=i(function(){x(this)}.bind(J),500)}return 2===J.details}}(),isShiftDown:function(c){return c?c.shiftKey:yp["16"]},isCtrlDown:function(X){return X?a?X.metaKey:X.ctrlKey:a?yp["91"]:yp["17"]},getClientPoint:function(l){return _n&&(l=Xk(l)),{x:l.clientX,y:l.clientY}},isMouseEvent:function(g){return g instanceof MouseEvent||0===g.type.indexOf("mouse")},getTargetElement:function(c){if(v.isMouseEvent(c)||!p.elementFromPoint)return c.target;var z=Jc(c);return p.elementFromPoint(z.x,z.y)},getPagePoint:function(Y){return _n&&(Y=Xk(Y)),{x:Y.pageX,y:Y.pageY}},createObject:function(h,Z){var d=new h;for(var L in Z){var u=Z[L];if(bk(u))d[L]=u;else if(0===L.indexOf("s:"))d.s(L.substr(2),Z[L]);else if(0===L.indexOf("a:"))d.a(L.substr(2),Z[L]);else{var b=Qp(L),u=Z[L];d[b]?(d[b](u),"setToolTip"===b&&d.enableToolTip&&d.enableToolTip()):d[L]=u}}return d},setImage:function(k,q,f,l){var Z=arguments.length;4===Z?lo(k,l,q,f):2===Z?Ai(q)?lo(k,q):bb[k]=q:1===Z&&lo(k,k)},getImage:function(F,c,o){var L;if(F==C)return C;if(vl(F)?L=F:(L=bb[F],F&&L===r&&(ec&&ec[F]||lo(F,F))),c&&L&&L.tagName){var B;B="override"===o?"colors_override":"override_rgb"===o?"colors_override_rgb":"override_a"===o?"colors_override_a":"colors",L[B]||(L[B]={__count__:0});var E=L[B][c];return E||(L[B].__count__>v.imageCacheThreshold&&(L[B]={__count__:0}),E=jq(L,Jn(c),L.width,L.height,o),L[B][c]=E,L[B].__count__++),E}return L},isImageComplete:function(V,I,D){var o=vl(V)?V:bb[V];if(!o)return!1;if(o.tagName)return o.complete;for(var f,V,J,i=o.comps,x=!0,y=0,X=i.length;X>y;y++)if(f=i[y],J=f.type,"image"===f.type){V=f.name,V&&V.func&&(V=Gb(V,I));var R=Yg(V,I,D);if(!R){x=!1;break}}else if(Vq.test(J)&&v.getCompType(J)===r){x=!1;break}return x},getId:function(){var H=1;return function(){return++H}}(),callLater:function(C,V,F,n){var x=function(){C.apply(V,F)};return n?i(x,n):N.requestAnimationFrame(x)},clone:function(T){if(null==T||"object"!=typeof T)return T;if(T instanceof Date){var Q=new Date;return Q.setTime(T.getTime()),Q}if(T instanceof Array){for(var Q=[],k=0,C=T.length;C>k;k++)Q[k]=Io(T[k]);return Q}if(T instanceof Oh){for(var Q=new Oh,k=0,C=T.length;C>k;k++)Q.set(k,Io(T.get(k)));return Q}if(T instanceof ap)return T;if(T instanceof m){var Q={};for(var f in T)T.hasOwnProperty(f)&&(Q[f]=Io(T[f]));return Q}return T},callWhenLoaded:function(V,v){v=v||100;var M=Ri(V,v);Ih||(Ih={}),Ih[M]={tick:M,cb:V,delay:v}},beforeLoadURL:function(I){if(Ih){var Y={};for(var q in Ih){var w=Ih[q];A(w.tick);var F=Ri(w.cb,w.delay);Y[F]={tick:F,delay:w.delay,cb:w.cb}}Ih=Y}return v.convertURL?v.convertURL(I):I},convertURL:function(a){return a},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(R,m){if(R===m)return 0;if(R==C&&m!=C)return 1;if(R!=C&&m==C)return-1;if(R==C&&m==C)return 0;var q,$=typeof R,E=typeof m;return $===Mm&&E===Mm?q=R.localeCompare(m):$===jr&&E===jr&&(q=R-m),q===r&&(q=(""+R).localeCompare(""+m)),q>0?1:0>q?-1:0},getClassMap:function(){return yn},getClass:function(P){if(Ai(P)){var _,C=yn[P];if(!C){_=P.split("."),C=N;for(var w=0;w<_.length;w++)C=C[_[w]];yn[P]=C}return C}return P},def:function(T,q,K){var F,V,N,r=function(){};if(r.prototype=q.prototype,F=new r,Ai(T)){if(yn[T])throw"'"+T+"' already defined";N=Vk(T),F.getClassName=function(){return T}}else N=T;if(F.constructor=N,F.getClass=function(){return N},F.getSuperClass=function(){return q},K)for(V in K)_p[V]&&_p.hasOwnProperty(V)?_p[V](F,K):yd(F,K,V);N.prototype=F,N.superClass=q.prototype},startAnim:function(){var i=function(N){N.duration&&(N.startTime=de()),N.timeId=pp(N.tick,C,C,N.interval)};return function(W){return W=Io(W),W.easing=W.easing||v.animEasing,W.duration||W.frames||(W.duration=v.animDuration),W.t=0,W.duration?W.interval=0:(W.frame=0,W.interval=W.interval||10),W.tick=function(){if(W.duration){var U=(de()-W.startTime)/W.duration;U>1&&(U=1),W.t=U,W.action(W.easing(U),U),1===U?W.stop():W._isPaused||(W.timeId=pp(W.tick))}else W.frame++,U=W.t=W.frame/W.frames,W.action(W.easing(U),U),W.frame<W.frames?W._isPaused||(W.timeId=pp(W.tick,C,C,W.interval)):W.stop()},W.resume=function(){W._isPaused&&(delete W._isPaused,W.duration?W.t<1&&(W.startTime=de()-W.duration*W.t,W.timeId=pp(W.tick)):W.frame<W.frames&&(W.timeId=pp(W.tick,C,C,W.interval)))},W.pause=function(){W._isPaused=!0},W.isPaused=function(){return this._isPaused},W.stop=function(O){W.isRunning()&&(W.duration?W.t<1&&O&&(W.t=1,W.action(W.easing(1),1)):W.frame<W.frames&&O&&(W.frame=W.frames,W.action(W.easing(1),1)),W._37o&&W._37o(),W.finishFunc&&W.finishFunc(),ge(W.timeId,!W.duration),delete W.timeId)},W.isRunning=function(){return W.timeId!=C},W.delay?pp(i,C,[W],W.delay):i(W),W}}(),getTextSize:function(){var A={},o=p?tc().getContext("2d"):C;return function(x,j){o.font=x?x:kn;var u=A[o.font];return u||(u=2*o.measureText("e").width+4,A[o.font]=u),{width:o.measureText(j).width+4,height:u}}}(),drawText:function(W,X,D,b,R,A,B,M,v,I){if(X!=C){var o=On(D,X),H={};H.y=I&&I!==ih?I===al?A+o.height/2:A+M-o.height/2:A+M/2,H.x=v&&v!==en?v===lg?R+B-o.width/2:R+B/2:R+o.width/2,ro(W,X,H,D,b)}},getDistance:function(v,W){var z=v.length;return W?3===z?c(s(v[0]-W[0])+s(v[1]-W[1])+s(v[2]-W[2])):2===z?c(s(v[0]-W[0])+s(v[1]-W[1])):v.z===r?c(s(W.x-v.x)+s(W.y-v.y)):c(s(W.x-v.x)+s(W.y-v.y)+s(W.z-v.z)):3===z?c(s(v[0])+s(v[1])+s(v[2])):2===z?c(s(v[0])+s(v[1])):void 0},brighter:function(w,V){return 0>V&&(V=-V),Mo(w,V?V:40)},darker:function($,X){return X>0&&(X=-X),Mo($,X?X:-40)},unionPoint:function(G,n){if(!G)return C;if(2===arguments.length)return G&&n?{x:x(G.x,n.x),y:x(G.y,n.y),width:M(G.x-n.x),height:M(G.y-n.y)}:C;var s=G;if(s._as&&(s=s._as),s.length===r)return C;var Y=s.length;if(0>=Y)return C;for(var S=1,f=s[0],U={x:f.x,y:f.y,width:0,height:0};Y>S;S++){f=s[S];var N=x(U.x,f.x),l=F(U.x+U.width,f.x),a=x(U.y,f.y),g=F(U.y+U.height,f.y);U.x=N,U.y=a,U.width=l-N,U.height=g-a}return U},unionRect:function($,G){if($&&!G)return Io($);if(!$&&G)return Io(G);if($&&G){var W={x:x($.x,G.x),y:x($.y,G.y)};return W.width=F($.x+$.width,G.x+G.width)-W.x,W.height=F($.y+$.height,G.y+G.height)-W.y,W}return C},containsPoint:function(V,X,E,Y){if(Y!=C&&1!==Y){var F=V.x+V.width/2,a=V.y+V.height/2;V={x:F-V.width/2*Y,y:a-V.height/2*Y,width:V.width*Y,height:V.height*Y}}if(E){var R=V.width/2,f=V.height/2,G=Q(-E),v=h(-E),$=X.x-V.x-R,S=X.y-V.y-f;return X={x:v*$-G*S,y:G*$+v*S},Ng({x:-R,y:-f,width:V.width,height:V.height},X)}return!(!V||X.x<V.x||X.y<V.y||X.x>V.x+V.width||X.y>V.y+V.height)},containsRect:function(M,p){if(!M||!p)return!1;var Q=p.x,w=p.y,L=p.width,K=p.height,G=M.width,E=M.height;if(0>(G|E|L|K))return!1;var g=M.x,b=M.y;if(g>Q||b>w)return!1;if(G+=g,L+=Q,Q>=L){if(G>=g||L>G)return!1}else if(G>=g&&L>G)return!1;if(E+=b,K+=w,w>=K){if(E>=b||K>E)return!1}else if(E>=b&&K>E)return!1;return!0},intersectsRect:function(r,R){if(!r||!R)return!1;var b=R.width,W=R.height,y=r.width,g=r.height;if(0>=y||0>=g||0>=b||0>=W)return!1;var J=R.x,f=R.y,x=r.x,Z=r.y;return y+=x,g+=Z,b+=J,W+=f,y>J&&g>f&&b>x&&W>Z},intersection:function(q,n){if(!q||!n)return C;var R=n.x,s=n.y,A=q.x,M=q.y,k=R,r=s,o=A,T=M;return k+=n.width,r+=n.height,o+=q.width,T+=q.height,A>R&&(R=A),M>s&&(s=M),k>o&&(k=o),r>T&&(r=T),k-=R,r-=s,0>=k||0>=r?C:{x:R,y:s,width:k,height:r}},grow:function(w,$,l){l===r&&(l=$),w.x-=$,w.y-=l,w.width=w.width+2*$,w.height=w.height+2*l},getScreenPoint:function(u,D,R,C,L,N,M){var U,s,G=R.getBoundingClientRect(),x=u*(N||1)+G.left-R.scrollLeft+(C||0),a=D*(M||1)+G.top-R.scrollTop+(L||0),K={x:x,y:a};return(U=R.parentElement)&&(s=U.maxtrixAppend)?s.applyInverse(K,{}):K},getLogicalPoint:function(h,W,U,A,o,z){var q,e,O=W.getBoundingClientRect();h.target?(md(h)?a?yp["91"]=!0:yp["17"]=!0:a?yp["91"]=!1:yp["17"]=!1,yp["16"]=Nh(h)?!0:!1,h=_n?Xk(h):h,q=h.clientX,e=h.clientY):(q=h.x,e=h.y);var v,F;if((v=W.parentElement)&&(F=v.maxtrixAppend)){var V=F.apply({x:q,y:e},{});return V.x=(V.x+W.scrollLeft-(U||0))/(o||1),V.y=(V.y+W.scrollTop-(A||0))/(z||1),V}return{x:(q-O.left+W.scrollLeft-(U||0))/(o||1),y:(e-O.top+W.scrollTop-(A||0))/(z||1)}},removeHTML:function(){var U;return function(Z){return Z&&Z.parentNode?U===Z?!0:(U=Z,Z.parentNode.removeChild(Z),U=C,!0):!1}}(),getToolTipDiv:function(){if(!ph){ph=gh(),bg=gh();var p=ph.style;v.baseZIndex!=C&&(p.zIndex=Z(v.baseZIndex)+3+""),p.whiteSpace="nowrap",p.color=v.toolTipLabelColor,p.background=v.toolTipBackground,p.font=v.toolTipLabelFont,p.padding="5px",p.boxShadow="0px 0px 3px "+v.toolTipShadowColor}return ph},isToolTipShowing:function(){return ph&&ph.parentNode?!0:bg&&bg.parentNode?!0:!1},hideToolTip:function(){ks(ph),ks(bg),bf()},showToolTip:function(M,B){if(!M||B==C)return zf(),void 0;v.getToolTipDiv();var x,H;if(B.html?(B=B.html,x=bg,ks(ph)):(x=ph,ks(bg)),H=x.style,x.innerHTML=B,x.parentNode||u.Default.appendToScreen(x),M.target){M=Jc(M);var n=Rl(),P=M.x,d=M.y,J=_n?60:12;if(_n){var L=x.getBoundingClientRect();H.left=P-L.width/2+bi,H.top=d-L.height-J<n.top?d+J+bi:d-L.height-J+bi
}else{H.left=P+J+bi,H.top=d+J+bi;var L=x.getBoundingClientRect();L.left+L.width>n.width&&(H.left=P-J-L.width+bi),L.top+L.height>n.height&&(H.top=d-J-L.height+bi),L.left<0&&(H.left=P+J+bi),L.top<0&&(H.top=d+J+bi)}}else H.left=M.x+bi,H.top=M.y+bi;bf()},startDragging:function(L,a,k){k==r&&(k=!0),L!==Mc&&(Mc?k&&(_n?Mc.handleWindowTouchEnd(a):Mc.handleWindowMouseUp(a)):_n?(N.addEventListener(Wi,np,!1),N.addEventListener(Qc,ym,!1)):(N.addEventListener(wb,hh,!1),N.addEventListener(hg,Di,!1)),Mc=L)},getImageMap:function(){return bb},toBoundaries:function(b,p,s,i){var Z=[];return kk(b,p,s,i).forEach(function(h){var u=[];h.forEach(function(G){u.push(G.x,G.y)}),Z.push(u)}),Z},getCurrentKeyCodeMap:function(){return yp},drawCenterImage:function(A,S,n,g,p,s,I,J){var N=Ml(S,p,s),U=Zj(S,p,s);er(A,S,t(n-N/2),t(g-U/2),N,U,p,s,I,J)},drawStretchImage:function(s,_,I,l,U,a,P,D,H,p,O,o){var d,c=Ml(_,D,H,a),S=Zj(_,D,H,P);"uniform"===I?(d=x(a/c,P/S),c*=d,S*=d,l+=t((a-c)/2),U+=t((P-S)/2),a=c,P=S):"centerUniform"===I&&((c>a||S>P)&&(d=x(a/c,P/S),c*=d,S*=d),l+=t((a-c)/2),U+=t((P-S)/2),a=c,P=S);var k=s.interactiveInfo;if(k){var r;if(r="center"===I?{x:l+a/2-c/2,y:U+P/2-S/2,width:c,height:S}:{x:l,y:U,width:a,height:P},k.rect){var B=k.compInfos,i=B.length;i&&(B[i-1].rect.image=_)}else k.rect=r}if("center"===I){var g=O!==!1&&(c>a||S>P);g&&(s.save(),s.beginPath(),s.rect(l,U,a,P),s.clip()),er(s,_,l+a/2-c/2,U+P/2-S/2,c,S,D,H,p,o),g&&s.restore()}else er(s,_,l,U,a,P,D,H,p,o)},toCanvas:function(H,q,E,g,p,V,z,s,b){H=Sg(H,z),q=q||Ml(H,p),E=E||Zj(H,p);var i=tc(),k=Tp(i);return s?(Rn(i,q,E,s),k.scale(s,s)):Rn(i,q,E,1),_e(k,H,g,0,0,q,E,p,V,z,b),H&&H.clampToEdge&&(i.clampToEdge=H.clampToEdge),k.restore(),i},createGradientImage:function(K,_,l,F){for(var b=["L",0,0,K,0,1,0,0,1,0,0],v=0,Y=Math.min(_.length,l.length);Y>v;v++)b.push(l[v],_[v]);var A=u.Default.toCanvas({width:K,height:K,clampToEdge:!0,comps:[{type:"shape",rotation:F||0,points:[0,0,K,0,K,K,0,K],background:"#ffffff",gradientPack:b}]});return A},createElement:function(M,c,Z,O){var l=p.createElement(M);return Tl(l,c||D.widgetBorder,2),l.style.font=Z?Z:kn,O!=C&&(l.value=O),v.onElementCreated&&v.onElementCreated(l),l},containedInView:function(_,Y){var c=as(Y).getBoundingClientRect();return Ng({x:c.left,y:c.top,width:c.width,height:c.height},vq(_))},isIsolating:function(){return Zr>0},setIsolating:function(K){K?Zr++:Zr--},getMSMap:function(){return _p},stringify:function(b,$){var K=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var Q=JSON.stringify(b,function(y,p){return"function"==typeof p?"__ht__"+(p.__ht__||p.toString()):gl(p)?lf(p):p},$==C?2:$);return Date.prototype.toJSON=K,Q},parse:function(W){return Ai(W)?JSON.parse(W,function(q,J){if(Ai(J)){if("__ht__function"==J.substr(0,14)){var t=J.indexOf("{")+1,C=J.lastIndexOf("}"),w=J.indexOf("(")+1,D=J.indexOf(")");if(t&&C&&w&&D){var $=new Function(J.substring(w,D),J.substring(t,C));return $.__ht__=J.substr(6),$}}if("__ht__date"==J.substr(0,10))return new Date(Z(J.substr(10)))}return J}):W},loadJS:function(f,s){s&&f.push(s);var W=f.shift();if(ij(W))f=W.contact(f),v.loadJS(f);else if(bk(W))W(),v.loadJS(f);else if(Ai(W)){var X=p.createElement("script");X.onload=function(){v.loadJS(f)},X.setAttribute("src",W),p.getElementsByTagName("head")[0].appendChild(X)}else f.length&&v.loadJS(f)},toRoundedCorner:function(v,Z){var R=v.size();if(0>=Z)return{points:v};var C,e=new Oh,J=new Oh,F=v.get(0);e.add(F),J.add(1);for(var y=1;R>y;y++)if(R>y+1){var I=v.get(y),A=v.get(y+1),D=F.x,u=F.y,X=I.x,N=I.y,g=N-u,d=X-D,c=W(g,d);C=x(.99*Xo(F,I),Z),e.add({x:X-C*h(c),y:N-C*Q(c)}),e.add(I),D=I.x,u=I.y,X=A.x,N=A.y,g=N-u,d=X-D,c=W(g,d),C=x(.99*Xo(I,A),Z),F={x:D+C*h(c),y:u+C*Q(c)},e.add(F),J.addAll([2,3])}else e.add(v.get(y)),J.add(2);return{points:e,segments:J}},toColorData:Lo,setCanvas:Rn,createDiv:gh,createDisabledDiv:Kq,createView:ei,createCanvas:tc,appendChild:Ap,initContext:Tp,checkLoadingImage:mh,translateAndScale:sg,layout:re,getPosition:vh,drawPoints:cd,drawRoundRect:Fn,drawBorder:jc,setFocus:Je,getter:wh,setter:Qp,isEmptyObject:Ye},!0),xj(V,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var eq=v.disabledOpacity,Il=v.toolTipDelay,Kb=v.devicePixelRatio,Kj=v.autoMakeVisible,Vn=v.autoHideScrollBar,Br=v.imageGradient,oi=v.showToolTip,zf=v.hideToolTip,ur=v.dashPattern,hm=v.lineCap,Le=v.lineJoin,ib=v.labelColor,qp=v.labelSelectColor,kn=v.labelFont,ms=v.widgetIndent,wk=v.widgetRowHeight,Ir=v.widgetHeaderHeight,Tc=v.widgetTitleHeight,Qg=v.scrollBarColor,mk=v.scrollBarSize,kl=v.scrollBarTimeout,ao=v.scrollBarMinLength,Oi=v.scrollBarInteractiveSize,wp=v.zoomIncrement,Xp=v.scrollZoomIncrement,se=v.pinchZoomIncrement,Dn=v.zoomMax,$q=v.zoomMin,fn=v.createObject,Ib=v.preventDefault,pq=v.setImage,Sg=v.getImage,Yg=v.isImageComplete,Zl=v.drawCenterImage,_e=v.drawStretchImage,As=v.getId,pp=v.callLater,Yc=v.sortFunc,Io=v.clone,Vk=v.getClass,zk=v.startAnim,Lj=v.brighter,id=v.darker,hs=v.drawText,On=v.getTextSize,Pr=v.isLeftButton,vm=v.getTouchCount,co=v.isDoubleClick,Nh=v.isShiftDown,md=v.isCtrlDown,vq=v.getClientPoint,Jc=v.getPagePoint,Xo=v.getDistance,xo=v.unionPoint,$k=v.unionRect,Ng=v.containsPoint,Ii=v.containsRect,cj=v.intersectsRect,Ep=v.intersection,Rl=v.getWindowInfo,Ud=v.grow,Al=v.getLogicalPoint,qg=v.getScreenPoint,qf=v.startDragging,ks=v.removeHTML,fm=v.createElement,Se=v.segmentResolution,kf=v.shapeResolution,Ue=v.shapeSide,rh=v.def,rq=function(F,L,g){rh(H+"."+F,L,g)},rr=function(t,n){t.childNodes.forEach(function(A){n(A),rr(A,n)})};xj(v,{toolTipLabelColor:ib,toolTipLabelFont:kn,toolTipBackground:D.toolTipBackground,toolTipShadowColor:xc,drawBreakableText:ze,setDevicePixelRatio:function(k){Kb=v.devicePixelRatio="number"==typeof k?k:N.devicePixelRatio,rr(p.body,function(U){var S=U._ht;S&&S._canvas&&(Rn(S._canvas,S.getWidth(),S.getHeight()),S.redraw?S.redraw():S.iv())})}},!0);var eg=1e-6,Pl="undefined"!=typeof Uint16Array?Uint16Array:Array,me="undefined"!=typeof Float32Array?Float32Array:Array,Xl=function(m,X,z){var i=[m[0]-X[0],m[1]-X[1],m[2]-X[2]];if(z){var q=Xo(i);q>0&&(i[0]/=q,i[1]/=q,i[2]/=q)}return i},Po=function(){var I="charCodeAt",D=2*(2*Jg.length+1);for(var R in N)if(R===H+en[0]+bi.length){var E=N[R];if(!E)break;for(var U=E.length,Z=0;U>Z;Z++)if(E[Z][I](0)===D&&E[Z+1]!=C&&E[Z+1]===bi[0]&&E[Z+2]!=C&&E[Z+2][I](0)===D){for(var h=Z+3;U>h;h++)if(E[h][I](0)===D){if(0==E[h+1])for(var o,V=h+2;U>V;V++){if(E[V][I](0)===D){0==E[V-1]&&o&&(j=o.substr(0,o.length-1));break}o==C?o=E[V]:o+=E[V]}break}break}break}return function(B){return[-B[0],-B[1],-B[2]]}}(),Kc=function(J,L){return 3===J.length?J[0]*L[0]+J[1]*L[1]+J[2]*L[2]:J[0]*L[0]+J[1]*L[1]},mb=function(){var l=new me(16);return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},ni=mb(),Me=function(o){var G=new me(16);return G[0]=o[0],G[1]=o[1],G[2]=o[2],G[3]=o[3],G[4]=o[4],G[5]=o[5],G[6]=o[6],G[7]=o[7],G[8]=o[8],G[9]=o[9],G[10]=o[10],G[11]=o[11],G[12]=o[12],G[13]=o[13],G[14]=o[14],G[15]=o[15],G},sn=function(a,v){return a[0]=v[0],a[1]=v[1],a[2]=v[2],a[3]=v[3],a[4]=v[4],a[5]=v[5],a[6]=v[6],a[7]=v[7],a[8]=v[8],a[9]=v[9],a[10]=v[10],a[11]=v[11],a[12]=v[12],a[13]=v[13],a[14]=v[14],a[15]=v[15],a},gd=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},mg=function(k,v){var $=k[0],s=k[1],I=k[2];return k[0]=v[0]*$+v[4]*s+v[8]*I+v[12],k[1]=v[1]*$+v[5]*s+v[9]*I+v[13],k[2]=v[2]*$+v[6]*s+v[10]*I+v[14],k},Yn=function(A,X){var S=A[0],V=A[1],R=A[2],F=A[3];return A[0]=X[0]*S+X[4]*V+X[8]*R+X[12]*F,A[1]=X[1]*S+X[5]*V+X[9]*R+X[13]*F,A[2]=X[2]*S+X[6]*V+X[10]*R+X[14]*F,A[3]=X[3]*S+X[7]*V+X[11]*R+X[15]*F,A},mn=function(){var A,l,i,m,f=Gg(Gd[1]+Gd[7]),e=Gg(Gd[0]+Gd[3]-Gd[10]),$=Gg(Gd[8]+2),S=function(){return l=i.charAt(A),A+=1,l},V=function(){var w="";if(l===$)for(;S();){if(l===$)return S(),w;w+=l}else S()},Q=function(){for(;l&&" ">=l;)S()},j=function(){var M,t={};if(l===f){if(S(),Q(),l===e)return S(),t;for(;l;){if(M=V(),Q(),S(),t[M]=m(),Q(),l===e)return S(),t;S(),Q()}}};return m=function(){switch(Q(),l){case f:return j();default:return V()}},function(d){if(J={},d){var D;if(i=d,A=0,l=" ",D=m(),Q(),!l)return D}}}(),dj=function(s,c){if(c){var $=Q(c),H=h(c),x=s[4],j=s[5],r=s[6],n=s[7],V=s[8],v=s[9],S=s[10],d=s[11];s[4]=x*H+V*$,s[5]=j*H+v*$,s[6]=r*H+S*$,s[7]=n*H+d*$,s[8]=V*H-x*$,s[9]=v*H-j*$,s[10]=S*H-r*$,s[11]=d*H-n*$}},rc=function(f,i){if(i){var O=Q(i),s=h(i),H=f[0],S=f[1],J=f[2],T=f[3],L=f[8],G=f[9],y=f[10],D=f[11];f[0]=H*s-L*O,f[1]=S*s-G*O,f[2]=J*s-y*O,f[3]=T*s-D*O,f[8]=H*O+L*s,f[9]=S*O+G*s,f[10]=J*O+y*s,f[11]=T*O+D*s}},zn=function(T,R){if(R){var g=Q(R),k=h(R),K=T[0],D=T[1],V=T[2],Y=T[3],u=T[4],b=T[5],c=T[6],r=T[7];T[0]=K*k+u*g,T[1]=D*k+b*g,T[2]=V*k+c*g,T[3]=Y*k+r*g,T[4]=u*k-K*g,T[5]=b*k-D*g,T[6]=c*k-V*g,T[7]=r*k-Y*g}},yk=function(E,h,O){return $i(C,O===!1?C:E.getFinalScale3d(),E.getFinalRotation3d(),E.getRotationMode(),E.p3(),C,h)},$i=function(S,C,J,z,B,r,R){return r||(r=mb()),B&&fb(r,B),El(r,J,z),R&&zh(r,r,R),C&&Gn(r,C),S&&zh(r,r,S),r},mq=function(K,A,l){A=Z(A),l=Z(l);var E=this;E.g=K,E._84O=A,E._85O=l,E._70I=!0,E.F=0,E._83O=A+l,E.pen={x:0,y:0}},hn="lineDashOffset",oj="setLineDash",_b=function(m){for(var B in m)1===B.length&&(hn=m[B]);return B?1:0},ke=function(D,l,L){return ci(l)?D:D[oj]?(D[oj](l),L&&(D.lineDashOffset=L),D):new mq(D,l[0],l.length>1?l[1]:l[0])},ad=function(N,P){!ci(P)&&N[oj]&&(N[oj](Ze),N.lineDashOffset=0)};if(rh(mq,m,{_69I:6,moveTo:function(k,i){var e=this,F=e.pen;F.x=k,F.y=i,e.g.moveTo(k,i),e.start||(e.start={x:k,y:i})},lineTo:function(Y,J){var c=this,p=c.pen,R=Y-p.x,E=J-p.y,N=W(E,R),X=h(N),A=Q(N),k=c._23O(p.x,p.y,Y,J),$=c._85O,U=c._84O,_=c._83O;if(c.F){if(c.F>k)return c._70I?c._72I(Y,J):c.moveTo(Y,J),c.F-=k,void 0;if(c._70I?c._72I(p.x+X*c.F,p.y+A*c.F):c.moveTo(p.x+X*c.F,p.y+A*c.F),k-=c.F,c.F=0,c._70I=!c._70I,!k)return}var H=b(k/_);if(H){for(var u=X*U,j=A*U,r=X*$,s=A*$,P=0;H>P;P++)c._70I?(c._72I(p.x+u,p.y+j),c.moveTo(p.x+r,p.y+s)):(c.moveTo(p.x+r,p.y+s),c._72I(p.x+u,p.y+j));k-=_*H}c._70I?k>U?(c._72I(p.x+X*U,p.y+A*U),c.moveTo(Y,J),c.F=$-(k-U),c._70I=!1):(c._72I(Y,J),k===U?(c.F=0,c._70I=!c._70I):(c.F=U-k,c.moveTo(Y,J))):k>$?(c.moveTo(p.x+X*$,p.y+A*$),c._72I(Y,J),c.F=U-(k-$),c._70I=!0):(c.moveTo(Y,J),k===$?(c.F=0,c._70I=!c._70I):c.F=$-k)},quadraticCurveTo:function(L,a,F,H){var I,J=this,v=J.pen,C=v.x,V=v.y,i=J._22O(C,V,L,a,F,H),P=0,Z=0,h=J._85O,n=J._84O;if(J.F){if(J.F>i)return J._70I?J._71I(L,a,F,H):J.moveTo(F,H),J.F-=i,void 0;if(P=J.F/i,I=J._20O(C,V,L,a,F,H,P),J._70I?J._71I(I[2],I[3],I[4],I[5]):J.moveTo(I[4],I[5]),J.F=0,J._70I=!J._70I,!i)return}var s=i-i*P,q=b(s/J._83O),A=n/i,S=h/i;if(q)for(var l=0;q>l;l++)J._70I?(Z=P+A,I=J._21O(C,V,L,a,F,H,P,Z),J._71I(I[2],I[3],I[4],I[5]),P=Z,Z=P+S,I=J._21O(C,V,L,a,F,H,P,Z),J.moveTo(I[4],I[5])):(Z=P+S,I=J._21O(C,V,L,a,F,H,P,Z),J.moveTo(I[4],I[5]),P=Z,Z=P+A,I=J._21O(C,V,L,a,F,H,P,Z),J._71I(I[2],I[3],I[4],I[5])),P=Z;s=i-i*P,J._70I?s>n?(Z=P+A,I=J._21O(C,V,L,a,F,H,P,Z),J._71I(I[2],I[3],I[4],I[5]),J.moveTo(F,H),J.F=h-(s-n),J._70I=!1):(I=J._19O(C,V,L,a,F,H,P),J._71I(I[2],I[3],I[4],I[5]),i===n?(J.F=0,J._70I=!J._70I):(J.F=n-s,J.moveTo(F,H))):s>h?(Z=P+S,I=J._21O(C,V,L,a,F,H,P,Z),J.moveTo(I[4],I[5]),I=J._19O(C,V,L,a,F,H,Z),J._71I(I[2],I[3],I[4],I[5]),J.F=n-(s-h),J._70I=!0):(J.moveTo(F,H),s===h?(J.F=0,J._70I=!J._70I):J.F=h-s)},bezierCurveTo:function(){var K=arguments;this.pen={x:K[4],y:K[5]},this.g.bezierCurveTo(K[0],K[1],K[2],K[3],K[4],K[5])},arc:function(N,r,I,B,T,c){c||(B=-B,T=-T),Un(this,N,r,B,T-B,I,I,!1)},rect:function(p,P,W,u){var l=this;l.pen={x:p,y:P},l.moveTo(p,P),l.lineTo(p,P+u),l.lineTo(p+W,P+u),l.lineTo(p+W,P),l.lineTo(p,P)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(z,v,O,N){var S=O-z,u=N-v;return c(S*S+u*u)},_22O:function(P,l,v,j,N,G,b){for(var I,Y,g,J,T,o,O,V=0,Q=P,W=l,C=b>0?b:this._69I,u=1;C>=u;u++)g=u/C,J=1-g,T=J*J,o=2*g*J,O=g*g,I=T*P+o*v+O*N,Y=T*l+o*j+O*G,V+=this._23O(Q,W,I,Y),Q=I,W=Y;return V},_21O:function(f,K,M,G,R,Q,Z,z){var L=this;if(0===Z)return L._20O(f,K,M,G,R,Q,z);if(1===z)return L._19O(f,K,M,G,R,Q,Z);var u=L._20O(f,K,M,G,R,Q,z);return u.push(Z/z),L._19O.apply(L,u)},_20O:function(X,z,v,I,P,u,O){if(1!==O){var f=v+(P-v)*O,b=I+(u-I)*O;v=X+(v-X)*O,I=z+(I-z)*O,P=v+(f-v)*O,u=I+(b-I)*O}return[X,z,v,I,P,u]},_19O:function(X,q,D,N,G,S,o){if(1!==o){var Y=X+(D-X)*o,J=q+(N-q)*o;D+=(G-D)*o,N+=(S-N)*o,X=Y+(D-Y)*o,q=J+(N-J)*o}return[X,q,D,N,G,S]},_72I:function($,M){var u=this.pen;($!==u.x||M!==u.y)&&(u.x=$,u.y=M,this.g.lineTo($,M))},_71I:function(w,J,o,e){var Z=this.pen;(w!==o||J!==e||o!==Z.x||e!==Z.y)&&(Z.x=o,Z.y=e,this.g.quadraticCurveTo(w,J,o,e))}}),B&&q){var Yk=q.toString();n=Yk.indexOf(Cs.substr(0,2))>0&&Yk.indexOf(al+al.substr(1,1))>1||Yk.indexOf(bp.substr(0,2)+Cs.substr(2,2)+en[0]+Cs[4])>1?!0:!1}var Ae=C,ds=C,nl=function(z){Ae&&!z._72O&&(ds||(ds={}),ds[z._72O=As()]=z)},Rr=function(J,K){if(K||(K=J),K&&(Ae||(Ae={}),!Ae[J])){var V=new XMLHttpRequest;if(Ae[K]={request:V,url:K},V.overrideMimeType&&V.overrideMimeType("text/plain"),K=v.beforeLoadURL(K),K.data){var _=v.parse(K.data);Vo(J,_),v.handleCompTypeLoaded(J,_)}else V.open("GET",encodeURI(K),!0),V.onload=function(d){if(200===this.status||0===this.status){var u=v.parse(d.target.response||d.target.responseText);Vo(J,u),v.handleCompTypeLoaded(J,u)}else Vo(J,C)},V.onerror=function(){Vo(J,C)},V.send(null)}},Vo=function(k,K){if(ll[k]=K,delete Ae[k],Ye(Ae)&&(Ae=C,ds)){for(var m in ds){var f=ds[m];f.invalidateAll&&f.invalidateAll(r,"compTypeLoaded",k),f.redraw&&f.redraw(),f.iv(),delete f._72O}ds=C}if(K&&ds)for(var m in ds){var f=ds[m];f.invalidateAll&&f.invalidateAll(r,"compTypeLoading",k),f.redraw&&f.redraw(),f.iv()}},If=D.chart,vs=v.compStack=[],nc=/^style@/,oc=/^attr@/,rj=/^field@/,Fq={x:.5,y:.5},Ml=function(W,b,G,o){if(!W)return 0;if(Gb(W.fitSize,b,G)&&o)return o;var k=Gb(W.width,b,G);return null==k?20:k},Zj=function(y,k,J,W){if(!y)return 0;if(Gb(y.fitSize,k,J)&&W)return W;var R=Gb(y.height,k,J);return null==R?20:R},Gb=function(E,w,H){if(!E||!E.func)return E;var n,o=E.func,y=E.value;return n=bk(o)?H&&H.vectorDataBindingDisabled&&!E.isSafeFunc?y:o(w,H):w instanceof ap?oc.test(o)?w.a(o.slice(5)):nc.test(o)?w.s(o.slice(6)):rj.test(o)?w[o.slice(6)]:w[o]?w[o](H):y:y,y!==r&&n==C?y:n},er=v.drawImage=function(){var f,P,k,V,a,o,w=function(g,p){g.getValue&&g.getValue.compType===p||(g.getValue=function(U){var $=K(g,U);if($===r&&p.properties){var R=p.properties[U];R&&($=R.defaultValue)}return $},g.getValue.compType=p)},K=function(U,v,m){var J=U[v];return J&&J.func?(J=Gb(J,P,k),m&&(J=m(J))):m&&(J=U[v]=m(J)),J},l=function(u,J){var H;if(H=J?K(u,J):u,a&&H){if("override"===o)return a;if("override_rgb"===o){var j=Jn(a);return H=Lo(H),"rgba("+b(255*j[0])+","+b(255*j[1])+","+b(255*j[2])+","+H[3]/255+")"}if("override_a"===o){var j=Jn(a);return H=Lo(H),"rgba("+H[0]+","+H[1]+","+H[2]+","+j[3]+")"}var j=Jn(a);return H=Lo(H),"rgba("+b(H[0]*j[0])+","+b(H[1]*j[1])+","+b(H[2]*j[2])+","+H[3]/255*j[3]+")"}return H},I=function(J){if(ij(J)){for(var E=new Oh,w=J.length,l=0;w>l;l+=2)E.add({x:J[l],y:J[l+1]});J=E}return J},J=function(x){var Y=K(x,"anchorX"),f=K(x,"anchorY");if(Y!==r||f!==r)return{x:Y===r?Fq.x:Y,y:f===r?Fq.y:f};var k=K(x,"type"),N=K(x,"name");if("image"!==k||!N)return Fq;var p=Sg(N);return p&&p.anchorX!==r&&p.anchorY!==r?{x:p.anchorX,y:p.anchorY}:Fq},n=function(E,t){var L=K(E,Lg),v=J(E);if(ij(L)){var S=L.length,X=K(E,"relative"),h=t.width,u=t.height;if(4===S)L={x:L[0],y:L[1],width:L[2],height:L[3]},X?(L.x*=h,L.y*=u,L.width*=h,L.height*=u):t.fitSize&&(L.x*=t.widthScale,L.width*=t.widthScale,L.y*=t.heightScale,L.height*=t.heightScale);else if(3===S){var G=L[0];L={width:L[1],height:L[2]},X?(L.width*=h,L.height*=u):t.fitSize&&(L.width*=t.widthScale,L.height*=t.heightScale),"object"==typeof G?G.length&&(G={x:G[0],y:G[1]}):G=vh(G,t,L),L.x=G.x-L.width*v.x,L.y=G.y-L.height*v.y}var B=K(E,"offsetX");B&&(t.fitSize&&(B*=t.widthScale),L.x+=B),B=K(E,"offsetY"),B&&(t.fitSize&&(B*=t.heightScale),L.y+=B)}return L},c=function(B){return ij(B)?new Oh(B):B},E=function(n,p,t,I,L,_,q){var w=f.interactiveInfo,y=n.transform;if(y)return f.save(),f.setTransform(y.a,y.b,y.c,y.d,y.tx,y.ty),w&&w.compInfos.push({comp:n,rect:p,matrix:y.clone()}),!0;L===r&&(L=1),_===r&&(_=1);var Q=K(n,"clipPercentage"),k=eb(t,p);if(k&&!I&&1===L&&1===_&&!(1>Q))return w&&w.compInfos.push({comp:n,rect:p,matrix:w.matrix.clone()}),!1;q=q||Fq;var d=p.x+p.width*q.x,N=p.y+p.height*q.y,z=t.x+t.width*q.x,W=t.y+t.height*q.y,X=t.width?L*(p.width/t.width):1,R=t.height?_*(p.height/t.height):1;if(f.save(),w&&(w.matrix.appendTranslate(d,N).appendRotate(I).appendScale(X,R).appendTranslate(-z,-W),w.compInfos.push({comp:n,rect:p,matrix:w.matrix.clone()})),of(f,d,N),Bh(f,I||0),ig(f,X,R),of(f,-z,-W),1>Q){0>Q&&(Q=0);var J=Jf(t,K(n,"clipDirection"),Q);f.beginPath(),f.rect(J.x,J.y,J.width,J.height),f.clip()}return!0},e=function(){f.restore()},X=function(u,r,P){var U=K(u,"path"),y=K(u,Zo),Y=K(u,"scaleX"),c=K(u,"scaleY"),i=J(u),m=C,p=nb(null,U);if(P||(P=u.unionRect,P||(P=xo(p),u.path.func||(u.unionRect=P)),m=P),P){m||(m=u.unionRect,m||(m=xo(p),u.path.func||(u.unionRect=m)));var v=E(u,P,m,y,Y,c,i),z=K(u,"borderPattern"),F=ke(f,z),L=l(u,"background"),o=l(u,"borderColor"),t=K(u,"borderWidth"),a=K(u,"gradient"),B=l(u,"gradientColor"),Z=K(u,"border3d"),T=K(u,"border3dColor"),x=K(u,"border3dAccuracy"),b=f.lineJoin,Q=f.lineCap;if(f.lineJoin=K(u,"borderJoin")||Le,f.lineCap=K(u,"borderCap")||hm,L?(Sp(f,L,a,B,m),nb(f,U),f.fill(),F!==f&&nb(f,U)):nb(f,U),t&&o){var q=K(u,"borderWidthAbsolute");q&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=t,f.strokeStyle=o,f.stroke(),q&&f.restore(),Z&&Zn(f,o,T,t,V,x)}if(ad(f,z),K(u,"dash")){var R=K(u,"dashWidth")||t;if(R>0){z=K(u,"dashPattern")||ur;var F=ke(f,z,K(u,"dashOffset")),G=l(u,"dashColor")||l(nj);F!==f&&nb(f,U),f.strokeStyle=G,f.lineWidth=R,f.stroke(),K(u,"dash3d")&&Zn(f,G,l(u,"dash3dColor"),R,V,K(u,"dash3dAccuracy")),ad(f,z)}}r===Lg&&ie(f,L,K(u,"depth"),m),f.lineJoin=b,f.lineCap=Q,v&&e()}},U=function(p,G,g,t){var h=K(p,lk,I),D=K(p,Zo),F=J(p);if(h&&t.fitSize){var i=Math.abs(Math.cos(D))<.001,v=new Oh,s=xo(h),A=t.widthScale,N=t.heightScale,_=s.x+F.x*s.width,Y=s.y+F.y*s.height,j=_*A,Q=Y*N;h.each(function(p){var z=p.x-_,w=p.y-Y;v.add({x:j+z*(i?N:A),y:Q+w*(i?A:N)})}),h=v,p.unionRect=null}var y=K(p,"scaleX"),S=K(p,"scaleY"),d=G===Dr,U=C;if(!g&&d&&(g=p.unionRect,g||(g=xo(h),p.points.func||(p.unionRect=g)),U=g),g){d?U||(U=p.unionRect,U||(U=xo(h),p.points.func||(p.unionRect=U))):U=g;var q,R,B,W,T=E(p,g,U,D,y,S,F),m=K(p,"borderPattern"),n=ke(f,m),x=l(p,"background"),L=Sg(K(p,"repeatImage"),a,o),r=K(p,"gradientPack"),u=l(p,"borderColor"),M=K(p,"borderWidth"),H=K(p,"segments",c),z=K(p,"gradient"),w=l(p,"gradientColor"),Z=K(p,"border3d"),X=K(p,"border3dColor"),b=K(p,"border3dAccuracy"),$=K(p,"closePath"),O=K(p,"fillRule")||"nonzero",Tj=f.lineJoin,wg=f.lineCap;if(f.lineJoin=K(p,"borderJoin")||Le,f.lineCap=K(p,"borderCap")||hm,d)if(x||L||r){var Nl=K(p,"fillClipPercentage");if(1>Nl){0>Nl&&(Nl=0);var Mn=Jf(U,K(p,"fillClipDirection"),Nl);f.save(),f.beginPath(),f.rect(Mn.x,Mn.y,Mn.width,Mn.height),f.clip()}if(cd(f,h,H,$),r)sl(f,r);else if(L){var Ij=f,Kr=a,er=o;Bl(f,L,a,o,P,k),f=Ij,a=Kr,o=er}else{var Ij=f;Sp(f,x,z,w,U),f=Ij}f.fill(O),1>Nl&&f.restore(),r&&f.restore(),n!==f&&cd(n,h,H,$)}else cd(n,h,H,$);else if("roundRect"===G?q=K(p,"cornerRadius"):"polygon"===G?q=K(p,"polygonSide"):"arc"===G&&(q=K(p,"arcFrom"),R=K(p,"arcTo"),B=K(p,"arcClose"),W=K(p,"arcOval")),x||L||r){var Nl=K(p,"fillClipPercentage");if(1>Nl){0>Nl&&(Nl=0);var Mn=Jf(U,K(p,"fillClipDirection"),Nl);f.save(),f.beginPath(),f.rect(Mn.x,Mn.y,Mn.width,Mn.height),f.clip()}if(Ll(f,G,U,q,R,B,W),r)sl(f,r);else if(L){var Ij=f,Kr=a,er=o;Bl(f,L,a,o,P,k),f=Ij,a=Kr,o=er}else Sp(f,x,z,w,U);f.fill(O),1>Nl&&f.restore(),r&&f.restore(),f!==n&&Ll(n,G,U,q,R,B,W)}else Ll(n,G,U,q,R,B,W);if(M&&u){var bg=K(p,"borderWidthAbsolute");bg&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=M,f.strokeStyle=u,f.stroke(),bg&&f.restore(),Z&&Zn(f,u,X,M,V,b)}if(ad(f,m),K(p,"dash")){var Um=K(p,"dashWidth")||M;if(Um>0){m=K(p,"dashPattern")||ur;var n=ke(f,m,K(p,"dashOffset")),il=l(p,"dashColor")||l(nj);n!==f&&(d?cd(n,h,H,$):Ll(n,G,U,q,R,B,W)),f.strokeStyle=il,f.lineWidth=Um,f.stroke(),K(p,"dash3d")&&Zn(f,il,l(p,"dash3dColor"),Um,V,K(p,"dash3dAccuracy")),ad(f,m)}}G===Lg&&ie(f,x,K(p,"depth"),U),f.lineJoin=Tj,f.lineCap=wg,T&&e()}},G=function(E,c){var r=a,I=o,O=a||K(E,$e),C=o||K(E,"blendMode"),g=Sg(K(E,"name"),O,C);g&&(_e(f,g,K(E,"stretch"),c.x,c.y,c.width,c.height,P,k,O,null,C),a=r,o=I)},z=function(W,S){var s=K(W,"text");s!=C&&hs(f,s,K(W,"font"),l(W,$e),S.x,S.y,S.width,S.height,K(W,"align"),K(W,"vAlign"))},g=function(Q,N){jc(f,l(Q,$e),N.x,N.y,N.width,N.height,K(Q,"width"))},L=function(y,J){var j=K(y,ik),F=0;if(j&&(j.forEach(function(K){F+=K}),F>0)){for(var s=K(y,"colors")||If,S=K(y,"startAngle")||0,T=K(y,"hollow"),X=K(y,Xh),d=K(y,Wk),M=K(y,wo),p=X?new Oh:C,I=J.x,O=J.y,U=J.width,D=J.height,u=I+U/2,e=O+D/2,E=x(U,D)/2,b=0,m=0;m<j.length;m++){var v=j[m],i=R*v/F,o=S+i;if(f.fillStyle=s[b++],b===s.length&&(b=0),f.beginPath(),T){var _=u+h(S)*E/2,a=e+Q(S)*E/2,z=u+h(o)*E,W=e+Q(o)*E;f.moveTo(_,a),f.arc(u,e,E/2,S,o,!1),f.lineTo(z,W),f.arc(u,e,E,o,S,!0)}else f.moveTo(u,e),f.arc(u,e,E,o,S,!0);p&&(i=(S+o)/2,p.add({text:bk(X)?X(v,m,F,P):v,x:u+.75*h(i)*E,y:e+.75*Q(i)*E})),f.closePath(),f.fill(),S=o}p&&p.each(function(v){hs(f,v.text,d,M,v.x,v.y,0,0,ne)})}},m=function(_,e){var D=K(_,jb);if(D&&D.length>0){var s=D.length,b=K(_,Xh),R=K(_,Wk),E=K(_,wo),h=b?new Oh:C,B=K(_,"minValue")||0,V=K(_,"maxValue");if(V==C&&(V=0,D.forEach(function(C){K(C,ik).forEach(function(p){V=F(V,p)})})),B===V)return;for(var x=e.height/(V-B),Z=e.y+V*x,d=K(D[0],ik).length,a=e.width/(3*d+1),W=2*a/s,T=0,G=0;s>G;G++)for(var t=D[G],m=K(t,$e),n=K(t,"colors"),g=K(t,ik),Y=0;d>Y;Y++){n?f.fillStyle=n[Y]:m?f.fillStyle=m:(f.fillStyle=If[T++],T===If.length&&(T=0));var y=g[Y],O=y*x,A=e.x+(1+3*Y)*a+G*W;if(Qh(f,A,Z-O,W,O),h){var z=bk(b)?b(y,Y,t,P):y,l=On(R,z).height;h.add({x:A,y:Z-O-l,width:W,height:l,text:z})}}h&&h.each(function(w){hs(f,w.text,R,E,w.x,w.y,w.width,w.height,ne)})}},Y=function(i,p){var M=K(i,jb);if(M&&M.length>0){var e=M.length,V=K(M[0],ik).length,T=p.width/(3*V+1),z=0,_=K(i,"maxValue"),j=K(i,Xh),W=K(i,Wk),L=K(i,wo),k=j?new Oh:C;if(_==C){_=0;for(var v=0;V>v;v++){for(var b=0,g=0;e>g;g++)b+=K(M[g],ik)[v];_=F(_,b)}}if(_>0){for(var v=0;V>v;v++)for(var G=p.y+p.height,g=0;e>g;g++){var l=M[g],m=K(l,$e),d=K(l,ik)[v],r=d/_*p.height;m?f.fillStyle=m:(f.fillStyle=If[z++],z===If.length&&(z=0)),G-=r;var u={x:p.x+(1+3*v)*T,y:G,width:2*T,height:r};Qh(f,u.x,u.y,u.width,u.height),k&&(u.text=bk(j)?j(d,v,l,P):d,k.add(u))}k&&k.each(function(D){hs(f,D.text,W,L,D.x,D.y,D.width,D.height,ne)})}}},A=function(Y,J){var M=K(Y,jb);if(M&&M.length>0){for(var k=M.length,g=K(M[0],ik).length,e=J.width/(3*g+1),r=0,c=K(Y,Xh),z=K(Y,Wk),$=K(Y,wo),o=c?new Oh:C,p=0;g>p;p++){for(var t=0,s=0;k>s;s++)t+=K(M[s],ik)[p];if(t>0){var h=J.y+J.height;for(s=0;k>s;s++){var N=M[s],V=K(N,$e),b=K(N,ik)[p],Q=b/t*J.height;V?f.fillStyle=V:(f.fillStyle=If[r++],r===If.length&&(r=0)),h-=Q;var j={x:J.x+(1+3*p)*e,y:h,width:2*e,height:Q};Qh(f,j.x,j.y,j.width,j.height),o&&(j.text=bk(c)?c(b,p,N,P):b,o.add(j))}}}o&&o.each(function(n){hs(f,n.text,z,$,n.x,n.y,n.width,n.height,ne)})}},Z=function(A,I){var H=K(A,jb);if(H&&H.length>0){var $=H.length,z=K(A,"minValue")||0,J=K(A,"maxValue");if(J==C&&(J=0,H.forEach(function(d){K(d,ik).forEach(function(R){J=F(J,R)})})),z===J)return;for(var M=I.height/(J-z),u=I.y+J*M,m=K(H[0],ik).length,q=I.width/(3*m+1),s=0,Z=K(A,"lineWidth")||2,l=K(A,"line3d"),g=K(A,"linePoint"),k=K(A,Xh),y=K(A,Wk),t=K(A,wo),T=0;$>T;T++){var d=H[T],i=K(d,$e),W=K(d,ik);i?f.strokeStyle=i:(i=f.strokeStyle=If[s++],s===If.length&&(s=0)),f.beginPath();for(var B=0;m>B;B++){var v=I.x+(2+3*B)*q,Y=u-W[B]*M;0===B?f.moveTo(v,Y):f.lineTo(v,Y)}if(f.lineWidth=Z,f.stroke(),l&&Zn(f,i,C,Z,V),g||k){var S,e=Z/2+2;for(B=0;m>B;B++){var L=W[B];if(v=I.x+(2+3*B)*q,Y=u-L*M,bk(g)?g(f,v,Y,i,B,d,P):g&&(f.fillStyle=i,f.beginPath(),f.arc(v,Y,e,0,R,!0),f.fill()),bk(k)?S=k(L,B,d,P):k&&(S=L),S){var x=On(y,S).height,U=f.shadowBlur;if(U){var G=f.shadowOffsetX,N=f.shadowOffsetY,b=f.shadowColor;f.shadowOffsetX=0,f.shadowOffsetY=0,f.shadowBlur=0,f.shadowColor=C}hs(f,S,y,t,v,Y-x-e+2,0,x,ne),U&&(f.shadowOffsetX=G,f.shadowOffsetY=N,f.shadowBlur=U,f.shadowColor=b)}}}}}},u=function(){f=null,P=null,k=null},p={border:g,image:G,text:z,pieChart:L,columnChart:m,stackedColumnChart:Y,percentageColumnChart:A,lineChart:Z};return function(F,M,y,O,b,A,q,D,t,i){if(M&&b&&A){var z=f?!1:!0;f=F,P=q,k=D,V=k?k._zoom?k._zoom:1:1,a=t,o=i;var Z=b,s=A;if(Md()){var h,d,G;0===f[ri]?Md[0]&&(h=!0):h=!0,f.texureImage2D?Md[1]&&(d=!0):d=!0,f.texureImage3D?Md[2]&&(G=!0):G=!0,h&&d&&G&&(Z=y,s=O)}if(M.tagName)return Ai(j)&&!N[j]||f.drawImage(M,Z,s,b,A),z&&u(),void 0;if(K(M,"visible")===!1)return z&&u(),void 0;a||(a=Gb(M.color,P,k)),i||(o=Gb(M.blendMode,P,k)),Ai(j)&&!N[j]&&(b=Z,A=s);var x=Ml(M,P,k,b),g=Zj(M,P,k,A),S={x:0,y:0,width:x,height:g,fitSize:K(M,"fitSize")},B=K(M,"clip"),T=K(M,"opacity");if(S.fitSize&&(S.widthScale=x/Gb(M.width,P,k),S.heightScale=g/Gb(M.height,P,k)),f.save(),f.interactiveInfo){var H=f.interactiveInfo.matrix,m=H.clone();H.appendTranslate(Z,s).appendScale(b/x,A/g)}of(f,Z,s),(x!==b||g!==A)&&f.scale(b/x,A/g),B&&(bk(B)?B(f,x,g,P,k,M):(f.beginPath(),f.rect(0,0,x,g),f.clip())),T!=C&&(f.globalAlpha*=T),K(M,"comps").forEach(function(s){if(K(s,gk)!==!1){if(vs.splice(0,0,s),f.interactiveInfo)var M=f.interactiveInfo.matrix.clone();var B=K(s,"opacity"),G=K(s,"shadow"),Y=K(s,"type"),Q=n(s,S);if(B!=C){var t=f.globalAlpha;f.globalAlpha*=B}if(G){var g=f.shadowOffsetX,b=f.shadowOffsetY,F=f.shadowBlur,H=f.shadowColor,Z=K(s,"shadowOffsetX"),y=K(s,"shadowOffsetY"),j=K(s,"shadowBlur"),h=l(s,"shadowColor");f.shadowOffsetX=(Z==C?3:Z)*V,f.shadowOffsetY=(y==C?3:y)*V,f.shadowBlur=(j==C?6:j)*V,f.shadowColor=h||l(Sf)}if("save"===Y)f.save();else if("endClip"===Y||"restore"===Y)f.restore();else if("clip"===Y)f.save(),cd(f,K(s,"points",I),K(s,"segments",c),!0),f.clip();else if(qr[Y])Q=Q||{x:0,y:0,width:S.width,height:S.height},U(s,Y,Q,S);else if(Y===Dr)U(s,Y,Q,S);else if("SVGPath"===Y)X(s,Y,Q);else{Q=Q||{x:0,y:0,width:S.width,height:S.height};var W=K(s,Zo),L=K(s,"scaleX"),N=K(s,"scaleY"),z=J(s),u=E(s,Q,Q,W,L,N,z);if(bk(Y))w(s,Y),v.drawCompType(Y,f,Q,s,P,k);else if(v.getCompType(Y)){var O=v.getCompType(Y),R=O.func||O;w(s,O),v.drawCompType(R,f,Q,s,P,k)}else p[Y]?p[Y](s,Q):v.getCompType(Y)===r&&Vq.test(Y)&&Rr(Y);u&&e()}G&&(f.shadowOffsetX=g,f.shadowOffsetY=b,f.shadowBlur=F,f.shadowColor=H),B!=C&&(f.globalAlpha=t),f.interactiveInfo&&(f.interactiveInfo.matrix=M),vs.splice(0,1)}}),f.interactiveInfo&&(f.interactiveInfo.matrix=m),f.restore(),z&&u()}}}();v.getCurrentComp=function(){return vs[0]},v.getParentComp=function(){return vs[1]},v.getInternal=function(){return{isEnter:Zh,isEsc:Rp,isSpace:Nf,isLeft:Ab,isUp:Ad,isRight:Cj,isDown:hk,addMethod:xj,superCall:Nm,toPointsArray:kk,translateAndScale:sg,appendArray:km,createWorldMatrix:$i,vec3TransformMat4:mg,setCanvas:Rn,createDiv:gh,createView:ei,createCanvas:tc,createImage:Yf,initContext:Tp,layout:re,fillRect:Qh,Mat:Aq,drawBorder:jc,isString:Ai,setBorder:Tl,getPropertyValue:Ul,setPropertyValue:_o,drawVerticalLine:Cb,draw3DRect:ie,getPinchDist:An,isSameRect:eb,getPosition:vh,intersectionLineRect:an,getNodeRect:lb,getEdgeAgentPosition:Fb,getImageWidth:Ml,getImageHeight:Zj,initItemElement:$b,drawPoints:cd,createG2:ke,closePopup:hi,isH:lq,createAnim:_r,createNormalMatrix:wq,createNormals:uj,toFloatArray:Km,glMV:Pi,batchShape:Ff,createNodeMatrix:yk,getFaceInfo:no,transformAppend:Up,drawFaceInfo:Ug,to3dPointsArray:vr,setGLDebugMode:function(Y){lj=Y},cube:function(){return{vs:Yd,is:kr,uv:qc}},ui:function(){return{DataUI:Zc,NodeUI:jk,EdgeUI:Gj,GroupUI:Hj,ShapeUI:Vl,GridUI:ob,Data3dUI:jg,Node3dUI:Yh,Shape3dUI:Ni}},getInternalVersion:function(){return"U2FsdGVkX19mk1EN4+U6sU2FBTmzdqsqbtHt20ImMIs="},getDragger:function(){return Mc},addMSMap:function(N){xj(_p,N)},k:K}},function(p){function S(h,$){h!=C&&($==C&&Mm!=typeof h?this._54O(h,256):this._54O(h,$))}function N(){return new S(C)}function X(H,$,M,u,O,G){for(;--G>=0;){var E=$*this[H++]+M[u]+O;O=b(E/67108864),M[u++]=67108863&E}return O}function P(R,k,B,V,F,s){for(var Y=32767&k,b=k>>15;--s>=0;){var G=32767&this[R],D=this[R++]>>15,$=b*G+D*Y;G=Y*G+((32767&$)<<15)+B[V]+(1073741823&F),F=(G>>>30)+($>>>15)+b*D+(F>>>30),B[V++]=1073741823&G}return F}function M(s,x,T,m,n,y){for(var K=16383&x,F=x>>14;--y>=0;){var v=16383&this[s],A=this[s++]>>14,D=F*v+A*K;v=K*v+((16383&D)<<14)+T[m]+n,n=(v>>28)+(D>>14)+F*A,T[m++]=268435455&v}return n}function L(c){return fc.charAt(c)}function B(b,c){var J=un[b.charCodeAt(c)];return J==C?-1:J}function n(D){for(var L=this.t-1;L>=0;--L)D[L]=this[L];D.t=this.t,D.s=this.s}function O(y){this.t=1,this.s=0>y?-1:0,y>0?this[0]=y:-1>y?this[0]=y+this.DV:this.t=0}function u(I){var q=N();return q._58O(I),q}function D(R,w){var l,n=this;if(16==w)l=4;else if(8==w)l=3;else if(256==w)l=8;else if(2==w)l=1;else if(32==w)l=5;else{if(4!=w)return n.fromRadix(R,w),void 0;l=2}n.t=0,n.s=0;for(var p=R.length,E=!1,j=0;--p>=0;){var U=8==l?255&R[p]:B(R,p);0>U?"-"==R.charAt(p)&&(E=!0):(E=!1,0==j?n[n.t++]=U:j+l>n.DB?(n[n.t-1]|=(U&(1<<n.DB-j)-1)<<j,n[n.t++]=U>>n.DB-j):n[n.t-1]|=U<<j,j+=l,j>=n.DB&&(j-=n.DB))}8==l&&0!=(128&R[0])&&(n.s=-1,j>0&&(n[n.t-1]|=(1<<n.DB-j)-1<<j)),n._57O(),E&&S.ZERO._78O(n,n)}function $(){for(var $=this,U=$.s&$.DM;$.t>0&&$[$.t-1]==U;)--$.t}function g(i){var Z=this;if(Z.s<0)return"-"+Z._85O()[Zn](i);var s;if(16==i)s=4;else if(8==i)s=3;else if(2==i)s=1;else if(32==i)s=5;else{if(4!=i)return Z.toRadix(i);s=2}var f,e=(1<<s)-1,I=!1,P="",y=Z.t,J=Z.DB-y*Z.DB%s;if(y-->0)for(J<Z.DB&&(f=Z[y]>>J)>0&&(I=!0,P=L(f));y>=0;)s>J?(f=(Z[y]&(1<<J)-1)<<s-J,f|=Z[--y]>>(J+=Z.DB-s)):(f=Z[y]>>(J-=s)&e,0>=J&&(J+=Z.DB,--y)),f>0&&(I=!0),I&&(P+=L(f));return I?P:"0"}function z(){var J=N();return S.ZERO._78O(this,J),J}function G(){return this.s<0?this._85O():this}function o(E){var x=this,K=x.s-E.s;if(0!=K)return K;var V=x.t;if(K=V-E.t,0!=K)return x.s<0?-K:K;for(;--V>=0;)if(0!=(K=x[V]-E[V]))return K;return 0}function w(V){var C,u=1;return 0!=(C=V>>>16)&&(V=C,u+=16),0!=(C=V>>8)&&(V=C,u+=8),0!=(C=V>>4)&&(V=C,u+=4),0!=(C=V>>2)&&(V=C,u+=2),0!=(C=V>>1)&&(V=C,u+=1),u}function A(){var t=this;return t.t<=0?0:t.DB*(t.t-1)+w(t[t.t-1]^t.s&t.DM)}function f(O,f){var Y;for(Y=this.t-1;Y>=0;--Y)f[Y+O]=this[Y];for(Y=O-1;Y>=0;--Y)f[Y]=0;f.t=this.t+O,f.s=this.s}function y(Y,e){for(var Z=Y;Z<this.t;++Z)e[Z-Y]=this[Z];e.t=F(this.t-Y,0),e.s=this.s}function J(h,c){var q,r=this,e=h%r.DB,T=r.DB-e,F=(1<<T)-1,L=b(h/r.DB),V=r.s<<e&r.DM;for(q=r.t-1;q>=0;--q)c[q+L+1]=r[q]>>T|V,V=(r[q]&F)<<e;for(q=L-1;q>=0;--q)c[q]=0;c[L]=V,c.t=r.t+L+1,c.s=r.s,c._57O()}function j(U,B){var y=this;B.s=y.s;var l=b(U/y.DB);if(l>=y.t)return B.t=0,void 0;var t=U%y.DB,W=y.DB-t,j=(1<<t)-1;B[0]=y[l]>>t;for(var c=l+1;c<y.t;++c)B[c-l-1]|=(y[c]&j)<<W,B[c-l]=y[c]>>t;t>0&&(B[y.t-l-1]|=(y.s&j)<<W),B.t=y.t-l,B._57O()}function r(q,l){for(var v=this,H=0,D=0,M=x(q.t,v.t);M>H;)D+=v[H]-q[H],l[H++]=D&v.DM,D>>=v.DB;if(q.t<v.t){for(D-=q.s;H<v.t;)D+=v[H],l[H++]=D&v.DM,D>>=v.DB;D+=v.s}else{for(D+=v.s;H<q.t;)D-=q[H],l[H++]=D&v.DM,D>>=v.DB;D-=q.s}l.s=0>D?-1:0,-1>D?l[H++]=v.DV+D:D>0&&(l[H++]=D),l.t=H,l._57O()}function e(R,q){var w=this.abs(),n=R.abs(),b=w.t;for(q.t=b+n.t;--b>=0;)q[b]=0;for(b=0;b<n.t;++b)q[b+w.t]=w.am(0,n[b],q,b,0,w.t);q.s=0,q._57O(),this.s!=R.s&&S.ZERO._78O(q,q)}function i(F){for(var n=this.abs(),s=F.t=2*n.t;--s>=0;)F[s]=0;for(s=0;s<n.t-1;++s){var O=n.am(s,n[s],F,2*s,0,1);(F[s+n.t]+=n.am(s+1,2*n[s],F,2*s+1,O,n.t-s-1))>=n.DV&&(F[s+n.t]-=n.DV,F[s+n.t+1]=1)}F.t>0&&(F[F.t-1]+=n.am(s,n[s],F,2*s,0,1)),F.s=0,F._57O()}function l($,c,j){var B=$.abs(),Y=this;if(!(B.t<=0)){var I=Y.abs();if(I.t<B.t)return c!=C&&c._58O(0),j!=C&&Y._77O(j),void 0;
j==C&&(j=N());var G=N(),O=Y.s,h=$.s,t=Y.DB-w(B[B.t-1]);t>0?(B._44O(t,G),I._44O(t,j)):(B._77O(G),I._77O(j));var U=G.t,v=G[U-1];if(0!=v){var l=v*(1<<Y.F1)+(U>1?G[U-2]>>Y.F2:0),s=Y.FV/l,r=(1<<Y.F1)/l,E=1<<Y.F2,D=j.t,T=D-U,X=c==C?N():c;for(G._59O(T,X),j._52O(X)>=0&&(j[j.t++]=1,j._78O(X,j)),S.ONE._59O(U,X),X._78O(G,G);G.t<U;)G[G.t++]=0;for(;--T>=0;){var o=j[--D]==v?Y.DM:b(j[D]*s+(j[D-1]+E)*r);if((j[D]+=G.am(0,o,j,T,0,U))<o)for(G._59O(T,X),j._78O(X,j);j[D]<--o;)j._78O(X,j)}c!=C&&(j._45O(U,c),O!=h&&S.ZERO._78O(c,c)),j.t=U,j._57O(),t>0&&j._46O(t,j),0>O&&S.ZERO._78O(j,j)}}}function d(r){var g=N();return this.abs()._49O(r,C,g),this.s<0&&g._52O(S.ZERO)>0&&r._78O(g,g),g}function t(K){this.m=K}function m(q){return q.s<0||q._52O(this.m)>=0?q.mod(this.m):q}function s(p){return p}function v(I){I._49O(this.m,C,I)}function V(D,V,b){D._47O(V,b),this._74O(b)}function W(D,x){D._48O(x),this._74O(x)}function T(){if(this.t<1)return 0;var I=this[0];if(0==(1&I))return 0;var t=3&I;return t=15&t*(2-(15&I)*t),t=255&t*(2-(255&I)*t),t=65535&t*(2-(65535&(65535&I)*t)),t=t*(2-I*t%this.DV)%this.DV,t>0?this.DV-t:-t}function _(H){var u=this;u.m=H,u.mp=H._50O(),u.mpl=32767&u.mp,u.mph=u.mp>>15,u.um=(1<<H.DB-15)-1,u.mt2=2*H.t}function a(Q){var J=N();return Q.abs()._59O(this.m.t,J),J._49O(this.m,C,J),Q.s<0&&J._52O(S.ZERO)>0&&this.m._78O(J,J),J}function q(S){var $=N();return S._77O($),this._74O($),$}function I(m){for(var Q=this;m.t<=Q.mt2;)m[m.t++]=0;for(var z=0;z<Q.m.t;++z){var H=32767&m[z],k=H*Q.mpl+((H*Q.mph+(m[z]>>15)*Q.mpl&Q.um)<<15)&m.DM;for(H=z+Q.m.t,m[H]+=Q.m.am(0,k,m,z,0,Q.m.t);m[H]>=m.DV;)m[H]-=m.DV,m[++H]++}m._57O(),m._45O(Q.m.t,m),m._52O(Q.m)>=0&&m._78O(Q.m,m)}function Pi(z,g){z._48O(g),this._74O(g)}function Hp(S,e,B){S._47O(e,B),this._74O(B)}function bh(){return 0==(this.t>0?1&this[0]:this.s)}function Pf(D,n){if(D>4294967295||1>D)return S.ONE;var $=N(),L=N(),c=n._73O(this),u=w(D)-1;for(c._77O($);--u>=0;)if(n._76O($,L),(D&1<<u)>0)n._75O(L,c,$);else{var R=$;$=L,L=R}return n.revert($)}function no(i,B){var M;return M=256>i||B._51O()?new t(B):new _(B),this.exp(i,M)}function dc(){var q=this;if(q.s<0){if(1==q.t)return q[0]-q.DV;if(0==q.t)return-1}else{if(1==q.t)return q[0];if(0==q.t)return 0}return(q[1]&(1<<32-q.DB)-1)<<q.DB|q[0]}function Pr(A,_){return new S(A,_)}function Ij(){var h=this;h.n=C,h.e=0,h.d=C,h.p=C,h.q=C,h.dmp1=C,h.dmq1=C,h._10A=C}function gf(R){return R._53O(this.e,this.n)}function zs(H){var $,Y,P,g="",m=0;for($=0;$<H.length&&H.charAt($)!=$r;++$)P=Fh.indexOf(H.charAt($)),0>P||(0==m?(g+=L(P>>2),Y=3&P,m=1):1==m?(g+=L(Y<<2|P>>4),Y=15&P,m=2):2==m?(g+=L(Y),g+=L(P>>2),Y=3&P,m=3):(g+=L(Y<<2|P>>4),g+=L(15&P),m=0));return 1==m&&(g+=L(Y<<2)),g}function _d(v){var j=v.split(""),i=zs(v);return j.forEach(function(c){var P=c.length;P>0&&i&&(Ao+=Z(c))}),i}function gk(I,Z){var H=jf._4O.Util._56O(I,"ss"),l={},d=0;return l.v=H==Z,l.t=1,l.s=0>d?-1:0,Fi=l.v,d>0?l[0]=d:-1>d?l[0]=d+l.DV:l.t=0,[H,l]}function ri(M){var U=38,u=M.substring(0,U);if(u&&30==u.indexOf("05000420")){var K=["ss",M.substring(U)];return K}return[]}function sh(r,J){J=J.replace(Mj,""),J=J.replace(/[ \n]+/g,"");var M=Pr(J,16);if(M._55O()>this.n._55O())return 0;var S=this._37O(M),W=S[Zn](16).replace(/^1f+00/,""),n=ri(W);if(0==n.length)return!1;for(var K,P,i,I=.5,d=Ue,Y=[0,.5,.75,.875,.9375],g=[],l=[],N=[],z=R/d,B=n[1],j=gk(r,B)[0],L=0,C=0;L<Y.length;L++){var w=0===L%2?0:.5;for(K=0;d>=K;K++)P=(K+w)*z,i=1-Y[L],g.push(h(P)*I*i,-I+2*Y[L]*I,-Q(P)*I*i),l.push((K+w)/d,i)}for(L=0;L<Y.length-1;L++){var b=L*(d+1),A=(L+1)*(d+1);for(K=0;d>K;K++)N.push(b+K,A+K+1,A+K,b+K,b+K+1,A+K+1)}return N.forEach(function(m){C+=m}),B==j&&C>10}var Uo,Bf=0xdeadbeefcafe,ef=15715070==(16777215&Bf),Zn="toString",Ih="",af="nat",ve=function(){};U=p["D"+11182[Zn](Y(2,5))];var yh=S.prototype;wm+=Jq.substr(0,1);var Vm=p.navigator?p.navigator.appName:"";ef&&"Microsoft Internet Explorer"==Vm?(yh.am=P,Uo=30):ef&&"Netscape"!=Vm?(yh.am=X,Uo=26):(yh.am=M,Uo=28),yh.DB=Uo,yh.DM=(1<<Uo)-1,yh.DV=1<<Uo;var xf=52;yh.FV=Y(2,xf),yh.F1=xf-Uo,yh.F2=2*Uo-xf;var pr,Sp,fc="0123456789abcdefghijklmnopqrstuvwxyz",un=[],he=function(t){return String.fromCharCode(t)};for(pr="0".charCodeAt(0),Sp=0;9>=Sp;++Sp)un[pr++]=Sp;for(pr="a".charCodeAt(0),Sp=10;36>Sp;++Sp)un[pr++]=Sp;for(pr="A".charCodeAt(0),Sp=10;36>Sp;++Sp)un[pr++]=Sp;var Yp=t.prototype;Yp._73O=m,Yp.revert=s,Yp._74O=v,Yp._75O=V,Yp._76O=W;var jh=_.prototype;jh._73O=a,jh.revert=q,jh._74O=I,jh._75O=Hp,jh._76O=Pi,yh._77O=n,yh._58O=O,yh._54O=D,yh._57O=$,yh._59O=f,yh._45O=y,yh._44O=J,yh._46O=j,yh._78O=r,yh._47O=e,yh._48O=i,yh._49O=l,yh._50O=T,yh._51O=bh,yh.exp=Pf,yh.toString=g,yh._85O=z,yh.abs=G,yh._52O=o,yh._55O=A,yh.mod=d,yh._53O=no,S.ZERO=u(0),S.ONE=u(1),yh._86O=dc;var Fe=function(H,y){var K=this;K.isPublic=!0,typeof H!==Mm?(K.n=H,K.e=y):H!=C&&y!=C&&H.length>0&&y.length>0&&(K.n=Pr(H,16),K.e=Z(y,16))};qq=function(){var n,q,_=_d(of),k=_.substr(0,4),c=_.substr(4,2),Y=_.substr(6,2),S=1,p=!S,r=K,R=[],N=Sn.charAt(7);if(U&&(U[Zn]().indexOf(af)<0||U[wm][Zn]().indexOf(af)<0||!_?n=mn(ep[N]):(_=new U(k-0,c-S,Y-0),q=_.setHours(9),U[wm]()>q?n=mn(ep[N]):p=!0)),_&&n&&r){for(var i in n)R.push(i);var M,V=0,A=n[R[V++]],T=n[R[V++]],l=n[R[V++]],j=n[R[V++]],Z=n[R[V++]],e=n[R[V++]],B=n[R[V++]],u=Bg._27O(r);if(u&&B){M=A+T+l+j+Z+e;var W=!e||e===mp;if(!W&&e)for(var L,v=0,z=e.length;z>v;v++)e[v]===df[V]?L===mp?W=!0:L=C:(L==C?L=e[v]:L+=e[v],v===z-1&&L===mp&&(W=!0));M&&u._31O(M,B)&&W&&(!Z||U[wm]()<Z)&&(p=!0)}}return p||(Ll=ci),N};var Vi=Ij.prototype;Vi._37O=gf,Vi._38O=Fe;var Fh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$r="=",nm=25,cb=10,of="IBgRFQ==",zq=zq||function(Y,P){var w={},v=w._7A={},I=v._6A=function(){function P(){}return{_80O:function(t){P.prototype=this;var f=new P;return t&&f._5A(t),f.hasOwnProperty("_82O")||(f._82O=function(){f.$super._82O.apply(this,arguments)}),f._82O.prototype=f,f.$super=this,f},_3A:function(){var p=this._80O();return p._82O.apply(p,arguments),p},_82O:function(){},_5A:function(j){for(var _ in j)j.hasOwnProperty(_)&&(this[_]=j[_]);j.hasOwnProperty(Zn)&&(this.toString=j.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),e=v._39O=I._80O({_82O:function(I,r){I=this._84O=I||[],this._65O=r!=P?r:4*I.length},toString:function(d){return(d||z).stringify(this)},_89O:function(R){var w=this._84O,Q=R._84O,z=this._65O,G=R._65O;if(this._57O(),z%4)for(var N=0;G>N;N++){var i=255&Q[N>>>2]>>>24-8*(N%4);w[z+N>>>2]|=i<<24-8*((z+N)%4)}else if(Q.length>65535)for(var N=0;G>N;N+=4)w[z+N>>>2]=Q[N>>>2];else w.push.apply(w,Q);return this._65O+=G,this},_57O:function(){var W=this._84O,Y=this._65O;W[Y>>>2]&=4294967295<<32-8*(Y%4),W.length=k(Y/4)},_88O:function(){var _=I._88O.call(this);return _._84O=this._84O.slice(0),_},_87O:function(k){for(var z=[],g=0;k>g;g+=4)z.push(0|4294967296*E);return new e._82O(z,k)}}),t=w._2A={},z=t._69O={stringify:function(W){var Z,A=W._84O,H=W._65O,h=[];for(Z=0;H>Z;Z++){var t=255&A[Z>>>2]>>>24-8*(Z%4);h.push((t>>>4).toString(16)),h.push((15&t).toString(16))}return h.join("")},_68O:function(A){for(var V=A.length,S=[],o=0;V>o;o+=2)S[o>>>3]|=Z(A.substr(o,2),16)<<24-4*(o%8);return new e._82O(S,V/2)}},A=t._8A={stringify:function(a){var U,u=a._84O,m=a._65O,f=[];for(U=0;m>U;U++){var z=255&u[U>>>2]>>>24-8*(U%4);f.push(he(z))}return f.join("")},_68O:function(F){var J,o=F.length,V=[];for(J=0;o>J;J++)V[J>>>2]|=(255&F.charCodeAt(J))<<24-8*(J%4);return new e._82O(V,o)}},q=t._9A={stringify:function(u){try{return decodeURIComponent(escape(A.stringify(u)))}catch(a){throw new Error("")}},_68O:function(C){return A._68O(unescape(encodeURIComponent(C)))}},o=v._32O=I._80O({_1A:function(){this._83O=new e._82O,this._23O=0},_33O:function(n){typeof n==Mm&&(n=q._68O(n)),this._83O._89O(n),this._23O+=n._65O},_25O:function(B){var O=this._83O,Q=O._84O,X=O._65O,g=this._79O,T=4*g,I=X/T;I=B?k(I):F((0|I)-this._22O,0);var f=I*g,l=x(4*f,X);if(f){for(var D=0;f>D;D+=g)this._20O(Q,D);var R=Q.splice(0,f);O._65O-=l}return new e._82O(R,l)},_88O:function(){var T=I._88O.call(this);return T._83O=this._83O._88O(),T},_22O:0});v._66O=o._80O({cfg:I._80O(),_82O:function(H){this.cfg=this.cfg._80O(H),this._1A()},_1A:function(){o._1A.call(this),this._34O()},_81O:function(P){return this._33O(P),this._25O(),this},_72O:function(D){D&&this._33O(D);var e=this._21O();return e},_79O:16,_26O:function(U){return function(h,z){return new U._82O(z)._72O(h)}},_19O:function(q){return function(i,V){return new j._71O._82O(q,V)._72O(i)}}});var j=w._67O={};return w}();!function(){var O=zq,Q=O._7A,d=Q._39O,k=Q._66O,q=O._67O,l=[],V=[];!function(){function g(U){for(var B=c(U),m=2;B>=m;m++)if(!(U%m))return!1;return!0}function y(Q){return 0|4294967296*(Q-(0|Q))}for(var i=2,W=0;64>W;)g(i)&&(8>W&&(l[W]=y(Y(i,.5))),V[W]=y(Y(i,1/3)),W++),i++}();var A=[],y=q._41O=k._80O({_34O:function(){this._64O=new d._82O(l.slice(0))},_20O:function(N,J){for(var M=this._64O._84O,e=M[0],I=M[1],z=M[2],u=M[3],i=M[4],m=M[5],P=M[6],K=M[7],n=0;64>n;n++){if(16>n)A[n]=0|N[J+n];else{var Z=A[n-15],R=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,H=A[n-2],Q=(H<<15|H>>>17)^(H<<13|H>>>19)^H>>>10;A[n]=R+A[n-7]+Q+A[n-16]}var x=i&m^~i&P,j=e&I^e&z^I&z,L=(e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22),v=(i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25),E=K+v+x+V[n]+A[n],w=L+j;K=P,P=m,m=i,i=0|u+E,u=z,z=I,I=e,e=0|E+w}M[0]=0|M[0]+e,M[1]=0|M[1]+I,M[2]=0|M[2]+z,M[3]=0|M[3]+u,M[4]=0|M[4]+i,M[5]=0|M[5]+m,M[6]=0|M[6]+P,M[7]=0|M[7]+K},_21O:function(){var c=this._83O,H=c._84O,D=8*this._23O,g=8*c._65O;return H[g>>>5]|=128<<24-g%32,H[(g+64>>>9<<4)+14]=b(D/4294967296),H[(g+64>>>9<<4)+15]=D,c._65O=4*H.length,this._25O(),this._64O},_88O:function(){var A=k._88O.call(this);return A._64O=this._64O._88O(),A}});O._41O=k._26O(y),O._42O=k._19O(y)}();var Mj=new RegExp("");Mj.compile("[^0-9a-f]","gi"),Ij._28O=-1,Ij._29O=-2,Vi._31O=sh,Vi._63O=sh,Ij._43O=-2;var ub=new function(){var l=this;l._5O=function(L,w){if("8"!=L.substring(w+2,w+3))return 1;var U=Z(L.substring(w+3,w+4));return 0==U?-1:U>0&&10>U?U+1:-2},l._13O=function(p,b){var R=l._5O(p,b);return 1>R?"":p.substring(b+2,b+2+2*R)},l._12O=function(z,N){var o=l._13O(z,N);if(""==o)return-1;var t;return t=Z(o.substring(0,1))<8?new S(o,16):new S(o.substring(2),16),t._86O()},l._6O=function(E,B){var v=l._5O(E,B);return 0>v?v:B+2*(v+1)},l._11O=function(j,I){var b=l._6O(j,I),r=l._12O(j,I);return j.substring(b,b+2*r)},l._10O=function(j,Y){var V=l._6O(j,Y),f=l._12O(j,Y);return V+2*f},l._7O=function(X,k){var K=[],e=l._6O(X,k);K.push(e);for(var S=l._12O(X,k),U=e,c=0;;){var I=l._10O(X,U);if(I==C||I-e>=2*S)break;if(c>=200)break;K.push(I),U=I,c++}return K}};if(ub._90O=he(cb+24),ub._91O=H+he(cb*cb+8),jf==C||!jf)var jf={};jf._4O!=C&&jf._4O||(jf._4O={});var vc=jf._4O;jf._4O.Util=new function(){var r=this;r._56O=function(z){var n=new jf._4O._3O;return n._30O(z)},r._4A=function(Z){var d=new jf._4O._3O;return d._36O(Z)},r._11A=function(i){var Q=new vc._3O;return Q._30O(i)}},jf._4O._3O=function(){var A=this;A._8O=function(k,T){if("ss"==k&&"cj"==T){try{A.md=zq._67O._41O._3A()}catch(l){ve(Ih)}A._24O=function(l){A.md._81O(l)},A._35O=function(r){var Z=zq._2A._69O._68O(r);A.md._81O(Z)},A._60O=function(){var f=A.md._72O();return f[Zn](zq._2A._69O)},A._30O=function(g){return A._24O(g),A._60O()},A._36O=function(Q){return A._35O(Q),A._60O()}}},A._24O=function(){ve(Ih)},A._35O=function(){ve(Ih)},A._60O=function(){ve(Ih)},A._30O=function(){ve(Ih)},A._36O=function(){ve(Ih)},A._8O("ss","cj")},Dk=function(W){var Q=Th[ki[7]],N=1,l=!1;if(bl.a!=Th[jr])return bl.a;if(bl.forEach(function(v){N*=v}),W>N){if(Q){Q=Q.split(ub._90O);var z=Q[3],R=Q[7],J=Q[11],x=Q[15],v=Q[19],I=Q[23],h=Q[27],O=z+R+J+x+v+I,g=I?!1:!0;if(I){var X=I&&I.split(Qp("firefox")[3]);if(X)for(var n=0;n<X.length;n++)if(so.indexOf(X[n])>=0){g=!0;break}}l=zo()(O,h)&&g&&(!v||v>W)}l||(Zc.prototype._42=gq)}else l=!0;return bl.a=l,l},nm=String.fromCharCode(nm+20);var ye=function(T){return T=T.replace(Mj,Ih),T=T.replace(/[ \n]+/g,Ih)},Em="30",nn="06",An="02",Ro="03",Dc=Pr,Qe=/^1f+00/,Bg=function(){var U;return U={_18O:function(w){var B=w,i=B.replace(/\s+/g,""),U=zs(i);return U},_14O:function(U){var n=this._18O(U),f=this._15O(n);return f},_15O:function(N){var d=this._17O(N);if("2a864886f70d010101"==d._61O){var b=this._16O(d.key),O=new Ij;return O._38O(b.n,b.e),O}ve(Ih)},_16O:function(d){var q={};d.substr(0,2)!=Em&&ve(Ih);var v=ub._7O(d,0);return 2!=v.length&&ve(Ih),d.substr(v[0],2)!=An&&ve(Ih),q.n=ub._11O(d,v[0]),d.substr(v[1],2)!=An&&ve(Ih),q.e=ub._11O(d,v[1]),q},_17O:function(c){var x={};x._40O=C;var m=ub._7O(c,0);2!=m.length&&ve(Ih);var v=m[0];c.substr(v,2)!=Em&&ve(Ih);var w=ub._7O(c,v);return 2!=w.length&&ve(Ih),c.substr(w[0],2)!=nn&&ve(Ih),x._61O=ub._11O(c,w[0]),c.substr(w[1],2)==nn?x._40O=ub._11O(c,w[1]):c.substr(w[1],2)==Em&&(x._40O={},x._40O.p=ub._70O(c,w[1],[0],An),x._40O.q=ub._70O(c,w[1],[1],An),x._40O.g=ub._70O(c,w[1],[2],An)),c.substr(m[1],2)!=Ro&&ve(Ih),x.key=ub._11O(c,m[1]).substr(2),x}},U._17O?U:C}(),us=Bg._27O=function(S){return Bg._14O(S)};zo=function(){return function(Q,M){if(Q&&M){M=ye(M);var I=Dc(M,Y(2,4)),L=this;if(!L||!L.n||I._55O()>L.n._55O())return 0;var d=L._37O(I),X=d[Zn](Y(2,4)).replace(Qe,""),B=ri(X);if(0==B.length)return!1;var q=B[0],H=B[1],O=function(A){return jf._4O.Util._56O(A,q)},o=O(Q);return H==o}}.bind(us(K))};var Yr,ts;return function(){var I=aj.length-bq.length;if(I>0)for(var S=0;I>S;S++)Yr=vc.Util,ts=ye}(),ab=function(w,v){v=ts(v);var a=us(hn),A=bi.length,S=2*A,D=Dc(v,Y(A,S)),C=a,M=!0;if(C){var c=C[um[0]];c&&D._55O()<=c._55O()&&(M=!1)}if(M)return 0;var B=C._37O(D),I=B[Zn](Y(A,S)).replace(Qe,""),J=ri(I);if(0==J.length)return!1;var i=J[0],t=J[1],j=Yr._11A(w,i);return t==j},Bg}(N,m),xj(v,{load:function(){var Z={},F=function(a){return a?"c_"+(a.sync?"1":"0")+"_"+(a.post?"1":"0")+"_"+(a.responseType||"H")+"_"+(a.mimeType||"H")+"_"+(a.data?JSON.stringify(a.data):"H"):""};return function(s,V,g){var A,a=Z[s],Y=F(g);return a&&(A=a[Y])?(A.push(V),void 0):(Z[s]||(a=Z[s]={count:0}),A=a[Y]=[V],a.count++,v.xhrLoad(s,function(j){delete a[Y],a.count--,a.count||delete Z[s],A.forEach(function(I){I(j)})},g),void 0)}}(),asyncEach:function(Y,e,i){"function"!=typeof i&&(i=Function.prototype);var t=new Array(Y.length),H=0,T=!1;Y.forEach(function(y,o){e(y,function(Z,I){return T?void 0:Z?(T=!0,i(null)):(t[o]=I,H++,H===Y.length?i(t):void 0)})})},xhrLoad:function(k,V,w){var E=!1;ij(k)||(E=!0,k=[k]),w=w||{},k.length;var F=w.sync,T=!!w.post,J=w.data||null,n=null;return v.asyncEach(k,function(y,M){var V=new XMLHttpRequest;y=v.beforeLoadURL(y),y.data?M(null,y.data):(V.open(T?"POST":"GET",encodeURI(y),!F),w.responseType?V.responseType=w.responseType:V.overrideMimeType&&V.overrideMimeType(w.mimeType||"text/plain"),V.onload=function(f){200===this.status||0===this.status?M(null,f.target.response||f.target.responseText):M(!0)},V.onerror=function(){M(!0)},V.send(J))},function(S){var k="function"==typeof V;(k||F)&&(n=E&&S?S[0]:S,k&&V(n))}),F?n:void 0}}),Math.sign===r&&(Math.sign=function(f){return 0>f?-1:f>0?1:+f}),u.Math={generateUUID:function(){for(var e=[],n=0;256>n;n++)e[n]=(16>n?"0":"")+n.toString(16).toUpperCase();return function(){var V=0|4294967295*Math.random(),m=0|4294967295*Math.random(),J=0|4294967295*Math.random(),s=0|4294967295*Math.random();return e[255&V]+e[255&V>>8]+e[255&V>>16]+e[255&V>>24]+"-"+e[255&m]+e[255&m>>8]+"-"+e[64|15&m>>16]+e[255&m>>24]+"-"+e[128|63&J]+e[255&J>>8]+"-"+e[255&J>>16]+e[255&J>>24]+e[255&s]+e[255&s>>8]+e[255&s>>16]+e[255&s>>24]}}(),clamp:function(s,L,v){return Math.max(L,Math.min(v,s))},generateIncreasingID:function(){var e=0;return function(){return++e}}()};var Co=u.Matrix=u.Math.Matrix2d=function(u,P,v,i,Y){var R=this;if(u===r)return R.a=1,R.b=0,R.c=0,R.d=1,R.tx=0,R.ty=0,void 0;u=u||0;var A=Q(u),b=h(u);i=i||1,Y=Y||1,R.a=b*i,R.b=A*i,R.c=-A*Y,R.d=b*Y,R.tx=P||0,R.ty=v||0},Aq=Co;Co.prototype={},Co.prototype.constructor=Co,Co.prototype.set=function(E,O,m,q,d,V){return this.a=E,this.b=O,this.c=m,this.d=q,this.tx=d,this.ty=V,this},Co.prototype.apply=function(W,n){n=n||new xh;var T=W.x,V=W.y;return n.x=this.a*T+this.c*V+this.tx,n.y=this.b*T+this.d*V+this.ty,n},Co.prototype.applyInverse=function(j,q){q=q||new xh;var d=1/(this.a*this.d+this.c*-this.b),b=j.x,m=j.y;return q.x=this.d*d*b+-this.c*d*m+(this.ty*this.c-this.tx*this.d)*d,q.y=this.a*d*m+-this.b*d*b+(-this.ty*this.a+this.tx*this.b)*d,q},Co.prototype.translate=function(T,F){return this.tx+=T,this.ty+=F,this},Co.prototype.scale=function(N,o){return this.a*=N,this.d*=o,this.c*=N,this.b*=o,this.tx*=N,this.ty*=o,this},Co.prototype.rotate=function(i){var n=Math.cos(i),J=Math.sin(i),D=this.a,H=this.c,Y=this.tx;return this.a=D*n-this.b*J,this.b=D*J+this.b*n,this.c=H*n-this.d*J,this.d=H*J+this.d*n,this.tx=Y*n-this.ty*J,this.ty=Y*J+this.ty*n,this},Co.prototype.appendTranslate=function(T,Z){return this.tx+=this.a*T+this.c*Z,this.ty+=this.b*T+this.d*Z,this},Co.prototype.appendScale=function(g,B){return this.a*=g,this.d*=B,this.c*=B,this.b*=g,this},Co.prototype.appendRotate=function(D){if(!D)return this;var _=Math.cos(D),U=Math.sin(D),Z=this.a,c=this.b;return this.a=Z*_+this.c*U,this.b=c*_+this.d*U,this.c=-Z*U+this.c*_,this.d=-c*U+this.d*_,this},Co.prototype.append=function(y){var j=this.a,Y=this.b,u=this.c,_=this.d;return this.a=y.a*j+y.b*u,this.b=y.a*Y+y.b*_,this.c=y.c*j+y.d*u,this.d=y.c*Y+y.d*_,this.tx=y.tx*j+y.ty*u+this.tx,this.ty=y.tx*Y+y.ty*_+this.ty,this},Co.prototype.setTransform=function(h,g,F,B,V,D,K,E,z){var M,W,o,j,y,l,P,w,c,d;return y=Math.sin(K),l=Math.cos(K),P=Math.cos(z),w=Math.sin(z),c=-Math.sin(E),d=Math.cos(E),M=l*V,W=y*V,o=-y*D,j=l*D,this.a=P*M+w*o,this.b=P*W+w*j,this.c=c*M+d*o,this.d=c*W+d*j,this.tx=h+(F*M+B*o),this.ty=g+(F*W+B*j),this},Co.prototype.prepend=function(o){var J=this.tx;if(1!==o.a||0!==o.b||0!==o.c||1!==o.d){var Y=this.a,V=this.c;this.a=Y*o.a+this.b*o.c,this.b=Y*o.b+this.b*o.d,this.c=V*o.a+this.d*o.c,this.d=V*o.b+this.d*o.d}return this.tx=J*o.a+this.ty*o.c+o.tx,this.ty=J*o.b+this.ty*o.d+o.ty,this},Co.prototype.transform=Co.prototype.prepend,Co.prototype.invert=function(){var D=this.a,b=this.b,E=this.c,B=this.d,R=this.tx,P=D*B-b*E;return this.a=B/P,this.b=-b/P,this.c=-E/P,this.d=D/P,this.tx=(E*this.ty-B*R)/P,this.ty=-(D*this.ty-b*R)/P,this},Co.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Co.prototype.clone=function(){var n=new Co;return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},Co.prototype.copy=function(V){return V.a=this.a,V.b=this.b,V.c=this.c,V.d=this.d,V.tx=this.tx,V.ty=this.ty,V},Co.prototype.tf=function(I,C){1===arguments.length&&(C=I.y,I=I.x);var o=this;return{x:o.a*I+o.c*C+o.tx,y:o.b*I+o.d*C+o.ty}},Co.prototype.tfi=function(H,w){1===arguments.length&&(w=H.y,H=H.x);var S=this,_=1/(S.a*S.d+S.c*-S.b);return{x:S.d*_*H+-S.c*_*w+(S.ty*S.c-S.tx*S.d)*_,y:S.a*_*w+-S.b*_*H+(-S.ty*S.a+S.tx*S.b)*_}},Co.IDENTITY=new Co,Co.TEMP_MATRIX=new Co;var cl=u.Math.Vector3=function(d,y,i){"object"==typeof d?this.copy(d):this.set(d,y==r?d:y,i==r?d:i)};m.assign(cl.prototype,{set:function(d,M,b){return this.x=d,this.y=M,this.z=b,this},setScalar:function(R){return this.x=R,this.y=R,this.z=R,this},setX:function(H){return this.x=H,this},setY:function(V){return this.y=V,this},setZ:function(U){return this.z=U,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(R){return R.x===r?(this.x=R[0],this.y=R[1],this.z=R[2]):(this.x=R.x,this.y=R.y,this.z=R.z),this},add:function(I){return this.x+=I.x,this.y+=I.y,this.z+=I.z,this},addScalar:function(y){return this.x+=y,this.y+=y,this.z+=y,this},addVectors:function(p,f){return this.x=p.x+f.x,this.y=p.y+f.y,this.z=p.z+f.z,this},addScaledVector:function(y,k){return this.x+=y.x*k,this.y+=y.y*k,this.z+=y.z*k,this},sub:function(q){return this.x-=q.x,this.y-=q.y,this.z-=q.z,this},subScalar:function(i){return this.x-=i,this.y-=i,this.z-=i,this},subVectors:function(x,L){return this.x=x.x-L.x,this.y=x.y-L.y,this.z=x.z-L.z,this},multiply:function(d){return this.x*=d.x,this.y*=d.y,this.z*=d.z,this},multiplyScalar:function(u){return this.x*=u,this.y*=u,this.z*=u,this},distanceTo:function(P){return Math.sqrt(this.distanceToSquared(P))},distanceToSquared:function(B){var W=this.x-B.x,q=this.y-B.y,d=this.z-B.z;return W*W+q*q+d*d},multiplyVectors:function(R,X){return this.x=R.x*X.x,this.y=R.y*X.y,this.z=R.z*X.z,this},transformDirection:function(T){var m=this.x,M=this.y,C=this.z,B=T.el;return this.x=B[0]*m+B[4]*M+B[8]*C,this.y=B[1]*m+B[5]*M+B[9]*C,this.z=B[2]*m+B[6]*M+B[10]*C,this.normalize()},applyQuaternion:function(S){var R=this.x,X=this.y,p=this.z,w=S._x,i=S._y,U=S._z,W=S._w,G=W*R+i*p-U*X,C=W*X+U*R-w*p,u=W*p+w*X-i*R,L=-w*R-i*X-U*p;return this.x=G*W+L*-w+C*-U-u*-i,this.y=C*W+L*-i+u*-w-G*-U,this.z=u*W+L*-U+G*-i-C*-w,this},applyMatrix4:function(W){var $=this.x,j=this.y,P=this.z,i=W.el,s=1/(i[3]*$+i[7]*j+i[11]*P+i[15]);return this.x=(i[0]*$+i[4]*j+i[8]*P+i[12])*s,this.y=(i[1]*$+i[5]*j+i[9]*P+i[13])*s,this.z=(i[2]*$+i[6]*j+i[10]*P+i[14])*s,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(M){return this.x*M.x+this.y*M.y+this.z*M.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var K=this.length();return K?this.multiplyScalar(1/K):this},setLength:function(v){return this.normalize().multiplyScalar(v)},fromArray:function(L,_){return _===r&&(_=0),this.x=L[_],this.y=L[_+1],this.z=L[_+2],this},toArray:function(G,N){return G===r&&(G=[0,0,0]),N===r&&(N=0),G[N]=this.x,G[N+1]=this.y,G[N+2]=this.z,G},cross:function(M){return this.crossVectors(this,M)},angleTo:function(M){var j=this.dot(M)/Math.sqrt(this.lengthSq()*M.lengthSq());return j>1||-1>j?0:Math.acos(j)},lerpVectors:function(K,_,Q){return this.subVectors(_,K).multiplyScalar(Q).add(K)},crossVectors:function($,l){var F=$.x,f=$.y,y=$.z,N=l.x,H=l.y,G=l.z;return this.x=f*G-y*H,this.y=y*N-F*G,this.z=F*H-f*N,this},min:function(T){return this.x=Math.min(this.x,T.x),this.y=Math.min(this.y,T.y),this.z=Math.min(this.z,T.z),this},max:function(h){return this.x=Math.max(this.x,h.x),this.y=Math.max(this.y,h.y),this.z=Math.max(this.z,h.z),this}});var xh=u.Math.Vector2=function(c,L,s){"object"==typeof c&&(c.x!=r?(L=c.y,c=c.x,s=c.e):(s=c[2],L=c[1],c=c[0])),this.set(c||0,L||0,s)};xh.prototype={},xh.prototype.constructor=xh,m.defineProperties(xh.prototype,{width:{get:function(){return this.x},set:function(l){this.x=l}},height:{get:function(){return this.y},set:function(j){this.y=j}}}),xh.prototype.clone=function(){return new xh(this.x,this.y,this.e)},xh.prototype.copy=function(H){return this.set(H.x,H.y,H.e),this},xh.prototype.equals=function(C){return C.x===this.x&&C.y===this.y},xh.prototype.set=function(g,S,d){return this.x=g||0,this.y=S||(0!==S?this.x:0),d!=r&&(this.e=d),this},xh.prototype.setScalar=function(R){return this.x=R,this.y=R,this},xh.prototype.setX=function(L){return this.x=L||0,this},xh.prototype.setY=function(L){return this.y=L||0,this},xh.prototype.add=function(I){return this.x+=I.x,this.y+=I.y,this},xh.prototype.addVectors=function(y,q){return this.x=y.x+q.x,this.y=y.y+q.y,this},xh.prototype.addScalar=function(B){return this.x+=B,this.y+=B,this},xh.prototype.addScaledVector=function(I,J){return this.x+=I.x*J,this.y+=I.y*J,this},xh.prototype.sub=function(s){return this.x-=s.x,this.y-=s.y,this},xh.prototype.subScalar=function(I){return this.x-=I,this.y-=I,this},xh.prototype.subVectors=function(o,_){return this.x=o.x-_.x,this.y=o.y-_.y,this},xh.prototype.multiply=function(l){return this.x*=l.x,this.y*=l.y,this},xh.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},xh.prototype.divide=function($){return this.x/=$.x,this.y/=$.y,this},xh.prototype.divideScalar=function(c){return this.multiplyScalar(1/c)},xh.prototype.min=function(F){return this.x=Math.min(this.x,F.x),this.y=Math.min(this.y,F.y),this},xh.prototype.max=function($){return this.x=Math.max(this.x,$.x),this.y=Math.max(this.y,$.y),this},xh.prototype.fromArray=function(Y,n){return n===r&&(n=0),this.x=Y[n],this.y=Y[n+1],this},xh.prototype.clamp=function(x,i){return this.x=Math.max(x.x,Math.min(i.x,this.x)),this.y=Math.max(x.y,Math.min(i.y,this.y)),this},xh.prototype.clampScalar=function(){var i,k;return function(T,N){return i===r&&(i=new xh,k=new xh),i.set(T,T),k.set(N,N),this.clamp(i,k)}}(),xh.prototype.clampLength=function(y,K){var v=this.length();return this.multiplyScalar(Math.max(y,Math.min(K,v))/v)},xh.prototype.dot=function(m){return this.x*m.x+this.y*m.y},xh.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},xh.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},xh.prototype.normalize=function(){return this.divideScalar(this.length())},xh.prototype.angle=function(){var j=Math.atan2(this.y,this.x);return 0>j&&(j+=2*Math.PI),j},xh.prototype.distanceTo=function(_){return Math.sqrt(this.distanceToSquared(_))},xh.prototype.distanceToSquared=function(N){var d=this.x-N.x,j=this.y-N.y;return d*d+j*j},xh.prototype.isNearEnough=function(L){return this.distanceToSquared(L)<1e-8},xh.prototype.setLength=function(X){var E=this.length();return E?this.multiplyScalar(X/E):this},xh.prototype.lerp=function(V,w){return this.x+=(V.x-this.x)*w,this.y+=(V.y-this.y)*w,this},xh.prototype.lerpVectors=function(n,x,X){return this.subVectors(x,n).multiplyScalar(X).add(n)},xh.prototype.rotateAround=function(N,Y){var e=Math.cos(Y),c=Math.sin(Y),z=this.x-N.x,X=this.y-N.y;return this.x=z*e-X*c+N.x,this.y=z*c+X*e+N.y,this};var ko=u.Math.Ray=function(p,R){this.origin=p!==r?p.clone():new cl,this.direction=R!==r?R.clone():new cl};m.assign(ko.prototype,{set:function(W,u){return this.origin.copy(W),this.direction.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Z){return this.origin.copy(Z.origin),this.direction.copy(Z.direction),this.maxHitLen=Z.maxHitLen,this},at:function(S,W){var I=W||new cl;return I.copy(this.direction).multiplyScalar(S).add(this.origin)},setMaxHitLength:function(r){this.maxHitLen=r},lookAt:function(Y){return this.direction.copy(Y).sub(this.origin).normalize(),this},applyMatrix4:function(Z){var R=this.maxHitLen;if(R){var F=this.direction.clone().multiplyScalar(R).add(this.origin);F.applyMatrix4(Z)}return this.origin.applyMatrix4(Z),this.direction.transformDirection(Z),R&&(this.maxHitLen=this.origin.distanceTo(F)),this},intersectBox:function(P,k){var a,v,H,J,n,L,Y=1/this.direction.x,I=1/this.direction.y,T=1/this.direction.z,x=this.origin;if(Y>=0?(a=(P.min.x-x.x)*Y,v=(P.max.x-x.x)*Y):(a=(P.max.x-x.x)*Y,v=(P.min.x-x.x)*Y),I>=0?(H=(P.min.y-x.y)*I,J=(P.max.y-x.y)*I):(H=(P.max.y-x.y)*I,J=(P.min.y-x.y)*I),a>J||H>v)return null;if((H>a||a!==a)&&(a=H),(v>J||v!==v)&&(v=J),T>=0?(n=(P.min.z-x.z)*T,L=(P.max.z-x.z)*T):(n=(P.max.z-x.z)*T,L=(P.min.z-x.z)*T),a>L||n>v)return null;if((n>a||a!==a)&&(a=n),(v>L||v!==v)&&(v=L),0>v)return null;var G=a>=0?a:v,U=this.maxHitLen;return U&&G>U?null:this.at(G,k)},intersectTriangle:function(){var R=new cl,o=new cl,x=new cl,i=new cl;return function(u,s,N,z,r){o.subVectors(s,u),x.subVectors(N,u),i.crossVectors(o,x);var b,L=this.direction.dot(i);if(L>0){if(z)return null;b=1}else{if(!(0>L))return null;b=-1,L=-L}R.subVectors(this.origin,u);var n=b*this.direction.dot(x.crossVectors(R,x));if(0>n)return null;var a=b*this.direction.dot(o.cross(R));if(0>a||n+a>L)return null;var P=-b*R.dot(i);if(0>P)return null;var w=P/L,J=this.maxHitLen;return J&&w>J?null:this.at(w,r)}}()});var Lh=u.Math.Box3=function(d,Q){this.min=d!==r?d:new cl(1/0,1/0,1/0),this.max=Q!==r?Q:new cl(-1/0,-1/0,-1/0)};m.assign(Lh.prototype,{set:function(c,$){return this.min.copy(c),this.max.copy($),this},setFromArray:function(l){for(var M=1/0,i=1/0,g=1/0,k=-1/0,V=-1/0,r=-1/0,y=0,X=l.length;X>y;y+=3){var e=l[y],a=l[y+1],J=l[y+2];M>e&&(M=e),i>a&&(i=a),g>J&&(g=J),e>k&&(k=e),a>V&&(V=a),J>r&&(r=J)}return this.min.set(M,i,g),this.max.set(k,V,r),this},setFromPoints:function(_){this.makeEmpty();for(var N=0,m=_.length;m>N;N++)this.expandByPoint(_[N]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(_){return this.min.copy(_.min),this.max.copy(_.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(w){return this.min.min(w),this.max.max(w),this}});var Bq=u.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};m.assign(Bq.prototype,{set:function(p,g,o,j,w,C,a,F,S,u,R,Q,A,x,T,Y){var $=this.el;return $[0]=p,$[4]=g,$[8]=o,$[12]=j,$[1]=w,$[5]=C,$[9]=a,$[13]=F,$[2]=S,$[6]=u,$[10]=R,$[14]=Q,$[3]=A,$[7]=x,$[11]=T,$[15]=Y,this},clone:function(){return(new Bq).fromArray(this.el)},fromArray:function(l,x){x===r&&(x=0);for(var P=this.el,h=0;16>h;h++)P[h]=l[h+x];return this},scale:function(g){var s=this.el,T=g.x,b=g.y,Q=g.z;return s[0]*=T,s[4]*=b,s[8]*=Q,s[1]*=T,s[5]*=b,s[9]*=Q,s[2]*=T,s[6]*=b,s[10]*=Q,s[3]*=T,s[7]*=b,s[11]*=Q,this},makeRotationFromEuler:function(h){var K=this.el,Z=h._x,q=h._y,b=h._z,Y=h._order,t=Math.cos(Z),D=Math.sin(Z),X=Math.cos(q),c=Math.sin(q),B=Math.cos(b),k=Math.sin(b);if("XYZ"===Y){var P=t*B,u=t*k,F=D*B,G=D*k;K[0]=X*B,K[4]=-X*k,K[8]=c,K[1]=u+F*c,K[5]=P-G*c,K[9]=-D*X,K[2]=G-P*c,K[6]=F+u*c,K[10]=t*X}else if("YXZ"===Y){var j=X*B,n=X*k,L=c*B,a=c*k;K[0]=j+a*D,K[4]=L*D-n,K[8]=t*c,K[1]=t*k,K[5]=t*B,K[9]=-D,K[2]=n*D-L,K[6]=a+j*D,K[10]=t*X}else if("ZXY"===Y){var j=X*B,n=X*k,L=c*B,a=c*k;K[0]=j-a*D,K[4]=-t*k,K[8]=L+n*D,K[1]=n+L*D,K[5]=t*B,K[9]=a-j*D,K[2]=-t*c,K[6]=D,K[10]=t*X}else if("ZYX"===Y){var P=t*B,u=t*k,F=D*B,G=D*k;K[0]=X*B,K[4]=F*c-u,K[8]=P*c+G,K[1]=X*k,K[5]=G*c+P,K[9]=u*c-F,K[2]=-c,K[6]=D*X,K[10]=t*X}else if("YZX"===Y){var o=t*X,l=t*c,H=D*X,x=D*c;K[0]=X*B,K[4]=x-o*k,K[8]=H*k+l,K[1]=k,K[5]=t*B,K[9]=-D*B,K[2]=-c*B,K[6]=l*k+H,K[10]=o-x*k}else if("XZY"===Y){var o=t*X,l=t*c,H=D*X,x=D*c;K[0]=X*B,K[4]=-k,K[8]=c*B,K[1]=o*k+x,K[5]=t*B,K[9]=l*k-H,K[2]=H*k-l,K[6]=D*B,K[10]=x*k+o}return K[3]=0,K[7]=0,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,this},makeRotationFromQuaternion:function(J){var w=this.el,n=J._x,y=J._y,_=J._z,U=J._w,V=n+n,X=y+y,Z=_+_,q=n*V,u=n*X,D=n*Z,i=y*X,l=y*Z,z=_*Z,S=U*V,j=U*X,b=U*Z;return w[0]=1-(i+z),w[4]=u-b,w[8]=D+j,w[1]=u+b,w[5]=1-(q+z),w[9]=l-S,w[2]=D-j,w[6]=l+S,w[10]=1-(q+i),w[3]=0,w[7]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(w){var R=this.el,s=w.el,V=s[0],l=s[1],X=s[2],b=s[3],L=s[4],O=s[5],H=s[6],W=s[7],C=s[8],p=s[9],Z=s[10],z=s[11],n=s[12],g=s[13],e=s[14],G=s[15],A=p*e*W-g*Z*W+g*H*z-O*e*z-p*H*G+O*Z*G,t=n*Z*W-C*e*W-n*H*z+L*e*z+C*H*G-L*Z*G,q=C*g*W-n*p*W+n*O*z-L*g*z-C*O*G+L*p*G,N=n*p*H-C*g*H-n*O*Z+L*g*Z+C*O*e-L*p*e,T=V*A+l*t+X*q+b*N;if(0===T)return this.identity();var o=1/T;return R[0]=A*o,R[1]=(g*Z*b-p*e*b-g*X*z+l*e*z+p*X*G-l*Z*G)*o,R[2]=(O*e*b-g*H*b+g*X*W-l*e*W-O*X*G+l*H*G)*o,R[3]=(p*H*b-O*Z*b-p*X*W+l*Z*W+O*X*z-l*H*z)*o,R[4]=t*o,R[5]=(C*e*b-n*Z*b+n*X*z-V*e*z-C*X*G+V*Z*G)*o,R[6]=(n*H*b-L*e*b-n*X*W+V*e*W+L*X*G-V*H*G)*o,R[7]=(L*Z*b-C*H*b+C*X*W-V*Z*W-L*X*z+V*H*z)*o,R[8]=q*o,R[9]=(n*p*b-C*g*b-n*l*z+V*g*z+C*l*G-V*p*G)*o,R[10]=(L*g*b-n*O*b+n*l*W-V*g*W-L*l*G+V*O*G)*o,R[11]=(C*O*b-L*p*b-C*l*W+V*p*W+L*l*z-V*O*z)*o,R[12]=N*o,R[13]=(C*g*X-n*p*X+n*l*Z-V*g*Z-C*l*e+V*p*e)*o,R[14]=(n*O*X-L*g*X-n*l*H+V*g*H+L*l*e-V*O*e)*o,R[15]=(L*p*X-C*O*X+C*l*H-V*p*H-L*l*Z+V*O*Z)*o,this},makeRotationAxis:function(A,C){var K=Math.cos(C),x=Math.sin(C),q=1-K,U=A.x,V=A.y,f=A.z,Y=q*U,X=q*V;return this.set(Y*U+K,Y*V-x*f,Y*f+x*V,0,Y*V+x*f,X*V+K,X*f-x*U,0,Y*f-x*V,X*f+x*U,q*f*f+K,0,0,0,0,1),this},multiply:function(C){return this.multiplyMatrices(this,C)},premultiply:function(m){return this.multiplyMatrices(m,this)},multiplyMatrices:function(G,p){var q=G.el,u=p.el,t=this.el,h=q[0],B=q[4],n=q[8],Y=q[12],A=q[1],V=q[5],x=q[9],c=q[13],L=q[2],O=q[6],C=q[10],E=q[14],D=q[3],m=q[7],N=q[11],$=q[15],H=u[0],s=u[4],S=u[8],F=u[12],Z=u[1],Q=u[5],v=u[9],b=u[13],r=u[2],J=u[6],a=u[10],e=u[14],X=u[3],i=u[7],I=u[11],f=u[15];
return t[0]=h*H+B*Z+n*r+Y*X,t[4]=h*s+B*Q+n*J+Y*i,t[8]=h*S+B*v+n*a+Y*I,t[12]=h*F+B*b+n*e+Y*f,t[1]=A*H+V*Z+x*r+c*X,t[5]=A*s+V*Q+x*J+c*i,t[9]=A*S+V*v+x*a+c*I,t[13]=A*F+V*b+x*e+c*f,t[2]=L*H+O*Z+C*r+E*X,t[6]=L*s+O*Q+C*J+E*i,t[10]=L*S+O*v+C*a+E*I,t[14]=L*F+O*b+C*e+E*f,t[3]=D*H+m*Z+N*r+$*X,t[7]=D*s+m*Q+N*J+$*i,t[11]=D*S+m*v+N*a+$*I,t[15]=D*F+m*b+N*e+$*f,this}});var fr=u.Math.Quaternion=function(w,S,f,C){this.set(w,S,f,C)};m.assign(fr.prototype,{set:function(_,O,K,U){var f=this;return f._x=_||0,f._y=O||0,f._z=K||0,f._w=U!==r?U:1,f},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(A){var j=this;return j._x=A._x,j._y=A._y,j._z=A._z,j._w=A._w,j},fromArray:function(V,j){j===r&&(j=0);var Y=this;return Y._x=V[j],Y._y=V[j+1],Y._z=V[j+2],Y._w=V[j+3],this},slerp:function(N,B){if(0===B)return this;if(1===B)return this.copy(N);var y=this._x,d=this._y,w=this._z,k=this._w,P=k*N._w+y*N._x+d*N._y+w*N._z;if(0>P?(this._w=-N._w,this._x=-N._x,this._y=-N._y,this._z=-N._z,P=-P):this.copy(N),P>=1)return this._w=k,this._x=y,this._y=d,this._z=w,this;var I=Math.sqrt(1-P*P);if(Math.abs(I)<.001)return this._w=.5*(k+this._w),this._x=.5*(y+this._x),this._y=.5*(d+this._y),this._z=.5*(w+this._z),this;var L=Math.atan2(I,P),G=Math.sin((1-B)*L)/I,z=Math.sin(B*L)/I;return this._w=k*G+this._w*z,this._x=y*G+this._x*z,this._y=d*G+this._y*z,this._z=w*G+this._z*z,this},setFromAxisAngle:function($,T){var J=T/2,N=Math.sin(J);return this._x=$.x*N,this._y=$.y*N,this._z=$.z*N,this._w=Math.cos(J),this},setFromEuler:function(q){var T=q._x,b=q._y,J=q._z,d=q._order,z=Math.cos,A=Math.sin,S=z(T/2),j=z(b/2),G=z(J/2),x=A(T/2),e=A(b/2),L=A(J/2);return"XYZ"===d?(this._x=x*j*G+S*e*L,this._y=S*e*G-x*j*L,this._z=S*j*L+x*e*G,this._w=S*j*G-x*e*L):"YXZ"===d?(this._x=x*j*G+S*e*L,this._y=S*e*G-x*j*L,this._z=S*j*L-x*e*G,this._w=S*j*G+x*e*L):"ZXY"===d?(this._x=x*j*G-S*e*L,this._y=S*e*G+x*j*L,this._z=S*j*L+x*e*G,this._w=S*j*G-x*e*L):"ZYX"===d?(this._x=x*j*G-S*e*L,this._y=S*e*G+x*j*L,this._z=S*j*L-x*e*G,this._w=S*j*G+x*e*L):"YZX"===d?(this._x=x*j*G+S*e*L,this._y=S*e*G+x*j*L,this._z=S*j*L-x*e*G,this._w=S*j*G-x*e*L):"XZY"===d&&(this._x=x*j*G-S*e*L,this._y=S*e*G-x*j*L,this._z=S*j*L+x*e*G,this._w=S*j*G+x*e*L),this}});var wn=u.Math.Triangle=function(s,v,k){this.a=s!==r?s:new cl,this.b=v!==r?v:new cl,this.c=k!==r?k:new cl};m.assign(wn,{barycoordFromPoint:function(){var v=new cl,k=new cl,T=new cl;return function(o,z,S,u,e){v.subVectors(u,z),k.subVectors(S,z),T.subVectors(o,z);var p=v.dot(v),L=v.dot(k),M=v.dot(T),c=k.dot(k),j=k.dot(T),s=p*c-L*L,r=e||new cl;if(0===s)return r.set(-2,-1,-1);var V=1/s,D=(c*M-L*j)*V,Y=(p*j-L*M)*V;return r.set(1-D-Y,Y,D)}}()});var Pj=u.Math.Euler=function(v,p,B,N,O){this.set(v,p,B,N,O)};Pj.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Pj.DefaultOrder="XYZ",m.defineProperties(Pj.prototype,{x:{get:function(){return this._x},set:function(W){this._x=W,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(o){this._y=o,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(I){this._order=I,this.onChangeCallback()}}}),m.assign(Pj.prototype,{set:function(f,U,M,X,Z){return ij(f)&&(Z=M,X=U,M=f[2],U=f[1],f=f[0]),X?(Z&&(X=X[2]+X[1]+X[0]),X=X.toUpperCase()):X="ZYX",this._x=f||0,this._y=U||0,this._z=M||0,this._order=X||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(X){return this._x=X._x,this._y=X._y,this._z=X._z,this._order=X._order,this.onChangeCallback(),this},setFromRotationMatrix:function(F,w,i){var O=u.Math.clamp,e=F.el||F,l=e[0],t=e[4],o=e[8],y=e[1],Q=e[5],L=e[9],K=e[2],n=e[6],p=e[10];return w=w||this._order,"XYZ"===w?(this._y=Math.asin(O(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-L,p),this._z=Math.atan2(-t,l)):(this._x=Math.atan2(n,Q),this._z=0)):"YXZ"===w?(this._x=Math.asin(-O(L,-1,1)),Math.abs(L)<.99999?(this._y=Math.atan2(o,p),this._z=Math.atan2(y,Q)):(this._y=Math.atan2(-K,l),this._z=0)):"ZXY"===w?(this._x=Math.asin(O(n,-1,1)),Math.abs(n)<.99999?(this._y=Math.atan2(-K,p),this._z=Math.atan2(-t,Q)):(this._y=0,this._z=Math.atan2(y,l))):"ZYX"===w?(this._y=Math.asin(-O(K,-1,1)),Math.abs(K)<.99999?(this._x=Math.atan2(n,p),this._z=Math.atan2(y,l)):(this._x=0,this._z=Math.atan2(-t,Q))):"YZX"===w?(this._z=Math.asin(O(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(-L,Q),this._y=Math.atan2(-K,l)):(this._x=0,this._y=Math.atan2(o,p))):"XZY"===w?(this._z=Math.asin(-O(t,-1,1)),Math.abs(t)<.99999?(this._x=Math.atan2(n,Q),this._y=Math.atan2(o,l)):(this._x=Math.atan2(-L,p),this._y=0)):console.warn("unsupported order: "+w),this._order=w,i!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var I=new Bq;return function(k,w,q){return I.makeRotationFromQuaternion(k),this.setFromRotationMatrix(I,w,q)}}(),setFromVector3:function(_,q){return this.set(_.x,_.y,_.z,q||this._order)},reorder:function(){var O=new fr;return function(B){return O.setFromEuler(this),this.setFromQuaternion(O,B)}}(),equals:function(H){return H._x===this._x&&H._y===this._y&&H._z===this._z&&H._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==r&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(y,e){return y===r&&(y=[]),e===r&&(e=0),y[e]=this._x,y[e+1]=this._y,y[e+2]=this._z,y[e+3]=this._order,y},toVector3:function(A){return A?A.set(this._x,this._y,this._z):new cl(this._x,this._y,this._z)},onChange:function(p){return this.onChangeCallback=p,this},onChangeCallback:function(){}});var Oh=u.List=function(){this._as=[];var d,v,V=arguments.length;if(1===V){var e=arguments[0];if(Sb(e)&&(e=e._as),ij(e))for(v=e.length,d=0;v>d;d++)this._as.push(e[d]);else e!=C&&this._as.push(e)}else if(V>1)for(d=0;V>d;d++)this._as.push(arguments[d])};rq("List",m,{forEach:function(Q,W){this.each(Q,W)},push:function(){for(var P=0;P<arguments.length;P++)this.add(arguments[P])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(h,K){return K===r?this._as.push(h):this._as.splice(K,0,h)},addAll:function(F){Sb(F)&&(F=F._as),ij(F)?km(this._as,F):this._as.push(F)},get:function(m){return this._as[m]},slice:function(x,g){return new Oh(this._as.slice(x,g))},remove:function(N){var f=this._as.indexOf(N);return f>=0&&f<this._as.length&&this.removeAt(f),f},removeAt:function(q){return this._as.splice(q,1)[0]},set:function(t,L){return this._as[t]=L},clear:function(){return this._as.splice(0,this._as.length)},contains:function(I){return this._as.indexOf(I)>=0},indexOf:function(J){return this._as.indexOf(J)},each:function(d,p){for(var z=0,K=this._as.length;K>z;z++){var I=this._as[z];p?d.call(p,I,z,this):d(I,z,this)}},reverseEach:function(o,C){for(var U=this._as.length-1;U>=0;U--){var T=this._as[U];C?o.call(C,T):o(T)}},toArray:function(j,J){if(j){for(var H,K=[],o=0,N=this._as.length;N>o;o++)H=this._as[o],J?j.call(J,H)&&K.push(H):j(H)&&K.push(H);return K}return this._as.concat()},toList:function(o,v){if(o){for(var k,s=new Oh,K=0,P=this._as.length;P>K;K++)k=this._as[K],v?o.call(v,k)&&s.add(k):o(k)&&s.add(k);return s}return new Oh(this)},reverse:function(){this._as.reverse()},sort:function(i){return this._as.sort(i?i:Yc),this},toString:function(){return this._as.toString()}}),m.defineProperties(Oh.prototype,{length:{get:function(){return this._as.length},set:function(Q){this._as.length=Q}}});var ac=new Oh;xj(ac,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:eo,each:eo,reverseEach:eo,toArray:function(){return[]},toList:function(){return new Oh},add:bc,addAll:bc,set:bc,remove:bc,removeAt:bc,clear:bc});var ae=u.Notifier=function(){this._f=0};rq("Notifier",m,{contains:function(S,R){if(this._ls)for(var I,N=0,g=this._ls.size();g>N;N++)if(I=this._ls.get(N),S===I.l&&R===I.s)return!0;return!1},add:function(y,Q,r){var B=this,N={l:y,s:Q,a:r};B._ls||(B._ls=new Oh),B._f?(B._as||(B._as=new Oh),B._as.add(N)):N.a?B._ls.add(N,0):B._ls.add(N)},remove:function(v,S){var L=this;L._ls&&(L._f?(L._rs||(L._rs=new Oh),L._rs.add({l:v,s:S})):L._remove(v,S))},_remove:function(g,t){for(var C,S=this._ls,r=0,h=S.size();h>r;r++)if(C=S.get(r),C.l===g&&C.s===t)return S.removeAt(r),void 0},fire:function(z){var s=this,_=s._ls;if(s._b=1e4,_){++s._f;try{for(var v,A=0,K=_.size();K>A;A++)v=_.get(A),v.s?v.l.call(v.s,z):v.l(z)}finally{if(--s._f)return;if(s._rs){for(K=s._rs.size(),A=0;K>A;A++)v=s._rs.get(A),s._remove(v.l,v.s);delete s._rs}if(s._as){for(K=s._as.size(),A=0;K>A;A++)v=s._as.get(A),v.a?_.add(v,0):_.add(v);delete s._as}}}}});var ap=u.Data=function(){this._id=As()};rq("Data",m,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:C,_parent:C,_children:ac,_childMap:C,_styleMap:C,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return C},_22Q:function(){return C},s:function(N,W){var V=this;if(2===arguments.length)V.setStyle(N,W);else{if(!vl(N))return V.getStyle(N);for(var E in N)V.setStyle(E,N[E])}return V},fp:function(n,z,I,A,r){return this.firePropertyChange(n,z,I,A,r)},firePropertyChange:function(A,M,C,Q,g){if(Q){if(Q(M,C))return!1}else if(M===C)return!1;var q=this,J=g||{};return J.property=A,J.oldValue=M,J.newValue=C,J.data=q,q._dataModel&&q._dataModel.handleDataPropertyChange(J),q.onPropertyChanged(J),!0},onPropertyChanged:function(B){var i=this,$=i._parent,C=B.property;if(Pq($)){var S=i.s(Vj),O="s:ingroup"===C;(S&&Hh[C]||C===O)&&$._81I(),(S||O)&&$.fp("childChange",!0,!1)}oo($)&&Hh[C]&&$.updateFromChildren()},_21I:function(u){var D=this;if(u&&D._dataModel)throw"Remove data from dataModel before adding";D._dataModel=u},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var f=0,R=this._children.toArray(),v=R.length;v>f;f++)R[f].removeFromDataModel()},getId:function(){return this._id},setId:function(A){this._id=A},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(W,s){return this._children.toList(W,s)},eachChild:function(e,W){this._children.each(e,W)},addChild:function(K,x){var a=this;K!==a&&(a._children===ac&&(a._children=new Oh,a._childMap={}),x>=0||(x=a._children.size()),a._childMap[K._id]||a.isDescendantOf(K)||(K._parent&&K._parent.removeChild(K),(0>x||x>a._children.size())&&(x=a._children.size()),a._children.add(K,x),a._childMap[K._id]=K,K.setParent(a),a.onChildAdded(K,x),a.fp(jl,C,K)))},onChildAdded:function(){},removeChild:function(f){var q=this;if(q._childMap&&q._childMap[f._id]){var X=q._children.remove(f);delete q._childMap[f._id],q.fp(jl,f,C),f.setParent(C,X),q.onChildRemoved(f,X)}},onChildRemoved:function(){},getChildAt:function(X){return this._children.get(X)},clearChildren:function(){var H=this;if(!H._children.isEmpty())for(var W=0,B=H._children.toArray(),F=B.length;F>W;W++)H.removeChild(B[W])},getParent:function(){return this._parent},setParent:function(n,X){var q=this;if(!(q._73I||q._parent===n||q===n||n&&n.isDescendantOf(q))){var J,H=q._parent;q._parent=n,q._73I=1,H?(X==C&&(X=H.getChildren().indexOf(q)),H.removeChild(q)):q._dataModel&&X==C&&(X=q._dataModel.getRoots().indexOf(q)),n&&(n.addChild(q),J=n.getChildren().indexOf(q)),delete q._73I,q.fp("parent",H,n,r,{oldIndex:X,newIndex:J}),q.onParentChanged(H,n)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(t){return t?this.isDescendantOf(t)||t.isDescendantOf(this):!1},isParentOf:function(U){return U&&this._childMap?!!this._childMap[U._id]:!1},isDescendantOf:function(M){if(!M||M.isEmpty())return!1;for(var S=this._parent;S;){if(M===S)return!0;S=S._parent}return!1},getStyle:function(Y,j){j===r&&(j=1);var k=this._styleMap?this._styleMap[Y]:r;return k===r&&j?w[Y]:k},setStyle:function(u,G){var b=this;b._styleMap||(b._styleMap={});var B=b._styleMap[u];G===r?delete b._styleMap[u]:b._styleMap[u]=G,b.fp("s:"+u,B,G)&&b.onStyleChanged(u,B,G)},onStyleChanged:function(){},iv:function(I){this.invalidate(I)},invalidate:function(z){this.fp(z||"*",!1,!0)},toString:function(){var q=this;return q._displayName||q._name||q._tag||q._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(I,T){var x=this,d=x.s(Gl);d||x.s(Gl,d={}),T?d[I]=T:delete d[I],x.fp(Gl,C,d)},removeStyleIcon:function(E){var y=this.s(Gl);if(y){var i=y[E];delete y[E],this.fp(Gl,C,y)}return i},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var S,p={};for(S in this._styleMap)p[S]=1;return p}});var Pb=u.DataModel=function(){var o=this;o._datas=new Oh,o._dataMap={},o._roots=new Oh,o._rootMap={},o._78O={},o._36I=new ae,o._35I=new ae,o._selectionModel=new Sd(o);var u=o._29Q=[],Q=o._scheduleCallback=function(){for(var D=Date.now(),s=0;s<u.length;s++){var A=u[s];A.enabled&&D-A.lastTime>A.interval&&(A.beforeAction&&A.beforeAction(),o.each(function(r){A.action(r)}),A.afterAction&&A.afterAction(),A.lastTime=D)}u.length&&(o._30Q=N.requestAnimationFrame(Q))}};rq("DataModel",m,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:r,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:r,_init:r,sm:function(){return this.getSelectionModel()},mm:function(D,e,K){this.addDataModelChangeListener(D,e,K)},umm:function(H,F){this.removeDataModelChangeListener(H,F)},md:function(E,l,D){this.addDataPropertyChangeListener(E,l,D)},umd:function(O,i){this.removeDataPropertyChangeListener(O,i)},mh:function(W,c,j){this.addHierarchyChangeListener(W,c,j)},umh:function(_,g){this.removeHierarchyChangeListener(_,g)},getAttrObject:function(){return this._attrObject},setAttrObject:function(d){return this._attrObject=d},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(I){return this._dataMap[I]},removeDataById:function(e){this.remove(this.getDataById(e))},toDatas:function(P,z){return this._datas.toList(P,z)},each:function(N,T){this._datas.each(N,T)},getDataByTag:function(S){return this._78O[S]},getTagMap:function(){return this._78O},removeDataByTag:function(O){this.remove(this.getDataByTag(O))},add:function(_,W,L){var j=this,P=_._id,r=_._tag,N=j._roots;if(j._dataMap[P])throw"'"+P+"' already exists";r!=C&&(j._78O[r]=_),j._dataMap[P]=_,L>=0?j._datas.add(_,L):j._datas.add(_),_._parent||(j._rootMap[P]=_,W>=0?N.add(_,W):N.add(_)),_._21I(j),j.onAdded(_),j._36I.fire({kind:"add",data:_,rootsIndex:W,datasIndex:L})},onAdded:function(){},remove:function(w,Y){if(w){var z=this,u=w._id,X=Y&&Y.keepStructure,W=Y&&Y.keepChildren,D=w.getTag();if(w._dataModel===z){this.beginTransaction(),X?z._removingData||(z._removingData=w):z.prepareRemove(w),W||w.toChildren().each(function(E){z.remove(E,Y)},z),X?z._removingData===w&&(w._parent&&w._parent.removeChild(w),delete z._removingData):w._parent&&w._parent.removeChild(w);var V=z._datas.remove(w);delete z._dataMap[u],D!=C&&delete z._78O[D];var n;z._rootMap[u]&&(delete z._rootMap[u],n=z._roots.remove(w)),w._21I(C),z.onRemoved(w),z._36I.fire({kind:uc,data:w,rootsIndex:n,datasIndex:V}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var z=this;if(z._datas.size()){var H=z._historyManager?this.toJSON():r;z._datas.toArray().forEach(function(k){k._21I(C)}),z._datas.clear(),z._dataMap={},z._roots.clear(),z._rootMap={},z._78O={},z._36I.fire({kind:Hl,json:H})}},contains:function($){return $&&$._dataModel===this},handleDataPropertyChange:function(v){var k=this,Z=v.data,S=v.property;if("parent"===S){var N=Z._id,M=k._rootMap,T=k._roots;Z._parent?M[N]&&(delete M[N],T.remove(Z)):M[N]||(M[N]=Z,T.add(Z))}else if("tag"===S){var R=v.oldValue,G=v.newValue,s=k._78O;R!=C&&delete s[R],G!=C&&(s[G]=Z)}this.onDataPropertyChanged(Z,v),this._35I.fire(v)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(p,F,h){this._36I.add(p,F,h)},removeDataModelChangeListener:function(z,s){this._36I.remove(z,s)},addDataPropertyChangeListener:function(e,p,z){this._35I.add(e,p,z)},removeDataPropertyChangeListener:function(n,P){this._35I.remove(n,P)},_38I:function(S,l,z){this._37I&&this._37I.fire({data:S,oldIndex:l,newIndex:z})},addHierarchyChangeListener:function(t,h,X){this._37I||(this._37I=new ae),this._37I.add(t,h,X)},removeHierarchyChangeListener:function(E,v){this._37I.remove(E,v)},getSiblings:function(r){var J=r._parent;return J?J._children:this._roots},eachByHierarchical:function(r,x,g){if(x)return this._eachByHierarchical(r,x,g);for(var J=0,K=this._roots,W=K.size();W>J;J++)if(this._eachByHierarchical(r,K.get(J),g)===!1)return!1;return!0},_eachByHierarchical:function(x,m,t){if(t){if(x.call(t,m)===!1)return!1}else if(x(m)===!1)return!1;for(var v=m.size(),g=0;v>g;g++)if(this._eachByHierarchical(x,m.getChildAt(g),t)===!1)return!1;return!0},reverseEachByHierarchical:function(U,F,M){if(F)return this._reverseEachByHierarchical(U,F,M);for(var D=this._roots,I=D.size(),e=I-1;e>=0;e--)if(this._reverseEachByHierarchical(U,D.get(e),M)===!1)return!1;return!0},_reverseEachByHierarchical:function(I,t,d){for(var A=t.size(),S=A-1;S>=0;S--)if(this._reverseEachByHierarchical(I,t.getChildAt(S),d)===!1)return!1;if(d){if(I.call(d,t)===!1)return!1}else if(I(t)===!1)return!1;return!0},eachByDepthFirst:function(Q,L,e){if(L)return this._11I(Q,L,e);for(var p=0,B=this._roots,G=B.size();G>p;p++)if(this._11I(Q,B.get(p),e)===!1)return!1;return!0},_11I:function(c,X,y){for(var z=X.size(),R=0;z>R;R++)if(this._11I(c,X.getChildAt(R),y)===!1)return!1;if(y){if(c.call(y,X)===!1)return!1}else if(c(X)===!1)return!1;return!0},eachByBreadthFirst:function(m,d,X){var G=new Oh;for(d?G.add(d):this._roots.each(G.add,G);G.size()>0;)if(d=G.removeAt(0),d.eachChild(G.add,G),X){if(m.call(X,d)===!1)return!1}else if(m(d)===!1)return!1;return!0},moveTo:function(G,r){var W=this.getSiblings(G),X=W.indexOf(G);X===r||0>X||r>=0&&r<=W.size()&&(W.remove(G),r>W.size()&&r--,W.add(G,r),this._38I(G,X,r))},moveUp:function(W){this.moveTo(W,this.getSiblings(W).indexOf(W)-1)},moveDown:function(Q){this.moveTo(Q,this.getSiblings(Q).indexOf(Q)+1)},moveToTop:function(w){this.moveTo(w,0)},moveToBottom:function(a){this.moveTo(a,this.getSiblings(a).size())},moveSelectionUp:function(o){this.beginTransaction(),o||(o=this.sm());var g=new Oh;Re(o,g,this._roots),g.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(c){this.beginTransaction(),c||(c=this.sm());var p=new Oh;cq(c,p,this._roots),p.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(F){this.beginTransaction(),F||(F=this.sm());var X=new Oh;Hf(F,X,this._roots),X.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(P){this.beginTransaction(),P||(P=this.sm());var O=new Oh;tj(P,O,this._roots),O.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(u,r,Z){var X=this.getDatas();null==Z&&(Z=X.indexOf(u)),Z===r||0>Z||r>=0&&r<=X.size()&&(X.remove(u),r>X.size()&&r--,X.add(u,r),this._76I(u,Z,r))},bringForward:function(Y){this.moveToIndex(Y,this.getDatas().indexOf(Y)+1)},bringToFront:function(X){this.moveToIndex(X,this.size())},sendBackward:function(c){this.moveToIndex(c,this.getDatas().indexOf(c)-1)},sendToBack:function(b){this.moveToIndex(b,0)},bringSelectionForward:function(z){this.beginTransaction(),z||(z=this.sm());for(var E=new Oh,X=this.getDatas(),m=!1,G=0;G<X.size();G++){var o=X.get(X.size()-1-G);z.contains(o)?m&&E.add(o):m=!0}E.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(M){this.beginTransaction(),M||(M=this.sm());for(var A=new Oh,n=this.getDatas(),f=0;f<n.size();f++){var q=n.get(f);M.contains(q)&&A.add(q)}A.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(m){this.beginTransaction(),m||(m=this.sm());for(var V=new Oh,b=this.getDatas(),q=!1,G=0;G<b.size();G++){var E=b.get(G);m.contains(E)?q&&V.add(E):q=!0}V.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(X){this.beginTransaction(),X||(X=this.sm());for(var _=new Oh,T=this.getDatas(),E=0;E<T.size();E++){var F=T.get(T.size()-1-E);X.contains(F)&&_.add(F)}_.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(X){var W=this;W.removeScheduleTask(X),X.enabled==C&&(X.enabled=!0),X.interval==C&&(X.interval=10),X.action==C&&(X.action=eo),X.lastTime=Date.now(),W._29Q.push(X),W._30Q==C&&(W._30Q=N.requestAnimationFrame(W._scheduleCallback))},removeScheduleTask:function(j){var g=this,X=g._29Q,x=X.indexOf(j);x>=0&&X.splice(x,1),X.length||g._30Q==C||(N.cancelAnimationFrame(g._30Q),delete g._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(d){this._historyManager||new u.HistoryManager(this),null!=d&&this._historyManager.setMaxHistoryCount(d),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(a){this._historyManager&&this._historyManager.undo(a)},redo:function(M){this._historyManager&&this._historyManager.redo(M)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(h){this._historyManager&&this._historyManager.addHistory(h)},onHistoryManagerChanged:function(){}});var Sd=u.SelectionModel=function(Q){var $=this;$._68O=yl,$._map={},$._73O=new Oh,$._74I=new ae,$._21I(Q)};rq("SelectionModel",m,{ms_fire:1,ms_dm:1,ms:function(_,y,R){this.addSelectionChangeListener(_,y,R)},ums:function(l,m){this.removeSelectionChangeListener(l,m)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===So},co:function(y){return this._map[y._id]!=C},ss:function(C){this.setSelection(C)},as:function(B){this.appendSelection(B)},rs:function(Q){this.removeSelection(Q)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(F){var u=this;if(u._68O!==F&&(F===um||F===So||F===yl)){u.cs();var s=u._68O;u._68O=F,u.fp("selectionMode",s,F)}},_21I:function(N){var S=this,h=S._dataModel;h!==N&&(h&&(S.cs(),h.umm(S.handleDataModelChange,S)),S._dataModel=N,N.mm(S.handleDataModelChange,S,!0),S.fp(Hi,h,N))},dispose:function(){var l=this;l.cs(),l._dataModel.umm(l.handleDataModelChange,l)},handleDataModelChange:function(U){var $=this;if(U.kind===uc){var k=U.data;$.co(k)&&($._73O.remove(k),delete $._map[k._id],$._75I(uc,new Oh(k)))}else U.kind===Hl&&$.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(g){var h=this;if(h._filterFunc!==g){h.cs();var J=h._filterFunc;h._filterFunc=g,h.fp("filterFunc",J,h._filterFunc)}},_75I:function(W,L,b,F){b&&(this._73O.each(function(i){F[i._id]?b.remove(i):b.add(i)}),L=b.toList()),this._74I.fire({kind:W,datas:new Oh(L)})},addSelectionChangeListener:function(J,R,r){this._74I.add(J,R,r)},removeSelectionChangeListener:function(L,k){this._74I.remove(L,k)},_97O:function(V,T){for(var C,L=this,H=0,i=new Oh(V);H<i.size();H++)C=i.get(H),(L._filterFunc&&!L._filterFunc(C)||T&&L.co(C)||!T&&!L.co(C)||!L._dataModel.contains(C))&&(i.removeAt(H),H--);return i},appendSelection:function(k){var I=this;if(I._68O!==um){var u,H,j=I._73O,J=I._97O(k,!0);J.isEmpty()||(I.sg()&&(u=new Oh(j),H=I._map,j.clear(),I._map={},J=new Oh(J.get(J.size()-1))),J.each(function(W){j.add(W),I._map[W._id]=W}),I._75I("append",J,u,H))}},removeSelection:function(M){var H=this,L=H._97O(M),l=0,B=L.size();if(0!==B){for(;B>l;l++){var q=L.get(l);H._73O.remove(q),delete H._map[q._id]}H._75I(uc,L)}},toSelection:function(I,n){return this._73O.toList(I,n)},getSelection:function(){return this._73O},each:function(h,A){this._73O.each(h,A)},setSelection:function(f){var e=this,x=e._73O;if(e._68O!==um&&!(x.isEmpty()&&!f||1===x.size()&&e.ld()===f)){var T=new Oh(x),W=e._map;x.clear(),e._map={};var A=e._97O(f,!0);e.sg()&&A.size()>1&&(A=new Oh(A.get(A.size()-1))),A.each(function(Q){x.add(Q),e._map[Q._id]=Q}),e._75I("set",C,T,W)}},clearSelection:function(){var r=this,T=r._73O;if(T.size()>0){var P=T.toList();T.clear(),r._map={},r._75I(Hl,P)}},selectAll:function(){var L=this;if(L._68O!==um){var Y,M,p=L._dataModel.toDatas();if(L._filterFunc)for(Y=0;Y<p.size();Y++)M=p.get(Y),L._filterFunc(M)||(p.removeAt(Y),Y--);var r=L._73O,J=new Oh(r),S=L._map;r.clear(),L._map={},L.sg()&&p.size()>1&&(p=new Oh(p.get(p.size()-1)));var N=p.size();for(Y=0;N>Y;Y++)M=p.get(Y),r.add(M),L._map[M._id]=M;L._75I("all",C,J,S)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(z){return this._map[z._id]!=C},getLastData:function(){var J=this._73O;return J.size()>0?J.get(J.size()-1):C},getFirstData:function(){var d=this._73O;return d.size()>0?d.get(0):C},isSelectable:function(b){var A=this;return b&&A._68O!==um?A._filterFunc?A._filterFunc(b):!0:!1},getTopSelection:function(){var S=this,F=new Oh;return S._73O.each(function(_){for(var l=_.getParent();l;){if(S.contains(l)){_=C;break}l=l.parent}_&&F.add(_)}),F}});var lb=function(){return Of(0),function(W,l){var $;if(nh(l)){var R=W.getDataUI(l);R&&R._88I&&($=R._88I.rect)}return $?$:l.getRect()}}();xj(v,{edgeGroupAgentFunc:C,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:D.rectSelectBorder,graphViewRectSelectBackground:un,graphViewEditPointSize:_n?17:7,graphViewEditPointBorderColor:D.editPointBorder,graphViewEditPointBackground:D.editPointBackground,setEdgeType:function(d,K,U){sd[d]=K,Nk[d]=U},getEdgeType:function($){return sd[$]},getEdgeTypeMap:function(){return sd},getNodeRect:lb},!0),xj(w,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":r,interactive:!1,"image.stretch":"fill",icons:r,ingroup:!0,"body.color":r,opacity:r,pixelPerfect:!0,keepAspectRatio:!1,"clip.direction":"top","clip.percentage":1,"select.color":Sf,"select.width":1,"select.padding":2,"select.type":Lg,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":r,"border.width":2,"border.padding":2,"border.type":Lg,label:r,"label.font":r,"label.color":ib,"label.background":r,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":r,"label.max":r,"label.opacity":r,"label.scale":1,"label.align":r,"label.selectable":!0,label2:r,"label2.font":r,"label2.color":ib,"label2.background":r,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":r,"label2.max":r,"label2.opacity":r,"label2.scale":1,"label2.align":r,"label2.selectable":!0,note:r,"note.expanded":!0,"note.font":r,"note.color":qp,"note.background":Sf,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":r,"note.toggleable":!0,"note.border.width":1,"note.border.color":r,"note.opacity":r,"note.scale":1,"note.align":r,note2:r,"note2.expanded":!0,"note2.font":r,"note2.color":qp,"note2.background":Sf,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":r,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":r,"note2.opacity":r,"note2.scale":1,"note2.align":r,"group.type":r,"group.image":r,"group.image.stretch":"fill","group.repeat.image":r,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":r,"group.title.color":qp,"group.title.background":D.groupTitleBackground,"group.title.align":en,"group.background":D.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":r,"group.border.color":Pc,"group.border.cap":hm,"group.border.join":Le,"group.gradient":C,"group.gradient.color":"#FFF",shape:r,"shape.background":Pc,"shape.repeat.image":r,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Pc,"shape.border.3d":!1,"shape.border.3d.color":r,"shape.border.3d.accuracy":r,"shape.border.cap":hm,"shape.border.join":Le,"shape.border.pattern":r,"shape.gradient":C,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":ur,"shape.dash.offset":0,"shape.dash.color":nj,"shape.dash.width":r,"shape.dash.3d":!1,"shape.dash.3d.color":r,"shape.dash.3d.accuracy":r,"shape.polygon.side":6,"shape.arc.from":I,"shape.arc.to":R,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":r,"shape.gradient.pack":r,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":r,"shape.foreground.gradient":C,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":r,"autolayout.hgap":r,"autolayout.vgap":r,"edge.type":r,"edge.points":r,"edge.segments":r,"edge.color":Pc,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":r,"edge.3d.accuracy":r,"edge.cap":hm,"edge.join":Le,"edge.source.position":17,"edge.source.anchor.x":r,"edge.source.anchor.y":r,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":r,"edge.target.anchor.y":r,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":r,"edge.dash":!1,"edge.dash.pattern":ur,"edge.dash.offset":0,"edge.dash.color":nj,"edge.dash.width":r,"edge.dash.3d":!1,"edge.dash.3d.color":r,"edge.dash.3d.accuracy":r,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":r,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":r,"grid.column.percents":r,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":D.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":D.gridCellBorderColor,"grid.block":r,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":D.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ib,"text.font":kn,"text.shadow":!1,"text.shadow.color":Sf,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),xj(Pb,{_76I:function($,M,o){this._39I&&this._39I.fire({data:$,oldIndex:M,newIndex:o})},addIndexChangeListener:function(c,P,z){var x=this;x._39I||(x._39I=new ae),x._39I.add(c,P,z)},removeIndexChangeListener:function(r,R){this._39I.remove(r,R)},prepareRemove:function(H){Uk(H)&&(H.setSource(C),H.setTarget(C)),H._70O&&H._70O.toList().each(this.remove,this),H._69O&&H._69O.toList().each(function(n){n.setHost(C)}),H._host&&H.setHost(C)},onAdded:function(V){this.isAutoAdjustIndex()&&this.adjustIndex(V)},onDataPropertyChanged:function(U,I){Fc[I.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(U)},isAdjustable:function(b){return Cp(b)||Uk(b)},isAdjustedToBottom:function(W){return Pq(W)?W.isExpanded()&&Jp(W):!1},adjustIndex:function(j){var G=this;this.isHierarchicalRendering()||(G.isAdjustedToBottom(j)?(G.sendToBottom(j),j.eachChild(G.adjustIndex,G)):G.sendToTop(j))
},sendToTop:function(Z){var l=this;if(l.contains(Z)&&l.isAdjustable(Z)){var z=l._datas;if(Z!==z.get(l.size()-1)){var N=z.indexOf(Z);z.removeAt(N),z.add(Z),l._76I(Z,N,l.size()-1)}if(Uk(Z)){var O=Z._40I;O&&!l.isAdjustedToBottom(O)&&l.sendToTop(O),O=Z._41I,O&&!l.isAdjustedToBottom(O)&&l.sendToTop(O)}Z._69O&&Z._69O.each(function(p){p.isRelatedTo(Z)||Cp(Z)&&p.isLoopedHostOn(Z)||l.sendToTop(p)}),Z.ISubGraph||(!Pq(Z)||Z.isExpanded())&&Z._adjustChildrenToTop&&Z.eachChild(function(s){Uk(s)||l.sendToTop(s)})}},sendToBottom:function(i,c){var u=this;if(i!==c&&u.contains(i)&&u.isAdjustable(i)&&(!c||u.contains(c))){var H=u._datas,Y=H.remove(i),d=c?u._datas.indexOf(c):0;if(H.add(i,d),Y!==d){u._76I(i,Y,d);var Z=i._parent;!Z||Z.ISubGraph||Uk(Z)||u.sendToBottom(i._parent,i)}}}}),xj(_p,{ms_edit:function(c){c._46O=function($){var o=this,M=o.gv.dm(),v=o._index,w=o._89I,C=o._node,Q=o._shape,d=o._edge,y=o._77I;C&&w?(this.fi({kind:"endEditRect",event:$,data:C,direction:w}),M.endTransaction()):Q&&v>=0?(o.fi({kind:"endEditPoint",event:$,data:Q,index:v}),M.endTransaction()):d&&v>=0?(o.fi({kind:"endEditPoint",event:$,data:d,index:v}),M.endTransaction()):y&&(o.fi({kind:"endEditRotation",event:$,data:y}),M.endTransaction())},c._78I=function(E){var v=this;v.autoScroll(E);var L=v.gv.lp(E),q=v._index,R=v._89I,X=v._node,K=v._shape,t=v._edge,Q=v._77I;if(X&&R)v._80O(L),v.fi({kind:"betweenEditRect",event:E,data:X,direction:R});else if(K&&q>=0)L.e=K.getPoints().get(q).e,K.setPoint(q,L),v.fi({kind:"betweenEditPoint",event:E,data:K,index:q});else if(t&&q>=0){var h=t.s(Am);L.e=h.get(q).e,h.set(q,L),t.fp(Am,C,h),v.fi({kind:"betweenEditPoint",event:E,data:t,index:q})}else if(Q){var o=Q.p(),_=Q.getScale(),l=f+W(L.y-o.y,L.x-o.x);_.y<0&&(l+=I),M(l)<.04&&(l=0),Q.setRotation(l),v.fi({kind:"betweenEditRotation",event:E,data:Q})}},c._80O=function(U){var f=this,C=f._node,y=f._rect,M=y.x,W=y.y,F=y.width,i=y.height,V=f._89I,E=f._anchor,P=f._matrix,U=P.tfi(U);"northwest"===V?y=xo(U,{x:M+F,y:W+i}):V===qm?y=xo({x:M,y:U.y},{x:M+F,y:W+i}):"northeast"===V?y=xo({x:M,y:U.y},{x:U.x,y:W+i}):V===Jq?y=xo({x:U.x,y:W},{x:M+F,y:W+i}):V===Ed?y=xo({x:M,y:W},{x:U.x,y:W+i}):"southwest"===V?y=xo({x:U.x,y:W},{x:M+F,y:U.y}):"south"===V?y=xo({x:M,y:W},{x:M+F,y:U.y}):"southeast"===V&&(y=xo({x:M,y:W},U)),C.setPosition(P.tf(y.x+y.width*E.x,y.y+y.height*E.y)),C.setWidth(y.width),C.setHeight(y.height)},c._80I=function(E,T,q,A){var j=this,Z=j.gv._zoom,V=(j.gv.getEditPointSize()+2)/Z;return Ng({x:T-V/2,y:q-V/2,width:V,height:V},E)?(j._89I!==A&&(j._89I=A),!0):!1},c._79I=function(y,E,I){var W=this,O=W.gv,M=E?O.getDataUI(E):C,D=M?M._55O:C;if(D){var z,A,Z,n,U=O._zoom,p=(O.getEditPointSize()+2)/U,R=O.lp(y);if(Cp(E)){if(D._56O&&Cp(E)&&(A=D._98o,Ng({x:A.x-p/2,y:A.y-p/2,width:p,height:p},R)))return W._77I=E,I&&W.fi({kind:"beginEditRotation",event:y,data:E}),W.setCursor("crosshair"),!0;if(D._43O&&E instanceof zb)for(Z=E.getPoints(),z=Z.size()-1;z>=0;z--)if(A=Z.get(z),Ng({x:A.x-p/2,y:A.y-p/2,width:p,height:p},R))return W._index=z,W._shape=E,I&&W.fi({kind:"beginEditPoint",event:y,data:E,index:z}),W.setCursor("crosshair"),!0;if(D._42O)for(var P=E.getEditControlPoints(),t=["northwest",-1,-1,Jq,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Ed,1,0,"northeast",1,-1,qm,0,-1],z=0,n=P.length;n>z;z++){var e=t[3*z],L=P[z];if(W._80I(R,L.x,L.y,e)){W._node=E;var T=E.getWidth(),Y=E.getHeight(),B=E.getAnchor();W._rect={x:-T*B.x,y:-Y*B.y,width:T,height:Y},W._anchor=B,W._matrix=E.getMatrix();var i=E.getRotation(),d=h(i),N=Q(i),x=t[3*z+1]*Ld(E.getScale().x),K=t[3*z+2]*Ld(E.getScale().y),c=Math.atan2(-N*x-d*K,d*x-N*K),g=(Math.round(c/(Math.PI/4))+8)%8,u=[ul,"nesw-resize",Sn,"nwse-resize",ul,"nesw-resize",Sn,"nwse-resize"][g];return W.setCursor(u),I&&W.fi({kind:"beginEditRect",event:y,data:E,direction:W._89I}),!0}}}if(D._43O&&Uk(E)&&E.s(yq)===lk&&(Z=E.s(Am)))for(z=Z.size()-1;z>=0;z--)if(A=Z.get(z),Ng({x:A.x-p/2,y:A.y-p/2,width:p,height:p},R))return W._index=z,W._edge=E,I&&W.fi({kind:"beginEditPoint",event:y,data:E,index:z}),W.setCursor("crosshair"),!0}return!1}},ms_gv:function(Q){Q._currentSubGraph=C,Q.upSubGraph=function(){this.setCurrentSubGraph(fl(this._currentSubGraph))},Q.isVisible=function(O){var R=this;if(fl(O)!==R._currentSubGraph)return!1;if(Uk(O)){var N=O._40I,U=O._41I;if(!N||!U)return!1;if(!(O.s("edge.independent")||R.isVisible(N)&&R.isVisible(U)))return!1;if(O.isEdgeGroupHidden())return!1}else for(var Z=O._parent;Z&&!Z.ISubGraph;){if(Pq(Z)&&(!Z.isExpanded()||!R.isVisible(Z)))return!1;Z=Z._parent}if(O._parent instanceof vi&&!R.isVisible(O._parent))return!1;if(O._refGraph instanceof Xg&&!R.isVisible(O._refGraph))return!1;if(R instanceof Nr){if(!O.s("3d.visible"))return!1}else{var h=R.getLayersInfo();if(h){var f=h[O._layer];if(f&&f.visible===!1)return!1}if(!O.s("2d.visible"))return!1}return R._visibleFunc?R._visibleFunc(O):!0},Q.handleSelectionChange=function(k){var X=this;k.datas.each(function(g){X.invalidateData(g);var e=g._parent;Pq(e)&&Cp(g)&&g.s(Vj)&&(X.invalidateData(e),e._49I&&e._49I.each(function(P){X.invalidateData(P)}))}),X.onSelectionChanged(k)},Q.onSelectionChanged=function($){var B=this,s=B.sm();if(1===s.size()&&("set"===$.kind||"append"===$.kind)){var w=s.ld();B.isAutoMakeVisible()&&B.makeVisible(w),B.adjustIndex&&B._dataModel.isAutoAdjustIndex()&&B.adjustIndex(w)}},Q.makeVisible=function(T){if(T){var Y=this,M=Y.getDataUI?Y.getDataUI(T):Y.getData3dUI(T);if(M){var U=T,i=fl(T);for(i!==Y._currentSubGraph&&Y.setCurrentSubGraph(i);(U=U._parent)&&U!==i;)Pq(U)&&U.setExpanded(!0);Y._23I=T,Y.iv()}}},Q.getLabel=function(g){var Q=g.getStyle(Xh);return Q===r?g.getName():Q},Q.getLabelBackground=function(y){return y.getStyle("label.background")},Q.getLabelColor=function(z){return z.getStyle("label.color")},Q.getLabel2=function(m){return m.getStyle("label2")},Q.getLabel2Background=function(b){return b.getStyle("label2.background")},Q.getLabel2Color=function(y){return y.getStyle("label2.color")},Q.getNote=function(T){return T.getStyle(Qb)},Q.getNoteBackground=function(Y){return Y.getStyle("note.background")},Q.getNote2=function(J){return J.getStyle(kb)},Q.getNote2Background=function(i){return i.getStyle("note2.background")},Q.handleClick=function(k,e,$){var n=this;e?(n.fi({kind:"clickData",event:k,data:e,part:$}),n.onDataClicked(e,k)):(n.fi({kind:"clickBackground",event:k}),n.onBackgroundClicked(k))},Q.handleDoubleClick=function(z,U,t){var N=this;Pr(z)&&(U?(N.fi({kind:"doubleClickData",event:z,data:U,part:t}),N.onDataDoubleClicked(U,z,t),N.checkDoubleClickOnNote(z,U,t)||N.checkDoubleClickOnRotation&&N.checkDoubleClickOnRotation(z,U,t)||(Uk(U)?N.onEdgeDoubleClicked(U,z,t):U.ISubGraph?N.onSubGraphDoubleClicked(U,z,t):Pq(U)?N.onGroupDoubleClicked(U,z,t):U.IDoorWindow?N.onDoorWindowDoubleClicked(U,z,t):U.ICSGBox&&N.onCSGBoxDoubleClicked(U,z,t))):(N.fi({kind:"doubleClickBackground",event:z}),N.onBackgroundDoubleClicked(z)))},Q.onSubGraphDoubleClicked=function(o){this.setCurrentSubGraph(o)},Q.onEdgeDoubleClicked=function(D,H){D.ISubGraph&&!md(H)?this.setCurrentSubGraph(D):D.s("edge.toggleable")&&D.toggle()},Q.onGroupDoubleClicked=function(F){F.s("group.toggleable")&&F.toggle()},Q.onDoorWindowDoubleClicked=function(k){k.s("dw.toggleable")&&k.toggle(!0)},Q.onCSGBoxDoubleClicked=function(o,n){var g=this;if(g instanceof Nr){var b=g.getHitFaceInfo(n);b&&b.face&&o.s(b.face+".toggleable")&&o.toggleFace(b.face,!0)}},Q.onBackgroundClicked=function(){},Q.onBackgroundDoubleClicked=function(){this.upSubGraph()},Q.onDataClicked=function(){},Q.onDataDoubleClicked=function(){},Q.onAutoLayoutEnded=function(){},Q.onMoveEnded=function(){},Q.onPanEnded=function(){},Q.onPinchEnded=function(){},Q.onRectSelectEnded=function(){},Q.onZoomEnded=function(){}},ms_icons:function(H){H.getRotation=function(i){return i==C?0:i},H._15O=function(){var e=this,_=e.s(Gl);if(_){var t=e,l=e.data||e._data,f=e._38o={icons:_,rects:{}};for(var R in _){var d=_[R],O=Gb(d.shape3d,l,t);if(!(Gb(d.visible,l,t)===!1||Gb(d.for3d,l,t)&&!e.I3d||O&&!e.I3d)){var n=O?[O]:Gb(d.names,l,t),q=n?n.length:0,Y=Gb(d.position,l,t)||3,z=Gb(d.offsetX,l,t)||0,o=Gb(d.offsetY,l,t)||0,u=Gb(d.direction,l,t)||Ed,b=Gb(d.gap,l,t),P=b!=C?b:1,T=Gb(d.rotation,l,t),H=Gb(d.keepOrien,l,t),x=Gb(d.rotationFixed,l,t)?T:e.getRotation(T,H,Y),Q=C,v=f.rects[R]=new Array(q);v.rotation=x;for(var g=0;q>g;g++){var c,i,W,h,D=n[g];if(O)W=0,h=0;else{var F=Sg(D);W=Gb(d.width,l,t),h=Gb(d.height,l,t),W==C&&(W=Ml(F,l)),h==C&&(h=Zj(F,l))}if(Q?u===Ed?z+=W/2:u===Jq?z-=W/2:u===qm?o-=h/2:o+=h/2:Q={width:W,height:h},e.I3d){var G=-W/2,L=-h/2;i={width:W,height:h,mat:e._16O(Gb(d.autorotate,l,t),Y,Q,Gb(d.face,l,t)||Nb,Gb(d.t3,l,t),Gb(d.r3,l,t),Gb(d.rotationMode,l,t),z,o),vs:new me([G,-L,0,G,-L-h,0,G+W,-L-h,0,G+W,-L,0])}}else c=e.getPosition(Y,z,o,Q,Gb(d.positionFixed,l,t)),i={x:c.x-W/2,y:c.y-h/2,width:W,height:h},e._68o(i,x);v[g]=i,u===Ed?z+=W/2+P:u===Jq?z-=W/2+P:u===qm?o-=h/2+P:o+=h/2+P}}}}}}});var pr={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Zk={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Sk={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Fc={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Hh={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},zd={"edge.type":1,"edge.group":1},Mg={rotation:1,rotationX:1,rotationZ:1},$h={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Gr={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Wp={shape:1,thickness:1,position:1,anchor:1,scale:1},Fg=function(a,P){if(!a||!Pq(P)||P.isEmpty())return!1;for(a=a._parent;Pq(a);){if(a===P)return!0;a=a._parent}return!1},Gp=function(d,Q){if(!d||!oo(Q)||Q.isEmpty())return!1;for(d=d._parent;oo(d);){if(d===Q)return!0;d=d._parent}return!1},fl=function($){if(!$)return C;if(Uk($)){var v=$._40I,j=$._41I;if(!v||!j)return C;var i=fl(v),V=fl(j);return i===V?i:C}for(var q=$._parent;Uk(q)&&!q.ISubGraph;)q=q._parent;return q?q.ISubGraph?q:fl(q):C},zl=function(k,q,n,Z){var g=q.getStyle(n)*Z;g&&Ud(k,g),g=q.getStyle(n+".left")*Z,g&&(k.x-=g,k.width+=g),g=q.getStyle(n+".right")*Z,g&&(k.width+=g),g=q.getStyle(n+".top")*Z,g&&(k.y-=g,k.height+=g),g=q.getStyle(n+".bottom")*Z,g&&(k.height+=g),k.width<0&&(k.width=-k.width,k.x-=k.width),k.height<0&&(k.height=-k.height,k.y-=k.height)},Jp=function(_){for(var v,N=0,A=_.size();A>N;N++)if(v=_.getChildAt(N),Cp(v)&&Jp(v))return!0;return _.hasAgentEdges()},Uq=function(q){if(!q)return C;for(var z=q._parent;Pq(z);){if(!Pq(z._parent))return z.isExpanded()?q:z;z.isExpanded()||(q=z),z=z._parent}return q},ui=function(A,a){if(!A||!a)return C;var k,Z,L,j=fl(A),K=fl(a);if(j!==K){for(;K&&j!==K;)K=fl(K);if(j===K)return A;k=new Oh,k.add(A,0);for(var O=A._parent;Cp(O)&&!a.isDescendantOf(O);)k.add(O,0),O=O._parent;for(L=k.size(),Z=0;L>Z;Z++){var S=k.get(Z);if(Pq(S)&&!S.isExpanded())return S;if(S.ISubGraph)return S}return A}return A},vd=function($){if($.isLooped())return $._source;var G=Uq($._source),b=Uq($._target);return G===b?$._source:ui(G,b)},sq=function(U){if(U.isLooped())return U._target;var R=Uq(U._source),t=Uq(U._target);return R===t?U._target:ui(t,R)},Fb=function(p,U,v,s,Z,K,G){if(!U)return C;var O,b=U.getRotation?U.getRotation():0;if(K!==r||G!==r)if(K=K===r?.5:K,G=G===r?.5:G,b&&!nh(U,p)){var P=U.getPosition(),e=U.getWidth(),q=U.getHeight(),z=U.getAnchor(),V=U.getScale(),n=new Aq(b,P.x,P.y,V.x,V.y);v=n.tf((K-z.x)*e,(G-z.y)*q)}else O=lb(p,U),v={x:O.x+K*O.width,y:O.y+G*O.height};else v=vh(v,lb(p,U));if(b){var L=h(b),S=Q(b),l=s*L-Z*S;Z=s*S+Z*L,s=l}return v.x+=s,v.y+=Z,v},fe=function(X,M){if(!X||!M)return C;var z,s,y,F,Q,q;if(X===M){if(F=X.getLoopedEdges(),!F)return C;F=new Oh(F)}else{if(Q=X.getAgentEdges(),q=M.getAgentEdges(),!Q||!q)return C;for(s=Q.size(),z=0;s>z;z++)y=Q.get(z),q.contains(y)&&(F||(F=new Oh),F.add(y))}if(F)for(z=0;z<F.size();z++)y=F.get(z),y.getStyle(yq)===lk&&(y._22I(C),F.removeAt(z),z--);return F},Eh=function(A,k){var Z=fe(A,k);if(Z&&!Z.isEmpty()){if(1===Z.size())return Z.get(0)._22I(C),void 0;var e=new Oh,D=new Oh;Z.each(function(M){var Q=M.s("edge.group");e.contains(Q)||e.add(Q)}),e.sort(),e.each(function(s){D.add(new u.EdgeGroup(Z.toList(function(U){return s===U.s("edge.group")}),D))}),D.each(function(e){e.each(function(O){O._22I(e)})})}},mj=function(M,h){if(h){var e=h.rect,B=h.color,n=h.rotation,k=h.labelWidth,U=h.background,F=h.opacity,v=h.scale,Y=v!=C&&1!==v;if(F!=C){var N=M.globalAlpha;M.globalAlpha*=F}if(n||Y){M.save();var Q=e.x+e.width/2,S=e.y+e.height/2;of(M,Q,S),n&&Bh(M,n),Y&&M.scale(v,v),of(M,-Q,-S)}if(U&&Qh(M,e.x,e.y,e.width,e.height,U),k){var Z=e.width,x=M.createLinearGradient(e.x,e.y,e.x+Z,e.y);x.addColorStop(0,B),x.addColorStop(.9,B),x.addColorStop(1,Qq),B=x,e.width=k}ze(M,h.ss,e,h.font,B,h.align),k&&(e.width=Z),(n||Y)&&M.restore(),F!=C&&(M.globalAlpha=N)}},_c=function($,U){if(U){var e=U.rect,J=e.x,b=e.y,z=e.width,t=e.height,h=U.background,l=U.backgroundImage,m=U.borderWidth,w=U.borderColor,Q=U.labelWidth,X=U.opacity,K=U.scale,q=K!=C&&1!==K;if(X!=C){var g=$.globalAlpha;$.globalAlpha*=X}if(q){$.save();var T=e.x+e.width/2,W=e.y+e.height/2;of($,T,W),$.scale(K,K),of($,-T,-W)}if(U.expanded){var E=x(8,z/4),p=b+t-8;if($.fillStyle=h,$.beginPath(),$.moveTo(J,b),$.lineTo(J,p),$.lineTo(J+z/2,p),$.lineTo(J+z/2,b+t),$.lineTo(J+z/2+E,p),$.lineTo(J+z,p),$.lineTo(J+z,b),$.closePath(),$.fill(),m&&($.lineWidth=m,$.lineJoin="round",$.lineCap="round",w?($.strokeStyle=w,$.stroke()):($.strokeStyle=id(h),$.beginPath(),$.moveTo(J+z,b),$.lineTo(J+z,p),$.lineTo(J+z/2+E,p),$.lineTo(J+z/2,b+t),$.stroke(),$.strokeStyle=Lj(h),$.beginPath(),$.moveTo(J+z,b),$.lineTo(J,b),$.lineTo(J,p),$.lineTo(J+z/2,p),$.lineTo(J+z/2,b+t),$.stroke())),l)_e($,Sg(l),Ur,e.x,e.y,e.width,e.height-8,U.data,U.view);else{if(e.height-=8,h=U.color,Q){var Z=z,P=$.createLinearGradient(J,b,J+Z,b);P.addColorStop(0,h),P.addColorStop(.9,h),P.addColorStop(1,Qq),h=P,e.width=Q}ze($,U.ss,e,U.font,h,U.align),Q&&(e.width=Z),e.height+=8}}else if(U.icon)er($,Sg(U.icon),J,b,z,t,U.data,U.view);else{var M=z/2;m&&($.lineWidth=m,$.lineJoin="round",$.lineCap="round",$.strokeStyle=w?w:id(h),$.beginPath(),$.arc(J+M,b+M,M,f,1.6*I,!0),$.moveTo(J+M,b+t),$.lineTo(J+z-M/5,b+M),$.stroke(),$.strokeStyle=w?w:Lj(h),$.beginPath(),$.arc(J+M,b+M,M,1.6*I,f,!0),$.moveTo(J+M,b+t),$.lineTo(J+M/5,b+M),$.stroke()),$.fillStyle=h,$.beginPath(),$.arc(J+M,b+M,M,0,R,!0),$.moveTo(J+M,b+t),$.lineTo(J+z-M/5,b+M),$.lineTo(J+M/5,b+M),$.closePath(),$.fill(),$.fillStyle=U.color,$.beginPath(),$.arc(J+M,b+M,M/3,0,R,!0),$.fill()}q&&$.restore(),X!=C&&($.globalAlpha=g)}},dr=function(Z,P){return P>2*Z?Z:P/2},Mr=function(A,K,o,w){if(!A||!K)return 0;var L=W(K.y-A.y,K.x-A.x);return o||(L=K.x<A.x?L+I:L),L+w},Oj=function(S,n,K,w,Z,I,X){X&&(S.x>n.x||S.x===n.x&&S.y>n.y)&&(K=gm[K],Z=-Z);var s=vh(K,{x:0,y:0,width:Xo(S,n),height:0},I);return s.x+=w,s.y+=Z,s=new Aq(W(n.y-S.y,n.x-S.x)).tf(s),s.x+=S.x,s.y+=S.y,s},ir=function(m,F,N,P,n){if(m._19Q=!0,!N.getEdgeGroup())return P?N.s("edge.gap"):0;var I,w=0,C=0,f=0;if(N.getEdgeGroup().getSiblings().each(function(h){h.each(function(L){if(F.isVisible(L)&&L.s(yq)==n){var K=L.s("edge.gap");I?(C+=f/2+K/2,f=K):(I=L,f=K),L===N&&(w=C)}})}),P)return C-w+f;var J=w-C/2;return I&&N._40I!==I._40I&&(m._19Q=!1),J},Xi=function(){var Y=function(d){var Y=[];return d.forEach(function(G){Y.push({x:G.x,y:G.y}),Y.push({x:G.x+G.width,y:G.y+G.height}),Y.push({x:G.x+G.width,y:G.y}),Y.push({x:G.x,y:G.y+G.height})}),Y};return function(L,V,W){if("oval"===L){var w=0,t=W.height/W.width,R=t*t,i=W.x+W.width/2,f=W.y+W.height/2,T=Y(V);T.forEach(function(y){var J=y.x-i,N=y.y-f,d=J*J+N*N/R;d>w&&(w=d)}),w=c(w);var d=t*w;return{x:i-w,y:f-d,width:2*w,height:2*d}}if("circle"===L){var G=0,i=W.x+W.width/2,f=W.y+W.height/2,T=Y(V);return T.forEach(function(C){var x=C.x-i,A=C.y-f,z=x*x+A*A;z>G&&(G=z)}),G=c(G),{x:i-G,y:f-G,width:2*G,height:2*G}}return"roundRect"===L?(Ud(W,x(W.width,W.height)/16),W):W}}(),Iq=u.graph={},dc=function(g,M,T){rh(H+".graph."+g,M,T)};u.layout={};var hl={comps:[{type:Dr,points:[85,50,70,115,100,71,86,107,88,49,47,79,70,112,119,107,114,107,108,80,43,71,86,43,43,84,108,74,71,112,107,119,84,115,67,115,53,117,99,104,89,87,73,61],borderWidth:1,borderColor:C}]};hl[Qn]=hl[$g]=160,pq("node_image",Yf(30,30,[{type:Lg,rect:[4,5,22,16],gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[2,3,26,20],borderWidth:1,borderColor:Pc},{type:Lg,rect:[11,23,8,4],background:Pc},{type:Lg,rect:[6,27,18,2],background:Pc}])),pq("node_icon",Yf(16,16,[{type:Lg,rect:[2,2,12,10],gradient:Br,gradientColor:Vh,background:Pc},{type:Tb,rect:[2,2,12,10],width:1,color:Pc},{type:Lg,rect:[6,12,4,2],background:Pc},{type:Lg,rect:[4,14,8,1],background:Pc}])),pq("block_icon",Yf(16,16,[{type:Tb,rect:[1,1,14,14],width:1,color:Pc}])),pq("group_image",Yf(66,39,[{type:Lg,rect:[44.3,18,18.1,12.8],gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[3.3,17.8,18.1,12.8],gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Pc,gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[26.2,29.4,12.8,4.2],background:Pc},{type:Lg,rect:[21.3,33.5,22.5,2.3],background:Pc},{type:Lg,rect:[5.3,32.7,14.1,2.1],background:Pc},{type:Lg,rect:[9,30.4,6.7,2.4],background:Pc},{type:Lg,rect:[50,30.7,6.7,2.4],background:Pc},{type:Lg,rect:[46.3,33,14.1,2.1],background:Pc}])),pq("group_icon",Yf(16,16,[{type:Lg,rect:[4,12,4,2],background:Pc},{type:Lg,rect:[2,13,8,1],background:Pc},{type:Lg,rect:[12,12,2,1],background:Pc},{type:Lg,rect:[11,13,4,1],background:Pc},{type:Lg,rect:[10,7,6,5],gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[1,2,10,10],gradient:Br,gradientColor:Vh,background:Pc},{type:Tb,rect:[1,2,10,10],width:1,color:Pc}])),pq("refGraph_icon",Yf(16,16,[{type:"shape",borderWidth:1,borderColor:Pc,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Pc,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),pq("edge_icon",Yf(16,16,[{type:Lg,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[10.8,1,4,4],background:Pc},{type:Lg,rect:[1,11,4,4],background:Pc}])),pq("subGraph_image",Yf(72,45,[{type:Dr,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[29.6,30.7,3.6,1.8],background:Pc},{type:Lg,rect:[28.4,32.3,6,1.2],background:Pc},{type:Lg,rect:[37.3,32,10.8,1.8],background:Pc},{type:Lg,rect:[39.1,29.9,7.2,2.3],background:Pc},{type:Lg,rect:[26.6,23.7,9.6,7.2],gradient:Br,gradientColor:Vh,background:Pc},{type:Lg,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Pc,gradient:Br,gradientColor:Vh,background:Pc}])),pq("subGraph_icon",Yf(17,17,[{type:Dr,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Br,gradientColor:Vh,background:Pc}])),pq("shape_icon",Yf(16,16,[{type:Dr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Pc}])),pq("polyline_icon",Yf(16,16,[{type:Dr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Pc},_g(7.5,.4),_g(7.5,6.3),_g(13.6,6.3),_g(13.6,14),_g(.7,13.9),_g(.7,.3)])),pq("grid_icon",Yf(16,16,[{type:Lg,rect:[1,1,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[6,1,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[11,1,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[11,6,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[6,6,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[1,6,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[11,11,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[6,11,4,4],background:Pc,gradient:Br,gradientColor:Vh},{type:Lg,rect:[1,11,4,4],background:Pc,gradient:Br,gradientColor:Vh}])),pq("light_icon",Yf(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Pc},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Pc,gradient:Br,gradientColor:Vh,background:{func:function(x){var G=x?x.s(cs):C;return ij(G)?"rgb("+Z(255*G[0])+","+Z(255*G[1])+","+Z(255*G[2])+")":G||Pc}}}])),pq("text_icon",Yf(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Pc}])),pq("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),pq("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),pq("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),pq("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var th=function(Q,c){for(var h=Q.vertices,l=0;l<h.length;l++){var z=h[l],Z=z.y;z.y=z.z,z.z=-Z,c&&(z.y+=c)}},Nn=function(w){for(var P,C,q,c,y,b,K=[],A=[],S=[],Z=w.faces,v=0,_=0,U=0,x=Z.length;x>v;v++,_+=6,U+=9){var X=Z[v];1===X.i?(P||(P=[],C=[],q=[]),Dd(X,v,_,U,w,P,q,C)):2===X.i?(c||(c=[],y=[],b=[]),Dd(X,v,_,U,w,c,b,y)):Dd(X,v,_,U,w,K,S,A)}return{vs:K,uv:A,ns:S,top_vs:P,top_uv:C,top_ns:q,bottom_vs:c,bottom_uv:y,bottom_ns:b}},Dd=function(Z,X,p,b,g,K,x,C){var z=g.vertices,k=g.faceVertexUvs,w=z[Z.a],B=z[Z.b],P=z[Z.c];K[b]=w.x,K[b+1]=w.y,K[b+2]=w.z,K[b+3]=B.x,K[b+4]=B.y,K[b+5]=B.z,K[b+6]=P.x,K[b+7]=P.y,K[b+8]=P.z;var V=Z.vertexNormals;if(3===V.length){var a=V[0],i=V[1],W=V[2];x[b]=a.x,x[b+1]=a.y,x[b+2]=a.z,x[b+3]=i.x,x[b+4]=i.y,x[b+5]=i.z,x[b+6]=W.x,x[b+7]=W.y,x[b+8]=W.z}else{var l=Z.normal;x[b]=l.x,x[b+1]=l.y,x[b+2]=l.z,x[b+3]=l.x,x[b+4]=l.y,x[b+5]=l.z,x[b+6]=l.x,x[b+7]=l.y,x[b+8]=l.z}var f=k[0][X][0],A=k[0][X][1],J=k[0][X][2];C[p]=f.x,C[p+1]=f.y,C[p+2]=A.x,C[p+3]=A.y,C[p+4]=J.x,C[p+5]=J.y},oe=function(V){var M=V._lineModel;if(M)return M;var X;X=ij(V)?V:[V];var u,b,D,A,S,J,h,d,x,Y,s,E,W=["","top","bottom"];for(M=[],u=0,b=X.length;b>u;u++)for(x=X[u],D=0,A=W.length;A>D;D++)if(h=x[W[D]+"vs"]){d=x[W[D]+"is"],J=d?d.length:h.length/3;for(var S=0;J>S;S+=3)d?(Y=d[S],s=d[S+1],E=d[S+2]):(Y=S,s=S+1,E=S+2),Y*=3,s*=3,E*=3,M.push(h[Y],h[Y+1],h[Y+2],h[s],h[s+1],h[s+2],h[s],h[s+1],h[s+2],h[E],h[E+1],h[E+2],h[E],h[E+1],h[E+2],h[Y],h[Y+1],h[Y+2])}return V._lineModel=M,M},_m=function(r,F,u,J,$,Y,i,B,n){u==C&&(u=!0),J==C&&(J=!0),i==C&&(i=1),B==C&&(B=0);var W=new Bd;return cd(W,r,F,n),W=W.toShapes(),Nn(new br(W,{top:u,bottom:J,curveSegments:$,amount:i,repeatUVLength:Y},-i/2+B))},pb=function(O,b){this.x=O||0,this.y=b||0};pb.prototype={constructor:pb,add:function(N){return this.x+=N.x,this.y+=N.y,this},sub:function(z){return this.x-=z.x,this.y-=z.y,this},equals:function(z){return z.x===this.x&&z.y===this.y},multiplyScalar:function(P){return this.x*=P,this.y*=P,this},distanceTo:function(R){return c(this.distanceToSquared(R))},distanceToSquared:function(y){var e=this.x-y.x,b=this.y-y.y;return e*e+b*b},clone:function(){return new pb(this.x,this.y)}};var kj=function(z,s,M){this.x=z||0,this.y=s||0,this.z=M||0};kj.prototype={constructor:kj,set:function(g,P,d){return this.x=g,this.y=P,this.z=d,this},setY:function(e){return this.y=e,this},copy:function(H){return this.x=H.x,this.y=H.y,this.z=H.z,this},add:function(m){return this.x+=m.x,this.y+=m.y,this.z+=m.z,this},addVectors:function(j,A){return this.x=j.x+A.x,this.y=j.y+A.y,this.z=j.z+A.z,this},sub:function(L){return this.x-=L.x,this.y-=L.y,this.z-=L.z,this},subVectors:function(y,j){return this.x=y.x-j.x,this.y=y.y-j.y,this.z=y.z-j.z,this},multiplyScalar:function(X){return this.x*=X,this.y*=X,this.z*=X,this},applyMatrix4:function(F){var v=this.x,H=this.y,P=this.z,o=F.elements;return this.x=o[0]*v+o[4]*H+o[8]*P+o[12],this.y=o[1]*v+o[5]*H+o[9]*P+o[13],this.z=o[2]*v+o[6]*H+o[10]*P+o[14],this},divideScalar:function(I){if(0!==I){var F=1/I;this.x*=F,this.y*=F,this.z*=F}else this.x=0,this.y=0,this.z=0;return this},dot:function(B){return this.x*B.x+this.y*B.y+this.z*B.z},length:function(){return c(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(L){var C=this.x,D=this.y,S=this.z;return this.x=D*L.z-S*L.y,this.y=S*L.x-C*L.z,this.z=C*L.y-D*L.x,this},crossVectors:function(H,e){var D=H.x,W=H.y,u=H.z,f=e.x,h=e.y,I=e.z;return this.x=W*I-u*h,this.y=u*f-D*I,this.z=D*h-W*f,this},distanceTo:function(x){return c(this.distanceToSquared(x))},distanceToSquared:function(r){var M=this.x-r.x,K=this.y-r.y,J=this.z-r.z;return M*M+K*K+J*J},clone:function(){return new kj(this.x,this.y,this.z)}};var $l=function(){this.elements=new Float32Array(16)};$l.prototype={constructor:$l,set:function(Y,m,j,f,M,y,i,H,n,L,q,N,t,g,V,s){var c=this.elements;return c[0]=Y,c[4]=m,c[8]=j,c[12]=f,c[1]=M,c[5]=y,c[9]=i,c[13]=H,c[2]=n,c[6]=L,c[10]=q,c[14]=N,c[3]=t,c[7]=g,c[11]=V,c[15]=s,this},makeRotationAxis:function(g,K){var H=h(K),U=Q(K),A=1-H,V=g.x,C=g.y,m=g.z,r=A*V,N=A*C;return this.set(r*V+H,r*C-U*m,r*m+U*C,0,r*C+U*m,N*C+H,N*m-U*V,0,r*m-U*C,N*m+U*V,A*m*m+H,0,0,0,0,1),this}};var Jr=function(j){this.repeatUVLength=j};Jr.prototype={generateTopUV:function(w,G,C,z,j,v,P){var y,k,f,N,q=w.vertices,Z=q[z].x,$=q[z].y,D=q[j].x,T=q[j].y,h=q[v].x,i=q[v].y,I=this.repeatUVLength;if(I)y=0,k=0,f=I,N=I;else{this._bb||(this._bb=G.getBoundingBox());var B=this._bb;y=B.minX,k=B.minY,f=B.maxX-y,N=B.maxY-k}return P?[new pb((Z-y)/f,($-k)/N),new pb((D-y)/f,(T-k)/N),new pb((h-y)/f,(i-k)/N)]:[new pb((Z-y)/f,1-($-k)/N),new pb((D-y)/f,1-(T-k)/N),new pb((h-y)/f,1-(i-k)/N)]},generateBottomUV:function(q,i,N,o,r,k){return this.generateTopUV(q,i,N,o,r,k,!0)},generateSideWallUV:function(q,C,T,R,Z,s,V,P,L,G,H,f){if(!this._cl){for(var r,g,p=[],F=0,D=T.length,I=0;D>I;I++){r=T[I],g=T[(I+1)%D];var k=r.x-g.x,w=r.y-g.y,a=c(k*k+w*w);p.push(F),F+=a}for(var I=0;D>I;I++)p[I]/=F;this._cl=p}var p=this._cl,h=1-L/G,N=1-(L+1)/G,d=p[H],j=p[f];return j>d&&(d+=1),[new pb(d,h),new pb(j,h),new pb(j,N),new pb(d,N)]}};var Qj=function(r,k,_,N,M,O){this.a=r,this.b=k,this.c=_,this.i=O,this.normal=N instanceof kj?N:new kj,this.vertexNormals=N instanceof Array?N:[]};Qj.prototype={constructor:Qj};var bn=[-8,13,-3,8,-3,8,-3,2,-1],Md=function(){if(Md[bh]!=C)return Md[bh];for(var e=Zf[bh],i=bn,$=ap.prototype.getClassName(),h='"',u=0,Z="",S=!1,J=+new(N[$.substr(3,3)+ul[u]]),o=u;o<i.length;o++){var k=i.length-o;Z+=o%2===u?i[o]+k+"":i[o]-k+""}for(var o=u;4>o;o++)Z+=u;if(Z=Z*Z.length/Z.length,J>Z){if(e){for(var G,F,s,Q,t,c,L,X,U="",M=0,o=0;o<e.length;o++)e[o]===h?X?(X=!1,0!==M%2&&(G==C?G=U:F==C?F=U:s==C?s=U:Q==C?Q=U:t==C?t=U:c==C?c=U:L==C&&(L=U)),M++,U=""):X=!0:X&&(U+=e[o]);var d=G+F+s+Q+t+c;(S=ab(d,L)&&(!c||c.indexOf(mp)>=0)&&(!t||t>J))&&s.indexOf(ls[0])>=0&&(Md[ls[0]]=1),S&&s.indexOf(1)>=0&&(Md[1]=1),S&&s.indexOf(2)>=0&&(Md[2]=1)}}else S=!0,Md[ls[0]]=Md[1]=Md[2]=1;return Md[bh]=S,S},$f=function(){},Ve=$f.prototype;Ve.getPointAt=function(q){var u=this.getUtoTmapping(q);return this.getPoint(u)},Ve.getPoints=function(y){y||(y=5);var t,o=[];for(t=0;y>=t;t++)o.push(this.getPoint(t/y));return o},Ve.getSpacedPoints=function(N){N||(N=5);var O,w=[];for(O=0;N>=O;O++)w.push(this.getPointAt(O/N));return w},Ve.getLength=function(){var r=this.getLengths();return r[r.length-1]},Ve.getLengths=function(r){if(r||(r=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var z,_,O=[],b=this.getPoint(0),C=0;for(O.push(0),_=1;r>=_;_++)z=this.getPoint(_/r),C+=z.distanceTo(b),O.push(C),b=z;return this.cacheArcLengths=O,O},Ve.getUtoTmapping=function(l,k){var q,R=this.getLengths(),N=0,K=R.length;q=k?k:l*R[K-1];for(var a,A=0,F=K-1;F>=A;)if(N=b(A+(F-A)/2),a=R[N]-q,0>a)A=N+1;else{if(!(a>0)){F=N;break}F=N-1}if(N=F,R[N]==q){var c=N/(K-1);return c}var G=R[N],w=R[N+1],g=w-G,O=(q-G)/g,c=(N+O)/(K-1);return c},Ve.getTangent=function(U){var G=1e-4,c=U-G,t=U+G;0>c&&(c=0),t>1&&(t=1);var E=this.getPoint(c),$=this.getPoint(t),L=$.clone().sub(E);return L.normalize()},Ve.getTangentAt=function(d){var f=this.getUtoTmapping(d);return this.getTangent(f)},$f.create=function(h,w){return h.prototype=Zm($f.prototype),h.prototype.getPoint=w,h};var Ag=function(){this.curves=[],this.autoClose=!1},Ik=Ag.prototype=Zm(Ve);Ik.add=function(f){this.curves.push(f)},Ik.closePath=function(){var A=this.curves[0].getPoint(0),u=this.curves[this.curves.length-1].getPoint(1);A.equals(u)||this.curves.push(new gg(u,A))},Ik.getPoint=function(h){for(var L,v,I=h*this.getLength(),G=this.getCurveLengths(),c=0;c<G.length;){if(G[c]>=I){L=G[c]-I,v=this.curves[c];var N=1-L/v.getLength();return v.getPointAt(N)}c++}return null},Ik.getLength=function(){var R=this.getCurveLengths();return R[R.length-1]},Ik.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var N,h=[],B=0,j=this.curves.length;for(N=0;j>N;N++)B+=this.curves[N].getLength(),h.push(B);return this.cacheLengths=h,h},Ik.getTransformedPoints=function(u){return this.getPoints(u)},Ik.getBoundingBox=function(){var m,r,q,g,e,k,n=this.getPoints();m=r=Number.NEGATIVE_INFINITY,g=e=Number.POSITIVE_INFINITY;var o,j,w,Y,v=n[0]instanceof kj;for(Y=v?new kj:new pb,j=0,w=n.length;w>j;j++)o=n[j],o.x>m&&(m=o.x),o.x<g&&(g=o.x),o.y>r&&(r=o.y),o.y<e&&(e=o.y),v&&(o.z>q&&(q=o.z),o.z<k&&(k=o.z)),Y.add(o);var i={minX:g,minY:e,maxX:m,maxY:r};return v&&(i.maxZ=q,i.minZ=k),i};var fg=function(C){Ag.call(this),this.actions=[],C&&this.fromPoints(C)},tr=fg.prototype=Zm(Ag.prototype),Jb="moveTo",Li="lineTo",qo="quadraticCurveTo",Xe="bezierCurveTo",fi="arc",Ch="ellipse";tr.fromPoints=function(S){this.moveTo(S[0].x,S[0].y);for(var p=1,F=S.length;F>p;p++)this.lineTo(S[p].x,S[p].y)},tr.moveTo=function(){var e=Array.prototype.slice.call(arguments);this.actions.push({action:Jb,args:e})},tr.lineTo=function(R,B){var v=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,u=h[h.length-2],N=h[h.length-1],S=new gg(new pb(u,N),new pb(R,B));this.curves.push(S),this.actions.push({action:Li,args:v})},tr.quadraticCurveTo=function(G,i,e,a){var R=Array.prototype.slice.call(arguments),A=this.actions[this.actions.length-1].args,l=A[A.length-2],B=A[A.length-1],r=new ii(new pb(l,B),new pb(G,i),new pb(e,a));
this.curves.push(r),this.actions.push({action:qo,args:R})},tr.bezierCurveTo=function(g,e,N,y,I,F){var R=Array.prototype.slice.call(arguments),u=this.actions[this.actions.length-1].args,M=u[u.length-2],b=u[u.length-1],x=new Ti(new pb(M,b),new pb(g,e),new pb(N,y),new pb(I,F));this.curves.push(x),this.actions.push({action:Xe,args:R})},tr.arc=function(R,M,Z,a,B,P){var L=this.actions[this.actions.length-1].args,X=L[L.length-2],I=L[L.length-1];this.absarc(R+X,M+I,Z,a,B,P)},tr.absarc=function(U,V,n,W,x,w){this.absellipse(U,V,n,n,W,x,w)},tr.ellipse=function(j,I,V,t,N,_,y){var m=this.actions[this.actions.length-1].args,U=m[m.length-2],s=m[m.length-1];this.absellipse(j+U,I+s,V,t,N,_,y)},tr.absellipse=function(u,y,Q,M,S,n,O){var V=Array.prototype.slice.call(arguments),H=new io(u,y,Q,M,S,n,O);this.curves.push(H);var d=H.getPoint(1);V.push(d.x),V.push(d.y),this.actions.push({action:Ch,args:V})},tr.getSpacedPoints=function(T){T||(T=40);for(var Y=[],k=0;T>k;k++)Y.push(this.getPoint(k/T));return Y},tr.getPoints=function(K,U){K=K||12;var V,B,a,j,P,r,z,Y,t,u,X,e,J,D,F,d,s,O,g=[];for(V=0,B=this.actions.length;B>V;V++)switch(a=this.actions[V],j=a.action,P=a.args,j){case Jb:g.push(new pb(P[0],P[1]));break;case Li:g.push(new pb(P[0],P[1]));break;case qo:for(r=P[2],z=P[3],u=P[0],X=P[1],g.length>0?(D=g[g.length-1],e=D.x,J=D.y):(D=this.actions[V-1].args,e=D[D.length-2],J=D[D.length-1]),F=1;K>=F;F++)d=F/K,s=Vp.b2(d,e,u,r),O=Vp.b2(d,J,X,z),g.push(new pb(s,O));break;case Xe:for(r=P[4],z=P[5],u=P[0],X=P[1],Y=P[2],t=P[3],g.length>0?(D=g[g.length-1],e=D.x,J=D.y):(D=this.actions[V-1].args,e=D[D.length-2],J=D[D.length-1]),F=1;K>=F;F++)d=F/K,s=Vp.b3(d,e,u,Y,r),O=Vp.b3(d,J,X,t,z),g.push(new pb(s,O));break;case fi:var G,H=P[0],y=P[1],S=P[2],n=P[3],f=P[4],x=!!P[5],o=f-n,w=2*K;for(F=1;w>=F;F++)d=F/w,x||(d=1-d),G=n+d*o,s=H+S*h(G),O=y+S*Q(G),g.push(new pb(s,O));break;case Ch:var G,H=P[0],y=P[1],k=P[2],b=P[3],n=P[4],f=P[5],x=!!P[6],o=f-n,w=2*K;for(F=1;w>=F;F++)d=F/w,x||(d=1-d),G=n+d*o,s=H+k*h(G),O=y+b*Q(G),g.push(new pb(s,O))}var m=g[g.length-1],T=1e-10;return M(m.x-g[0].x)<T&&M(m.y-g[0].y)<T&&g.splice(g.length-1,1),U&&g.push(g[0]),g},tr.toShapes=function(g,n){function b(S){var p,$,w,F,E,z=[],U=new fg;for(p=0,$=S.length;$>p;p++)w=S[p],E=w.args,F=w.action,F==Jb&&0!=U.actions.length&&(z.push(U),U=new fg),U[F].apply(U,E);return 0!=U.actions.length&&z.push(U),z}function G(w){for(var X=[],Z=0,c=w.length;c>Z;Z++){var J=w[Z],f=new Bd;f.actions=J.actions,f.curves=J.curves,X.push(f)}return X}function S(v,m){for(var P=1e-10,j=m.length,f=!1,W=j-1,U=0;j>U;W=U++){var T=m[W],d=m[U],b=d.x-T.x,k=d.y-T.y;if(M(k)>P){if(0>k&&(T=m[U],b=-b,d=m[W],k=-k),v.y<T.y||v.y>d.y)continue;if(v.y==T.y){if(v.x==T.x)return!0}else{var r=k*(v.x-T.x)-b*(v.y-T.y);if(0==r)return!0;if(0>r)continue;f=!f}}else{if(v.y!=T.y)continue;if(d.x<=v.x&&v.x<=T.x||T.x<=v.x&&v.x<=d.x)return!0}}return f}var j=b(this.actions);if(0==j.length)return[];if(n===!0)return G(j);var m,R,p,T=[];if(1==j.length)return R=j[0],p=new Bd,p.actions=R.actions,p.curves=R.curves,T.push(p),T;var c=!Vp.isClockWise(j[0].getPoints());c=g?!c:c;var d,P=[],Q=[],l=[],W=0;Q[W]=r,l[W]=[];var U,N;for(U=0,N=j.length;N>U;U++)R=j[U],d=R.getPoints(),m=Vp.isClockWise(d),m=g?!m:m,m?(!c&&Q[W]&&W++,Q[W]={s:new Bd,p:d},Q[W].s.actions=R.actions,Q[W].s.curves=R.curves,c&&W++,l[W]=[]):l[W].push({h:R,p:d[0]});if(!Q[0])return G(j);if(Q.length>1){for(var O=!1,Y=[],V=0,$=Q.length;$>V;V++)P[V]=[];for(var V=0,$=Q.length;$>V;V++){Q[V];for(var y=l[V],F=0;F<y.length;F++){for(var Z=y[F],k=!0,h=0;h<Q.length;h++)S(Z.p,Q[h].p)&&(V!=h&&Y.push({froms:V,tos:h,hole:F}),k?(k=!1,P[h].push(Z)):O=!0);k&&P[V].push(Z)}}Y.length>0&&(O||(l=P))}var f,E,q;for(U=0,N=Q.length;N>U;U++)for(p=Q[U].s,T.push(p),f=l[U],E=0,q=f.length;q>E;E++)p.holes.push(f[E].h);return T};var Bd=function(){fg.apply(this,arguments),this.holes=[]},Xn=Bd.prototype=Zm(tr);Xn.getPointsHoles=function(S){var y,o=this.holes.length,q=[];for(y=0;o>y;y++)q[y]=this.holes[y].getTransformedPoints(S);return q},Xn.extractAllPoints=function(h){return{shape:this.getTransformedPoints(h),holes:this.getPointsHoles(h)}},Xn.extractPoints=function(B){return this.extractAllPoints(B)};var Vp={triangulateShape:function(V,z){function C(y,B,F){return y.x!=B.x?y.x<B.x?y.x<=F.x&&F.x<=B.x:B.x<=F.x&&F.x<=y.x:y.y<B.y?y.y<=F.y&&F.y<=B.y:B.y<=F.y&&F.y<=y.y}function x(L,a,g,p,W){var J=1e-10,U=a.x-L.x,Y=a.y-L.y,q=p.x-g.x,x=p.y-g.y,e=L.x-g.x,u=L.y-g.y,X=Y*q-U*x,D=Y*e-U*u;if(M(X)>J){var f;if(X>0){if(0>D||D>X)return[];if(f=x*e-q*u,0>f||f>X)return[]}else{if(D>0||X>D)return[];if(f=x*e-q*u,f>0||X>f)return[]}if(0==f)return!W||0!=D&&D!=X?[L]:[];if(f==X)return!W||0!=D&&D!=X?[a]:[];if(0==D)return[g];if(D==X)return[p];var Z=f/X;return[{x:L.x+Z*U,y:L.y+Z*Y}]}if(0!=D||x*e!=q*u)return[];var K=0==U&&0==Y,c=0==q&&0==x;if(K&&c)return L.x!=g.x||L.y!=g.y?[]:[L];if(K)return C(g,p,L)?[L]:[];if(c)return C(L,a,g)?[g]:[];var b,w,T,o,h,B,y,N;return 0!=U?(L.x<a.x?(b=L,T=L.x,w=a,o=a.x):(b=a,T=a.x,w=L,o=L.x),g.x<p.x?(h=g,y=g.x,B=p,N=p.x):(h=p,y=p.x,B=g,N=g.x)):(L.y<a.y?(b=L,T=L.y,w=a,o=a.y):(b=a,T=a.y,w=L,o=L.y),g.y<p.y?(h=g,y=g.y,B=p,N=p.y):(h=p,y=p.y,B=g,N=g.y)),y>=T?y>o?[]:o==y?W?[]:[h]:N>=o?[h,w]:[h,B]:T>N?[]:T==N?W?[]:[b]:N>=o?[b,w]:[b,B]}function K(d,y,r,t){var J=1e-10,B=y.x-d.x,K=y.y-d.y,l=r.x-d.x,Q=r.y-d.y,g=t.x-d.x,k=t.y-d.y,O=B*Q-K*l,w=B*k-K*g;if(M(O)>J){var u=g*Q-k*l;return O>0?w>=0&&u>=0:w>=0||u>=0}return w>0}function h(f,i){function w(F,t){var H=o.length-1,_=F-1;0>_&&(_=H);var B=F+1;B>H&&(B=0);var Q=K(o[F],o[_],o[B],J[t]);if(!Q)return!1;var Z=J.length-1,w=t-1;0>w&&(w=Z);var L=t+1;return L>Z&&(L=0),Q=K(J[t],J[w],J[L],o[F]),Q?!0:!1}function y(r,M){var h,C,f;for(h=0;h<o.length;h++)if(C=h+1,C%=o.length,f=x(r,M,o[h],o[C],!0),f.length>0)return!0;return!1}function O(X,d){var O,D,V,S,A;for(O=0;O<P.length;O++)for(D=i[P[O]],V=0;V<D.length;V++)if(S=V+1,S%=D.length,A=x(X,d,D[V],D[S],!0),A.length>0)return!0;return!1}for(var J,H,I,e,R,U,$,k,q,l,W,o=f.concat(),P=[],Y=[],E=0,z=i.length;z>E;E++)P.push(E);for(var T=0,a=2*P.length;P.length>0&&(a--,!(0>a));)for(I=T;I<o.length;I++){e=o[I],H=-1;for(var E=0;E<P.length;E++)if(U=P[E],$=e.x+":"+e.y+":"+U,Y[$]===r){J=i[U];for(var u=0;u<J.length;u++)if(R=J[u],w(I,u)&&!y(e,R)&&!O(e,R)){H=u,P.splice(E,1),k=o.slice(0,I+1),q=o.slice(I),l=J.slice(H),W=J.slice(0,H+1),o=k.concat(l).concat(W).concat(q),T=I;break}if(H>=0)break;Y[$]=!0}if(H>=0)break}return o}for(var N,b,$,s,Y,d,Q={},l=V.concat(),J=0,g=z.length;g>J;J++)Array.prototype.push.apply(l,z[J]);for(N=0,b=l.length;b>N;N++)Y=l[N].x+":"+l[N].y,Q[Y]!==r,Q[Y]=N;var H=h(V,z),n=Ah.Triangulate(H,!1);for(N=0,b=n.length;b>N;N++)for(s=n[N],$=0;3>$;$++)Y=s[$].x+":"+s[$].y,d=Q[Y],d!==r&&(s[$]=d);return n.concat()},isClockWise:function(u){return Ah.Triangulate.area(u)<0},b2p0:function(E,m){var p=1-E;return p*p*m},b2p1:function(F,P){return 2*(1-F)*F*P},b2p2:function(X,s){return X*X*s},b2:function(m,$,_,O){return this.b2p0(m,$)+this.b2p1(m,_)+this.b2p2(m,O)},b3p0:function(u,a){var G=1-u;return G*G*G*a},b3p1:function(u,O){var r=1-u;return 3*r*r*u*O},b3p2:function(b,B){var e=1-b;return 3*e*b*b*B},b3p3:function(z,v){return z*z*z*v},b3:function(H,I,D,h,G){return this.b3p0(H,I)+this.b3p1(H,D)+this.b3p2(H,h)+this.b3p3(H,G)}},Ah={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var d=m.keys(this.faces);return d.length?d[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(h){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(L){var S=L.familyName.toLowerCase(),l=this;return l.faces[S]=l.faces[S]||{},l.faces[S][L.cssFontWeight]=l.faces[S][L.cssFontWeight]||{},l.faces[S][L.cssFontWeight][L.cssFontStyle]=L,L},drawText:function($){var z,V=this.getFace(),t=this.size/V.resolution,l=0,g=String($).split(""),e=g.length,J=[];for(z=0;e>z;z++){var v=new fg,E=this.extractGlyphPoints(g[z],V,t,l,v);E&&(l+=E.offset*this.spacing,J.push(E.path))}var C=l/2;return{paths:J,offset:C}},extractGlyphPoints:function(s,O,g,X,G){var J,p,u,l,U,_,A,z,n,f,E,T,x,V,L,m,M,h,t,q=[],y=O.glyphs[s]||O.glyphs["?"];if(y){if(y.o)for(l=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),_=l.length,A=g,z=g,J=0;_>J;)switch(U=l[J++]){case"m":n=l[J++]*A+X,f=l[J++]*z,G.moveTo(n,f);break;case"l":n=l[J++]*A+X,f=l[J++]*z,G.lineTo(n,f);break;case"q":if(E=l[J++]*A+X,T=l[J++]*z,L=l[J++]*A+X,m=l[J++]*z,G.quadraticCurveTo(L,m,E,T),t=q[q.length-1])for(x=t.x,V=t.y,p=1,u=this.divisions;u>=p;p++){var c=p/u;Vp.b2(c,x,L,E),Vp.b2(c,V,m,T)}break;case"b":if(E=l[J++]*A+X,T=l[J++]*z,L=l[J++]*A+X,m=l[J++]*z,M=l[J++]*A+X,h=l[J++]*z,G.bezierCurveTo(L,m,M,h,E,T),t=q[q.length-1])for(x=t.x,V=t.y,p=1,u=this.divisions;u>=p;p++){var c=p/u;Vp.b3(c,x,L,M,E),Vp.b3(c,V,m,h,T)}}return{offset:y.ha*g,path:G}}}};Ah.generateShapes=function(S,w){w=w||{};var m=w.font;if(m===r&&(m=Ah.getDefaultFont(),!m))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var L=w.size!==r?w.size:1,s=w.curveSegments!==r?w.curveSegments:4,G=w.spacing!==r?w.spacing:1,A=w.weight!==r?w.weight:"normal",o=w.style!==r?w.style:"normal";Ah.size=L,Ah.divisions=s,Ah.face=m,Ah.weight=A,Ah.style=o,Ah.spacing=G;for(var $=Ah.drawText(S),Q=$.paths,W=[],X=0,T=Q.length;T>X;X++)Array.prototype.push.apply(W,Q[X].toShapes());return W},function(o){var c=1e-10,Q=function(X,i){var O=X.length;if(3>O)return null;var H,Y,U,x=[],b=[],s=[];if(N(X)>0)for(Y=0;O>Y;Y++)b[Y]=Y;else for(Y=0;O>Y;Y++)b[Y]=O-1-Y;var S=O,j=2*S;for(Y=S-1;S>2;){if(j--<=0)return i?s:x;if(H=Y,H>=S&&(H=0),Y=H+1,Y>=S&&(Y=0),U=Y+1,U>=S&&(U=0),L(X,H,Y,U,S,b)){var $,A,E,P,D;for($=b[H],A=b[Y],E=b[U],x.push([X[$],X[A],X[E]]),s.push([b[H],b[Y],b[U]]),P=Y,D=Y+1;S>D;P++,D++)b[P]=b[D];S--,j=2*S}}return i?s:x},N=function(l){for(var $=l.length,Y=0,h=$-1,x=0;$>x;h=x++)Y+=l[h].x*l[x].y-l[x].x*l[h].y;return.5*Y},L=function(i,D,x,v,L,e){var d,E,k,b,N,G,j,P,Q;if(E=i[e[D]].x,k=i[e[D]].y,b=i[e[x]].x,N=i[e[x]].y,G=i[e[v]].x,j=i[e[v]].y,c>(b-E)*(j-k)-(N-k)*(G-E))return!1;var o,w,Z,Y,B,z,_,J,h,u,O,H,X,R,W;for(o=G-b,w=j-N,Z=E-G,Y=k-j,B=b-E,z=N-k,d=0;L>d;d++)if(P=i[e[d]].x,Q=i[e[d]].y,!(P===E&&Q===k||P===b&&Q===N||P===G&&Q===j)&&(_=P-E,J=Q-k,h=P-b,u=Q-N,O=P-G,H=Q-j,W=o*u-w*h,X=B*J-z*_,R=Z*H-Y*O,W>=-c&&R>=-c&&X>=-c))return!1;return!0};return o.Triangulate=Q,o.Triangulate.area=N,o}(Ah),N._typeface_js={faces:Ah.faces,loadFace:Ah.loadFace};var yj=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Mn=yj.prototype={constructor:yj,computeFaceNormals:function(){for(var Z=new kj,C=new kj,B=0,d=this.faces.length;d>B;B++){var R=this.faces[B],s=this.vertices[R.a],S=this.vertices[R.b],b=this.vertices[R.c];Z.subVectors(b,S),C.subVectors(s,S),Z.cross(C),Z.normalize(),R.normal.copy(Z)}},computeVertexNormals:function(w){var e,S,I,C,V,F;for(F=new Array(this.vertices.length),e=0,S=this.vertices.length;S>e;e++)F[e]=new kj;if(w){var v,z,A,q=new kj,Q=new kj;for(I=0,C=this.faces.length;C>I;I++)V=this.faces[I],v=this.vertices[V.a],z=this.vertices[V.b],A=this.vertices[V.c],q.subVectors(A,z),Q.subVectors(v,z),q.cross(Q),F[V.a].add(q),F[V.b].add(q),F[V.c].add(q)}else for(I=0,C=this.faces.length;C>I;I++)V=this.faces[I],F[V.a].add(V.normal),F[V.b].add(V.normal),F[V.c].add(V.normal);for(e=0,S=this.vertices.length;S>e;e++)F[e].normalize();for(I=0,C=this.faces.length;C>I;I++)V=this.faces[I],V.vertexNormals[0]=F[V.a].clone(),V.vertexNormals[1]=F[V.b].clone(),V.vertexNormals[2]=F[V.c].clone()},mergeVertices:function(){var q,x,m,i,N,k,X,T,w={},Q=[],_=[],H=4,b=Y(10,H);for(m=0,i=this.vertices.length;i>m;m++)q=this.vertices[m],x=t(q.x*b)+"_"+t(q.y*b)+"_"+t(q.z*b),w[x]===r?(w[x]=m,Q.push(this.vertices[m]),_[m]=Q.length-1):_[m]=_[w[x]];var U=[];for(m=0,i=this.faces.length;i>m;m++){N=this.faces[m],N.a=_[N.a],N.b=_[N.b],N.c=_[N.c],k=[N.a,N.b,N.c];for(var L=0;3>L;L++)if(k[L]==k[(L+1)%3]){U.push(m);break}}for(m=U.length-1;m>=0;m--){var d=U[m];for(this.faces.splice(d,1),X=0,T=this.faceVertexUvs.length;T>X;X++)this.faceVertexUvs[X].splice(d,1)}var j=this.vertices.length-Q.length;return this.vertices=Q,j}},io=function(x,c,k,f,p,P,S){this.aX=x,this.aY=c,this.xRadius=k,this.yRadius=f,this.aStartAngle=p,this.aEndAngle=P,this.aClockwise=S};io.prototype=Zm(Ve),io.prototype.getPoint=function(H){var Z,S=this.aEndAngle-this.aStartAngle;0>S&&(S+=R),S>R&&(S-=R),Z=this.aClockwise===!0?this.aEndAngle+(1-H)*(R-S):this.aStartAngle+H*S;var $=this.aX+this.xRadius*h(Z),q=this.aY+this.yRadius*Q(Z);return new pb($,q)};var gg=function(s,T){this.v1=s,this.v2=T},Lp=gg.prototype=Zm(Ve);Lp.getPoint=function(j){var M=this.v2.clone().sub(this.v1);return M.multiplyScalar(j).add(this.v1),M},Lp.getPointAt=function(N){return this.getPoint(N)},Lp.getTangent=function(){var T=this.v2.clone().sub(this.v1);return T.normalize()};var ii=function(m,h,K){this.v0=m,this.v1=h,this.v2=K};ii.prototype=Zm(Ve),ii.prototype.getPoint=function(S){var I,K;return I=Vp.b2(S,this.v0.x,this.v1.x,this.v2.x),K=Vp.b2(S,this.v0.y,this.v1.y,this.v2.y),new pb(I,K)};var Ti=function(H,g,a,I){this.v0=H,this.v1=g,this.v2=a,this.v3=I};Ti.prototype=Zm(Ve),Ti.prototype.getPoint=function($){var N,y;return N=Vp.b3($,this.v0.x,this.v1.x,this.v2.x,this.v3.x),y=Vp.b3($,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new pb(N,y)},$f.create(function(V,E){this.v1=V,this.v2=E},function(L){var d=new kj;return d.subVectors(this.v2,this.v1),d.multiplyScalar(L),d.add(this.v1),d});var fo=$f.create(function(P,Y,k){this.v0=P,this.v1=Y,this.v2=k},function(T){var S,U,I;return S=Vp.b2(T,this.v0.x,this.v1.x,this.v2.x),U=Vp.b2(T,this.v0.y,this.v1.y,this.v2.y),I=Vp.b2(T,this.v0.z,this.v1.z,this.v2.z),new kj(S,U,I)}),gr=$f.create(function(x,w,l,J){this.v0=x,this.v1=w,this.v2=l,this.v3=J},function(_){var O,M,h;return O=Vp.b3(_,this.v0.x,this.v1.x,this.v2.x,this.v3.x),M=Vp.b3(_,this.v0.y,this.v1.y,this.v2.y,this.v3.y),h=Vp.b3(_,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new kj(O,M,h)}),Jj=function(K,F,g,$,i,C,W,o){yj.call(this),$=$!==r?$:.5,i=i!==r?i:.5,o=o!==r?o:1,K=K||8,C=C||0,W=W||R;var Y,A,Z=1,S=o/2,y=[],M=[],B=this.vertices,G=this.faces,I=this.faceVertexUvs;for(A=0;Z>=A;A++){var J=[],q=[],v=A/Z,w=v*(i-$)+$;for(Y=0;K>=Y;Y++){var z=Y/K,f=new kj,H=-(z*W+C);f.z=w*Q(H),f.y=-v*o+S,f.x=w*h(H),B.push(f),J.push(B.length-1),q.push(new pb(z,v))}y.push(J),M.push(q)}var U,k,b=(i-$)/o;for(Y=0;K>Y;Y++)for(0!==$?(U=B[y[0][Y]].clone(),k=B[y[0][Y+1]].clone()):(U=B[y[1][Y]].clone(),k=B[y[1][Y+1]].clone()),U.setY(c(U.x*U.x+U.z*U.z)*b).normalize(),k.setY(c(k.x*k.x+k.z*k.z)*b).normalize(),A=0;Z>A;A++){var X=y[A][Y],x=y[A+1][Y],L=y[A+1][Y+1],s=y[A][Y+1],P=U.clone(),V=U.clone(),D=k.clone(),e=k.clone(),u=M[A][Y].clone(),t=M[A+1][Y].clone(),_=M[A+1][Y+1].clone(),p=M[A][Y+1].clone();G.push(new Qj(X,x,s,[P,V,e])),I[0].push([u,t,p]),G.push(new Qj(x,L,s,[V.clone(),D,e.clone()])),I[0].push([t.clone(),_,p.clone()])}if(F&&$>0)for(this.vertices.push(new kj(0,S,0)),Y=0;K>Y;Y++){var X=y[0][Y],x=y[0][Y+1],L=this.vertices.length-1,P=new kj(0,1,0),V=new kj(0,1,0),D=new kj(0,1,0),u=M[0][Y].clone(),t=M[0][Y+1].clone(),_=new pb(t.x,0);G.push(new Qj(X,x,L,[P,V,D],null,1));var n=Y/K*R,T=h(n),j=Q(n),m=(Y+1)/K*R,E=h(m),l=Q(m);I[0].push([new pb(.5+.5*T,.5+.5*j),new pb(.5+.5*E,.5+.5*l),new pb(.5,.5)])}if(g&&i>0)for(this.vertices.push(new kj(0,-S,0)),Y=0;K>Y;Y++){var X=y[A][Y+1],x=y[A][Y],L=B.length-1,P=new kj(0,-1,0),V=new kj(0,-1,0),D=new kj(0,-1,0),u=M[A][Y+1].clone(),t=M[A][Y].clone();G.push(new Qj(X,x,L,[P,V,D],null,2));var n=Y/K*R,T=h(n),j=Q(n),m=(Y+1)/K*R,E=h(m),l=Q(m);I[0].push([new pb(.5+.5*E,.5-.5*l),new pb(.5+.5*T,.5-.5*j),new pb(.5,.5)])}};Jj.prototype=Zm(Mn);var Er=function(y,l,m,t,u,T,f){yj.call(this),f=f||.5,y=y||16,l=l||16,m=(m!==r?m:0)-I,t=t!==r?t:R,u=u!==r?u:0,T=T!==r?T:I;var s,n,e=[],x=[],O=this.vertices,q=this.faces,P=this.faceVertexUvs;for(n=0;l>=n;n++){var o=[],D=[];for(s=0;y>=s;s++){var B=s/y,w=n/l,V=new kj;V.x=-f*h(m+B*t)*Q(u+w*T),V.y=f*h(u+w*T),V.z=f*Q(m+B*t)*Q(u+w*T),O.push(V),o.push(O.length-1),D.push(new pb(B,w))}e.push(o),x.push(D)}for(n=0;l>n;n++)for(s=0;y>s;s++){var C=e[n][s+1],a=e[n][s],i=e[n+1][s],Z=e[n+1][s+1],J=O[C].clone().normalize(),K=O[a].clone().normalize(),F=O[i].clone().normalize(),d=O[Z].clone().normalize(),E=x[n][s+1].clone(),Y=x[n][s].clone(),p=x[n+1][s].clone(),G=x[n+1][s+1].clone();M(O[C].y)===f?(E.x=(E.x+Y.x)/2,q.push(new Qj(C,i,Z,[J,F,d])),P[0].push([E,p,G])):M(O[i].y)===f?(p.x=(p.x+G.x)/2,q.push(new Qj(C,a,i,[J,K,F])),P[0].push([E,Y,p])):(q.push(new Qj(C,a,Z,[J,K,d])),P[0].push([E,Y,G]),q.push(new Qj(a,i,Z,[K.clone(),F,d.clone()])),P[0].push([Y.clone(),p,G.clone()]))}};Er.prototype=Zm(Mn);var Jo=function(M,i,L,A,c,U){yj.call(this),M=M||.33,i=i||.17,A=A||8,L=L||6,c=c||0,U=U||R;for(var z=new kj,F=[],p=[],n=0;A>=n;n++)for(var y=n/A*R+I,f=0;L>=f;f++){var q=f/L*U+c;z.x=M*h(q),z.z=-M*Q(q);var k=new kj,d=M+i*h(y);k.x=d*h(q),k.z=-d*Q(q),k.y=i*Q(y),this.vertices.push(k),F.push(new pb(f/L,1-n/A)),p.push(k.clone().sub(z).normalize())}for(var n=1;A>=n;n++)for(var f=1;L>=f;f++){var v=(L+1)*n+f-1,t=(L+1)*(n-1)+f-1,a=(L+1)*(n-1)+f,Y=(L+1)*n+f,e=new Qj(v,t,Y,[p[v].clone(),p[t].clone(),p[Y].clone()]);this.faces.push(e),this.faceVertexUvs[0].push([F[v].clone(),F[t].clone(),F[Y].clone()]),e=new Qj(t,a,Y,[p[t].clone(),p[a].clone(),p[Y].clone()]),this.faces.push(e),this.faceVertexUvs[0].push([F[t].clone(),F[a].clone(),F[Y].clone()])}this.computeFaceNormals()};Jo.prototype=Zm(Mn);var br=function(q,A,n){return q?(yj.call(this),q=q instanceof Array?q:[q],this.addShapeList(q,A),A.convertYZ!==!1&&th(this,n),this.computeFaceNormals(),void 0):(q=[],void 0)},wg=br.prototype=Zm(yj.prototype);wg.addShapeList=function(x,B){for(var w=x.length,G=0;w>G;G++){var q=x[G];this.addShape(q,B)}},wg.addShape=function(m,n){function e(){if(n.bottom)for(var f=0;d>f;f++)g=j[f],Z(g[2],g[1],g[0],!0);if(n.top)for(f=0;d>f;f++)g=j[f],Z(g[0]+K*G,g[1]+K*G,g[2]+K*G,!1)}function B(){var D=0;for(y(X,D),D+=X.length,N=0,O=t.length;O>N;N++)l=t[N],y(l,D),D+=l.length}function y(O,x){for(var t,F,k=O.length;--k>=0;){t=k,F=k-1,0>F&&(F=O.length-1);var o=0,d=G;for(o=0;d>o;o++){var c=K*o,S=K*(o+1),u=x+t+c,V=x+F+c,f=x+F+S,Q=x+t+S;T(u,V,f,Q,O,o,d,t,F)}}}function q(Z,Q,b){E.vertices.push(new kj(Z,Q,b))}function Z(z,e,o,r){z+=x,e+=x,o+=x,E.faces.push(new Qj(z,e,o,null,null,r?2:1));var O=r?i.generateBottomUV(E,m,n,z,e,o):i.generateTopUV(E,m,n,z,e,o);E.faceVertexUvs[0].push(O)}function T(o,V,q,P,M,Z,S,F,w){o+=x,V+=x,q+=x,P+=x,E.faces.push(new Qj(o,V,P)),E.faces.push(new Qj(V,q,P));var d=i.generateSideWallUV(E,m,M,n,o,V,q,P,Z,S,F,w);E.faceVertexUvs[0].push([d[0],d[1],d[3]]),E.faceVertexUvs[0].push([d[1],d[2],d[3]])}var J,u,A,S,L,_=n.amount,D=n.curveSegments||kf,G=n.steps||1,Q=n.extrudePath,p=!1,i=new Jr(n.repeatUVLength);Q&&(J=Q.getSpacedPoints(G),p=!0,u=n.frames!==r?n.frames:new xg.FrenetFrames(Q,G,!1),A=new kj,S=new kj,L=new kj);var l,N,O,E=this,x=this.vertices.length,R=m.extractPoints(D),k=R.shape,t=R.holes,U=!Vp.isClockWise(k);if(U){for(k=k.reverse(),N=0,O=t.length;O>N;N++)l=t[N],Vp.isClockWise(l)&&(t[N]=l.reverse());U=!1}var j=Vp.triangulateShape(k,t),X=k;for(N=0,O=t.length;O>N;N++)l=t[N],k=k.concat(l);for(var f,g,K=k.length,d=j.length,h=0;K>h;h++)f=k[h],p?(S.copy(u.normals[0]).multiplyScalar(f.x),A.copy(u.binormals[0]).multiplyScalar(f.y),L.copy(J[0]).add(S).add(A),q(L.x,L.y,L.z)):q(f.x,f.y,0);var M;for(M=1;G>=M;M++)for(h=0;K>h;h++)f=k[h],p?(S.copy(u.normals[M]).multiplyScalar(f.x),A.copy(u.binormals[M]).multiplyScalar(f.y),L.copy(J[M]).add(S).add(A),q(L.x,L.y,L.z)):q(f.x,f.y,_/G*M);e(),B()};var xg=function(Y,P,A,x,E){function X(Z,z,E){return $.vertices.push(new kj(Z,z,E))-1}yj.call(this),P=P||64,A=A||1,x=x||8,E=E||!1;var r,l,_,d,n,s,D,u,f,q,L,B,k,e,y,z,W,Z,b,U,m=[],$=this,G=P+1,T=new kj,I=new xg.FrenetFrames(Y,P,E),v=I.tangents,w=I.normals,a=I.binormals;for(this.tangents=v,this.normals=w,this.binormals=a,f=0;G>f;f++)for(m[f]=[],d=f/(G-1),u=Y.getPointAt(d),r=v[f],l=w[f],_=a[f],q=0;x>q;q++)n=q/x*R,s=-A*h(n),D=A*Q(n),T.copy(u),T.x+=s*l.x+D*_.x,T.y+=s*l.y+D*_.y,T.z+=s*l.z+D*_.z,m[f][q]=X(T.x,T.y,T.z);for(f=0;P>f;f++)for(q=0;x>q;q++)L=E?(f+1)%P:f+1,B=(q+1)%x,k=m[f][q],e=m[L][q],y=m[L][B],z=m[f][B],W=new pb(f/P,q/x),Z=new pb((f+1)/P,q/x),b=new pb((f+1)/P,(q+1)/x),U=new pb(f/P,(q+1)/x),this.faces.push(new Qj(k,e,z)),this.faceVertexUvs[0].push([W,Z,U]),this.faces.push(new Qj(e,y,z)),this.faceVertexUvs[0].push([Z.clone(),b,U.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};xg.prototype=Zm(Mn),xg.FrenetFrames=function(Y,K,v){function U(){$[0]=new kj,H[0]=new kj,N=Number.MAX_VALUE,A=M(P[0].x),e=M(P[0].y),W=M(P[0].z),N>=A&&(N=A,p.set(1,0,0)),N>=e&&(N=e,p.set(0,1,0)),N>=W&&p.set(0,0,1),Z.crossVectors(P[0],p).normalize(),$[0].crossVectors(P[0],Z),H[0].crossVectors(P[0],$[0])}var r,N,A,e,W,h,g,p=new kj,P=[],$=[],H=[],Z=new kj,s=new $l,Q=K+1,B=1e-4;for(this.tangents=P,this.normals=$,this.binormals=H,h=0;Q>h;h++)g=h/(Q-1),P[h]=Y.getTangentAt(g),P[h].normalize();for(U(),h=1;Q>h;h++)$[h]=$[h-1].clone(),H[h]=H[h-1].clone(),Z.crossVectors(P[h-1],P[h]),Z.length()>B&&(Z.normalize(),r=T(pd(P[h-1].dot(P[h]),-1,1)),$[h].applyMatrix4(s.makeRotationAxis(Z,r))),H[h].crossVectors(P[h],$[h]);if(v)for(r=T(pd($[0].dot($[Q-1]),-1,1)),r/=Q-1,P[0].dot(Z.crossVectors($[0],$[Q-1]))>0&&(r=-r),h=1;Q>h;h++)$[h].applyMatrix4(s.makeRotationAxis(P[h],r*h)),H[h].crossVectors(P[h],$[h])};var od=function(L,I,T,i){yj.call(this),I=I||18,T=T||0,i=i==C?R:i;for(var q=1/(L.length-1),e=1/I,p=0,w=I;w>=p;p++)for(var j=T+p*e*i,s=h(j),m=Q(j),E=0,f=L.length;f>E;E++){var N=L[E],Z=new kj;Z.x=s*N.x-m*N.y,Z.y=m*N.x+s*N.y,Z.z=N.z,this.vertices.push(Z)}for(var c=L.length,p=0,w=I;w>p;p++)for(var E=0,f=L.length-1;f>E;E++){var r=E+c*p,Y=r,o=r+c,s=r+1+c,W=r+1,y=p*e,U=E*q,d=y+e,k=U+q;this.faces.push(new Qj(Y,W,o)),this.faceVertexUvs[0].push([new pb(y,U),new pb(y,k),new pb(d,U)]),this.faces.push(new Qj(o,W,s)),this.faceVertexUvs[0].push([new pb(d,U),new pb(y,k),new pb(d,k)])}this.mergeVertices(),th(this),this.computeFaceNormals(),this.computeVertexNormals()};od.prototype=Zm(Mn);var dh=function(d,E){E=E||{};var $=Ah.generateShapes(d,E);E.amount=E.amount!==r?E.amount:.5,E.convertYZ=!1,E.fill!==!1&&(E.bottom=!0,E.top=!0),br.call(this,$,E)};dh.prototype=Zm(wg);var dg=u.Node=function(){Nm(dg,this)},Ie={X:dj,Y:rc,Z:zn},jj={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Cg="xzy",El=function(U,W,f){if(W){var G=W[0],x=W[1],p=W[2];"xzy"===f?(rc(U,x),zn(U,p),dj(U,G)):"xyz"===f?(zn(U,p),rc(U,x),dj(U,G)):"yxz"===f?(zn(U,p),dj(U,G),rc(U,x)):"yzx"===f?(dj(U,G),zn(U,p),rc(U,x)):"zxy"===f?(rc(U,x),dj(U,G),zn(U,p)):"zyx"===f?(dj(U,G),rc(U,x),zn(U,p)):(rc(U,x),zn(U,p),dj(U,G))}};rq("Node",ap,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Cg,_64O:0,_rotationX:0,_53O:0,_host:C,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return jk},_22Q:function(){return Yh},getX:function(){return this.p().x},setX:function(i){this.p(i,this.p().y)},getY:function(){return this.p().y},setY:function(d){this.p(this.p().x,d)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(P){this.setAnchor(P,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(s){this.setAnchor(this.getAnchor().x,s)},getScaleX:function(){return this.getScale().x},setScaleX:function(Z){this.setScale(Z,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function($){this.setScale(this.getScale().x,$)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(P,f){mg(P,$i(C,C,this.r3(),this.getRotationMode())),this.translate3d(P[0]*f,P[1]*f,P[2]*f)},translateFront:function($){this.translate3dBy([0,0,1],$)},translateBack:function(p){this.translate3dBy([0,0,-1],p)},translateLeft:function(N){this.translate3dBy([-1,0,0],N)},translateRight:function(r){this.translate3dBy([1,0,0],r)},translateTop:function(O){this.translate3dBy([0,1,0],O)},translateBottom:function(p){this.translate3dBy([0,-1,0],p)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(L,R,n){1===arguments.length&&(R=L[1],n=L[2],L=L[0]),this.p(L,n),this.setElevation(R)},translate3d:function(r,E,K){1===arguments.length&&(E=r[1],K=r[2],r=r[0]),this.translate(r,K),this.setElevation(this._54O+E)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(g,y,I){1===arguments.length&&(y=g[1],I=g[2],g=g[0]),this.setSize(g,I),this.setTall(y)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(L,j,e){1===arguments.length&&(j=L[1],e=L[2],L=L[0]),this.setRotationX(L),this.setRotation(-j),this.setRotationZ(e)},setRotationY:function(j){this.setRotation(-j)},getRotationY:function(){return-this._64O},lookAtDirection:function(p,Z){Z=Z||Nb;var s=this,H=Xo(p);Z===Nb?(s.r3([-y(p[1]/H),-W(p[2],p[0])+f,0]),s.setRotationMode("xzy")):Z===lg?(s.r3(0,-W(p[2],p[0]),y(p[1]/H)),s.setRotationMode("zyx")):Z===en?(s.r3(0,-W(p[2],p[0])+I,-y(p[1]/H)),s.setRotationMode("zyx")):Z===al?(s.r3([-y(p[1]/H)+f,-W(p[2],p[0])+f,0]),s.setRotationMode("xzy")):Z===rb&&(s.r3([-y(p[1]/H)-f,-W(p[2],p[0])+f,0]),s.setRotationMode("xzy")),Z===Eg&&(s.r3([-y(p[1]/H)+I,-W(p[2],p[0])+f,I]),s.setRotationMode("zxy"))},lookAt:function(g,W){return this.lookAtDirection(Xl(g,this.p3()),W)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(V){var K=this;if(K!==V&&K._host!==V){var c=K._host;c&&c._removeAttach(K),K._host=V,K._host&&K._host._addAttach(K),K.fp("host",c,V),K.onHostChanged(c,V)}},getAttaches:function(){return this._69O},_addAttach:function(t){var a=this;a._69O||(a._69O=new Oh),a._69O.add(t),a.fp("attaches",C,t)},_removeAttach:function(z){var G=this;G._69O.remove(z),G._69O.isEmpty()&&delete G._69O,G.fp("attaches",z,C)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(V){var u=this;u._44I||(u._44I=new Oh),u._42I||(u._42I=new Oh),u._44I.add(V),u._42I.add(V),u._20I()},_4I:function(u){var z=this;z._44I||(z._44I=new Oh),z._43I||(z._43I=new Oh),z._44I.add(u),z._43I.add(u),z._20I()},_16I:function(Q){var Z=this;Z._44I.remove(Q),Z._42I.remove(Q),Z._44I.isEmpty()&&delete Z._44I,Z._42I.isEmpty()&&delete Z._42I,Z._20I()},_18I:function(E){var v=this;v._44I.remove(E),v._43I.remove(E),v._44I.isEmpty()&&delete v._44I,v._43I.isEmpty()&&delete v._43I,v._20I()},_20I:function(){var l=this;if(delete l._45I,!l._44I||l._44I.isEmpty())return delete l._70O,void 0;var Y;l._44I.each(function(e){e.isLooped()&&(Y||(Y={}),Y[e._id]||(l._45I||(l._45I=new Oh),l._45I.add(e),Y[e._id]=e))}),Y?(l._70O=new Oh,l._44I.each(function(O){Y[O._id]?"A"===Y[O._id]||(Y[O._id]="A",l._70O.add(O)):l._70O.add(O)})):l._70O=l._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(T){var R=this;R._46I||(R._46I=new Oh),R._48I||(R._48I=new Oh),R._46I.add(T),R._48I.add(T),R._19I()},_3I:function(G){var s=this;s._47I||(s._47I=new Oh),s._48I||(s._48I=new Oh),s._47I.add(G),s._48I.add(G),s._19I()},_15I:function(g){var U=this;U._46I.remove(g),U._48I.remove(g),U._46I.isEmpty()&&delete U._46I,U._48I.isEmpty()&&delete U._48I,U._19I()},_17I:function(o){var J=this;J._47I.remove(o),J._48I.remove(o),J._47I.isEmpty()&&delete J._47I,J._48I.isEmpty()&&delete J._48I,J._19I()},_19I:function(){var D=this;delete D._49I;var L=D._48I;if(L&&!L.isEmpty()){var d={};L.each(function(m){d[m._id]?D._49I||(D._49I=new Oh):d[m._id]=m}),D._49I?L.each(function($){d[$._id]&&(D._49I.add($),delete d[$._id])}):D._49I=L}},getImage:function(){if(this._pendingCheckImageJSON){var C=v.getImage(this._image);C&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Xg&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(o){var b=this,l=b._image,G=b.getWidth(),v=b.getHeight();b._image=o,b.fp("image",l,o)&&(null!=o&&(vl(o)||Ai(o)&&/\.json$/i.test(o))&&(this._pendingCheckImageJSON=!0),b.fp(Qn,G,b.getWidth()),b.fp($g,v,b.getHeight()))},getElevation:function(){return this._54O},setElevation:function(A){var q=this;if(!q._50O){q._50O=1;var x=q._54O;q._54O=A,q.fp(lc,x,A),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(w){var m=this;if(!m._49O){m._49O=1;var g=m._64O;m._64O=w,m.fp(Zo,g,w),delete m._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(v){var l=this;if(!l._51O){l._51O=1;var V=l._rotationX;l._rotationX=v,l.fp("rotationX",V,v),delete l._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(I){var h=this;if(!h._52O){h._52O=1;var m=h._53O;h._53O=I,h.fp("rotationZ",m,I),delete h._52O}},getPosition:function(){return this._position},setPosition:function(U,i){var f=this;if(!f._50I){f._50I=1;var A;if(A=2===arguments.length?{x:U,y:i}:U,A.x!==f._position.x||A.y!==f._position.y){var G=f._position;f._position=A,f.fp(Aj,G,A)}delete f._50I}},translate:function(B,p){var X=this._position;this.p(X.x+B,X.y+p)},getWidth:function(){var G=this;if(G._width>=0)return G._width;var O=G.getStyle("shape3d");if(O){var v=Zb(O);if(v&&v.rawS3)return v.rawS3[0];if("billboard"===O||"plane"===O){var e=Sg(G.getStyle("shape3d.image"));return e?Ml(e,G):20}}var e=Sg(G._image);return e?Ml(e,G):20},setWidth:function(O){var w=this,a=w._width;w._width=O,w.fp(Qn,a,O)},getHeight:function(){var p=this;if(p._height>=0)return p._height;var b=p.getStyle("shape3d");if(b){var i=Zb(b);if(i&&i.rawS3)return i.rawS3[2];if("plane"===b){var M=Sg(p.getStyle("shape3d.image"));return M?Zj(M,p):20}if("billboard"===b)return 2}var M=Sg(p._image);return M?Zj(M,p):20},setHeight:function(I){var B=this,n=B._height;B._height=I,B.fp($g,n,I)},getTall:function(){var U=this;if(U._tall>=0)return U._tall;var E=U.getStyle("shape3d");if(E){var r=Zb(E);if(r&&r.rawS3)return r.rawS3[1];if("billboard"===E){var K=Sg(U.getStyle("shape3d.image"));return K?Zj(K,U):20}if("plane"===E)return 2}return 20},setTall:function(s){var q=this,t=q._tall;q._tall=s,q.fp("tall",t,s)},setSize:function(w,A){var g=this;2===arguments.length?(g.setWidth(w),g.setHeight(A)):(g.setWidth(w.width),g.setHeight(w.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(v,d,h,p,S){var s=this,M=s.getAnchor(),T=s.getScale();arguments.length<=2&&(S=d,d=v.y,h=v.width,p=v.height,v=v.x);var P=S&&T.x<0?1-M.x:M.x,q=S&&T.y<0?1-M.y:M.y;s.p(v+h*P,d+p*q),S&&(h/=Math.abs(T.x),p/=Math.abs(T.y)),s.setWidth(h),s.setHeight(p)},getMatrix:function(){var K=this,r=K._64O,m=K._position,V=K.getScale();return new Aq(r,m.x,m.y,V.x,V.y)},getAnchorRect:function(){var t=this,h=t.getWidth(),G=t.getHeight(),k=t.getAnchor();return{x:-h*k.x,y:-G*k.y,width:h,height:G}},toLocal:function(l){return this.getMatrix().tfi(l)},toGlobal:function(d){return this.getMatrix().tf(d)},isInRect:function(c){c=this.toLocal(c);var R=this.getWidth(),H=this.getHeight();return c.x+=R*this.getAnchorX(),c.y+=H*this.getAnchorY(),!(c.x<0||c.y<0||c.x>R||c.y>H)},getRect:function(){var Q=this,j=Q.getWidth(),I=Q.getHeight(),$=Q.getAnchor(),D={x:-j*$.x,y:-I*$.y,width:j,height:I},R=Q.getMatrix();return D=xo([R.tf(D.x,D.y),R.tf(D.x+D.width,D.y),R.tf(D.x+D.width,D.y+D.height),R.tf(D.x,D.y+D.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var E=this,I=E.getAnchor(),S=E._anchorElevation;return{x:I.x,y:S,z:I.y}},setAnchorElevation:function(h){var N=this,R=N._anchorElevation;return R!==h?(N._anchorElevation=h,N.fp("anchorElevation",R,h),!0):!1
},setAnchor3d:function(u,v,Y,B){var D,C=this;"number"==typeof u?D={x:u,y:v,z:Y}:(D=u.length?{x:u[0],y:u[1],z:u[2]}:u,B=v);var e=C.getDataModel();e&&e.beginTransaction();var q=C.getAnchor3d(),S=C.setAnchor(D.x,D.z);if(C.setAnchorElevation(D.y)&&(S=!0),S&&B&&!Zr){C.getAnchor3d();var O=yk(C),K=mg([D.x-q.x,D.y-q.y,D.z-q.z],O);C.p3(K)}return e&&e.endTransaction(),S},getAnchor:function(){var g=this;if(g.hasOwnProperty("_anchor"))return g._anchor;var l=Sg(g._image);return l&&l.anchorX!==r?{x:l.anchorX,y:l.anchorY}:g._anchor},setAnchor:function(q,O,U){var p,r=this;"number"==typeof q?p={x:q,y:O}:(p=q.length?{x:q[0],y:q[1]}:q,U=O);var d=r.getAnchor();if(d.x!==p.x||d.y!==p.y){var u=r.getDataModel();if(u&&u.beginTransaction(),r._anchor=p,r.fp("anchor",d,p),U&&!Zr){var c=r.getPosition(),g=r.getSize(),n=r.getRotation(),P=r.getScale(),G=-g.width*(d.x-p.x)*P.x,B=-g.height*(d.y-p.y)*P.y,z=Q(n),a=h(n);r.setPosition(c.x+a*G-z*B,c.y+z*G+a*B)}return u&&u.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(C,e){var K,l=this;K=2===arguments.length?{x:C,y:e}:C;var L=l.getScale();(L.x!==K.x||L.y!==K.y)&&(l._scale=K,l.fp("scale",L,K))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var b=this,G=b._scaleTall,i=b.getScale();return[i.x,G,i.y]},getFinalScale3d:function(){var L=this,N=L.s3(),r=L._dynamicScale3d,m=L.getScale3d();return N&&(m[0]*=N[0],m[1]*=N[1],m[2]*=N[2]),r&&(m[0]*=r[0],m[1]*=r[1],m[2]*=r[2]),m},getFinalRotation3d:function(){var P=this;return P._dynamicRotation||P.r3()},setScaleTall:function(c){var i=this,Q=i._scaleTall;Q!==c&&(i._scaleTall=c,i.fp("scaleTall",Q,c))},setScale3d:function(Q,l,q){var k,v=this;k="number"==typeof Q?{x:Q,y:l,z:q}:Q.length?{x:Q[0],y:Q[1],z:Q[2]}:Q,v.setScaleTall(k.y),v.setScale(k.x,k.z)},getCorners:function(k,j){k==C&&(k=0),j==C&&(j=k);var u=this,V=u.getAnchor(),A=u.getWidth(),d=u.getHeight(),m=-A*V.x-k,X=-d*V.y-j,Z=A+2*k,T=d+2*j,S=u.getMatrix();return[S.tf(m,X),S.tf(m,X+T),S.tf(m+Z,X+T),S.tf(m+Z,X)]},getEditControlPoints:function(v,x,A){x==C&&(x=0),A==C&&(A=x);var n=this,y=n.getAnchor(),r=n.getWidth(),D=n.getHeight(),j=-r*y.x-x,m=-D*y.y-A,w=r+2*x,X=D+2*A;if(v)return[{x:j,y:m},{x:j,y:0},{x:j,y:m+X},{x:0,y:m+X},{x:j+w,y:m+X},{x:j+w,y:0},{x:j+w,y:m},{x:0,y:m}];var Z=n.getMatrix();return[Z.tf(j,m),Z.tf(j,0),Z.tf(j,m+X),Z.tf(0,m+X),Z.tf(j+w,m+X),Z.tf(j+w,0),Z.tf(j+w,m),Z.tf(0,m)]},rotateAt:function(U,g,r){var t=this,n=t._position,p=t._64O,I=new Aq(p,n.x,n.y).tf(U,g),R=c(U*U+g*g),B=W(n.y-I.y,n.x-I.x)+r;t.setRotation(p+r),t.p(I.x+R*h(B),I.y+R*Q(B))},onParentChanged:function(){dg.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(B){B._7I()})},onPropertyChanged:function(c){var Y=this;dg.superClass.onPropertyChanged.call(Y,c),Y._69O&&Y._69O.each(function(f){f.handleHostPropertyChange(c)}),Y._49I&&Y._49I.each(function(a){a.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(k){this.updateAttach(k)},onStyleChanged:function(b){dg.superClass.onStyleChanged.apply(this,arguments),Gr[b]&&this.updateAttach()},updateAttach:function(d){var M=this;M._51I||Zr||(M._51I=1,M._71O(d),delete M._51I)},_71O:function(q){var F,U,B,b,t,E,I=this,_=I._host,x=q?q.property:C,O=q?q.oldValue:C,A=q?q.newValue:C;if(_ instanceof u.Grid){if(x===lc)I.setElevation(I._54O+A-O);else if(!q||$h[x]){if(F=I.s("attach.row.index"),U=I.s("attach.column.index"),B=_.getCellRect(F,U),!B)return;b=I.s("attach.row.span"),t=I.s("attach.column.span"),(1!==b||1!==t)&&(B=$k(B,_.getCellRect(F+b-1,U+t-1))),zl(B,I,"attach.padding",1),I.setRect(B)}}else if(_ instanceof zb&&(E=I.s("attach.index"))>=0&&(!q||Wp[x])){var o=I.s("attach.thickness");o!=C&&I.setHeight(_.getThickness()*o);var V=I.s("attach.offset"),m=_.getPoints(),i=m.size();if(i>E){var n=m.get(E),r=i===E+1?m.get(0):m.get(E+1),R=[r.x-n.x,r.y-n.y],Q=Xo(R);if(Q){I.s("attach.offset.relative")&&(V*=Q),I.s("attach.offset.opposite")&&(V=Q-V);var P={x:n.x+R[0]/Q*V,y:n.y+R[1]/Q*V},z=I.s("attach.gap");z&&(I.s("attach.gap.relative")&&(z*=_.getThickness()),P=Bg(C,P,r,z)),I.p(P),I.setRotation(W(R[1],R[0]))}}}else q&&(x===Aj?I.translate(A.x-O.x,A.y-O.y):x===lc?I.setElevation(I._54O+A-O):Mg[x]&&I._11Q(_,x,A-O))},_11Q:function(H,r,D){var K=this,_=H.p3(),x=Xl(K.p3(),_),i=mb(),n=jj[K.getRotationMode()],U=n[0],C=n[1],S=n[2],L=Ie[U],j=Ie[C],d=Ie[S];r===Zo&&(r="rotationY",D=-D),r===Zo+U?(d(i,H[Fr+S]()),j(i,H[Fr+C]()),L(i,D),j(i,-H[Fr+C]()),d(i,-H[Fr+S]()),K[oq+U](K[Fr+U]()+D)):r===Zo+C?(d(i,H[Fr+S]()),j(i,D),d(i,-H[Fr+S]()),K[oq+C](K[Fr+C]()+D)):r===Zo+S&&(d(i,D),K[oq+S](K[Fr+S]()+D)),mg(x,i),K.p3(_[0]+x[0],_[1]+x[1],_[2]+x[2])},isHostOn:function(N){var t=this;if(t._host&&N&&N._69O)for(var J={},A=t._host;A&&A!==t&&!J[A._id];){if(A===N)return!0;J[A._id]=A,A=A._host}return!1},isLoopedHostOn:function(o){return this.isHostOn(o)&&o.isHostOn(this)},getSerializableProperties:function(){var R=dg.superClass.getSerializableProperties.call(this);return xj(R,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),R}});var Wb=u.Edge=function(_,l){var U=this;Nm(Wb,U),U.setSource(_),U.setTarget(l)};rq("Edge",ap,{_icon:"edge_icon",getUIClass:function(){return Gj},_22Q:function(){return ek},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(g){var A=this;if(A._source!==g){var J=A._source;A._source=g,J&&J._16I(A),g&&g._2I(A),A._7I(),A.fp("source",J,g)}},setTarget:function(Z){var E=this;if(E._target!==Z){var A=E._target;E._target=Z,A&&A._18I(E),Z&&Z._4I(E),E._7I(),E.fp("target",A,Z)}},isLooped:function(){var z=this;return z._source===z._target&&!!z._source&&!!z._target},_7I:function(){var $,L=this,g=vd(L);L._40I!==g&&($=this._40I,$&&$._15I(L),L._40I=g,g&&g._1I(L),L.fp("sourceAgent",$,g),Eh($,L._41I),Eh(g,L._41I));var k=sq(L);L._41I!==k&&($=L._41I,$&&$._17I(L),L._41I=k,k&&k._3I(L),L.fp("targetAgent",$,k),Eh($,L._40I),Eh(k,L._40I))},_22I:function(F){this._52I=F,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var i=this;return i._52I&&i._52I.get(0)!==i&&!i.getStyle(Vc)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var s=this,V=s._52I;return V&&!s.getStyle(Vc)&&V.size()>1&&s===V.get(0)},toggle:function(){var P=this._52I,K=!this.s(Vc);P&&P.size()>1&&(P.each(function(P){P.s(Vc,K)}),P.getSiblings().each(function(E){E!==P&&E.each(function(z){z.fp("edgeGroup",C,E)})}))},setStyle:function(l,J){(l===Am||"edge.segments"===l)&&(J=Gi(J)),Wb.superClass.setStyle.call(this,l,J)},onStyleChanged:function(u){Wb.superClass.onStyleChanged.apply(this,arguments),zd[u]&&Eh(this._41I,this._40I)},getSerializableProperties:function(){var X=Wb.superClass.getSerializableProperties.call(this);return xj(X,{source:1,target:1}),X}});var ag=u.Group=function(){Nm(ag,this)};rq("Group",dg,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Hj},onChildAdded:function(){ag.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){ag.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var U=this;if(!U._54I&&!Zr){var g=U.getChildrenRect();g&&(U._53I=1,U.p(vh(U.s("group.position"),g,U.getSize())),delete U._53I)}},getChildrenRect:function(){var y,E=this;return E.eachChild(function(v){y=$k(y,E.getChildRect(v))}),y},getChildRect:function(z){var R;return Cp(z)&&z.s(Vj)&&(Pq(z)&&z.isExpanded()&&z.eachChild(function(h){R=$k(R,z.getChildRect(h))}),!R&&z.getRect&&(R=z.getRect())),R},setPosition:function($,c){var e=this;if(!e._54I){var G;G=2===arguments.length?{x:$,y:c}:$,Zr||e._53I||(e._54I=1,wr(e._children,G.x-e._position.x,G.y-e._position.y),delete e._54I),ag.superClass.setPosition.call(this,G)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(i){var f=this;if(f._57O!==i){var M=f._57O;f._57O=i,f.fp("expanded",M,f._57O),f._8I()}},_8I:function(){ag.superClass._8I.call(this),this.eachChild(function(L){Cp(L)&&L._8I()})},onStyleChanged:function(W){ag.superClass.onStyleChanged.apply(this,arguments),"group.position"===W&&this._81I()},getSerializableProperties:function(){var X=ag.superClass.getSerializableProperties.call(this);return X.expanded=1,X}});var vi=u.Block=function(){Nm(vi,this)};rq("Block",dg,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return nf},onChildAdded:function(){vi.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){vi.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var U=this;if(!Zr&&!U._updatingToChildren&&U._syncSize){var Z,g,l,o,y,k=[],R=U.getRotation();if(U.eachChild(function(u){Cp(u)&&k.push.apply(k,u.getCorners())}),k.length){U._updatingFromChildren=1;var f=h(-R),W=Q(-R),c=1/0,s=-1/0,L=1/0,O=-1/0;for(o=0,y=k.length;y>o;o++)l=k[o],Z=l.x,g=l.y,l.x=f*Z-W*g,l.y=W*Z+f*g,c=x(c,l.x),s=F(s,l.x),L=x(L,l.y),O=F(O,l.y);var n=U.getScale();U.setSize(M((s-c)/n.x),M((O-L)/n.y));var V;n.x<0&&(V=c,c=s,s=V),n.y<0&&(V=L,L=O,O=V),f=h(R),W=Q(R);var G=U.getAnchor();Z=c+(s-c)*G.x,g=L+(O-L)*G.y,U.setPosition(f*Z-W*g,W*Z+f*g),delete U._updatingFromChildren}}},setPosition:function(b,W){var y=this;if(!y._updatingToChildren){var K;K=2===arguments.length?{x:b,y:W}:b,Zr||y._updatingFromChildren||(y._updatingToChildren=1,wr(y._children,K.x-y._position.x,K.y-y._position.y),delete y._updatingToChildren),vi.superClass.setPosition.call(this,K)}},setWidth:function(A){return this.setSize(A,this.getHeight())},setHeight:function(E){return this.setSize(this.getWidth(),E)},setSize:function(P,e){1>P&&(P=1),1>e&&(e=1);var L=this;if(!L._updatingToChildren){2!==arguments.length&&(e=P.height,P=P.width);var s=L.getWidth(),U=L.getHeight();if(P!==s&&vi.superClass.setWidth.call(L,P),e!==U&&vi.superClass.setHeight.call(L,e),!Zr&&!L._updatingFromChildren){L._updatingToChildren=1;var X=P/s,r=e/U;L._adjustChildScaleOrSize(X,r,"size"),delete L._updatingToChildren,L.updateFromChildren()}}},_adjustChildScaleOrSize:function(i,T,N){var A=this;if(A._syncSize){var d=A.getPosition(),E=A.getRotation();A.getScale(),A.eachChild(function(w){if(Cp(w)){var k=w.getPosition(),p=w.getRotation(),r=w.getWidth(),s=w.getHeight(),u=w.getScale(),L=u.x*r,f=u.y*s,c=new Aq(p,k.x,k.y,L,f);c.translate(-d.x,-d.y),c.rotate(-E),p=W(c.b*Math.sign(L),c.a*Math.sign(L)),c.scale(i,T);var B,I,R,P=h(p);if(Math.abs(P)<.001?(B=Q(p),I=c.b/B,R=-c.c/B):(I=c.a/P,R=c.d/P),"scale"===N)w.setScale(I/r,R/s);else if("size"===N){var S=I/u.x,U=R/u.y;w.setScale(Ld(I)*Math.abs(u.x),Ld(R)*Math.abs(u.y)),w.setSize(Math.max(.1,Math.abs(S)),Math.max(.1,Math.abs(U)))}c.rotate(E),c.translate(d.x,d.y),w.setPosition(c.tx,c.ty)}})}},_calcChangeFactor:function(w,q,P,I){var b,Y,u,A;return b=M(w),Y=M(P),u=b>Y?b/Y:Y/b,b=M(q),Y=M(I),A=b>Y?b/Y:Y/b,F(u,A)},setAnchor:function(){var j=this;if(!j._updatingToChildren){var l=j.getAnchor();if(vi.superClass.setAnchor.apply(j,arguments),!Zr&&!j._updatingFromChildren&&j._syncSize){j._updatingToChildren=1;var O=j.getAnchor();j.getPosition();var R=j.getSize(),P=j.getScale(),t=j.getRotation(),U=-R.width*P.x*(l.x-O.x),k=-R.height*P.y*(l.y-O.y),f=Q(t),s=h(t),X=s*U-f*k,Z=f*U+s*k;j.eachChild(function(o){if(Cp(o)){var K=o.getPosition();o.setPosition(K.x-X,K.y-Z)}}),delete j._updatingToChildren}}},setRotation:function(E){var a=this;if(!a._updatingToChildren){var K=a.getRotation();if(vi.superClass.setRotation.apply(a,arguments),!Zr&&!a._updatingFromChildren){a._updatingToChildren=1;var S=a.getPosition(),g=E-K;a.eachChild(function(h){if(Cp(h)){var f=h.getMatrix();f.translate(-S.x,-S.y),f.rotate(g),f.translate(S.x,S.y);var s=Math.sign(h.getScale().x);h.setRotation(W(f.b*s,f.a*s)),h.setPosition(f.tx,f.ty)}}),delete a._updatingToChildren}}},setScale:function(d,Q){var L=this;if(!L._updatingToChildren){null==Q&&(Q=d.y,d=d.x);var P=L.getScale();if(M(d)<.01&&(d=.01*(Ld(d)||Ld(P.x))),M(Q)<.01&&(Q=.01*(Ld(Q)||Ld(P.y))),vi.superClass.setScale.call(L,d,Q),!Zr&&!L._updatingFromChildren){L._updatingToChildren=1;var T=d/P.x,y=Q/P.y;L._adjustChildScaleOrSize(T,y,"size"),delete L._updatingToChildren,L.updateFromChildren()}}},getSerializableProperties:function(){var e=vi.superClass.getSerializableProperties.call(this);return e.clickThroughEnabled=1,e.syncSize=1,e}});var jp=u.Grid=function(){Nm(u.Grid,this)};rq("Grid",dg,{IRotatable:!1,_icon:"grid_icon",_image:C,getUIClass:function(){return ob},setRotation:function(){},getCellRect:function(S,x){var R=this,P=R.s("grid.row.count"),f=R.s("grid.column.count");if(0>=P||0>=f||0>S||S>=P||0>x||x>=f)return C;var O,b,U,I=R.getRect(),j=R.s("grid.row.percents"),Y=R.s("grid.column.percents");if(zl(I,R,"grid.border",-1),j&&j._as&&(j=j._as),Y&&Y._as&&(Y=Y._as),j&&j.length===P){for(U=0,O=0;S>O;O++)U+=I.height*j[O];I.y+=U,I.height=I.height*j[S]}else I.height=I.height/P,I.y+=I.height*S;if(Y&&Y.length===f){for(b=0,O=0;x>O;O++)b+=I.width*Y[O];I.x+=b,I.width=I.width*Y[x]}else I.width=I.width/f,I.x+=I.width*x;return Ud(I,-R.s("grid.gap")),I}});var Xm=u.Text=function(){Nm(Xm,this),this.setSize(100,50),this.s("text","TEXT")};rq("Text",dg,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Im},setWidth:function(D){D||(D=.001),Xm.superClass.setWidth.call(this,D)},setHeight:function(j){j||(j=.001),Xm.superClass.setHeight.call(this,j)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),pq("__text__",{width:{value:100,isSafeFunc:!0,func:function(c){return c._width}},height:{value:50,isSafeFunc:!0,func:function(G){return G._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var zb=u.Shape=function(){Nm(zb,this),this._59O=new Oh};zb.__de__=hl,rq("Shape",dg,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Vl},_22Q:function(){return Ni},getLength:function(s){return Cl(kk(this._59O,this._58O,s,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var v=this._58O;return v?new Oh(v._as.slice(0)):v},setSegments:function(f){var y=this._58O;f=f?ij(f)?new Oh(f.slice(0)):new Oh(f._as.slice(0)):null,(y&&f&&y._as.join(",")!==f._as.join(",")||y!==f)&&(this._58O=f,this.fp("segments",y,f))},getPoints:function(){return this._59O},toPoints:function(){var n=this._59O;return new Oh(n._as.slice(0))},setPoints:function(B,w){var r=this,c=r._59O;B=B?ij(B)?new Oh(B.slice(0)):new Oh(B._as.slice(0)):new Oh;var R,g,F,O,v,o;w&&(R=r.getPosition(),o=new Aq(r.getRotation(),0,0,r.getScale().x,r.getScale().y)),(c&&B&&c._as.join(",")!==B._as.join(",")||c!==B)&&(r._59O=B,r.fs(),r.fp("points",c,B)),w&&(g=r.getPosition(),F=g.x-R.x,O=g.y-R.y,v=o.tf(F,O),r.setPosition(g.x-F+v.x,g.y-O+v.y))},addPoint:function(D,p,i){var M=this.toPoints();M.add(D,p),this.setPoints(M,i)},setPoint:function(j,c,N){var i=this.toPoints();i.set(j,c),this.setPoints(i,N)},removePointAt:function(N){var x=this.toPoints();x.removeAt(N),this.setPoints(x)},setWidth:function(k){var h=this;if(1>k&&(k=1),!h._55I&&!Zr&&h.getWidth()){h._55I=1;var x=h._position.x,u=k/h.getWidth(),I=h.toPoints(),J=new Oh;I.each(function(Q){J.add({x:(Q.x-x)*u+x,y:Q.y,e:Q.e})}),h.setPoints(J),ep(h,[u,0,0,1,x*(1-u),0]),h.fs(),delete h._55I}zb.superClass.setWidth.call(h,k)},setHeight:function(v){var N=this;if(1>v&&(v=1),!N._55I&&!Zr&&N.getHeight()){N._55I=1;var U=N._position.y,r=v/N.getHeight(),W=N.toPoints(),y=new Oh;W.each(function(b){y.add({x:b.x,y:(b.y-U)*r+U,e:b.e})}),N.setPoints(y),ep(N,[1,0,0,r,0,U*(1-r)]),N.fs(),delete N._55I}zb.superClass.setHeight.call(N,v)},setAnchorElevation:function($){var C=this;C._55I=!0;var f=C._updatingAnchor3d,i=!Zr&&!f;if(i){var b,o=$,U=C.getAnchorElevation(),t=C.getTall();b=t*(U-o),C.shiftPointsElevation(b)}var u=zb.superClass.setAnchorElevation.apply(C,arguments);return f||delete C._55I,u},getShapeElevation:function(){var d=this,g=d._54O;return g-(d.getTall()||0)*(d._anchorElevation-.5)},setAnchor3d:function(a,S,c,t){var O,V=this;"number"==typeof a?O={x:a,y:S,z:c}:(O=a.length?{x:a[0],y:a[1],z:a[2]}:a,t=S),V._55I=!0,V._updatingAnchor3d=!0;var D=V.getDataModel();if(D&&D.beginTransaction(),!Zr){var L=V.getAnchor3d(),h=V.getSize(),g=V.getTall(),m=h.width*(L.x-O.x),F=h.height*(L.z-O.z),J=g*(L.y-O.y);t||V.shiftPoints(m,F,J);var N=V.p3()}var T=zb.superClass.setAnchor3d.apply(V,arguments);if(!Zr&&t){var G=V.p3();V.shiftPoints(G[0]-N[0]+m,G[2]-N[2]+F,G[1]-N[1]+J)}return D&&D.endTransaction(),delete V._updatingAnchor3d,delete V._55I,T},setAnchor:function(E,O,T){var j=this;j._55I=!0;var p=j._updatingAnchor3d,Y=!Zr&&!p;if(Y){var o,Z,y;"number"==typeof E?y={x:E,y:O}:(y=E.length?{x:E[0],y:E[1]}:E,T=O);var v=j.getAnchor(),A=j.getSize();o=A.width*(v.x-y.x),Z=A.height*(v.y-y.y),T||j.shiftPoints(o,Z);var N=j.getPosition()}var s=zb.superClass.setAnchor.apply(j,arguments);if(Y){var V=j.getPosition();T&&j.shiftPoints(V.x-N.x+o,V.y-N.y+Z)}return p||delete j._55I,s},shiftPoints:function(U,r,u){var f=this,s=f.getElevation()||0,l=f.toPoints(),F=new Oh;l.each(function(i){var d=i.e;u&&(d=(d==C?s:d)+u),F.add({x:i.x+U,y:i.y+r,e:d})}),f.setPoints(F),f.fs()},shiftPointsElevation:function(e){return this.shiftPoints(0,0,e)},setPosition:function(m,$){var p,A=this;if(!A._28Q){if(A._28Q=1,!A._55I&&!Zr){p=2===arguments.length?{x:m,y:$}:m;var N=p.x-A._position.x,c=p.y-A._position.y;if(0===N&&0===c)return delete A._28Q,void 0;A._55I=1,A.shiftPoints(N,c),ep(A,[1,0,0,1,N,c]),delete A._55I}zb.superClass.setPosition.apply(A,arguments),delete A._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var k=this;if(2!==k._59O.size())return!1;var b=k._58O;return b?2===b.size()&&1===b.get(0)&&2===b.get(1)?!0:!1:!0},fireShapeChange:function(){var T=this;if(!T._55I&&!Zr){var S=xo(T._59O);S&&(T._55I=1,T.setRect(S),delete T._55I)}T.fp(Dr,!1,!0)},getSerializableProperties:function(){var i=zb.superClass.getSerializableProperties.call(this);return i.segments=1,i.points=1,i.thickness=1,i.closePath=1,i}});var tl=u.Polyline=function(){Nm(tl,this),this.s({"shape.background":null,"shape.border.width":2})};rq("Polyline",zb,{_icon:"polyline_icon",_22Q:function(){return Gh},getUIClass:function(){return ip},setClosePath:function(){},setTall:function(G){var x=this;if(!x._55I&&!x._24Q&&!Zr&&x.getTall()){x._24Q=1;var t=x._54O,N=G/x.getTall();x._59O.each(function(z){z.e=z.e==C?t:(z.e-t)*N+t}),x.fs(),delete x._24Q}tl.superClass.setTall.call(x,G)},setElevation:function(f){var k=this;if(!k._55I&&!k._24Q&&!Zr){k._24Q=1;var K=f-k._54O;k._59O.each(function(b){b.e==C?b.e=f:b.e+=K}),k.fs(),delete k._24Q}tl.superClass.setElevation.apply(k,arguments)},fireShapeChange:function(){var S=this,y=S._59O;if(!S._55I&&!S._24Q&&!Zr){var I=y.size();if(I){var i=1,q=y.get(0),f=S._54O;q.e==C&&(q.e=f);for(var e=q.e,b=0;I>i;i++){q=y.get(i),q.e==C&&(q.e=f);var D=x(e,q.e),t=F(e+b,q.e);e=D,b=t-D}S._24Q=1,S.setTall(b),S.setElevation(e+b*S._anchorElevation),delete S._24Q}}tl.superClass.fireShapeChange.apply(S,arguments)}});var Vm=u.SubGraph=function(){Nm(Vm,this)};rq("SubGraph",dg,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Vm.superClass._8I.call(this),this.eachChild(function(J){Cp(J)&&J._8I()})}}),v.loadingRefGraph=0;var Xg=u.RefGraph=function(){Nm(Xg,this)};rq("RefGraph",vi,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(J){var n=this._ref;this._ref=J,this.fp("ref",n,J),this.updateRef()},_21I:function(){Xg.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var Z=this;if(v.loadingRefGraph++,Z.clearChildrenFromDataModel(),v.loadingRefGraph--,Z._ref&&Z._dataModel){Z._xhrLoadHandler&&(Z._xhrLoadHandler.cancel=!0);var _=Zr,h=Z._xhrLoadHandler=function(K){if(K&&Z._dataModel){v.loadingRefGraph++;var r=Z._pendingUpdateInfo={needToRestore:_};_&&(r.position=Z.p(),r.width=Z.getWidth(),r.height=Z.getHeight(),r.rotation=Z.getRotation(),r.anchor=Z.getAnchor(),r.scale=Z.getScale()),Z.p(0,0),Z.setAnchor(.5,.5),Z.setRotation(0),Z.setScale(1,1);var h=v.parse(K),L=Z._dataModel.deserialize(h,Z,{justDatas:!0});L.each(function(n){n._refGraph=Z}),Z.checkPendingUpdateInfo(),v.loadingRefGraph--,v.handleRefGraphLoaded(Z,L,h)}};h.xhrLoadCalled=!1,v.load(Z._ref,function(r){h.cancel||(h.xhrLoadCalled?h(r):pp(function(){h(r)}))}),h.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var $=this,x=$._pendingUpdateInfo;if(!x)return $.onPendingUpdated&&(v.loadingRefGraph++,$.onPendingUpdated(),v.loadingRefGraph--),void 0;var r=!0;this.eachChild(function(g){(g._pendingCheckImageJSON||g._pendingUpdateInfo)&&(r=!1)}),r&&(v.loadingRefGraph++,$._pendingUpdateInfo=null,$.updateFromChildren(),x.needToRestore&&($.setSize(x.width,x.height),$.setAnchor(x.anchor),$.setRotation(x.rotation),$.setScale(x.scale),$.p(x.position)),this.getParent()instanceof Xg&&this.getParent().checkPendingUpdateInfo(),$.onPendingUpdated&&$.onPendingUpdated(),v.loadingRefGraph--)},getSerializableProperties:function(){var l=Xg.superClass.getSerializableProperties.call(this);return l.ref=1,l}}),u.EdgeGroup=function(M,s){this._70O=M,this._siblings=s;for(var D,q,i=0,z=M.size(),y=w[Vc];z>i;i++)if(D=M.get(i).getStyle(Vc,!1),D!=C){y=D;break}y==C&&(y=!0);var l=v.edgeGroupAgentFunc;for(l&&(q=l(M),q&&q!==M.get(0)&&(M.remove(q),M.add(q,0))),i=0;z>i;i++)M.get(i).s(Vc,y)},rq("EdgeGroup",m,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(H){return this._70O.get(H)},indexOf:function(Z){return this._70O.indexOf(Z)},each:function(h,m){this._70O.each(h,m)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(b,C){this._siblings.each(function(Z){Z._70O.each(b,C)})}});var Pg=function(L,w,H){var p=Jm[L]={type:L,action:w};if(H)for(var Y in H)p[Y]=H[Y]};xj(v,{setConnectAction:Pg,getConnectAction:function(L,b){if(!b){if(!L)return null;b=L.getCurrentConnectActionType()}return Jm[b]},doConnectAction:function(H,O,o,c){c=c||H.getCurrentConnectActionType();var g=Jm[c];if(!g)return!1;var b=g.action;return b?(O instanceof Ql.Group?H.sm().getSelection().each(function(E){b.call(null,H,E,o)}):b.call(null,H,O,o),!0):!1},doDeleteConnectionAction:function(c,M,R){R=R||c.getCurrentConnectActionType();var U=Jm[R];if(!U||!U.delete)return!1;var $=U.delete.action;return $?(M instanceof Ql.Group?c.sm().getSelection().each(function(P){$.call(null,c,P)}):$.call(null,c,M),!0):!1}});var Ph=u.JSONSerializer=function(u,g){this.dm=this._dataModel=u,this._hierarchical=v.forceHierarchicalSerialization?!0:g==C?u.isHierarchicalRendering():g};rq("JSONSerializer",m,{ms_ac:["hierarchical"],serialize:function(R){return v.stringify(this.toJSON(),R)},toJSON:function(){var m=this,e=m.dm,g=e.getRoots(),G=m.json={v:v.getVersion(),p:{},a:{},d:[]},I=e.getSerializableAttrs();e.getInit()&&(G.init=e.getInit()),e.getName()&&(G.p.name=e.getName()),e.getBackground()&&(G.p.background=e.getBackground()),e.getLayers()&&(G.p.layers=e.getLayers()),G.p.autoAdjustIndex=e.isAutoAdjustIndex(),G.p.hierarchicalRendering=e.isHierarchicalRendering();for(var p in I){var f=e.a(p);f!==r&&m[ki](p,f,G.a)}return Ye(G.a)&&delete G.a,m._hierarchical?g.each(m.serializeData,this):e.each(function(y){m.serializeData(y)}),G},isSerializable:function(){return!0},getProperties:function(e){return e.getSerializableProperties()},getStyles:function(g){return g.getSerializableStyles()},getAttrs:function(d){return d.getSerializableAttrs()},serializeData:function(N){var d=this;if(d.isSerializable(N)&&!N._refGraph){var F,$,C,s,x=Vk(N.getClassName())||N.getClass(),b=new x,u={c:N.getClassName(),i:N.getId(),p:{},s:{},a:{}};d.json.d.push(u),F=d.getProperties(N);for($ in F)/^_/.test($)?(C=N[$],C!==b[$]&&d[ki]($.substr(1),C,u.p)):(s=wh($),N[s]&&(C=N[s](),C!==b[s]()&&d[ki]($,C,u.p)));F=d.getStyles(N);for($ in F)C=N.s($),C!==b.s($)&&d[ki]($,C,u.s);F=d.getAttrs(N);for($ in F)C=N.a($),C!==b.a($)&&d[ki]($,C,u.a);Ye(u.p)&&delete u.p,Ye(u.s)&&delete u.s,Ye(u.a)&&delete u.a}d._hierarchical&&N.getChildren().each(d.serializeData,d)},serializeValue:function(d,D,o){Sb(D)?D={__a:D._as}:D instanceof ap&&(D={__i:D.getId()}),o[d]=D},deserialize:function(n,e,H){var k=this,r=k.dm;r.beginTransaction(),Zr++,H=Yi(H)?{setId:H}:H||{},n=k.json=Ai(n)?v.parse(n):n,k._82I={};var x=new Oh,c=new Oh,s=0,R=n.d.length;if(H.justDatas||(bk(n.init)&&n.init(r),r.setInit(n.init)),!H.justDatas){for(var g in n.a)r.a(g,k[fk](n.a[g]));for(var o in n.p)r[Qp(o)](n.p[o])}for(;R>s;s++){var N=n.d[s],d=Vk(N.c),u=new d,J=N.i;H.setId&&J!=C&&(u._id=J),k._82I[J]=u,x.add(u),c.add(N)}for(s=0;R>s;s++)k.deserializeData(x.get(s),c.get(s));return x.each(function(u){e&&!u.getParent()&&u.setParent(e),r.add(u)}),Zr--,r.endTransaction(),x},deserializeData:function(A,S){for(var g in S.p)A[Qp(g)](this[fk](S.p[g]));for(g in S.s)A.s(g,this[fk](S.s[g]));for(g in S.a)A.a(g,this[fk](S.a[g]))},deserializeValue:function(E){if(vl(E)){var g=E.__i;if(g!=C)return this._82I[g];if(g=E.__a,ij(g))return new Oh(g)}return E}}),xj(Pb,{serialize:function(h,e){return new Ph(this,e).serialize(h)},toJSON:function(c){return new Ph(this,c).toJSON()},deserialize:function(Y,v,c){return new Ph(this).deserialize(Y,v,c)}});var Id=u.OverlappingBox=function(F){this.gv=F,this.boxes={}};rq("OverlappingBox",m,{clear:function(){var k,v,x=this.boxes;for(k in x)v=x[k],v.length=0},isOverlapping:function(t,Z){var m,F,V=this,z=V.boxes,N=z[t];N?(m=N.rects,F=N.length):N=z[t]={rects:m=[],length:F=0};var X,_,Z;for(X=0;F>X;X++)if(_=m[X],_.x<Z.x+Z.w&&_.x+_.w>Z.x&&_.y<Z.y+Z.h&&_.h+_.y>Z.y)return!0;return m.length<=F?(m.push(Z),N.length++):m[N.length++]=Z,!1}}),Iq.GraphView=function(m){var Z=this;Z._24I={},Z._34I=new Oh,Z._25I={},Z._56I={},Z._view=ei(1,Z),Z._canvas=tc(Z._view),Z.dm(m?m:new Pb),this._coreInteractor=new Lf(this),Z.setEditable(!1),Z.setScrollBarVisible(v.graphViewScrollBarVisible)},dc("GraphView",m,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Qk,vp,Bc,$j,"resettable","editInteractor",mf,"pannable","rectSelectable","autoScrollZone",df,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:v.graphViewResettable,_pannable:v.graphViewPannable,_rectSelectable:v.graphViewRectSelectable,_autoScrollZone:v.graphViewAutoScrollZone,_rectSelectBackground:v.graphViewRectSelectBackground,_rectSelectBorderColor:v.graphViewRectSelectBorderColor,_editPointSize:v.graphViewEditPointSize,_editPointBorderColor:v.graphViewEditPointBorderColor,_editPointBackground:v.graphViewEditPointBackground,_scrollBarColor:Qg,_scrollBarSize:mk,_autoHideScrollBar:Vn,_autoMakeVisible:Kj,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(r){this._dataModel.setLayers(r)},setEditable:function(X){var p=this,o=p.__interactorMap__;if(!o){var s=Iq.XEditInteractor;o=p.__interactorMap__={scrollBar:new xq(p),select:new Og(p),edit:s?new s(p):new Nq(p),move:new rs(p),"default":new jh(p),touch:new Uc(p,{editable:!1})}}X?(p._uieditable=!0,p.setInteractors([o.scrollBar,o.select,o.edit,o.move,o.default,o.touch])):(p._uieditable=!1,p.setInteractors([o.scrollBar,o.select,o.move,o.default,o.touch]))},getCanvas:function(){return this._canvas},_33I:function(E){var h=E.getUIClass();return h?new h(this,E):C},getDataUI:function(z){var m=this,H=m._25I[z._id];return H===r&&(H=m._33I(z),m._25I[z._id]=H),H},getNodeRect:function(J){return v.getNodeRect(this,J)},getEdgeInfo:function(T){var p=this.getDataUI(T);return p?(p._79o(),p._78o):null},getEdgeSourcePosition:function(W){var O=this,r=O.getDataUI(W),o=r.s,s=r._data._40I;return Fb(O,s,o("edge.source.position"),o("edge.source.offset.x"),o("edge.source.offset.y"),o("edge.source.anchor.x"),o("edge.source.anchor.y"))},getEdgeTargetPosition:function(k){var p=this,z=p.getDataUI(k),y=z.s,J=z._data._41I;return Fb(p,J,y("edge.target.position"),y("edge.target.offset.x"),y("edge.target.offset.y"),y("edge.target.anchor.x"),y("edge.target.anchor.y"))},invalidateAll:function($){var c=this;if($){for(var P in c._25I){var s=c._25I[P];s&&s.dispose()}c._25I={},c._56I={},c._24I={},c._34I.clear(),c.redraw()}else c.dm().each(function(i){c.invalidateData(i)})},invalidateSelection:function(){var b=this;b.sm().each(function(M){b.invalidateData(M)})},invalidateData:function(M){var l=this;l._24I[M._id]=M,l._21Q(M),l.iv()},_21Q:function($){var S=this,b=S._24I;if(Uk($)&&Nk[$.s(yq)]){var W=$.getSourceAgent();W&&W.getAgentEdges().each(function(i){b[i._id]=i}),W=$.getTargetAgent(),W&&W.getAgentEdges().each(function(S){b[S._id]=S}),S.iv()}},redraw:function(H){var Y=this;Y._32I||(H?Y._34I.add(H):(Y._32I=1,Y._34I.clear()),Y.iv())},each:function(H,P){var F,J,k,M=0,Q=this.getLayers(),g=this._dataModel,T=g._datas._as,f=T.length;if(Q){for(var O=Q.length;O>M;M++)if(k=Q[M],vl(k)&&(k=k.name),g.isHierarchicalRendering()){var D=function(i){return i._layer===k?P?H.call(P,i):H(i):void 0};if(this._dataModel.eachByHierarchical(D)===!1)return}else for(var c=0;f>c;c++)if(F=T[c],F._layer===k&&(J=P?H.call(P,F):H(F),J===!1))return}else if(g.isHierarchicalRendering())this._dataModel.eachByHierarchical(H,null,P);else for(;f>M;M++)if(F=T[M],J=P?H.call(P,F):H(F),J===!1)return},reverseEach:function(E,X){var d,M,V,_,J=this._dataModel,O=J._layers,n=J._datas._as,k=n.length;if(O){for(d=O.length-1;d>=0;d--)if(_=O[d],vl(_)&&(_=_.name),J.isHierarchicalRendering()){var B=function(S){return S._layer===_?X?E.call(X,S):E(S):void 0};if(J.reverseEachByHierarchical(B)===!1)return}else for(var e=k-1;e>=0;e--)if(M=n[e],M._layer===_&&(V=X?E.call(X,M):E(M),V===!1))return}else if(J.isHierarchicalRendering())J.reverseEachByHierarchical(E,null,X);else for(d=k-1;d>=0;d--)if(M=n[d],V=X?E.call(X,M):E(M),V===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var e=this,B=e._84I;if(!B){var a=this.dm().a("width"),O=this.dm().a("height");a>0&&O>0?e._84I={x:0,y:0,width:a,height:O}:(e.each(function(q){e.isVisible(q)&&(B=$k(B,e.getDataUIBounds(q)))}),e._84I=B?B:Hk)}return e._84I},getScrollRect:function(){return $k(this.getContentRect(),this._29I)},makeCenter:function(R,U,i){var w=this;if(!w.getWidth()||!w.getHeight())return i||pp(w.centerData,w,[R,U,!0],500),void 0;w.makeVisible(R),w.validate();var d=w.getDataUIBounds(R);if(d){var r=w.getWidth(),Z=w.getHeight(),T=d.x+d.width/2,D=d.y+d.height/2,V=-T*w._zoom+r/2,X=-D*w._zoom+Z/2;w.setTranslate(V,X,U)}},fitData:function(n,w,q,u,D){var f=this;if(!f.getWidth()||!f.getHeight())return D||pp(f.fitData,f,[n,w,q,u,!0],500),void 0;var h=function(){f.makeVisible(n),f.validate();var D=f.getDataUIBounds(n);D&&(D=Io(D),Ud(D,q==C?20:q),f.fitRect(D,w,u))};w?v.callWhenLoaded(h):h()},fitContent:function(U,X,k,h){var A=this;if(!A.getWidth()||!A.getHeight())return h||pp(A.fitContent,A,[U,X,k,!0],500),void 0;var d=function(){A.validate();var e=Io(A.getContentRect());Ud(e,X==C?20:X),A.fitRect(e,U,k)};U?v.callWhenLoaded(d):d()},fitRect:function(V,$,v){var c=this,k=c.getWidth(),i=c.getHeight(),n=V.x+V.width/2,H=V.y+V.height/2,Y=x(k/V.width,i/V.height),T=c._zoom,K=-n*T+k/2,b=-H*T+i/2;0===Y||isNaN(Y)||(v&&(Y=x(1,Y)),$?(c._65I&&(delete c._65I.finishFunc,c._65I.stop(!0)),c._14o&&c._14o.stop(!0),c.setTranslate(K,b,{finishFunc:function(){c.setZoom(Y,$)
}})):(c.setTranslate(K,b),c.setZoom(Y)))},toCanvas:function(g,T){T=T||this._zoom,this.validateImpl();var Y=this,W=Y.getContentRect();W.width||(W.width=10),W.height||(W.height=10);var h=tc(),c=W.x*T,x=W.y*T,E=W.width*T,Q=W.height*T;Rn(h,E,Q,1);var j=Tp(h);return g=g||this._dataModel.getBackground(),g&&Qh(j,0,0,E,Q,g),of(j,-c,-x),j.scale(T,T),Y._42(j),j.restore(),h},toDataURL:function(f,Z,Q){return this.toCanvas(f,Q).toDataURL(Z||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(S,l){var f=this;f._93db(S,l),f.each(function(q){var U=f.getDataUI(q);if(U){var A=f._56I[q._id],t=U._htmlView;if(A){var J=U._79o();if(t=U._htmlView,u.HtmlNode&&q instanceof u.HtmlNode)U._42(S);else{var m=f.getViewRect(),E=t&&t.layoutHTML;!l||cj(l,J)?(E&&(t.layoutHTML(),U.__outerLayout&&delete U.__outerLayout),U._42(S)):cj(m,J)||!E||U.__outerLayout||(t.layoutHTML(),U.__outerLayout=!0)}}t&&(t.getView&&(t=t.getView()),t.style.display=A?"block":um)}}),f._92db(S,l)},validateImpl:function(){var Q,B,K,$,J,D=this,T=D.tx(),M=D.ty(),Z=D._zoom,C=D._canvas,p=this.getWidth(),o=this.getHeight(),Y=D._29I,g={x:-T/Z,y:-M/Z,width:p/Z,height:o/Z},x={},O=D._34I,I=D._24I,y=D._32I,X=D._23I;D._24I={},(p!==C.clientWidth||o!==C.clientHeight)&&(Rn(C,p,o),y=1),y||eb(g,Y)||(y=1),D._29I=g,D.each(function(l){B=l._id;var d=x[B]=D.isVisible(l);d!==D._56I[B]&&(I[B]=l,K=D.getDataUI(I[B]),K&&K._84o(d),D._84o(l,d))},D);for(B in I)K=D.getDataUI(I[B]),K&&(!y&&D._56I[B]&&(J=K._79o(),J&&O.add(J)),K.invalidate()),D._83I=1;if(D._56I=x,!y)for(B in I)x[B]&&(K=D.getDataUI(I[B]),K&&(J=K._79o(),J&&O.add(J)));if(y?$=g:(O.each(function(W){cj(g,W)&&($=$k($,W))}),$&&(Ud($,F(1,1/Z)),$.x=b($.x*Z)/Z,$.y=b($.y*Z)/Z,$.width=k($.width*Z)/Z,$.height=k($.height*Z)/Z,$=Ep(g,$))),D._74O=$,$){Q=Tp(C);var t=$.x,r=$.y,i=$.width,N=$.height;t=Math.floor((t*Z+T)*Kb),r=Math.floor((r*Z+M)*Kb),i=Math.ceil(i*Z*Kb)+1,N=Math.ceil(N*Z*Kb)+1,Q.beginPath(),Q.rect(t,r,i,N),Q.clip(),Q.clearRect(t,r,i,N),sg(Q,T,M,Z),D._42(Q,$),Q.restore(),delete D._74O}if(O.clear(),delete D._32I,X&&p>0&&o>0){var K=D.getDataUI(X);if(K){var J=K._79o(),u=D._29I,d=u.x,m=u.y,G=u.width,c=u.height,Z=D._zoom;J&&!cj(J,u)&&(J.x+J.width<d&&D.tx(-J.x*Z),J.x>d+G&&D.tx(-(J.x+J.width-G)*Z),J.y+J.height<m&&D.ty(-J.y*Z),J.y>m+c&&D.ty(-(J.y+J.height-c)*Z))}delete D._23I}D._83I&&(delete D._83I,delete D._84I),D._98O(),Ye(D._24I)||pp(D.iv,D)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(s){var N=this;s!==N.isScrollBarVisible()&&(s?(Ap(N._view,N._79O=gh()),Ap(N._79O,N._27I=gh()),Ap(N._79O,N._28I=gh())):(ks(N._79O),delete N._79O,delete N._27I,delete N._28I),N.fp("scrollBarVisible",!s,s))},showScrollBar:function(){var H=this;H._79O&&(H._85I||(i(function(){H._86I()},kl),H.iv()),H._85I=new Date)},_86I:function(){var $=this;if($._85I){var H=new Date,D=H.getTime();D-$._85I.getTime()>=kl?(delete $._85I,$.iv()):i(function(){$._86I()},kl)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var G=this,h=this._27I,a=this._28I;if(G._79O){if(G._autoHideScrollBar&&!G._85I)return h.style.visibility=Cs,a.style.visibility=Cs,void 0;var Y=G.getScrollBarColor(),x=G._zoom,M=G.getScrollBarSize(),q=G.getViewRect(),Q=G.getScrollRect(),c=q.height*x,g=Q.height*x,T=q.width*x-M-2,D=c*((q.y-Q.y)*x/g),z=c*(c/g),e=h.style;g-.5>c?(ao>z&&(D=D+z/2-ao/2,0>D&&(D=0),D+ao>c&&(D=c-ao),z=ao),re(h,T,D,M,z),e.visibility=gk,e.background=Y,e.borderRadius=M/2+bi):e.visibility=Cs;var n=q.width*x,L=Q.width*x,D=q.height*x-M-2,T=n*((q.x-Q.x)*x/L),F=n*(n/L),e=a.style;L-.5>n?(ao>F&&(T=T+F/2-ao/2,0>T&&(T=0),T+ao>n&&(T=n-ao),F=ao),re(a,T,D,F,M),e.visibility=gk,e.background=Y,e.borderRadius=M/2+bi):e.visibility=Cs}},setDataModel:function(L){var N=this,s=N._dataModel,W=N._selectionModel;s!==L&&(s&&(s.ump(N.handleDataModelPropertyChange,N),s.umm(N.handleDataModelChange,N),s.umd(N.handleDataPropertyChange,N),s.removeIndexChangeListener(N._75O,N),s.removeHierarchyChangeListener(N.handleHierarchyChange,N),W||s.sm().ums(N.handleSelectionChange,N)),N._dataModel=L,L.mp(N.handleDataModelPropertyChange,N),L.mm(N.handleDataModelChange,N),L.md(N.handleDataPropertyChange,N),L.addIndexChangeListener(N._75O,N),L.addHierarchyChangeListener(N.handleHierarchyChange,N),W?W._21I(L):L.sm().ms(N.handleSelectionChange,N),N.invalidateAll(!0),N.fp(Hi,s,L),N._canvas.style.background=L.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===r){var G=this.getLayers();G?(this._layersInfo={},G.forEach(function(O){var U=vl(O)?O.name:O;this._layersInfo[U]=O},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=r,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(M){if("background"===M.property){var i=this._canvas.style.background,e=M.newValue||"";this._canvas.style.background=e,this.fp("canvasBackground",i,e)}else"a:width"===M.property||"a:height"===M.property?(this._83I=1,this.redraw()):"layers"===M.property?this.updateLayers():"hierarchicalRendering"===M.property&&this.redraw()},handleDataPropertyChange:function(g){this.dm().isHierarchicalRendering()&&"parent"===g.property&&g.data.hasChildren()&&this.redraw(),this.invalidateData(g.data)},onPropertyChanged:function(X){var N=this,o=X.property;if(N.redraw(),"zoom"===o){var r=N.sm().getSelection();r.size()&&r.each(function(U){U.invalidate()})}Sk[o]?N.showScrollBar():o===mf&&N.onCurrentSubGraphChanged(X)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(A){var r=this,s=A.kind,f=A.data;if(r._83I=1,"add"===s)r.invalidateData(f),Uk(f)&&f.getEdgeGroup()&&f.getEdgeGroup().eachSiblingEdge(r.invalidateData,r);else if(s===uc){r._21Q(f);var p=f._id,j=r._25I[p];if(j){if(r._56I[p]){var S=j._79o();S&&r.redraw(S)}j.dispose(),delete r._25I[p],delete r._24I[p],delete r._56I[p]}f===r._currentSubGraph&&r.setCurrentSubGraph(C)}else s===Hl&&(r.invalidateAll(!0),r.setCurrentSubGraph(C))},_75O:function(m){this.invalidateData(m.data)},handleHierarchyChange:function(I){this.dm().isHierarchicalRendering()&&I.data.hasChildren()&&this.redraw(),this.invalidateData(I.data)},adjustIndex:function($){var T=this;if(T.isVisible($)){T.dm().beginTransaction();for(var h=$;h._parent&&T.isVisible(h._parent);)h=h._parent;h&&h!==$&&T._dataModel.adjustIndex(h),T._dataModel.adjustIndex($),T.dm().endTransaction()}},getImage:function(L){return L.getImage?L.getImage():r},getSelectWidth:function(q){var i=Sg(this.getImage(q));return i&&Gb(i.disableSelectedBorder,q,this)?0:q.s("select.width")},getSelectColor:function(W){return W.s("select.color")},isSelectable:function(q){if(!this._clickThroughChecking&&q.getParent()instanceof vi&&q.getParent().isSyncSize())return!1;var K=this.getLayersInfo();if(K){var e=K[q._layer];if(e&&e.selectable===!1)return!1}return q.s("2d.selectable")&&this.sm().isSelectable(q)},isMovable:function(R){var _=this;if(Uk(R)&&R.getStyle(yq)!==lk)return!1;var i=this.getLayersInfo();if(i){var J=i[R._layer];if(J&&J.movable===!1)return!1}return R.s("2d.movable")?_._movableFunc?_._movableFunc(R):!0:!1},isEditable:function(v){var R=this;if(u._uiSerializing)return R._uieditable;if(!R._editInteractor||!R.isSelected(v))return!1;if(Pq(v)){var T=R.getDataUI(v);if(!T||T._88I)return!1}if(Uk(v)&&v.getStyle(yq)!==lk)return!1;var g=this.getLayersInfo();if(g){var D=g[v._layer];if(D&&D.editable===!1)return!1}return v.s("2d.editable")?R._editableFunc?R._editableFunc(v):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(l){return Cp(l)&&0!==l.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(l):!0},isRectEditable:function(U){return this._rectEditableFunc?this._rectEditableFunc(U):!0},isAnchorEditable:function(v){return this._anchorEditableFunc?this._anchorEditableFunc(v):!0},isRotationEditable:function(n){return n.setRotation&&n.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(n):!0:!1},getRotationPoint:function(l){var w=l.getAnchor(),k=l.getScale(),h=this._zoom,Y=ck(l.getRotation(),0,-l.getHeight()*k.y*w.y-(k.y<0?-1:1)*(_n?32:16)/h),A=l.p();return Y.x+=A.x,Y.y+=A.y,Y},getLogicalPoint:function(y){var M=this;return Al(y,M._canvas,M.tx(),M.ty(),M._zoom,M._zoom)},getScreenPoint:function(K,i){var s,L=this;return"object"==typeof K?K.x!==r?(s=K.x,i=K.y):(s=K[0],i=K[1]):s=K,qg(s,i,L._canvas,L.tx(),L.ty(),L._zoom,L._zoom)},getSelectedDataAt:function(T){var R=this;return this.getDataAt(T,function(r){return R.isSelected(r)})},getDataInfoAt:function(W,t,w){var y,e=this.lp(W),g=this.getDataAt(e,t,w);if(g){var J=this.getDataUI(g);y={data:g,ui:J,point:e};var Y=J._38o;if(Y){var N=Y.icons;for(var Q in N){var m=N[Q],j=Y.rects[Q];if(j)for(var P=Gb(m.names,g,this),_=P?P.length:0,I=j.rotation,v=_-1;v>=0;v--){var q=P[v],l=j[v];if(Ng(l,e,I))return y.part="icons",y.name=Q,y.icon=q,y.rect=l,y.index=v,y.rotation=I,y}}}if(this.isNoteVisible(g)){if(J.note2Info&&Ng(J.note2Info.clickRect,e,C,J.note2Info.scale))return y.part="note2",y;if(J.noteInfo&&Ng(J.noteInfo.clickRect,e,C,J.noteInfo.scale))return y.part="note",y}if(this.isLabelVisible(g)){if(J.label2Info&&Ng(J.label2Info.rect,e,J.label2Info.rotation,J.label2Info.scale))return y.part="label2",y;if(J.labelInfo&&Ng(J.labelInfo.rect,e,J.labelInfo.rotation,J.labelInfo.scale))return y.part="label",y}if(g.isInRect&&g.isInRect(e))return y.part="body",y}return y},getDataAt:function(K,q,_){K.target&&(K=this.lp(K));var T,H=this._zoom;return this.reverseEach(function(I){return(q?q(I):this.isSelectable(I))&&this.rectIntersects(I,om(K.x,K.y,_,H))?(T=I,!1):void 0},this),T},getIconInfoAt:function(R,H){var J=this;if(R.target&&(R=J.lp(R)),H||(H=J.getDataAt(R)),H){var U=J.getDataUI(H);if(U&&U._38o){var e,s=U._38o,F=new Oh;for(e in s.icons)F.add(e);for(var E=F.size()-1;E>=0;E--){e=F.get(E);for(var i=s.rects[e],f=i.rotation,t=i.length-1;t>=0;t--){var d=i[t],o=d.width,w=d.height,Z={x:R.x-d.x-o/2,y:R.y-d.y-w/2};f!=C&&(Z=ck(-f,Z.x,Z.y));var d={x:-o/2,y:-w/2,width:o,height:w};if(Ng(d,Z))return{key:e,index:t,name:s.icons[e].names[t],rect:i[t],point:R,rotation:f,relativeRect:d,relativePoint:Z,data:H}}}}}return C},getDatasInRect:function(X,F,q){q===r&&(q=1);var A=this,i=new Oh;return A.reverseEach(function(z){q&&!A.isSelectable(z)||(F?A.rectIntersects(z,X):A.rectContains(z,X))&&i.add(z)}),i},moveSelection:function(r,S){var q=this;q.dm().beginTransaction(),wr(q.sm().toSelection(q.isMovable,q),r,S),q.dm().endTransaction()},moveDatas:function(s,i,o){var X=this;X.dm().beginTransaction(),s instanceof Oh||(s=new Oh(s)),wr(s,i,o),X.dm().endTransaction()},getDataUIBounds:function(w){var h=this.getDataUI(w);return h?h._79o():C},drawData:function($,R,k){var t=this.getDataUI(R);if(t){var O=t._79o();(!k||cj(k,O))&&(t._42($),R instanceof u.Block&&R.eachChild(function(Z){this.drawData($,Z,k)},this))}},getBoundsForGroup:function(d){return d.s(Vj)?this.getDataUIBounds(d):C},isPixelPerfect:function(G){return G.s("pixelPerfect")},rectIntersects:function($,Q){this.validate();var N=C;if(this._56I[$._id]){var I=this._25I[$._id];if(I){var c=I._79o();if(Ii(Q,c))N=!0;else if((Q=Ep(Q,c))&&(I.rectIntersects&&(N=I.rectIntersects(Q)),N==C)){if(!this.isPixelPerfect($))return!0;var i=Q.x,u=Q.y,r=Q.width,k=Q.height,U=this._zoom,G=v.hitMaxArea,M=r*k*U*U;if(M>G){var x=Math.sqrt(G/M);U*=x}r*=U,k*=U,2>r&&(r=2),2>k&&(k=2),i*=U,u*=U;var f=kg(r,k);of(f,-i,-u),f.scale(U,U),this._drawForChecking=!0,this.drawData(f,$,Q),this._drawForChecking=!1;try{for(var B=0,d=f.getImageData(0,0,r,k).data;B<d.length;B+=4)if(0!==d[B+3]){N=!0;break}f.restore()}catch(T){tf=C,N=!1}}}}return N?!0:!1},rectContains:function(W,_){if(this._56I[W._id]){var Q=this._25I[W._id];if(Q)return Ii(_,Q._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(s){if(!v.isInput(s.target)){var m=this,q=m._focusData,X=q&&m._25I[q._id],t=0,U=m._dataModel._datas;if(!(q&&q._enabled&&q._editable&&X&&X.onKeyDown&&X.onKeyDown(s)===!0))if(9===s.keyCode&&(q&&(t=U.indexOf(q),Nh(s)?-1===--t&&(t=0):++t===U.size()&&(t=0)),m._focusData=q=U.get(t),m.sm().setSelection(q)),_q(s)?m.selectAll():Nf(s)&&m.isResettable()&&m.reset(),m.sm().isEmpty()){if(m._editing)return;var d=m.tx(),r=m.ty(),D=!1,Y=Nh()?100:10;Ab(s)&&(d-=Y,D=!0),Ad(s)&&(r-=Y,D=!0),Cj(s)&&(d+=Y,D=!0),hk(s)&&(r+=Y,D=!0),D&&m.setTranslate(d,r)}else{ud(s)&&m.handleDelete(s);var T=Nh()?10:1;Ab(s)&&(m.moveSelection(-T,0),m.fi({kind:"moveLeft"})),Ad(s)&&(m.moveSelection(0,-T),m.fi({kind:"moveUp"})),Cj(s)&&(m.moveSelection(T,0),m.fi({kind:"moveRight"})),hk(s)&&(m.moveSelection(0,T),m.fi({kind:"moveDown"}))}}},handleScroll:function($,i){if(Ib($),!this.getEditInteractor()){var Z=this.getDataAt($);if(Z){var P=Sg(this.getImage(Z));if(P&&Gb(P.scrollable,Z,this))return}}var Q=this.lp($);i>0?this.scrollZoomIn(Q):0>i&&this.scrollZoomOut(Q)},handlePinch:function(h,Q,f){this._68I||(Q>f?this.pinchZoomIn(h):this.pinchZoomOut(h))},checkDoubleClickOnNote:function(p,$){var E=this,x=E.lp(p),W=E.getDataUI($),V=W.note2Info;return V&&$.s("note2.toggleable")&&Ng(V.clickRect,x)?($.s(xd,!$.s(xd)),E.fi({kind:"toggleNote2",event:p,data:$}),!0):(V=W.noteInfo,V&&$.s("note.toggleable")&&Ng(V.clickRect,x)?($.s(Dl,!$.s(Dl)),E.fi({kind:"toggleNote",event:p,data:$}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(m,v){var G=this,j=G.getAutoScrollZone(),h=j/G.getZoom(),$=j/4,H=G._29I,F=G.lp(m),X={x:G.tx(),y:G.ty()};return F&&j>0&&H&&(F.x-H.x<h?G.translate($,0):H.x+H.width-F.x<h&&G.translate(-$,0),F.y-H.y<h?G.translate(0,$):H.y+H.height-F.y<h&&G.translate(0,-$)),X.x=G.tx()-X.x,X.y=G.ty()-X.y,v&&(v.x+=X.x,v.y+=X.y),X},getMoveMode:function(v,u){var j=u.s("2d.move.mode");return j?j:yp["88"]?"x":yp["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(t,H,U){var B=this;return"currentSubGraph"===H?{__i:t.getId()}:U.serializeProperty(t,H,B)},deserializeProperty:function(z,o,_){var M=this;if("currentSubGraph"===o){var P=M.dm(),l=P.__idMap;return l[z.__i]}return _.deserializeProperty(z,o,M)},setDefaultCursor:function(c,J){this._defaultCursor=c,J!==!1&&this.setCursor(c)},setCursor:function(u){"default"===u&&(u=this._defaultCursor||u);var w=this.getView().style;w.cursor=u,w.cursor="-webkit-"+u,w.cursor="-moz-"+u},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(G){return G===C||v.getConnectAction(null,G)?(this._currentActionType=G,this.redraw(),!0):!1},isConnectActionVisible:function(r){var l=v.getConnectAction(this);if(!l)return!1;var K=l.visible;return bk(K)&&(K=K(this,r)),K},isInteractive:function(F){var U=Sg(this.getImage(F));return U&&Gb(U.interactive,F,this)?!0:F.s("interactive")},appendHTML:function(E){var Q=this.getView();if(!E||E.parentNode===Q||E.getView&&E.getView()===Q)return!1;if(E.isSelfViewEvent)return E.addToDOM(Q),!0;E.getView&&(E=E.getView());var D=this.getCanvas().nextSibling;return D?Q.insertBefore(E,D):Ap(Q,E),!0},layoutHTML:function(y,R,t){var J,L=this,u=L._zoom;if(R.getView&&(J=R,R=R.getView()),R.style.position="absolute",t){var N=y.getRect();re(J||R,L.tx()+N.x*u,L.ty()+N.y*u,N.width*u,N.height*u)}else{var Z=new Co,N=y.getAnchorRect(),F=y.getPosition(),g=y.getScale(),M=R.style;re(J||R,N),Z.appendTranslate(L.tx(),L.ty()),Z.appendScale(u,u),Z.append(new Co(y.getRotation(),F.x,F.y,g.x,g.y)),Dq(M,"transform","matrix("+Z.a.toFixed(5)+", "+Z.b.toFixed(5)+", "+Z.c.toFixed(5)+",\n    "+Z.d.toFixed(5)+", "+Z.tx.toFixed(5)+", "+Z.ty.toFixed(5)+")"),Dq(M,"transformOrigin",(-N.x).toFixed(5)+"px "+(-N.y).toFixed(5)+"px"),R.maxtrixAppend=Z.invert().translate(-N.x,-N.y)}}});var Zc=function(W,Y){var f=this;f.gv=W,f.s=function(s){return Y.getStyle(s)},f._data=Y,f._87I=new Oh};rh(Zc,m,{_6I:C,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var X=this,F=X.gv.isSelected(X._data);return!F||X.isShadowed()?0:X.gv.getSelectWidth(X._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(q){var w=this._data,Z=this.gv.getBodyColor(w);return Z?Z:q?w.getStyle(q):C},_2Q:function(T){return this.s(T)},_1Q:function(O,t,I,K){var G=this.s,h=G(t+".dash.color");O.strokeStyle=h,O.lineWidth=I,O.stroke(),G(t+".dash.3d")&&Zn(O,h,G(t+".dash.3d.color"),I,this.gv._zoom,G(t+".dash.3d.accuracy")),ad(O,K)},invalidate:function(){this._6I=C},_79o:function(){var n=this;if(!n._6I){var G=n._data,w=n.gv;n.labelInfo=n.label2Info=n.noteInfo=n.note2Info=n._38o=C,n._87I.clear(),n.interactiveInfo=w.isInteractive(G)?{}:C,n._3O(),n._55O=w.isEditable(G)?{_42O:w.isRectEditable(G),_43O:w.isPointEditable(G),_56O:w.isRotationEditable(G)}:C,n._6I=n._81o()}return n._6I},_3O:function(){},getPosition:function(){return Hk},_68o:function(g,F){g&&this._87I.add(ql(g,F))},_81o:function(){var k=this,Y=k.s;k._24O(Xh,"getLabel"),k._24O(be,"getLabel2"),k._26O(Qb,"getNote"),k._26O(kb,"getNote2"),k._15O(),k._55O&&k._48O();var S;if(k._87I.each(function(G){S=$k(S,G)}),S&&k.isShadowed()){var c=Io(S);c.x+=Y("shadow.offset.x"),c.y+=Y("shadow.offset.y"),Ud(c,Y("shadow.blur")),S=$k(S,c)}return k._87I.clear(),S},_42:function(Z){var W=this,i=W._data,t=W.gv,s=W.s,v=s("opacity"),f=this.isShadowed();if(f){var H=Z.shadowOffsetX,V=Z.shadowOffsetY,L=Z.shadowBlur,r=Z.shadowColor,m=t.getZoom();Z.shadowOffsetX=s("shadow.offset.x")*m,Z.shadowOffsetY=s("shadow.offset.y")*m,Z.shadowBlur=s("shadow.blur")*m,Z.shadowColor=W.getSelectColor()}if(v!=C){var k=Z.globalAlpha;Z.globalAlpha=v}W._80o(Z),t.isLabelVisible(i)&&((!t._drawForChecking||s("label.selectable"))&&mj(Z,W.labelInfo),(!t._drawForChecking||s("label2.selectable"))&&mj(Z,W.label2Info)),t.isNoteVisible(i)&&(_c(Z,W.noteInfo),_c(Z,W.note2Info)),W._99O(Z),v!=C&&(Z.globalAlpha=k),f&&(Z.shadowOffsetX=H,Z.shadowOffsetY=V,Z.shadowBlur=L,Z.shadowColor=r)},_80o:function(){},_47O:function(){},_24O:function(u,D){var B=this,x=B._data,k=B.gv,N=B.s,O=k[D](x);if(O!=C){var h=N(u+".scale"),d=N(u+".max"),t=N(u+".position"),K=B[u+"Info"]={label:O,scale:h,color:k[D+"Color"](x),font:N(u+".font"),opacity:N(u+".opacity"),align:N(u+".align"),rotation:B.getRotation(N(u+".rotation"),!1,t),background:k[D+"Background"](x)},A=Uf(K,O);d>0&&d<A.width&&(K.labelWidth=A.width,A.width=d),1!==h&&(A.width*=h,A.height*=h);var l=B.getPosition(t,N(u+".offset.x"),N(u+".offset.y"),A,N(u+".position.fixed"));if(A.x=l.x-A.width/2,A.y=l.y-A.height/2,B._68o(K.rect=A,K.rotation),1!==h){var V=A.width/h,o=A.height/h;K.rect={x:l.x-V/2,y:l.y-o/2,width:V,height:o}}}},_26O:function(o,I){var E=this,O=E.gv,B=E._data,$=E.s,U=O[I](B);if(U!=C){var f,v,b=$(o+".scale"),J=E[o+"Info"]={note:U,scale:b,data:B,view:O,expanded:$(o+".expanded"),font:$(o+".font"),color:$(o+".color"),opacity:$(o+".opacity"),align:$(o+".align"),icon:$(o+".icon"),backgroundImage:$(o+".backgroundImage"),borderWidth:$(o+".border.width"),borderColor:$(o+".border.color"),background:O[I+"Background"](B)},V=E.getPosition($(o+".position"),$(o+".offset.x"),$(o+".offset.y")),W=V.x,Q=V.y;if(J.expanded){var F,p=$(o+".max"),d=$(o+".backgroundImage");d?(d=Sg(d),F={width:Ml(d,B),height:Zj(d,B)}):F=Uf(J,U),F.width+=6,F.height+=2,p>0&&p<F.width&&(J.labelWidth=F.width,F.width=p),f=F.width,v=F.height+8,J.clickRect={x:W-f*b/2,y:Q-v*b,width:f*b,height:v*b*F.height/v}}else{var g=$(o+".icon");g?(g=Sg(g),f=Ml(g,B),v=Zj(g,B)):(f=12,v=18),J.clickRect={x:W-f*b/2,y:Q-v*b,width:f*b,height:v*b}}J.rect={x:W-f/2,y:Q-v*b/2-v/2,width:f,height:v};var y=k(J.borderWidth/2)*b;E._68o({x:W-f*b/2-y,y:Q-v*b-y,width:f*b+2*y,height:v*b+2*y})}},_48O:function(){},_99O:function(o){var w=this,F=w._38o;if(F){var t=w.gv,y=w._data,R=F.icons,k=w.interactiveInfo;k&&(k._38o={});for(var I in R){var X=R[I],D=F.rects[I];if(D){k&&(k._38o[I]=[]);var d=Gb(X.opacity,y,t),n=Gb(X.names,y,t),H=n?n.length:0,j=D.rotation;if(d!=C){var T=o.globalAlpha;o.globalAlpha*=d}for(var h=0;H>h;h++){var W=n[h],q=Sg(W),l=D[h];if(j){var M=l.x+l.width/2,z=l.y+l.height/2;o.save(),of(o,M,z),Bh(o,j),of(o,-M,-z)}k&&k._38o[I].push(o.interactiveInfo={compInfos:[],matrix:j?new Co(j,M,z).appendTranslate(-M,-z):new Co}),_e(o,q,Gb(X.stretch,y,t),l.x,l.y,l.width,l.height,w._data,w.gv),o.interactiveInfo=C,j&&o.restore()}d!=C&&(o.globalAlpha=T)}}}}});var jk=function(P,H){Nm(jk,this,[P,H])};rh(jk,Zc,{_checkEmptyRect:!0,_40O:function(u,n){var I=this,K=I.s,i=u.rect;(u.borderColor=I.gv.getBorderColor(I._data))&&(u.borderType=K("border.type"),u.borderWidth=K("border.width"),u.borderPadding=K("border.padding"),n=F(n,u.borderPadding+u.borderWidth/2));var U=I._data.getScale(),m=F(1,F(M(U.x),M(U.y)));if(u.selectWidth=I.getSelectWidth()){var y=I.gv._zoom;u.selectType=K("select.type"),u._97o=I.getSelectColor(),u.selectPadding=K("select.padding"),n=F(n,(u.selectPadding+u.selectWidth/2/y)/m)}n>0&&(n*=m,i=Io(i),Ud(i,n)),I._68o(i)},_39O:function(B,j){var D,d=this,G=j.rect;if(j.borderWidth>0&&(D=j.borderPadding,B.strokeStyle=j.borderColor,B.lineWidth=j.borderWidth,Ll(B,j.borderType,{x:G.x-D,y:G.y-D,width:G.width+2*D,height:G.height+2*D}),B.stroke()),j.selectWidth>0){var l=d.gv._zoom;if(D=j.selectPadding,B.strokeStyle=j._97o,B.lineWidth=j.selectWidth/l,j.rotation!=C){B.save(),B.translate(j.position.x,j.position.y),B.rotate(j.rotation);var H=d._data,q=H.getWidth(),J=H.getHeight(),f=j.scale,p=j.anchor;G={x:f.x*-q*p.x,y:f.y*-J*p.y,width:f.x*q,height:f.y*J}}Ll(B,j.selectType,{x:G.x-D,y:G.y-D,width:G.width+2*D,height:G.height+2*D}),j.rotation!=C&&B.restore(),B.stroke()}},dispose:function(){var i=this,a=i._htmlView;jk.superClass._3O.call(i),a&&(a.onHTMLRemoved&&a.onHTMLRemoved(),ks(a))},_3O:function(){var h=this,z=h.s,r=h._data,u=h.gv,l=r.getStyle(Dr),Y=h.getBodyColor(),k=h._83o=l?{shape:l,_53o:h.getBodyColor("shape.background"),_27Q:Sg(z("shape.repeat.image"),Y),shapeGradientPack:z("shape.gradient.pack"),_54o:z("shape.border.width"),_55o:z("shape.border.color"),_56o:z("shape.border.3d"),_57o:z("shape.border.3d.color"),_58o:z("shape.border.3d.accuracy"),shapeGradient:z("shape.gradient"),_59o:z("shape.gradient.color"),_60o:z("shape.border.pattern"),_61o:z("shape.border.cap"),_62o:z("shape.border.join"),shapeForeground:z("shape.foreground"),bodyColor:Y}:{img:Sg(u.getImage(r),Y),bodyColor:Y,stretch:z("image.stretch")};if(B&&!n);else{var $,N=k.img;N&&N.renderHTML?(h._htmlInfo&&h._htmlInfo.img!==N&&(h._htmlInfo=C),h._htmlInfo||(h._htmlInfo={img:N,cache:{}}),$=N.renderHTML(r,u,h._htmlInfo.cache)):h._htmlInfo=C,h._htmlView&&h._htmlView!==$&&(h._htmlView.onHTMLRemoved&&h._htmlView.onHTMLRemoved(),ks(h._htmlView.getView?h._htmlView.getView():h._htmlView)),(h._htmlView=$)&&u.appendHTML($)&&$.onHTMLAdded&&$.onHTMLAdded(),k.rect=r.getRect(),k.position=r.p(),k.scale=r.getScale(),k.anchor=r.getAnchor(),k.rotation=r.getRotation(),l===Lg&&(k._63o=z("shape.depth"));var T=0;if(l)T=Zf(C,k._54o/2,k._62o),h.s("shape.dash")&&(T=F(T,(h.s("shape.dash.width")||k._54o)/2));else if(N&&N.boundExtend)if(T=Gb(N.boundExtend,r,u),N.boundExtendAbsolute){var b=r.getScale();T/=u._zoom*F(1,F(M(b.x),M(b.y)))}else if(!Gb(N.fitSize,r,u)){var X=Gb(N.width,r,u),j=Gb(N.height,r,u);T*=F(r.getWidth()/X,r.getHeight()/j)}h._40O(k,T);var K=z("clip.percentage");if(1>K&&(0>K&&(K=0),k.clipRect=Jf(r.getAnchorRect(),z("clip.direction"),K)),l){var L=z("shape.fill.clip.percentage");1>L&&(0>L&&(L=0),k.shapeClipRect=Jf(r.getAnchorRect(),z("shape.fill.clip.direction"),L));var U=z("shape.foreground.clip.percentage");1>U&&(0>U&&(U=0),k.shapeForegroundClipRect=Jf(r.getAnchorRect(),z("shape.foreground.clip.direction"),U))}}},getPosition:function(Z,v,$,g){var u=vh(Z,this._83o.rect,g);return u.x+=v,u.y+=$,u},_80o:function(u){var d=this,v=d.s,t=d.gv,$=d._data,W=d._83o,I=W.rect,Y=W.position,b=W.rotation,f=W.anchor,J=W.scale,D=W.shape,y=W.clipRect;if(!d._checkEmptyRect||I.width>0&&I.height>0){var o=$.getSize();if(o.x=-o.width*f.x,o.y=-o.height*f.y,u.save(),of(u,Y.x,Y.y),Bh(u,b),ig(u,J.x,J.y),y&&(u.beginPath(),u.rect(y.x,y.y,y.width,y.height),u.clip()),t._drawForChecking&&W.img&&Gb(W.img.pixelPerfect,$,t)===!1)Qh(u,o.x,o.y,o.width,o.height,"#888888");else if(d.freeDraw)d.freeDraw(u,o,W);else if(D){var M,F,L,m,l=W._60o,_=ke(u,l),B=W._53o,k=W._27Q,A=W._54o,p=W._55o,Q=W.shapeGradientPack,r=u.lineJoin,P=u.lineCap;if("roundRect"===D?M=v("shape.corner.radius"):"polygon"===D?M=v("shape.polygon.side"):"arc"===D&&(M=v("shape.arc.from"),F=v("shape.arc.to"),L=v("shape.arc.close"),m=v("shape.arc.oval")),u.lineJoin=W._62o,u.lineCap=W._61o,B||k||Q){var T=W.shapeClipRect;T&&(u.save(),u.beginPath(),u.rect(T.x,T.y,T.width,T.height),u.clip()),Ll(u,D,o,M,F,L,m),Q?sl(u,Q):k?Bl(u,k,W.bodyColor,null,$,t):Sp(u,B,W.shapeGradient,W._59o,o),u.fill(),T&&u.restore(),Q&&u.restore(),u!==_&&Ll(_,D,o,M,F,L,m)}else Ll(_,D,o,M,F,L,m);var q=W.shapeForeground;if(q){u.save();var h=W.shapeForegroundClipRect;h&&(u.beginPath(),u.rect(h.x,h.y,h.width,h.height),u.clip()),Ll(u,D,o,M,F,L,m),Sp(u,q,v("shape.foreground.gradient"),v("shape.foreground.gradient.color"),o),u.fill(),u.restore()}if(A>0){var N=v("shape.border.width.absolute");N&&(u.save(),u.setTransform(1,0,0,1,0,0)),u.lineWidth=A,u.strokeStyle=p,u.stroke(),N&&u.restore(),W._56o&&Zn(u,p,W._57o,A,t._zoom,W._58o)}if(ad(u,l),v("shape.dash")){var i=v("shape.dash.width")||A;if(i>0){l=v("shape.dash.pattern");var _=ke(u,l,d._2Q("shape.dash.offset"));_!==u&&Ll(_,D,o,M,F,L,m),d._1Q(u,"shape",i,l)}}ie(u,B,W._63o,o),u.lineJoin=r,u.lineCap=P}else{var O=d.interactiveInfo;O&&(u.interactiveInfo=O.bodyInfo={compInfos:[],matrix:new Co(b,Y.x,Y.y,J.x,J.y)}),_e(u,W.img,W.stretch,o.x,o.y,o.width,o.height,$,t,W.bodyColor),u.interactiveInfo=C}u.restore()}d._39O(u,W)},_48O:function(){},_47O:function(){}});var Gj=function(E,u){Nm(Gj,this,[E,u])},yh=function(r,m,S,k){var p=Xo(r,m);return S=k?x(S,p):dr(S,p),p?S/=p:S=0,{x:r.x+(m.x-r.x)*S,y:r.y+(m.y-r.y)*S}};rh(Gj,Zc,{_3O:function(){var z,d=this,c=d._data,l=d.gv,i=d.s,X=i(yq),K=c.isLooped(),G=i("edge.width"),T=i("edge.center"),O=i("edge.offset"),R=l.getBorderColor(c),N=R?i("border.width"):0,Z=d.getSelectWidth(),n=c._40I,A=c._41I,Q=d._78o=n&&A?{looped:K,type:X,width:G,center:T,color:d.getBodyColor("edge.color"),borderColor:R,borderWidth:N,_97o:Z?d.getSelectColor():C,selectWidth:Z,pattern:i("edge.pattern"),cap:i("edge.cap"),join:i("edge.join"),is3d:i("edge.3d"),_67o:i("edge.3d.color"),_66o:i("edge.3d.accuracy")}:C;if(Q){var $=v.getEdgeType(X);if($){var e=$(c,ir(d,l,c,K,X),l,d._19Q);e.points&&e.points.size()>1?(Q.edgeTypeInfo=e,z=xo(Q.edgeTypeInfo.points)):e[_h]&&e.rect&&(Q.edgeTypeInfo=e,z=e.rect)}else{var g=i("edge.source.anchor.x"),Y=i("edge.source.anchor.y"),E=i("edge.target.anchor.x"),H=i("edge.target.anchor.y"),q=Fb(l,n,i("edge.source.position"),i("edge.source.offset.x"),i("edge.source.offset.y"),g,Y),p=Fb(l,A,i("edge.target.position"),i("edge.target.offset.x"),i("edge.target.offset.y"),E,H);if(X===lk){var x=Q.points=i(Am)||ac,P=x.size();Q.segments=i("edge.segments");var w=g!==r||Y!==r,U=E!==r||H!==r;if(!T)if(O)w||(q=yh(q,P?x.get(0):p,O,P)),U||(p=yh(p,P?x.get(P-1):q,O,P));else{var u;w||(u=an(q,P?x.get(0):p,lb(l,n)),u&&(q={x:u[0],y:u[1]})),U||(u=an(P?x.get(P-1):q,p,lb(l,A)),u&&(p={x:u[0],y:u[1]}))}z=$k(xo(Q.points),xo(q,p))}else{var j=ir(d,l,c,K,X);if(d._19Q||(j=-j),K)q=Io(q),q.x=l.getNodeRect(n).x,Q.radius=j,z={x:q.x-j,y:q.y-j,width:2*j,height:2*j};else{var k=Xo(q,p),J=dr(O,k),B={x:J,y:j},h={x:k-J,y:j},m=W(p.y-q.y,p.x-q.x),L=Q.mat=new Aq(m);if(Q.orienAngle=m,Q.angle=p.x<q.x?m+I:m,Q.rect={x:B.x,y:B.y,width:h.x-B.x,height:0},Q.origin=q,B=L.tf(B),B.x+=q.x,B.y+=q.y,h=L.tf(h),h.x+=q.x,h.y+=q.y,T){var V={x:k,y:0};V=L.tf(V),V.x+=q.x,V.y+=q.y,z=xo([q,B,h,V]),Q.c1=q,Q.c2=V}else z=xo(B,h);q=B,p=h}}Q.sourcePoint=q,Q.targetPoint=p,c._lastSourcePoint=q,c._lastTargetPoint=p}var t=0;i("edge.dash")&&(t=i("edge.dash.width")||G);var S="square"===Q.cap?.71:.5;Zf(z,F(t*S,G*S+N+Z),Q.join),d._68o(z)}},getRotation:function(S,f,K){S=S||0;var M=this._78o;if(M){var e,_=M.angle,O=M.points,i=M.edgeTypeInfo;if(_!=C)return f?M.orienAngle+S:_+S;if(i&&i[_h])return i.getRotation?i.getRotation(this,S,f,K):0;if(i&&i.points){var g=i.points;return e=g.size(),Zk[K]?e&&0===e%2?Mr(g.get(e/2-1),g.get(e/2),f,S):S:pr[K]?Mr(g.get(0),g.get(1),f,S):Mr(g.get(e-2),g.get(e-1),f,S)}if(O)return e=O.size(),Zk[K]?e&&0===e%2?Mr(O.get(e/2-1),O.get(e/2),f,S):S:pr[K]?Mr(M.sourcePoint,e?O.get(0):M.targetPoint,f,S):Mr(e?O.get(e-1):M.sourcePoint,M.targetPoint,f,S)}return S},getPosition:function(K,f,x,$,g){var S=this._78o;if(S){var _,R=S.type,p=S.points,E=S.edgeTypeInfo,G=S.sourcePoint,H=S.targetPoint;if(!R)return S.looped?{x:G.x-S.radius+f,y:G.y+x}:(g&&G&&H&&(G.x>H.x||G.x===H.x&&G.y>H.y)&&(K=gm[K],x=-x),_=vh(K,S.rect,$),_.x+=f,_.y+=x,_=S.mat.tf(_),_.x+=S.origin.x,_.y+=S.origin.y,_);if(E&&E[_h])return E.getPosition?E.getPosition(this,K,f,x,$,g):{x:(G.x+H.x)/2,y:(G.y+H.y)/2};if(p){var _,M=p.size();if(Zk[K]){if(M){var P=M%2;if(0===P)return Oj(p.get(M/2-1),p.get(M/2),K,f,x,$,g);_=p.get((M-P)/2)}else _={x:(G.x+H.x)/2,y:(G.y+H.y)/2};return _=vh(K,{x:_.x,y:_.y,width:0,height:0},$),_.x+=f,_.y+=x,_}return pr[K]?Oj(G,M?p.get(0):H,K,f,x,$,g):Oj(M?p.get(M-1):G,H,K,f,x,$,g)}if(E){var D=E.points,M=D.size();if(Zk[K]){var P=M%2;return 0===P?Oj(D.get(M/2-1),D.get(M/2),K,f,x,$,g):(_=D.get((M-P)/2),_=vh(K,{x:_.x,y:_.y,width:0,height:0},$),_.x+=f,_.y+=x,_)}return pr[K]?Oj(D.get(0),D.get(1),K,f,x,$,g):Oj(D.get(M-2),D.get(M-1),K,f,x,$,g)}}return Hk},_42:function(f){this._78o&&Gj.superClass._42.call(this,f)},drawPath:function(w,B){w.beginPath();var E=B.type,b=B.points,Z=B.segments,p=B.edgeTypeInfo;if(!E||b){var i=B.sourcePoint,v=i.x,Y=i.y,z=B.targetPoint,m=z.x,A=z.y;if(E)if(Z){var V=new Oh({x:v,y:Y});V.addAll(b),V.add({x:m,y:A}),cd(w,V,Z)}else w.moveTo(v,Y),b.each(function(q){w.lineTo(q.x,q.y)}),w.lineTo(m,A);else B.looped?w.arc(v,Y,B.radius,0,R,!0):B.center?(w.moveTo(B.c1.x,B.c1.y),w.lineTo(v,Y),w.lineTo(m,A),w.lineTo(B.c2.x,B.c2.y)):(w.moveTo(v,Y),w.lineTo(m,A))}else p&&(p.points?cd(w,p.points,p.segments):p[_h]&&p[_h](w,p))},_80o:function(y){var N=this,A=N.s,L=N._78o,u=L.width,Z=L.selectWidth,W=L.borderWidth,B=L.color,r=y.lineJoin,c=y.lineCap,M=L.pattern;y.lineJoin=L.join,y.lineCap=L.cap,N.drawPath(ke(y,M),L);var h=A("edge.width.absolute");if(h&&(y.save(),y.setTransform(1,0,0,1,0,0)),Z&&(y.strokeStyle=L._97o,y.lineWidth=u+2*(W+Z),y.stroke()),W&&(y.strokeStyle=L.borderColor,y.lineWidth=u+2*W,y.stroke()),y.strokeStyle=B,y.lineWidth=u,y.stroke(),L.is3d&&Zn(y,B,L._67o,u,N.gv._zoom,L._66o),h&&y.restore(),ad(y,M),A("edge.dash")){M=A("edge.dash.pattern");var e=ke(y,M,N._2Q("edge.dash.offset"));e!==y&&N.drawPath(e,L),N._1Q(y,"edge",A("edge.dash.width")||u,M)}y.lineJoin=r,y.lineCap=c},_48O:function(){},_47O:function(){},_71o:function(P,n){var h=this,o=h._data;if(h._19Q=!0,!o.getEdgeGroup())return P?o.s("edge.gap"):0;var l,e=0,E=0,Y=0;if(o.getEdgeGroup().getSiblings().each(function(f){f.each(function(Z){if(h.gv.isVisible(Z)&&Z.s(yq)==n){var S=Z.s("edge.gap");l?(E+=Y/2+S/2,Y=S):(l=Z,Y=S),Z===o&&(e=E)}})}),P)return E-e+Y;var k=e-E/2;return l&&o._40I!==l._40I&&(h._19Q=!1),k}});var Hj=function(I,V){Nm(Hj,this,[I,V])};rh(Hj,jk,{_3O:function(){var $,d,l=this,i=l.s,T=l._data,Z=l.gv;if(l._88I=C,T.isExpanded()&&T.eachChild(function(r){var D=Z.getBoundsForGroup(r);D&&(d||(d=[]),d.push(D),$=$k($,D))}),$){var w=Z.getLabel(T),j=i("group.type");$=Xi(j,d,$),zl($,T,"group.padding",1);var v=l._88I={type:j,rect:$,_64o:$};if(!j&&w!=C){var D,U=l.labelInfo={label:w,color:i("group.title.color"),font:i("group.title.font"),align:i("group.title.align")},o=Uf(U,w),G=o.width,u=o.height,B=i("group.title.align");
G>$.width&&($.width=G),U.rect={y:$.y-u,width:o.width,height:u},D=B===en?$.x:B===lg?$.x+$.width-G:$.x+$.width/2-G/2,U.rect.x=D,v.titleRect={x:$.x,y:$.y-u,width:$.width,height:u+1},v.rect={x:$.x,y:$.y-u,width:$.width,height:$.height+u}}l._40O(v,i("group.border.width")/2)}else Hj.superClass._3O.call(l)},getPosition:function(v,F,D,q){var M=this._88I;if(M){var b=vh(v,M.rect,q);return b.x+=F,b.y+=D,b}return Hj.superClass.getPosition.apply(this,arguments)},_24O:function(E,Z){var F=this._88I;(!F||F.type||"label2"===E)&&Hj.superClass._24O.call(this,E,Z)},_80o:function(c){var T=this,v=T._88I;if(v){var Y=T._data,b=T.s,l=T.gv,S=v.type,C=v.rect,M=v._64o,k=v.titleRect,P=T.getBodyColor(),s=Sg(b("group.image"),P),n=b("group.image.stretch"),f=T.getBodyColor("group.background"),W=Sg(b("group.repeat.image"),P),o=b("group.gradient.pack"),K=b("group.gradient"),Z=b("group.gradient.color"),E=b("group.depth");if(S){var F=b("group.border.pattern"),G=b("group.border.width"),r=c.lineJoin,H=c.lineCap;if(c.lineJoin=b("group.border.join"),c.lineCap=b("group.border.cap"),s){if(c.save(),Ll(c,S,C),c.clip(),_e(c,s,n,C.x,C.y,C.width,C.height,Y,l,P),c.restore(),G>0){var J=ke(c,F);Ll(J,S,C),c.lineWidth=G,c.strokeStyle=b("group.border.color"),c.stroke(),ad(c,F)}}else{var J=ke(c,F);f||W||o?(Ll(c,S,C),o?sl(c,o):W?Bl(c,W,P,null,Y,l):Sp(c,f,K,Z,C),c.fill(),o&&c.restore(),c!==J&&Ll(J,S,C)):Ll(J,S,C),G>0&&(c.lineWidth=G,c.strokeStyle=b("group.border.color"),c.stroke()),ad(c,F),S===Lg&&ie(c,f,E,C)}c.lineJoin=r,c.lineCap=H}else if(s?_e(c,s,n,M.x,M.y,M.width,M.height,Y,l,T.getBodyColor()):(f||W)&&(W?Bl(c,W,P,null,Y,l):Sp(c,f,K,Z,M),Ll(c,Lg,M),c.fill(),ie(c,f,E,M)),k){var N=b("group.title.background");Qh(c,k.x,k.y,k.width,k.height,N),ie(c,N,E,k)}T._39O(c,v)}else Hj.superClass._80o.call(T,c)}});var nf=function(w,V){Nm(nf,this,[w,V])};rh(nf,jk,{_80o:function(h){this._39O(h,this._83o)}});var Vl=function(n,o){Nm(Vl,this,[n,o])};rh(Vl,jk,{_3O:function(){var r=this,h=r._data,o=r.s,t=r.gv,m=h.getPoints(),j=t.getBorderColor(h),A=j?o("border.width"):0,$=r.getSelectWidth(),z=o("shape.border.width"),B=h.getRect(),H=t.getBodyColor(h),Z=r._99o=m.isEmpty()?C:{rect:B,rotation:h.getRotation(),fillRule:o("shape.fill.rule"),scale:h.getScale(),position:h.p(),points:m,segments:h.getSegments(),bodyColor:H,borderColor:j,borderWidth:A,_94o:o("shape.border.3d"),_95o:o("shape.border.3d.color"),_96o:o("shape.border.3d.accuracy"),_97o:$?r.getSelectColor():C,selectWidth:$,_53o:o("shape.background"),_27Q:Sg(o("shape.repeat.image"),H),shapeGradientPack:o("shape.gradient.pack"),_54o:z,_55o:o("shape.border.color"),shapeGradient:o("shape.gradient"),_59o:o("shape.gradient.color"),_60o:o("shape.border.pattern"),_61o:o("shape.border.cap"),_62o:o("shape.border.join"),shapeForeground:o("shape.foreground")};if(Z){var u=h.getScale(),T=F(1,F(M(u.x),M(u.y)));o("shape.dash")&&o("shape.dash.width")>z&&(z=o("shape.dash.width"));var L=z*("square"===Z._61o?.71:.5)+A+$/r.gv._zoom/T;L&&(L*=T,B=Io(B),Zf(B,L,Z._62o)),r._68o(B);var y=o("clip.percentage");1>y&&(0>y&&(y=0),Z.clipRect=Jf(h.getAnchorRect(),o("clip.direction"),y));var q=o("shape.fill.clip.percentage");1>q&&(0>q&&(q=0),Z.shapeClipRect=Jf(h.getAnchorRect(),o("shape.fill.clip.direction"),q));var f=o("shape.foreground.clip.percentage");1>f&&(0>f&&(f=0),Z.shapeForegroundClipRect=Jf(h.getAnchorRect(),o("shape.foreground.clip.direction"),f))}},getPosition:function(q,Z,E,x){var T=this._99o;if(T){var w=vh(q,T.rect,x);return w.x+=Z,w.y+=E,w}return Hk},_42:function(B){this._99o&&Vl.superClass._42.call(this,B)},_80o:function(p){var W,n=this,M=n.s,K=n._99o,f=K.position,u=K.scale,U=K.rotation,j=K.bodyColor,T=K.borderWidth,y=K.selectWidth,P=K._53o,C=K._27Q,z=K.shapeGradientPack,H=K._54o,R=K.clipRect,A=K.shapeClipRect,c=K.points,v=K.segments,b=n._data.isClosePath(),B=K.fillRule,L=P||C||z;p.save(),of(p,f.x,f.y),Bh(p,U),ig(p,u.x,u.y),R&&(p.beginPath(),p.rect(R.x,R.y,R.width,R.height),p.clip()),L&&A&&(p.save(),p.beginPath(),p.rect(A.x,A.y,A.width,A.height),p.clip()),of(p,-f.x,-f.y);var Y=K._60o,G=ke(p,Y),d=p.lineJoin,I=p.lineCap;p.lineJoin=K._62o,p.lineCap=K._61o,L?(cd(p,c,v,b),z?sl(p,z):C?Bl(p,C,j,null,n._data,n.gv):(W=j?j:P,Sp(p,W,K.shapeGradient,K._59o,K.rect)),p.fill(B),A&&(p.restore(),of(p,-f.x,-f.y)),z&&p.restore(),G!==p&&cd(G,c,v,b)):cd(G,c,v,b);var X=K.shapeForeground;if(X){p.save();var Q=K.shapeForegroundClipRect;Q&&(of(p,f.x,f.y),p.beginPath(),p.rect(Q.x,Q.y,Q.width,Q.height),p.clip(),of(p,-f.x,-f.y)),cd(p,c,v,b),Sp(p,X,M("shape.foreground.gradient"),M("shape.foreground.gradient.color"),K.rect),p.fill(B),p.restore()}var e=M("shape.border.width.absolute");if(e&&(p.save(),p.setTransform(1,0,0,1,0,0)),y&&(p.strokeStyle=K._97o,p.lineWidth=H+2*(T+y),p.stroke()),T&&(p.strokeStyle=K.borderColor,p.lineWidth=H+2*T,p.stroke()),H&&(W=K._55o,!P&&j&&(W=j),p.strokeStyle=W,p.lineWidth=H,p.stroke(),K._94o&&Zn(p,W,K._95o,H,n.gv._zoom,K._96o)),e&&p.restore(),ad(p,Y),M("shape.dash")){var F=M("shape.dash.width")||H;if(F>0){Y=M("shape.dash.pattern");var G=ke(p,Y,n._2Q("shape.dash.offset"));G!==p&&cd(G,c,v,b),n._1Q(p,"shape",F,Y)}}p.lineJoin=d,p.lineCap=I,p.restore()},_48O:function(){},_47O:function(){}});var ip=function(k,s){Nm(ip,this,[k,s])};rh(ip,Vl,{getRotation:function($,a,q){$=$||0;var j=this._data.getPoints(),m=j.size();return m>1?Zk[q]?m&&0===m%2?Mr(j.get(m/2-1),j.get(m/2),a,$):$:pr[q]?Mr(j.get(0),j.get(1),a,$):Mr(j.get(m-2),j.get(m-1),a,$):$},getPosition:function(Y,n,E,h,j){var J=this._data.getPoints(),M=J.size();if(M>1){if(Zk[Y]){var F=M%2;if(0===F)return Oj(J.get(M/2-1),J.get(M/2),Y,n,E,h,j);var N=J.get((M-F)/2),b={x:N.x,y:N.y,width:0,height:0};return N=vh(Y,b,h),N.x+=n,N.y+=E,N}return pr[Y]?Oj(J.get(0),J.get(1),Y,n,E,h,j):Oj(J.get(M-2),J.get(M-1),Y,n,E,h,j)}return Hk}});var ob=function(I,J){Nm(ob,this,[I,J])};rh(ob,jk,{_3O:function(){var b=this;ob.superClass._3O.call(b);var K=b.s,w=b._83o;b._82o=w.img||w.shape?C:{background:b.getBodyColor("grid.background"),depth:K("grid.depth"),rect:w.rect,_88o:K("grid.cell.depth"),cellBorderColor:K("grid.cell.border.color"),_89o:K("grid.row.count"),_90o:K("grid.column.count"),block:K("grid.block"),_91o:K("grid.block.color"),_92o:K("grid.block.padding"),_93o:K("grid.block.width")}},_80o:function(A){var y=this,O=y._82o;if(!O)return ob.superClass._80o.call(y,A),void 0;var d,Y,o=y._data,_=O.background,s=O.rect,G=O.block,h=O._91o,v=O._92o,q=O._93o,j=O._88o,D=O.cellBorderColor,e=O._89o,p=O._90o;if(_)if(Qh(A,s.x,s.y,s.width,s.height,_),ie(A,_,O.depth,s),j)for(d=0;e>d;d++)for(Y=0;p>Y;Y++)s=o.getCellRect(d,Y),s&&ie(A,_,j,s);else if(D){for(A.beginPath(),d=0;e>d;d++)for(Y=0;p>Y;Y++)s=o.getCellRect(d,Y),s&&A.rect(s.x,s.y,s.width,s.height);A.strokeStyle=D,A.lineWidth=1,A.stroke()}if("h"===G)for(d=0;e>d;d++)s=$k(o.getCellRect(d,0),o.getCellRect(d,p-1)),Ud(s,v),jc(A,h,s.x,s.y,s.width,s.height,q);else if("v"===G)for(Y=0;p>Y;Y++)s=$k(o.getCellRect(0,Y),o.getCellRect(e-1,Y)),Ud(s,v),jc(A,h,s.x,s.y,s.width,s.height,q);y._39O(A,y._83o)}});var Im=function(N,E){Nm(Im,this,[N,E])};rh(Im,jk,{_checkEmptyRect:!1,_81o:function(){var t=this._data,P=Im.superClass._81o.call(this),e=t.s("text");if(e!=C){var i,Y,m=t.s("text.font"),D=t.s("text.align"),d=t.s("text.vAlign"),G=On(m,e),Q=G.width,O=G.height,r=t.getAnchor(),Z=t.getWidth(),U=t.getHeight();"left"===D?i=-Z*r.x:"center"===D?i=-Z*r.x+(Z-Q)/2:"right"===D&&(i=Z*(1-r.x)-G.width),"top"===d?Y=-U*r.y:"middle"===d?Y=-U*r.y+(U-O)/2:"bottom"===d&&(Y=U*(1-r.y)-G.height);var l,R=t.getMatrix();if(l=xo([R.tf(i,Y),R.tf(i+Q,Y),R.tf(i+Q,Y+O),R.tf(i,Y+O)]),P=$k(P,l),P&&t.s("text.shadow")){var L=Io(P);L.x+=t.s("text.shadow.offset.x"),L.y+=t.s("text.shadow.offset.y"),Ud(L,t.s("text.shadow.blur")),P=$k(P,L)}}return P}});var Ip=Iq.Interactor=function(O){this.gv=this._graphView=O};dc("Interactor",m,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(m){this.gv.fi(m)},setCursor:function(c){_n||this.gv.setCursor(c)},startDragging:function(Y){var A=this;A._lastClientPoint=vq(Y),A._lastLogicalPoint=A.gv.lp(Y),qf(A,Y)},clearDragging:function(){var y=this;y._lastClientPoint=y._lastLogicalPoint=y._logicalPoint=C},autoScroll:function(z){return this.gv.autoScroll(z,this._lastClientPoint)}});var Ek=C,Pm=function(B){Ek.handleWindowTouchMove(B)},uh=function(L){Ek.handleWindowTouchEnd(L),N.removeEventListener(Wi,Pm,!1),N.removeEventListener(Qc,uh,!1),Ek=C},rm=function(T){Ek.handleWindowMouseMove(T)},qb=function(b){Ek.handleWindowMouseUp(b),N.removeEventListener(wb,rm,!1),N.removeEventListener(hg,qb,!1),Ek=C},wl=function(_,u){_!==Ek&&(Ek?_n?Ek.handleWindowTouchEnd(u):Ek.handleWindowMouseUp(u):_n?(N.addEventListener(Wi,Pm,!1),N.addEventListener(Qc,uh,!1)):(N.addEventListener(wb,rm,!1),N.addEventListener(hg,qb,!1)),Ek=_)},Lf=function(X){var $=this;$.gv=X,$._is2d=X instanceof Iq.GraphView,$._is2d&&($.filter=function(r){return X.isSelectable(r)&&X.isInteractive(r)}),X.getView(),["mousedown","mousemove","touchstart","touchmove",Fl].forEach(function(H){$.addListener(H)}),$.initImageResource()};rh(Lf,Ip,{enableVR:function(m){var X=this;if(!!X._vrEnable!==m)if(X._vrEnable=m,m)X.gv.vr.mp(X.onVRControllerChange,X);else if(X.gv.vr.ump(X.onVRControllerChange,X),X._vrRayPolyline){var e=X.gv.dm();e.remove(X._vrRayPolyline),e.remove(X._vrRayHitPoint),X._vrRayPolyline=r,X._vrRayHitPoint=r}},onVRControllerChange:function(l){var S=this,Q=l.property,i=l.newValue,H=S.gv.vr.getController(i.id),$=H.getRay();$&&("gamepad.button.trigger"===Q?"down"===i._62O?S.handle_mousedown($):S.handleWindowUp($):"gamepad.pose"===Q&&(S.handle_mousemove($),S.handleWindowMove($)))},drawVRRay:function(c,g,G){var l,$=this,M=$.gv,z=$._vrRayPolyline,t=!1;if(z)l=$._vrRayHitPoint;else{var A=M.dm();$._vrRayPolyline=z=new u.Polyline,$._vrRayHitPoint=l=new u.Node,l.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),l.setAnchor3d(.5,.5,.499);var V=.2/M.vr.measureOflength;l.s3(V,V,V),z.s("intersect",!1),l.s("intersect",!1),A.add(z),A.add(l),t=!0}if(g){var K=G.world,p=G.worldNormal,S=K.x,J=K.y,C=K.z;z.s("shape.border.color","red"),z.setPoints([{x:c.origin.x,y:c.origin.z,e:c.origin.y},{x:S,y:C,e:J}]),l.s("3d.visible",!0),l.p3(S,J,C),l.lookAtDirection([p.x,p.y,p.z],"front")}else{z.s("shape.border.color","blue");var B=new u.Math.Vector3;B.copy(c.direction).setLength(1e3/$.gv.vr.measureOflength).add(c.origin),z.setPoints([{x:c.origin.x,y:c.origin.z,e:c.origin.y},{x:B.x,y:B.z,e:B.y}]),l.s("3d.visible",!1)}M.fi({kind:"vrRayIntersect",ray:c,data:g,intersect:G,polyline:z,hitNode:l,begin:t})},addListener:function(H){var y=this;y.gv.getView().addEventListener(H,function(e){v.preventDefault(e),Pr(e)&&!y.disabled&&y["handle_"+H](e)},!1)},handleWindowTouchMove:function(i){this.handleWindowMouseMove(i)},handleWindowMouseMove:function(B){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",B):(this.handleDownInfo("onBeginDrag",B),this.isDragging=!0))},handleWindowTouchEnd:function(d){this.handleWindowMouseUp(d)},handleWindowMouseUp:function(I){if(this.isDragging&&(this.handleDownInfo("onEndDrag",I),this.isDragging=!1),this.downInfo){var R=this.handle("onUp",I);R&&R.data===this.downInfo.data?this.handleMissingUp(I):this.handleDownInfo("onUp",I),this.downInfo=C}},handle_mousewheel:function(l){l.scrollDelta=l.wheelDelta/40,this.handle("onScroll",l)},handle_DOMMouseScroll:function(F){F.scrollDelta=2===F.axis?-F.detail:0,this.handle("onScroll",F)},handle_touchstart:function(D){this.handle_mousedown(D)},handle_touchmove:function(Z){this.handle("onMove",Z)},handle_mousedown:function(L){this.isDragging&&(this.handleDownInfo("onEndDrag",L),this.isDragging=!1),this.downInfo=this.handle("onDown",L),this.downInfo&&wl(this,L)},handle_mousemove:function(e){var a=this,q=a.gv;a._hoverTimer&&(A(a._hoverTimer),delete a._hoverTimer);var r,w,g,L=a.handle("onMove",e),d=this.currentInfo?this.currentInfo.data:C,S=this.currentInfo?this.currentInfo.hits:C;if(L&&(w=L.data,g=L.hits,a._hoverTimer=i(function(){A(a._hoverTimer),delete a._hoverTimer,a.handle("onHover",e,L)},q.getHoverDelay()||v.hoverDelay)),w!==d){if(w&&w.s("onEnter")&&w.s("onEnter")(e,w,q),d&&d.s("onLeave")&&d.s("onLeave")(e,d,q),S)for(r in S)S[r].target.onLeave&&this.handleLeave(e,r);if(g)for(r in g)g[r].target.onEnter&&g[r].target.onEnter(e,w,q,g[r].point,g[r].width,g[r].height)}else{if(S)for(r in S)g&&g[r]||S[r].target.onLeave&&this.handleLeave(e,r);if(g)for(r in g)S&&S[r]||g[r].target.onEnter&&g[r].target.onEnter(e,w,q,g[r].point,g[r].width,g[r].height)}this.currentInfo=L},handle:function(A,x,s){var m,E=this,Q=E.gv;if(E._is2d){if(s=s||Q.getDataInfoAt(x,this.filter),!s)return;if(m=s.ui.interactiveInfo){var O,t=s.data;if(t.s(A)&&t.s(A)(x,t,Q),"body"===s.part&&m.bodyInfo)O="body",s.hits=this.handleImage(O,Q.getImage(t),A,x,t,s.point,m.bodyInfo);else if("icons"===s.part&&m._38o){var X=m._38o[s.name];X&&X[s.index]&&(O="icons|"+s.name+"|"+s.index,s.hits=this.handleImage(O,s.icon,A,x,t,s.point,X[s.index]))}}return s}var t,V;if(!s)if(x&&x instanceof u.Math.Ray){var c=Q.vr.intersectWorld(x);if(t=c.data,V=c.intersect,E.drawVRRay(x,t,V),!t)return;var g=Q.getData3dUI(t);if(m=g.interactiveInfo,!m)return;s={data:t,part:V.part,ui:g}}else{if(s=Q.getDataInfoAt(x),!s)return;s&&(s={data:s.data,part:s.part})}if(!V){t=s.data;var g=Q.getData3dUI(t);if(s.ui=g,m=g.interactiveInfo,!m)return s;if(V=Q.intersectObject(x,t),!V)return}t.s(A)&&t.s(A)(x,t,Q);var L,p=V.part;return"body"!==p&&(L=t.s(p+".image")||t.s("shape3d."+p+".image")),L||(L=t.s("all.image")||t.s("shape3d.image")),(m=m[L])?(s.part="body",s.interactiveInfo=m,s.point=V.uv.multiply({x:m.bodyInfo.rect.width,y:m.bodyInfo.rect.height}),s.image=L,s.hits=this.handleImage("body",L,A,x,t,s.point,m.bodyInfo),s):void 0},_handleLeaveOrMissing:function(J,l,B){var u="leave"===J?this.currentInfo:this.downInfo;if(u){var f=u.interactiveInfo||u.ui.interactiveInfo;if(f){var e,n,W=u.data;if(this._is2d){if(n=this.gv.lp(l),"body"===u.part&&f.bodyInfo)e="body","leave"===J?this.handleLeaveImage(B,e,this.gv.getImage(W),l,W,n,f.bodyInfo):this.handleMissingUpImage(e,this.gv.getImage(W),l,W,n,f.bodyInfo);else if("icons"===u.part&&f._38o){var v=f._38o[u.name];v&&v[u.index]&&(e="icons|"+u.name+"|"+u.index,"leave"===J?this.handleLeaveImage(B,e,u.icon,l,W,n,v[u.index]):this.handleMissingUpImage(e,u.icon,l,W,n,v[u.index]))}}else{var U=this.gv.intersectObject(l,W);n=U?U.uv.multiply({x:f.bodyInfo.rect.width,y:f.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===J?this.handleLeaveImage(B,"body",u.image,l,W,n,f.bodyInfo):this.handleMissingUpImage("body",u.image,l,W,n,f.bodyInfo)}}}},handleDownInfo:function(y,p){if(this.downInfo){var Q=this.downInfo,P=Q.interactiveInfo||Q.ui.interactiveInfo;if(P){var z,k=Q.data;if(k.s(y)&&k.s(y)(p,k,this.gv),this._is2d){var J=this.gv.lp(p);if("body"===Q.part&&P.bodyInfo)z="body",this.handleDownInfoImage(z,this.gv.getImage(k),y,p,k,J,P.bodyInfo);else if("icons"===Q.part&&P._38o){var O=P._38o[Q.name];O&&O[Q.index]&&(z="icons|"+Q.name+"|"+Q.index,this.handleDownInfoImage(z,Q.icon,y,p,k,J,O[Q.index]))}}else{var f=this.gv.intersectObject(p,k);if(!f)return;J=f.uv.multiply({x:P.bodyInfo.rect.width,y:P.bodyInfo.rect.height}),this.handleDownInfoImage("body",Q.image,y,p,k,J,P.bodyInfo)}}}},handleImage:function(w,i,c,k,K,h,p){var H={};if(i&&(i=Sg(i))){var y=this.gv,T=p.rect,C=this.convertPoint(h,p);C.inRect&&(i[c]&&i[c](k,K,y,C,T.width,T.height),H[w+"|image"]={target:i,point:C,width:T.width,height:T.height});for(var I=p.compInfos,U=i,E=I.length-1;E>=0;E--){var N=I[E],O=N.comp;C=this.convertPoint(h,N,U,O,y,K),C.inRect&&(T=N.rect,O[c]&&O[c](k,K,y,C,T.width,T.height),(i=T.image)&&i[c]&&i[c](k,K,y,C,T.width,T.height),H[w+"|"+E]={target:O,point:C,width:T.width,height:T.height},i&&(H[w+"|"+E+"|image"]={target:i,point:C,width:T.width,height:T.height}))}}return H},handleLeave:function(Y,l){return this._handleLeaveOrMissing("leave",Y,l)},handleMissingUp:function(r){return this._handleLeaveOrMissing("missing",r)},handleLeaveImage:function(K,a,O,A,W,Q,R){if(O&&(O=Sg(O))){var C=this.gv,t=R.rect,k=this.convertPoint(Q,R);K===a+"|image"&&O.onLeave&&O.onLeave(A,W,C,k,t.width,t.height);for(var q=R.compInfos,g=O,e=q.length-1;e>=0;e--){var Z=q[e],V=Z.comp;k=this.convertPoint(Q,Z,g,V,C,W),t=Z.rect,V.onLeave&&K===a+"|"+e&&V.onLeave(A,W,C,k,t.width,t.height),(O=t.image)&&O.onLeave&&K===a+"|"+e+"|image"&&O.onLeave(A,W,C,k,t.width,t.height)}}},handleMissingUpImage:function(Y,Q,M,G,u,s){var R="onUp",f=this.downInfo.hits;if(f&&Q&&(Q=Sg(Q))){var r=s.rect,T=this.convertPoint(u,s);!T.inRect&&f[Y+"|image"]&&Q[R]&&Q[R](M,G,this.gv,T,r.width,r.height);for(var X=s.compInfos,c=Q,n=X.length-1;n>=0;n--){var E=X[n],P=E.comp;T=this.convertPoint(u,E,c,P,this.gv,G),T.inRect||(r=E.rect,P[R]&&f[Y+"|"+n]&&P[R](M,G,this.gv,T,r.width,r.height),(Q=r.image)&&Q[R]&&f[Y+"|"+n+"|image"]&&Q[R](M,G,this.gv,T,r.width,r.height))}}},handleDownInfoImage:function(j,b,g,f,A,p,q){var Y=this.downInfo.hits;if(Y&&b&&(b=Sg(b))){var k=this.gv,I=q.rect,v=this.convertPoint(p,q);Y[j+"|image"]&&b[g]&&b[g](f,A,k,v,I.width,I.height);for(var R=q.compInfos,E=b,d=R.length-1;d>=0;d--){var e=R[d],m=e.comp;v=this.convertPoint(p,e,E,m,k,A),I=e.rect,m[g]&&Y[j+"|"+d]&&m[g](f,A,k,v,I.width,I.height),(b=I.image)&&b[g]&&Y[j+"|"+d+"|image"]&&b[g](f,A,k,v,I.width,I.height)}}},initImageResource:function(){v.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(U,D,u,V,G,s){var d=D.rect,P=D.matrix.applyInverse(U).sub(d),q=P.x>=0&&P.y>=0&&P.x<=d.width&&P.y<=d.height;if(!q)return P;if(V&&Gb(V.pixelPerfect,s,G)){var d,j=1;this._is2d?(j=G.getZoom(),d=om(U.x,U.y,r,j)):d=om(U.x,U.y);var S=!1,p=d.x,f=d.y,Q=d.width,K=d.height,y=v.hitMaxArea,$=Q*K*j*j;if($>y){var o=Math.sqrt(y/$);j*=o}Q*=j,K*=j,2>Q&&(Q=2),2>K&&(K=2),p*=j,f*=j;var b=kg(Q,K),R=new Co(0,-p,-f,j,j);R.append(D.matrix),G._drawForChecking=!0,V.transform=R;var g=u.comps;u.comps=[V],er(b,u,0,0,Q,K,s,self),u.comps=g,delete V.transform,G._drawForChecking=!1;try{for(var e=0,k=b.getImageData(0,0,Q,K).data;e<k.length;e+=4)if(0!==k[e+3]){S=!0;break}b.restore()}catch(m){tf=C,S=!1}P.inRect=S}else P.inRect=!0;return P}});var jh=Iq.DefaultInteractor=function(P){Nm(jh,this,[P])};dc("DefaultInteractor",Ip,{handle_mousedown:function(_){Ib(_);var s=this,a=s.gv,E=a.getDataAt(_);!a.setFocus(_)||a._editing||a._scrolling||(co(_)?a.handleDoubleClick(_,E):a.handleClick(_,E),!Nf()&&E&&(a.isMovable(E)||a.isInteractive(E))||!a.isPannable()||!Pr(_)||md(_)||(s._tx=a.tx(),s._ty=a.ty(),s.startDragging(_)))},handleWindowMouseUp:function($){var B=this,Y=B.gv;Y._panning&&(delete Y._panning,Y.onPanEnded(),B.fi({kind:"endPan",event:$})),delete B._tx,delete B._ty,B.clearDragging()},handle_mousemove:function(o){var D=this,X=D.gv;D._hoverTimer&&(A(D._hoverTimer),delete D._hoverTimer),D._hoverTimer=i(function(){D.fi({kind:"hover",event:o}),A(D._hoverTimer),delete D._hoverTimer},X.getHoverDelay()||v.hoverDelay)},handle_touchmove:function(U){this.handle_mousemove(U)},handleWindowMouseMove:function(B){var t=this,u=t.gv,J=t._lastClientPoint;t.fi({kind:u._panning?"betweenPan":"beginPan",event:B}),u._panning=1,u.setTranslate(t._tx+B.clientX-J.x,t._ty+B.clientY-J.y)},handle_mousewheel:function(k){this.gv.handleScroll(k,k.wheelDelta)},handle_DOMMouseScroll:function(s){2===s.axis&&this.gv.handleScroll(s,-s.detail)},handle_keydown:function(Y){this.gv.handleKeyDown(Y)}});var Og=Iq.SelectInteractor=function(l){Nm(Og,this,[l])};dc("SelectInteractor",Ip,{_42:function(){var H=this,$=H.gv,d=$.getZoom(),Z=H.mark,v=H.div;v||(v=H.div=gh(),Ap(H.getView(),v));var J={};J.x=Z.x*d+$.tx(),J.y=Z.y*d+$.ty(),J.width=Z.width*d,J.height=Z.height*d,re(v,J),this.intersects()?(v.style.border="",v.style.background=$.getRectSelectBackground()):(v.style.background="",v.style.border="1px solid "+$.getRectSelectBorderColor())},handle_mousedown:function(n){var z=this,E=z.gv;if(z._57I=C,!(E._editing||E._scrolling||Nf())){var s=E.getDataAt(n),Y=E.sm();if(s)if(md(n))Y.co(s)?Y.rs(s):Y.as(s);else if(Y.co(s)){if(co(n)&&s instanceof vi&&s.isClickThroughEnabled()){var o=E.getDataAt(n,function(S){E._clickThroughChecking=!0;var h=S.getParent()===s&&E.isSelectable(S);return delete E._clickThroughChecking,h});o&&(n.clickThrough=!0,Y.ss(o))}}else Y.ss(s);else md(n)||!E.isPannable()?Pr(n)&&(md(n)||Y.cs(),E.isRectSelectable()&&(z.startDragging(n),E._77O=1)):Pr(n)&&(z._57I=vq(n))}},handle_mouseup:function(d){var T=this,I=T._57I;I&&(Xo(I,vq(d))<=1&&T.gv.sm().cs(),T._57I=C)},handleWindowMouseUp:function(T){this.clear(T)},handleWindowMouseMove:function(b){var W=this,G=W.gv;W._logicalPoint=G.lp(b),W.mark?(W.fi({kind:"betweenRectSelect",event:b}),G.isPannable()&&W.autoScroll(b),W.redraw()):W.fi({kind:"beginRectSelect",event:b}),W.mark=xo(W._lastLogicalPoint,W._logicalPoint),W.redraw()},intersects:function(){var w=this,o=w._lastLogicalPoint,s=w._logicalPoint;return o.x>s.x||o.y>s.y},clear:function(d){var G=this,E=G.gv,l=G.mark;if(G._57I=C,G._lastLogicalPoint){if(l){if(0!==l.width&&0!==l.height){var Q=E.getDatasInRect(l,G.intersects());if(!Q.isEmpty()){var $=E.sm(),b=$.toSelection();Q.each(function(S){$.co(S)?b.remove(S):b.add(S)}),$.ss(b)}}ks(G.div),delete G.div,delete G.mark,G.redraw(),G.fi({kind:"endRectSelect",event:d}),E.onRectSelectEnded()}G.clearDragging(),delete E._77O}},redraw:function(){var u=this;u._draw||(u._draw=1,i(function(){u.mark&&u._42(),delete u._draw},16))}});var rs=Iq.MoveInteractor=function(T){Nm(rs,this,[T])};dc("MoveInteractor",Ip,{handle_mousedown:function(L){var D=this,R=D.gv;if(Pr(L)&&!R._editing&&!R._scrolling&&!Nf()){var j=R.getSelectedDataAt(L);!j||R.isInteractive(j)&&!R.isMovable(j)?R._focusData=C:(D._data=j,R.handleMouseDown&&R.handleMouseDown(L,j),D.startDragging(L),R.isMovable(j)&&(R._moving=1))}},handleWindowMouseUp:function(P){var p=this,w=p.gv;w.handleMouseUp&&w.handleMouseUp(P,p._data),p.clear(P)},handleWindowMouseMove:function(G){var E=this,c=E._data,B=E.gv;if((!B._93O||!B._93O(G,c))&&B._moving){E._logicalPoint||E.fi({kind:"prepareMove",event:G});var k=E._logicalPoint?"betweenMove":"beginMove",L={kind:k,event:G},p=E._logicalPoint=B.lp(G);"beginMove"!==k||E._alreadyBeginTransaction||(E._alreadyBeginTransaction=!0,B.getDataModel().beginTransaction());var y=E._calcShift(k,G),Z=y.x,M=y.y,C=E.gv.getMoveMode(G,c);C&&("x"===C?M=0:"y"===C?Z=0:"xy"!==C&&(Z=M=0)),B.moveSelection(Z,M),E._lastLogicalPoint=p,E.autoScroll(G),E.fi(L)}},_calcShift:function(){var V=this,n=V._logicalPoint,u=V._lastLogicalPoint,p=n.x-u.x,O=n.y-u.y;return{x:p,y:O}},clear:function(L){var j=this,l=j.gv;j._lastLogicalPoint&&(j._lastLogicalPoint=j._data=l._moving=C,j._logicalPoint&&(j.fi({kind:"endMove",event:L}),l.onMoveEnded()),j.clearDragging()),j._alreadyBeginTransaction&&(j._alreadyBeginTransaction=!1,l.getDataModel().endTransaction())}});var xq=Iq.ScrollBarInteractor=function(C){Nm(xq,this,[C])};dc("ScrollBarInteractor",Ip,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(l){var Y=this.gv.getViewRect();return this._41o()&&(Y.x+Y.width-this.gv.lp(l).x)*this.gv.getZoom()<Oi},isH:function(g){var W=this.gv.getViewRect();return this._40o()&&(W.y+W.height-this.gv.lp(g).y)*this.gv.getZoom()<Oi},handle_mousemove:function(v){this.handle_touchmove(v)},handle_touchmove:function(f){if(!Mc&&Pr(f)&&this.gv.isScrollBarVisible()){var q=this,F=q.isV(f),Y=q.isH(f);(F||Y)&&q.gv.showScrollBar(),q.gv._scrolling=F||Y}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(D){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=C,this.fi({kind:"endScroll",event:D})},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(K){var S=this;if(S.gv.setFocus(K),Ib(K),S.handle_touchmove(K),!(vm(K)>1)&&S.gv._scrolling&&S.gv.isScrollBarVisible()){S._cp=vq(K),S._tx=S.gv.tx(),S._ty=S.gv.ty();var a=S.isV(K);S._state=a?"vScroll":"hScroll",qf(S,K),S.fi({kind:"beginScroll",event:K})}},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(S){var K=vq(S),L=this.gv.getViewRect(),q=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-K.y)*q.height/L.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-K.x)*q.width/L.width),this.fi({kind:"betweenScroll",event:S})}});var Uc=Iq.TouchInteractor=function(q,R){R=R||{},R.selectable===r&&(R.selectable=!0),R.movable===r&&(R.movable=!0),R.pannable===r&&(R.pannable=!0),R.pinchable===r&&(R.pinchable=!0),R.editable===r&&(R.editable=!0),this.params=R,Nm(Uc,this,[q])};dc("TouchInteractor",Ip,{ms_edit:1,setUp:function(){var o=this;Uc.superClass.setUp.call(o),_n&&o.params.editable&&o.gv.setEditInteractor(o)},tearDown:function(){var I=this;Uc.superClass.tearDown.call(I),_n&&I.params.editable&&I.gv.setEditInteractor(C)},clear:function(B){var O=this,g=O.gv;g._moving&&(O.fi({kind:"endMove",event:B}),delete g._moving,g.onMoveEnded(),g.dm().endTransaction()),g._panning&&(O.fi({kind:"endPan",event:B}),delete g._panning,g.onPanEnded()),g._pinching&&(O.fi({kind:"endPinch",event:B}),delete g._pinching,g.onPinchEnded()),g._editing&&(O._46O(B),O._77I=O._node=O._edge=O._shape=O._rect=O._89I=O._index=g._editing=C),O._moving=O._panning=O._pinching=O._editing=O._57I=O._data=O._beginHistory=C,O.clearDragging()},handle_touchstart:function(i){var h=this;if(!h.gv._editing){Ib(i),h._57I=C;var V=h.params,z=h.gv,L=z.sm(),$=z.getDataAt(i),k=vm(i);if(1===k){if(co(i))return z.handleDoubleClick(i,$),void 0;z.handleClick(i,$),$&&(z.handleMouseDown&&z.handleMouseDown(i,$),h._data=$),V.selectable||($=C),$?(L.co($)||L.ss($),V.editable&&z.isEditable($)&&h._79I(i,$,!0)?(h._editing=1,h.startDragging(i)):V.movable&&z.isMovable($)&&(h._moving=1,h.startDragging(i))):(h._57I=vq(i),V.pannable&&z.isPannable()&&(h._panning=1,h.startDragging(i),h._translate={x:z.tx(),y:z.ty()}))}else if(V.pinchable&&2===k){h._pinching=1,h.startDragging(i);var b=z.getView(),e=z.getZoom(),W=b.getBoundingClientRect(),H=i.touches[0],a=i.touches[1],G={x:(H.clientX+a.clientX)/2-W.left,y:(H.clientY+a.clientY)/2-W.top};G.x-=z.tx(),G.y-=z.ty(),G.x/=e,G.y/=e,h._p=G,h._d=An(i)}}},handle_touchend:function(p){var N=this,A=N.gv,h=N._57I,X=N._data;h&&(Xo(h,vq(p))<=1&&A.sm().cs(),N._57I=C),X&&A.handleMouseUp&&A.handleMouseUp(p,X)},handleWindowTouchEnd:function(C){this.clear(C)},handleWindowTouchMove:function(B){var M=this,p=M.gv,Y=vm(B);if(1===Y){if(M._editing&&(M._beginHistory||(M._beginHistory=1,p.dm().beginTransaction()),p._editing=1,M._78I(B)),M._moving)M._beginHistory||(M._beginHistory=1,p.dm().beginTransaction()),M.handleMove(B);else if(M._panning){var E=vq(B);p.setTranslate(M._translate.x+E.x-M._lastClientPoint.x,M._translate.y+E.y-M._lastClientPoint.y),M.fi({kind:p._panning?"betweenPan":"beginPan",event:B}),p._panning=1}}else if(2===Y&&M._pinching){var y=An(B);p.handlePinch(M._p,y,M._d),M._d=y,M.fi({kind:p._pinching?"betweenPinch":"beginPinch",event:B}),p._pinching=1}},handleMove:function(V){var R=this,j=R.gv,T=j.lp(V);j._93O&&j._93O(V,R._data)||(j.moveSelection(T.x-R._lastLogicalPoint.x,T.y-R._lastLogicalPoint.y),R._lastLogicalPoint=T,R.autoScroll(V),R.fi({kind:j._moving?"betweenMove":"beginMove",event:V}),j._moving=1)}});var u=N.ht,Ql=u.graph._editor={Math:u.Math,Guide:{}};Ql.getStyle=function(x){var D,M=Ql.StyleMap;return M&&(D=M[x],D!==r)?D:Ql.DefaultStyleMap[x]},Ql.setStyle=function(m,O){var u=Ql.StyleMap;u||(u=Ql.StyleMap={}),u[m]=O},Ql.inEdit=function(P){return P._inXEdit===!0},Ql.startEdit=function($){$._inXEdit=!0,Ql.Inject.doInject($)},Ql._46O=function(b){b._inXEdit=!1,Ql.Inject.undoInject(b)},Ql.toScreenPosition=function(e,h){var A=e.tx(),F=e.ty(),B=e._zoom;return new Ql.Math.Vector2(h.x*B+A,h.y*B+F)},Ql.checkHit=function(J,c,y){return J.distanceTo(c)<y?!0:!1},Ql.toWorldPosition=function(M,Z){var c=M.tx(),H=M.ty(),S=M._zoom;return{x:(Z.x-c)/S,y:(Z.y-H)/S}},Ql.setAntialias=function(R,T){for(var y,I=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],E=0,L=I.length;L>E&&(y=I[E],!(y in R));E++);R[y],R[y]=T},Ql.getTargetCornersOnScreen=function(K,C){if(!C)return null;var Y,E=[];if(nh(C,K)){var x=lb(K,C);Y=[{x:x.x,y:x.y},{x:x.x+x.width,y:x.y},{x:x.x+x.width,y:x.y+x.height},{x:x.x,y:x.y+x.height}]}else{if(!C.getCorners)return null;Y=C.getCorners()}return Y.forEach(function(h){var P=Ql.toScreenPosition(K,h);E.push(P.x,P.y)}),E},Ql.log=function(){};var Jl=Ql.Inject={_modules:[]};Jl.registAsModule=function(B,g){var C={},Q={};for(var R in B){var A=g.prototype[R];C[R]=A}B.getBackup=function(k){return C[k]},B.getBackups=function(){return C},Q.doInject=function(){for(var Z in B)"getBackup"!==Z&&(g.prototype[Z]=B[Z])},Q.undoInject=function(){for(var n in B)"getBackup"!==n&&(g.prototype[n]=C[n])},Jl._modules.push(Q)},Jl.doInject=function(i){for(var C,$=Jl._modules,u=0,f=$.length;f>u;u++)C=$[u],C.doInject(i)},Jl.undoInject=function(Z){for(var o,$=Jl._modules,H=0,D=$.length;D>H;H++)o=$[H],o.undoInject(Z)};var Ip=u.graph.EditInteractor=function(q){var i=this,M=p.createElement("canvas");M.className="editCanvas",M.style.position="absolute",i._styleMap={},i._canvas=M,i._context=M.getContext("2d"),Ip.superClass.constructor.call(i,q),Ql.setAntialias(i._context,!1),i._subModules=[new Ql.Anchor(i),new Ql.Rect(i),new Ql.Curve(i),new Ql.MoveHelper(i)],i._gridGuide=new Ql.Guide.Grid(i),i._rectGuide=new Ql.Guide.Rect(i)},Nq=Ip;u.Default.def(Ip,u.graph.Interactor,{ms_edit:1,ms_fire:1}),m.defineProperties(Ip.prototype,{editDetail:{get:function(){var l=!!this._editDetail;return l},set:function(h){var K=this,l=K._editDetail;l!==h&&(K._editDetail=h,K.gv._editing=h,K.fp("editDetail",l,h),K.fp("pointsEditingMode",l,h),K.fi({kind:h?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(o){(!this._editDetail||o)&&(this.gv._editing=o,o||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(m){this._editing=m,this.gvEditing=m}},pointsEditingMode:{get:function(){return this.editDetail},set:function(Q){var N=this;N.editDetail!==Q&&(Q?N._tryEnterEditDetailMode():N._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var p=this._gridEnabled;if(!p)return!1;var I=this.gv;return I?!0:!0},set:function(l){l!==this._gridEnabled&&(this._gridEnabled=l,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(x){x!==this._agEnabled&&(this._agEnabled=x,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Ip.prototype.getSubModule=function(O){var f,C,Z,l=this._subModules;for(C=0,Z=l.length;Z>C;C++)if(f=l[C],f.catalog===O)return f},Ip.prototype.invokeSubModule=function(t,_){var w=this,v=w._subModules;if(v)for(var i,M,I,z=Array.prototype.slice.call(arguments,2),E=0,k=v.length;k>E;E++)if(i=v[E],M=i[t],M&&(I=M.apply(i,z),I!=r&&_))return i},Ip.prototype.invokeSubModuleInverse=function(p,q){var g=this,U=g._subModules;if(U)for(var j,S,N,X=Array.prototype.slice.call(arguments,2),L=U.length-1;L>=0;L--)if(j=U[L],S=j[p],S&&(N=S.apply(j,X),N!=r&&q))return j},Ip.prototype.setUp=function(){Ql.log("setUp");var I=this,a=I.gv,u=a.getView(),C=I._canvas;Ip.superClass.setUp.call(I),a.setEditInteractor(I),a._79O?u.insertBefore(C,a._79O):u.appendChild(C),Ql.startEdit(a),I.invokeSubModule("setUp"),a.dm().mm(I._onDataModelChanged,I),a.dm().md(I._onDataPropertyChanged,I)},Ip.prototype.tearDown=function(){Ql.log("tearDown");var G=this,h=G.gv,k=h.getView();G._resetCustomCursorStyle(),Ip.superClass.tearDown.call(G),h.dm().umm(G._onDataModelChanged,G),h.dm().umd(G._onDataPropertyChanged,G),h.setEditInteractor(null),k.removeChild(G._canvas),G._drawTimer&&(A(G._drawTimer),G._drawTimer=null),Ql._46O(h),G.invokeSubModule("tearDown")
},Ip.prototype._onDataModelChanged=function(G){var J=this;("clear"===G.kind||"remove"===G.kind&&J.editDetail&&G.data===J.getSubModule("Curve").target)&&(J.editDetail=!1,J._42())},Ip.prototype._onDataPropertyChanged=function(b){var t=this;if(t.editDetail){var B=t.getSubModule("Curve"),J=b.data;J===B.target&&(J._writing||B._handleDataChanged())}},Ip.prototype.clear=function(){Ql.log("clear")},Ip.prototype.redraw=function(){this._42()},Ip.prototype._42=function(){var X=this;X._drawTimer||(X._drawTimer=i(function(){X._drawTimer=null,X.drawImpl()},0))},Ip.prototype.drawImpl=function(){var J;for(J in{_42:!0})break;return function(){var h=this,l=h._canvas,i=h.gv,E=i.getWidth(),$=i.getHeight(),M=h._context,k=u.Default.getInternal();(l.width!==E||l.height!==$)&&k.setCanvas(l,E,$),M.clearRect(0,0,l.width,l.height);var o=h._getValidSelection();M.save();var q=u.Default.devicePixelRatio;M.scale(q,q),h._gridGuide._42(),h.invokeSubModuleInverse(J,!1,M,i,o),h._rectGuide._42(),M.restore()}}(),Ip.prototype._getValidSelection=function(){var E=this,r=E.gv,p=r.sm().getSelection(),F=[];return p.each(function($){r.isVisible($)&&r.isEditable($)&&F.push($)}),F},Ip.prototype.handle_touchmove=function(V){return this.handle_mousemove(V)},Ip.prototype.handle_mousemove=function(t){if(!u.Default.isDragging()){var v=this;(v.editDetail||!Nf())&&(v.gvEditing=!1,v._checkEdit(t)&&(v.gvEditing=!0))}},Ip.prototype.handle_touchstart=function(O){return this.handle_mousedown(O)},Ip.prototype.handle_mousedown=function(N){Ib(N);var B=this;if(B.editDetail||!Nf()){if(co(N)&&!N.clickThrough){if(B.editDetail){if(B._tryQuitEditDetailMode(N))return}else if(B._tryEnterEditDetailMode())return;B.gv.dm().beginTransaction();var w=B.invokeSubModule("handleDoubleClick",!0,N);if(B.gv.dm().endTransaction(),w)return}var t=B._checkEdit(N);t&&(B._downPosition=B._getLogicalPoint(N),B.gv.dm().beginTransaction(),t.startEdit(B,N),B.editing=!0)}},Ip.prototype._checkEdit=function(j){var g=this,p=g.gv,W=g._getLogicalPoint(j),K=g.invokeSubModule("check",!0,p,j,W)||null;return g._editMod=K,K},Ip.prototype.handleWindowTouchMove=function(W){return this.handleWindowMouseMove(W)},Ip.prototype.handleWindowMouseMove=function(P){var x=this,X=x._downPosition;if(X){var j=x._getLogicalPoint(P);if(j.distanceTo(X)<x.getStyle("moveSensitivity"))return;delete x._downPosition}var m=x._editMod;m&&m.handleEdit(x.gv,P)},Ip.prototype._getLogicalPoint=function(o){var b=this,g=u.Default.getLogicalPoint(o,b._canvas);return new Ql.Math.Vector2(g)},Ip.prototype.handleWindowTouchEnd=function(m){return this.handleWindowMouseUp(m)},Ip.prototype.handleWindowMouseUp=function(){var t;for(t in{_46O:!0})break;return function(Q){var n=this;n.editing=!1,n.setCursor("default"),n.invokeSubModule(t,!1,Q),n._42(),n.gv.dm().endTransaction()}}(),Ip.prototype.handle_mousewheel=function(u){var v=this;Ib(u),v.invokeSubModule("preHandleScroll",!0)||v.gv.handleScroll(u,u.wheelDelta)},Ip.prototype.handleDelete=function(){var a=this;if(!a.editDetail){a.gv.dm().beginTransaction();var Z=a.invokeSubModule("handleNormalStateDelete",!0);return a.gv.dm().endTransaction(),Z||a.gv.removeSelection(),void 0}a.gv.dm().beginTransaction(),a.invokeSubModule("handleDelete",!0),a.gv.dm().endTransaction(),a._42()},Ip.prototype.handle_keydown=function(o){var B=this;if((o.metaKey||o.ctrlKey)&&B._42(),Nf(o)&&!B.editing)return B.gvEditing=!1,B.setCursor("default"),B._42(),void 0;var F=Zh(o);return B.editDetail?((F||Rp(o))&&(B.editDetail=!1,B._42()),B.gv.dm().beginTransaction(),B.invokeSubModule("handle_keydown",!0,o),B.gv.dm().endTransaction(),void 0):(B.gv.dm().beginTransaction(),B.invokeSubModule("handleNormalStateKeyDown",!0,o),B.gv.dm().endTransaction(),F&&B._tryEnterEditDetailMode(),void 0)},Ip.prototype.handle_keyup=function(u){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,u),this.gv.dm().endTransaction()},Ip.prototype._tryEnterEditDetailMode=function(){var N=this;return!N.editDetail&&N.invokeSubModule("canEnterEditDetailMode",!0)&&1===N._getValidSelection().length?(N.editDetail=!0,N._42(),!0):void 0},Ip.prototype._tryQuitEditDetailMode=function(d){var L=this;if(L.editDetail){var f=L.gv,u=L.getSubModule("Curve").target;return d&&f.getDataAt(d)===u?void 0:(L.editDetail=!1,L._42(),!0)}},Ip.prototype.setStyle=function(G,H,D){var P=this;D?Ql.setStyle(G,H):P._styleMap[G]=H,P.fp("styleChanged",null,{key:G,value:H,base:D}),P._42()},Ip.prototype.getStyle=function(Q){var O=this,u=O._styleMap[Q];return u!==r?u:Ql.getStyle(Q)},Ip.prototype.setCursor=function(d){this._resetCustomCursorStyle(),u.graph.EditInteractor.superClass.setCursor.call(this,d)},Ip.prototype._resetCustomCursorStyle=function(){var K=this;if(K._customStyle){var X=this.gv.getView();X.classList&&X.classList.remove&&X.classList.remove(K._customStyle),K._customStyle=null}},Ip.prototype._setRotateCursor=function(w){var o=this,s=o._cursorFactory;s||(s=o._cursorFactory=new Ql.CursorFactory(o));var z=s.getRotateCursor(w),O=o.gv.getView();o._resetCustomCursorStyle(),o._customStyle=z,O.classList&&O.classList.add&&O.classList.add(z)};var Jd=Ql.Group=function(b){var h=this;h._entities=b,h._64O=0,h._position={x:0,y:0},h._scale={x:1,y:1},h._anchor={x:.5,y:.5},h._anchor2={x:.5,y:.5}};Jd.prototype={},Jd.prototype.constructor=Jd;var Rk=null;Jd.findOrCreateGroup=function(h){if(Rk&&Rk.checkIsMe(h))return Rk;var G=new Ql.Group(h);return G.getKeyOb()?(Rk=G,G):void 0},Jd.prototype.checkIsMe=function(N){var y=this._entities;if(y.length!==N.length)return!1;var X,M={},$=N.length;for(X=0;$>X;X++)M[N[X]._id]=!0;for(X=0;$>X;X++)if(!M[y[X]._id])return!1;return!0},Jd.prototype.getRotation=function(){return this._64O},Jd.prototype.getPosition=function(){return this._position},Jd.prototype.getAnchor=function(){return this._anchor},Jd.prototype.getWidth=function(){return this._width},Jd.prototype.getScale=function(){return this._scale},Jd.prototype.getSize=function(){return{width:this._width,height:this._height}},Jd.prototype.getHeight=function(){return this._height},Jd.prototype.getKeyOb=function(){for(var i=this._entities,V=i.length-1;V>=0;V--){var y=i[V];if(this.isNode(y))return y}},Jd.prototype.getAnchor2=function(){var S=this,U=S.rotateCenter;if(U)return U;var E=S.getKeyOb();if(!E)return S._anchor;var M=S._anchor2,Q=E.getMatrix();return Q.tf({x:E.getWidth()*(M.x-E.getAnchor().x),y:E.getHeight()*(M.y-E.getAnchor().y)})},Jd.prototype.setAnchor2=function(_,P){var L=this,w=L.getKeyOb();if(w){var t,b=w.getMatrix();t="number"==typeof _?{x:_,y:P}:_;var i=b.tfi(t);L._anchor2={x:w.getAnchor().x+i.x/w.getWidth(),y:w.getAnchor().y+i.y/w.getHeight()}}},Jd.prototype.setRotation=function(){},Jd.prototype.beginRotate=function(r){this.rotateCenter=r.pos,this.rotateMode=r.groupRotateMode},Jd.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Jd.prototype.addRotation=function(N,h){return"batch"===h?this._addRotationInBatchMode(N):"block"===h?this._addRotationInBlockMode(N):void 0},Jd.prototype._addRotationInBlockMode=function(C){var M=this,J=M.rotateCenter||M.getPosition();M._entities.forEach(function(G){if(M.isNode(G)){var V=G.getMatrix();V.translate(-J.x,-J.y),V.rotate(C),V.translate(J.x,J.y);var T=Math.sign(G.getScale().x);G.setRotation(W(V.b*T,V.a*T)),G.setPosition(V.tx,V.ty)}})},Jd.prototype._addRotationInBatchMode=function(V){var i=this,G=i._anchor2;i._entities.forEach(function(z){if(i.isNode(z)){var C=z.getAnchor(),q=z.getMatrix(),x=q.tf({x:z.getWidth()*(G.x-C.x),y:z.getHeight()*(G.y-C.y)}),_=new Ql.Math.Matrix2d;_.set(q.a,q.b,q.c,q.d,q.tx,q.ty),_.translate(-x.x,-x.y),_.rotate(V),_.translate(x.x,x.y);var v=Math.sign(z.getScale().x);z.setRotation(W(_.b*v,_.a*v)),z.setPosition(_.tx,_.ty)}})},Jd.prototype.setPosition=function(P){var y,A,F,c,T=this,b=T._position,D=P.x-b.x,f=P.y-b.y,Q=T._entities;for(A=0,F=Q.length;F>A;A++)y=Q[A],Cp(y)&&(c=y.getPosition(),y.setPosition(c.x+D,c.y+f));T._position=P},Jd.prototype.setScale=function(f,M){var l=this,c=f/l._scale.x,Q=M/l._scale.y;l._adjustChildScaleOrSize(c,Q,"size"),l._scale={x:f,y:M}},Jd.prototype.getRect=function(){var o=this,A=o._position,e=o._width,r=o._height;return{x:A.x-e/2,y:A.y-r/2,width:e,height:r}},Jd.prototype.setSize=function(s,M){var $=this,s=Math.max(1,s),M=Math.max(1,M),d=s/$._width,A=M/$._height;$._adjustChildScaleOrSize(d,A,"size"),$._width=s,$._height=M},Jd.prototype._adjustChildScaleOrSize=function(D,v,Y){var N,s,c,o,u,F,K,L,r,R,Q,q,O,l,Z=this,G=Z._position,f=Z._entities,P=new Ql.Math.Matrix2d;for(s=0,c=f.length;c>s;s++)if(N=f[s],Z.isNode(N)){if(o=N.getPosition(),u=N.getRotation(),F=N.getWidth(),K=N.getHeight(),L=N.getScale(),Q=L.x*F,q=L.y*K,P.identity().scale(Q,q).rotate(u).translate(o.x,o.y).translate(-G.x,-G.y).rotate(-Z._64O),u=W(P.b*Math.sign(Q),P.a*Math.sign(Q)),P.scale(D,v),r=Math.cos(u),R=Math.sin(u),Math.abs(r)<.001?(O=P.b/R,l=-P.c/R):(O=P.a/r,l=P.d/r),"scale"===Y)N.setScale(O/F,l/K);else if("size"===Y){var b=O/L.x,j=l/L.y;N.setScale(Ld(O)*Math.abs(L.x),Ld(l)*Math.abs(L.y)),N.setSize(Math.max(.1,Math.abs(b)),Math.max(.1,Math.abs(j)))}P.rotate(Z._64O).translate(G.x,G.y),N.setPosition(P.tx,P.ty)}},Jd.prototype.getMatrix=function(){var Q=this,L=Q._position,o=u.Default.getInternal(),F=Q._scale;return new o.Mat(Q._64O,L.x,L.y,F.x,F.y)},Jd.prototype.toGlobal=function(V){return this.getMatrix().tf(V)},Jd.prototype.getCorners=function(){var F=this,H=F._width,G=F._height,O=F._anchor,b=-H*O.x,z=-G*O.y,v=F.getMatrix();return[v.tf(b,z),v.tf(b,z+G),v.tf(b+H,z+G),v.tf(b+H,z)]},Jd.prototype.calcInfo=function(){var S,i,H,w,b,s,I=this,R=[],O=I._entities,t=I._64O;for(w=0,b=O.length;b>w;w++)s=O[w],I.isNode(s)&&s.getCorners&&R.push.apply(R,s.getCorners());if(R.length){var h=Math.cos(-t),W=Math.sin(-t),n=1/0,M=-1/0,x=1/0,c=-1/0;for(w=0,b=R.length;b>w;w++)H=R[w],S=H.x,i=H.y,H.x=h*S-W*i,H.y=W*S+h*i,n=Math.min(n,H.x),M=Math.max(M,H.x),x=Math.min(x,H.y),c=Math.max(c,H.y);I._width=(M-n)/I._scale.x,I._height=(c-x)/I._scale.y,h=Math.cos(t),W=Math.sin(t);var J=I._anchor;S=n+(M-n)*J.x,i=x+(c-x)*J.y,I._position={x:h*S-W*i,y:W*S+h*i}}},Jd.prototype.isNode=function($){return Cp($)?nh($)?!1:!0:!1},Jd.prototype._42=function(C,H,W){var A,m,V,t,X,J,K,i,Z=this,o=Z._entities,q=Z.rotateMode;for("batch"===q&&(i=Z.getKeyOb()),A=0,m=o.length;m>A;A++)V=o[A],Z.isNode(V)&&(J=V.getRect(),t=Ql.toScreenPosition(W,{x:J.x,y:J.y}),X=Ql.toScreenPosition(W,{x:J.x+J.width,y:J.y+J.height}),K={min:t,max:X},V===i&&(K.isKeyOb=!0),Ql.Icons.DrawIcon(C,H,Ql.Icons.GroupSubEntityRect,K))};var ss=Ql.CurveActiving=function(c,P){this._curve=c,this._interactor=c._interactor;for(var L in P)this[L]=P[L]};ss.prototype={},ss.prototype.constructor=ss,m.defineProperties(ss.prototype,{point:{get:function(){return this._point},set:function(d){var i=this;i._point=d,i.editingCtrl||i._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(M){var K=this;K._pairs=M,K.editingCtrl&&K._firePointChange()}}}),ss.prototype._firePointChange=function(){var J=this,m=J.getCurrentEditingPoint();if(!m)return q.fi({kind:"selectPoint"}),void 0;var q=J._interactor,G=this._curve.target;if(G){var b=Ql.getDataMatrix(G).invert(),X=m.e;m=b.apply(Ql.toWorldPosition(q.gv,m)),m.e=X;var O=J._lastFirePoint;O&&Math.abs(m.x-O.x)<1e-5&&Math.abs(m.y-O.y)<1e-5&&(m.e==r&&O.e==r||Math.abs(m.e-O.e)<1e-5)||(J._lastFirePoint=m,q.fi({kind:"selectPoint",x:m.x,y:m.y,e:m.e}))}},ss.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ss.prototype.getCurrentEditingPoint=function(){var W=this,i=W.editingCtrl;if(i){var Q=W.pairs;if(Q){var $=Q[i.pairId],z=$[i.type];if(z)return z}}return W._point};var Ki=Ql.CursorFactory=function(D){var H=this;H._interactor=D,H._rotateCursorStyles={}};Ki.prototype={},Ki.prototype.constructor=Ki,Ki.prototype.getRotateCursor=function(e){var J=this;0>e&&(e+=2*Math.PI);var m=J._interactor,x=m.getStyle("rotateCursorSize"),I=m.getStyle("rotateCursorRound"),Z=Math.round(180*(e/Math.PI)/I);Z*I>=360&&(Z=0);var E=J._rotateCursorStyles,S="htCustomRotateStyle_"+x+"_"+I+"_"+Z;return E[S]||(J._produceRotateCursor(S,x,I,Z),E[S]=!0),S},Ki.prototype._produceRotateCursor=function(c,j,X,e){var x=this;x._interactor;var G=x._canvas;G||(G=x._canvas=p.createElement("canvas")),G.width=G.height=j*devicePixelRatio,G.style.width=G.style.height=j+" px";var l=G.getContext("2d");Ql.setAntialias(l,!1),l.scale(devicePixelRatio,devicePixelRatio);var E,y,$,N,D,o=Math.round(j/2),T=""+o+" "+o+",auto !important;";E=Math.PI/180*e*X,l.clearRect(0,0,j,j),l.save(),l.scale(j/32,j/32),l.translate(16,16),l.rotate(E+Math.PI/2),l.beginPath(),l.moveTo(-8,0),l.lineTo(-8,3),l.lineTo(-5,3),l.moveTo(8,0),l.lineTo(8,3),l.lineTo(5,3),l.moveTo(-8,3),l.quadraticCurveTo(0,-6,8,3),l.restore(),l.strokeStyle="white",l.lineWidth=4,l.stroke(),l.strokeStyle="black",l.lineWidth=2,l.stroke(),y=JSON.stringify(G.toDataURL()),N="cursor:url("+y+")"+T,1!==devicePixelRatio&&($='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+j+'px" height="'+j+'px"><image xlink:href='+y+' width="'+j+'" height="'+j+'"/></svg>',N+="cursor:url(data:image/svg+xml;base64,"+btoa($)+")"+T,N+="cursor:-webkit-image-set(url("+y+")"+devicePixelRatio+"x,url("+y+")1x)"+T),D=p.createElement("style"),D.textContent="body."+c+" *, ."+c+"{"+N+"}",p.head.appendChild(D)};var jp=Ql.Guide.Grid=function(w){var b=this;b._interactor=w,b._alignmentGuideId=0,b._xAlignmentGuide=[],b._yAlignmentGuide=[]};jp.prototype={},jp.prototype.constructor=jp,m.defineProperties(jp.prototype,{gridBlockSize:{get:function(){var A=this;return A._gridBlockSize||A._interactor.getStyle("gridBlockSize")},set:function(c){this._gridBlockSize=c,this._interactor._42()}},gridThickLinesEvery:{get:function(){var A=this;return A._gridThickLinesEvery||A._interactor.getStyle("gridThickLinesEvery")},set:function(t){this._gridThickLinesEvery=t,this._interactor._42()}},gridEnabled:{get:function(){var J=this,n=J._interactor;return n.gridEnabled&&J.isValidGrid()}}}),jp.prototype._42=function(){var J=this,a=J._interactor;J.gridEnabled&&J.drawGrid(),a.alignmentGuideEnabled&&J.drawAlignmentGuide()},jp.prototype.makeMatrix=function(){var g=this,G=g._interactor.getStyle("gridAngle"),M=g._interactor.getStyle("gridRotation"),u=new Ql.Math.Matrix2d,I=Math.sin(G),T=Math.cos(G);return u.set(1,0,T,I,0,0),u.rotate(M),u},jp.prototype.isValidGrid=function(){var I=this,Q=Math.PI,P=I._interactor,k=P.gv;if(k._zoom<P.getStyle("gridZoomThreshold"))return!1;var x=P.getStyle("gridAngle"),O=Math.abs(180*(x%Q/Q)),v=1-1e-8;return v>O||O>180-v?!1:!0},jp.prototype.drawAlignmentGuide=function(){var j=this,d=j._interactor,v=d.gv,a=d._canvas,g=d._context,k=a.width,i=a.height,m=v.tx(),B=v.ty(),X=v._zoom;g.beginPath(),g.strokeStyle=d.getStyle("gridAlignmentGuideColor"),g.lineWidth=1,j._xAlignmentGuide.forEach(function(B){var N=B.p*X+m;g.moveTo(N,0),g.lineTo(N,i)}),j._yAlignmentGuide.forEach(function(E){var s=E.p*X+B;g.moveTo(0,s),g.lineTo(k,s)}),g.stroke()},jp.prototype.drawGrid=function(){function I(D,M,j,R){var Q=Ql.toScreenPosition(p,q.apply({x:D,y:M})),Z=Ql.toScreenPosition(p,q.apply({x:j,y:R}));d.moveTo(Q.x,Q.y),d.lineTo(Z.x,Z.y)}var $=this,k=$._interactor,s=$.gridBlockSize,t=$.gridThickLinesEvery,Y=k.getStyle("gridThickColor"),D=k.getStyle("gridLightColor"),p=k.gv,C=k._canvas,d=k._context,g=C.width,n=C.height,q=$.makeMatrix(),u=q.applyInverse(Ql.toWorldPosition(p,{x:0,y:0})),Z=q.applyInverse(Ql.toWorldPosition(p,{x:g,y:0})),e=q.applyInverse(Ql.toWorldPosition(p,{x:0,y:n})),y=q.applyInverse(Ql.toWorldPosition(p,{x:g,y:n})),B=Math.min(u.x,Z.x,e.x,y.x),E=Math.max(u.x,Z.x,e.x,y.x),F=Math.min(u.y,Z.y,e.y,y.y),i=Math.max(u.y,Z.y,e.y,y.y);g=E-B,n=i-F;var P=Math.ceil(B/s),c=Math.floor(E/s),A=Math.ceil(F/s),l=Math.floor(i/s);p.tx(),p.ty(),p._zoom;var W,X,J;for(d.save(),d.lineWidth=1,d.beginPath(),d.strokeStyle=Y,J=Math.ceil(P/t)*t;c>=J;J+=t)W=J*s,I(W,F,W,i);for(J=Math.ceil(A/t)*t;l>=J;J+=t)X=J*s,I(B,X,E,X);for(d.stroke(),d.beginPath(),d.strokeStyle=D,J=P;c>=J;J++)0!==J%t&&(W=J*s,I(W,F,W,i));for(J=A;l>=J;J++)0!==J%t&&(X=J*s,I(B,X,E,X));d.stroke(),d.restore()},jp.prototype.getAlignmentGuides=function(){var F=this;return{x:F._xAlignmentGuide,y:F._yAlignmentGuide}},jp.prototype.addAlignmentGuide=function(e,T,l){var w=this,W="x"===e?w._xAlignmentGuide:w._yAlignmentGuide,l=l?l:++w._alignmentGuideId,c={p:T,id:l};if(W.length){var U=w._findClosestAlignmentGuide(c.p,W);U.dis<0?W.splice(U.index+1,0,c):W.splice(U.index,0,c)}else W.push(c);return w._interactor._42(),l},jp.prototype.findClosest=function(J,z,G){var x=this,b=x._interactor,U=b.gv;G&&(J=Ql.toWorldPosition(U,J));var F,E,h,$=1/0,s=1/0,n=J.x,m=J.y;if(x.gridEnabled){var M=x.gridBlockSize,v=x.makeMatrix(),Y=v.applyInverse(J);Y=v.apply({x:Math.round(Y.x/M)*M,y:Math.round(Y.y/M)*M}),$=Y.x-n,s=Y.y-m,h=!0}if(b.alignmentGuideEnabled&&(F=x._findClosestAlignmentGuide(n,x._xAlignmentGuide).dis,E=x._findClosestAlignmentGuide(m,x._yAlignmentGuide).dis,Math.abs(F)<Math.abs($)&&($=F,h=!0),Math.abs(E)<Math.abs(s)&&(s=E,h=!0)),h){h=!1;var d=U._zoom,k=b.getStyle("smartGuideSensitivity")/d,p={};if(Math.abs($)<k&&"y"!==z&&(p.x=G?$*d:$,h=!0),Math.abs(s)<k&&"x"!==z&&(p.y=G?s*d:s,h=!0),h)return p}},jp.prototype._findClosestAlignmentGuide=function(g,b){if(!b.length)return{dis:1/0};for(var p,V=0,$=b.length-1;$-V>1;)p=Math.floor((V+$)/2),b[p].p<g?V=p:$=p;var s=b[V].p-g,B=b[$].p-g;return Math.abs(s)<=Math.abs(B)?{line:b[V],dis:s,index:V}:{line:b[$],dis:B,index:$}},jp.prototype.removeAllAlignmentGuide=function(q){var F=this;"y"!==q&&(F._xAlignmentGuide=[]),"x"!==q&&(F._yAlignmentGuide=[]),F._interactor._42()},jp.prototype.removeAlignmentGuide=function(g){for(var k,L,C,D=this,A=D._xAlignmentGuide,e=0;2>e;e++)for(A=0===e?D._xAlignmentGuide:D._yAlignmentGuide,k=0,L=A.length;L>k;k++)if(C=A[k],C.id===g)return A.splice(k,1),D._interactor._42(),{axis:0===e?"x":"y",position:C.p};return!1},jp.prototype.adjustAlignmentGuide=function(Z,I){var w=this,t=w.removeAlignmentGuide(Z);return t?(w.addAlignmentGuide(t.axis,I,Z),!0):!1};var Ak=Ql.Guide.Rect=function(b){var J=this;J._interactor=b};Ak.prototype={},Ak.prototype.constructor=Ak,Ak.prototype.gatherRects=function(){var b,u,H,U,j=this,o=j._interactor.gv,s=[],B=[],J={x:s,y:B},A={},C=o.getDataModel(),Y=C.a("width"),S=C.a("height");Y&&S&&(b=0,u=0,H=Y,U=S,s.push({node:C,type:0,p:b},{node:C,type:1,p:b+H/2},{node:C,type:2,p:b+H}),B.push({node:C,type:0,p:u},{node:C,type:1,p:u+U/2},{node:C,type:2,p:u+U}),A[C._id||0]={x:b,y:u,width:H,height:U}),C.each(function(M){if(Cp(M)&&!o.isSelected(M)&&o.isVisible(M)){var i=!1;if(o.sm().getSelection().each(function(v){i||(M.isHostOn(v)?i=!0:M.isDescendantOf(v)&&(i=!0))}),!i){var l=M.getRect();b=l.x,u=l.y,H=l.width,U=l.height,s.push({node:M,type:0,p:b},{node:M,type:1,p:b+H/2},{node:M,type:2,p:b+H}),B.push({node:M,type:0,p:u},{node:M,type:1,p:u+U/2},{node:M,type:2,p:u+U}),A[M._id]=l}}}),s.sort(function(H,V){return H.p-V.p}),B.sort(function(e,$){return e.p-$.p}),j._grid=J,j._87I=A},Ak.prototype.gatherLines=function(W,e,$){var h,E,P,Z,J,q,R,Y,N,u,X,f,m=this,b=[m.findClosest({x:W.x,y:W.y},e),m.findClosest({x:W.x+W.w/2,y:W.y+W.h/2},e),m.findClosest({x:W.x+W.w,y:W.y+W.h},e)],x={},G=m._87I;$=$||255;var O,l;for(m._guideLine=[],h=0;2>h;h++)for(x={},0===h?(Z="y",Y=W.x,N=Y+W.w):(Z="x",Y=W.y,N=Y+W.h),E=0;3>E;E++)J=b[E],J&&isFinite(J[Z])&&(O=1<<3*h+E,$&O&&(q=J[Z+"Line"],R=q.node,l=R._id||0,x[l]||(x[l]=!0,f=G[l],"y"===Z?(u=f.x,X=f.x+f.width):(u=f.y,X=f.y+f.height),P=q.p,m._guideLine.push({type:Z,a:Y,b:N,c:u,d:X,p:P,center:1===q.type}))))},Ak.prototype._binarySearchClosest=function(j,f){if(!f.length)return{dis:1/0};for(var n,F=0,m=f.length-1;m-F>1;)n=Math.floor((F+m)/2),f[n].p<j?F=n:m=n;var h=f[F].p-j,l=f[m].p-j;return Math.abs(h)<=Math.abs(l)?{line:f[F],dis:h}:{line:f[m],dis:l}},Ak.prototype.findClosest=function(F,v,z){var g=this,K=g._interactor,M=K.gv,R=g._grid;z&&(F=Ql.toWorldPosition(M,F));var n,o=g._binarySearchClosest(F.x,R.x),p=g._binarySearchClosest(F.y,R.y),w=o.dis,m=p.dis,N=M._zoom,J=K.getStyle("smartGuideSensitivity")/N,X={};return Math.abs(w)<J&&"y"!==v&&(X.x=z?w*N:w,X.xLine=o.line,n=!0),Math.abs(m)<J&&"x"!==v&&(X.y=z?m*N:m,X.yLine=p.line,n=!0),n?X:void 0},Ak.prototype._42=function(){var x=this,y=x._guideLine;if(y&&!u.Default.isCtrlDown()){var r,V,e,w,W,I,N,f,g,d,O,M,K,G,s,c,Q,h=x._interactor,j=h.gv,q=h._context,D=j.tx(),E=j.ty(),n=j._zoom,X=h.getStyle("guideLineTextSpacing");for(r=0,V=y.length;V>r;r++)e=y[r],f=e.type,g=e.p,d=e.a,O=e.b,M=e.c,K=e.d,G=Math.min(d,M),s=Math.max(O,K),"x"===f?(w=g*n+D,W=G*n+E,I=w,N=s*n+E):(w=G*n+D,W=g*n+E,I=s*n+D,N=W),Ql.Icons.DrawIcon(h,q,Ql.Icons.MoveLineGuide,{rect:[w,W,I,N],center:e.center}),K>=d&&O>=M||(G=d>K?K:O,s=d>K?d:M,Q=s-G,"x"===f?(e.center2center||(w-=X,I=w),W=G*n+E,N=s*n+E,c=Ql.Icons.MoveLineGuideDistanceV):"y"===f&&(e.center2center||(W-=X,N=W),w=G*n+D,I=s*n+D,c=Ql.Icons.MoveLineGuideDistanceH),Ql.Icons.DrawIcon(h,q,c,{x0:w,y0:W,x1:I,y1:N,dis:Q}))}},Ak.prototype.clear=function(){this._guideLine=null},Ql.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var lh=Ql.Icons={},Ce=1e4,kh=null,Mp="rgb(51,153,255)",Mk="rgb(183,232,135)",lp="rgb(255,204,153)",Qi=6;u.Default.setImage("Icons.RectPoint",{width:Qi,height:Qi,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Mp,rect:[0,0,Qi,Qi]}]});var mm="#e000e0";lh.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var U=lh.GroupSubEntityRect.data;if(!U)return[];var r=U.min,X=U.max;return[r.x,r.y,r.x,X.y,X.x,X.y,X.x,r.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return lh.GroupSubEntityRect.data.isKeyOb?mm:"#666666"}}}]},lh.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[lh.Line.data.P1.x,lh.Line.data.P1.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[lh.Line.data.P2.x,lh.Line.data.P2.y],Qi,Qi]}}}]},lh.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return lh.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},lh.Rect={comps:[{type:"shape",points:{func:function(){var C=lh.Rect.data;if(!C)return[];var i=C.LT,D=C.LB,J=C.RB,H=C.RT;return[i.x,i.y,D.x,D.y,J.x,J.y,H.x,H.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Mp},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},rect:{func:function(){return[[lh.Rect.data.LT.x,lh.Rect.data.LT.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},rect:{func:function(){return[[lh.Rect.data.LB.x,lh.Rect.data.LB.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},rect:{func:function(){return[[lh.Rect.data.RB.x,lh.Rect.data.RB.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},rect:{func:function(){return[[lh.Rect.data.RT.x,lh.Rect.data.RT.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},visible:{func:function(){return lh.Rect.data.L?!0:!1}},rect:{func:function(){return[[lh.Rect.data.L.x,lh.Rect.data.L.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},visible:{func:function(){return lh.Rect.data.R?!0:!1}},rect:{func:function(){return[[lh.Rect.data.R.x,lh.Rect.data.R.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},visible:{func:function(){return lh.Rect.data.T?!0:!1}},rect:{func:function(){return[[lh.Rect.data.T.x,lh.Rect.data.T.y],Qi,Qi]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return lh.Rect.data.rotation}},visible:{func:function(){return lh.Rect.data.B?!0:!1}},rect:{func:function(){return[[lh.Rect.data.B.x,lh.Rect.data.B.y],Qi,Qi]}}}]};var xn=16;u.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Mp,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Mp,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),lh.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[lh.Anchor.data.POS.x,lh.Anchor.data.POS.y],xn,xn]}}}]},lh.TipShiftX=12,lh.TipShiftY=12;var Kh=[8,28];lh.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[lh.TipHelper.data.helperPos.x,lh.TipHelper.data.helperPos.y,Kh[0]*lh.TipHelper.data.size,Kh[1]]}},background:{func:function(){return kh.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return lh.TipHelper.data.text}},rect:{func:function(){return[lh.TipHelper.data.helperPos.x,lh.TipHelper.data.helperPos.y,Kh[0]*lh.TipHelper.data.size,Kh[1]]}},color:{func:function(){return kh.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Tq=7;lh.ShapePoint={comps:[{type:"circle",rect:{func:function(){var t=lh.ShapePoint.data.point;return[t,Tq,Tq]}},background:{func:function(){var E=lh.ShapePoint.data.isEnd;return E?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:Mp}]},lh.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return lh.ShapeBgCurve.data.P}},segments:{func:function(){return lh.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Mp}]};var bd=8;lh.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var p=lh.ShapeHighlighPoint.data;return[[p.x,p.y],bd,bd]}},background:{func:function(){return kh.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Gq=10;lh.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var o=lh.ShapeHighlighRealPoint.data;return[[o.x,o.y],Gq,Gq]}},background:"#ffffff",borderWidth:2,borderColor:Mp}]};var Xj=8;lh.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var U=lh.ShapeHighlighCtrlPoint.data,g=U.x,Q=U.y,J=Xj/2;return[g-J,Q-J,g-J,Q+J,g+J,Q+J,g+J,Q-J]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return kh.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return kh.getStyle("shapeCtrlPointBorderColor")||Mp}}}]};var Ck=3;lh.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return lh.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Ck,borderColor:{func:function(){return kh.getStyle("curveHighlightColor")}}}]},lh.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return lh.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},lh.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return lh.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return lh.MoveLineGuide.data.center?Mk:lp}}}]};var Np=5;lh.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var g=lh.MoveLineGuideDistanceH.data,C=g.x0,U=g.y0;return[C,U-Np,C,U+Np]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lp},{type:"shape",points:{func:function(){var h=lh.MoveLineGuideDistanceH.data,Q=h.x1,W=h.y1;return[Q,W-Np,Q,W+Np]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lp},{type:"text",text:{func:function(){return Math.round(lh.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var h=lh.MoveLineGuideDistanceH.data;return[[(h.x0+h.x1)/2,h.y0-10],20,20]}},color:lp,font:"12px Arial",align:"center"}]},lh.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var x=lh.MoveLineGuideDistanceV.data,i=x.x0,M=x.y0;return[i-Np,M,i+Np,M]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lp},{type:"shape",points:{func:function(){var e=lh.MoveLineGuideDistanceV.data,o=e.x1,g=e.y1;return[o-Np,g,o+Np,g]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lp},{type:"text",text:{func:function(){return Math.round(lh.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var S=lh.MoveLineGuideDistanceV.data;return[[S.x0-10,(S.y0+S.y1)/2],20,20]}},color:lp,font:"12px Arial",align:"center"}]},u.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),lh.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var P=lh.EdgeElevationGuide.data,d=P.x,b=P.y,w=kh.getStyle("curveElevationIntersectSize"),p=kh.getStyle("curveElevationGuideShift");return d+=p[0],b+=p[1],[d-w,b-w,2*w,2*w]}}}]},u.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),u.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),lh.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return lh.ConnectGuide.data.rotation}},rect:{func:function(){var b=lh.ConnectGuide.data.connect;b.x,b.y;var X=kh.getStyle("connectGuideIntersectSize");return[[b.x,b.y],2*X,2*X]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var a=lh.ConnectGuide.data.cursorPos||lh.ConnectGuide.data.connect,u=kh.getStyle("connectGuideIntersectSize");return[[a.x,a.y],2*u-2,2*u-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var D=lh.ConnectGuide.data.connect,N=lh.ConnectGuide.data.cursorPos||D;return[D.x,D.y,D.x+.5*(N.x-D.x),D.y,N.x+.5*(D.x-N.x),N.y,N.x,N.y]}}}]},u.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),u.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),lh.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var $=lh.ConnectGuideGarbage.data.hover;
return $?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var c=lh.ConnectGuideGarbage.data,A=kh.getStyle("connectGuideGarbageIntersectsize");return c.hover&&(A+=5),[[c.x,c.y],2*A,2*A]}}}]};var Qe=6;lh.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return lh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var e=lh.ShapeActivingCtrl.data;return[e.point.x,e.point.y,e.c1.x,e.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Mp},{type:"shape",visible:{func:function(){return lh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var d=lh.ShapeActivingCtrl.data;return[d.point.x,d.point.y,d.c2.x,d.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Mp},{type:"shape",visible:{func:function(){return lh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var R=lh.ShapeActivingCtrl.data.c1,g=R.x,l=R.y,C=Qe/2;return"c1"===lh.ShapeActivingCtrl.data.hl&&(C+=.5),[g-C,l-C,g-C,l+C,g+C,l+C,g+C,l-C]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return kh.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===lh.ShapeActivingCtrl.data.hl?kh.getStyle("shapeCtrlPointHighlightBorder")||Mp:kh.getStyle("shapeCtrlPointBorderColor")||Mp}}},{type:"shape",visible:{func:function(){return lh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var D=lh.ShapeActivingCtrl.data.c2,m=D.x,d=D.y,t=Qe/2;return"c2"===lh.ShapeActivingCtrl.data.hl&&(t+=.5),[m-t,d-t,m-t,d+t,m+t,d+t,m+t,d-t]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return kh.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===lh.ShapeActivingCtrl.data.hl?kh.getStyle("shapeCtrlPointHighlightBorder")||Mp:kh.getStyle("shapeCtrlPointBorderColor")||Mp}}}]},Ql.Icons.DrawIcon=function(s,F,h,J){h.width=h.height=Ce,h.data=J,kh=s,u.Default.drawImage(F,h,0,0,Ce,Ce)},Ql.Icons.MapPoints=function(v,Y){for(var x=0,K=v.length;K>x;x++)v[x]/=Y},Ql.roundTo=function(n,l,I){var Z=Math.abs(n%l);return I>Z||I>l-Z?l*Math.round(n/l):n},Ql.toFixed=function(B){return Math.round(100*B)/100},Ql.getDataMatrix=function(M){if(M instanceof u.Shape){var D=new u.Math.Matrix2d,z=M.getPosition();return D.translate(-z.x,-z.y).scale(M.getScale().x,M.getScale().y).rotate(M.getRotation()).translate(z.x,z.y),D}return M.getMatrix?M.getMatrix():new u.Math.Matrix2d};var ed=Ql.Math.Curve=function(){this._curves=[]};ed.prototype={},ed.prototype.constructor=ed,ed.prototype.createFromHtShape=function(c,q,i){q instanceof u.List&&(q=q.toArray());var T,F,R,y,Y,e,b,D=this,t=null,W=null,g=0,Q=Ql.Math.Vector2,k=Ql.Math.CubicBezier,Z=function(E){return new Q(c[E],c[E+1],i?i[E/2]:r)};for(F=0,R=q.length;R>F;F++){switch(y=q[F],Y=null,y){case 1:W=Z(g),t=W,g+=2;break;case 2:T=Z(g),g+=2,Y=new k(W,W.clone(),T.clone(),T),W=T;break;case 3:e=Z(g),T=Z(g+2),g+=4,Y=new k(W,e.clone().sub(W).multiplyScalar(2/3).add(W),e.clone().sub(T).multiplyScalar(2/3).add(T),T),W=T;break;case 4:e=Z(g),b=Z(g+2),T=Z(g+4),g+=6,Y=new k(W,e,b,T),W=T;break;case 5:if(!t)break;Y=new k(W,W.clone(),t.clone(),t),W=null,t=null}Y&&(Y._index=D._curves.length,D._curves.push(Y))}},ed.prototype.checkPoint=function(O,r){var J,Z,b,m,C,_=this,x=_._curves;for(J=0,Z=x.length;Z>J;J++)if(m=x[J],C=m.intersectRect(O,r,r),C.length)return b=0,C.forEach(function(K){b+=K.t}),b/=C.length,O=m.getPointAt(b),O.t=b,{bezier:m,intersection:O}},ed.prototype.insertKnot=function(t,o){var a=t.insertKnot(o),L=this,w=L._curves;w.splice(t._index,1,a[0],a[1])},ed.prototype._isCloseEnough=function(M,U){return Math.abs(M.x-U.x)<1e-6&&Math.abs(M.y-U.y)<1e-6},ed.prototype._isSamePoint=function(P,R){return P===R},ed.prototype.moveRealPoint=function(W,$){var J=this,T=J._curves,b=$.clone().sub(W);T.forEach(function(i){var F=i._p1;i._p2,i._p3;var Y=i._p4;J._isSamePoint(F,W)&&(i._p2.add(b),i._p1=$),J._isSamePoint(Y,W)&&(i._p3.add(b),i._p4=$)})},ed.prototype.moveCtrlDueToRealPointMovement=function(v,M){var H=this,K=H._curves,E=function(S){S.add(M),S.e&&M.e&&(S.e+=M.e)};K.forEach(function(O){var z=O._p1;O._p2,O._p3;var o=O._p4;H._isSamePoint(z,v)&&E(O._p2),H._isSamePoint(o,v)&&E(O._p3)})},ed.prototype.moveCtrlPoint=function(E,P,C){var i=E[C];if(i){i.e!==r&&(P.e=i.e);var f=this,l=f._curves;P.clone().sub(i),l.forEach(function(g){var H;"c2"===C?H="_p2":"c1"===C&&(H="_p3"),f._isSamePoint(g[H],i)&&(g[H]=P)}),E[C]=P}},ed.prototype.deleteRealPoint=function(d,f){var q,L,s,i,v,X,U,r=this,e=r._curves,b={},y=[],m=Ql.Math.CubicBezier;for(L=0,s=e.length;s>L;L++)q=e[L],i=q._p1,v=q._p2,X=q._p3,U=q._p4,(b[L]||!r._isSamePoint(i,d))&&(r._isSamePoint(U,d)?s>L+1&&r._isSamePoint(e[L+1]._p1,d)&&(f||y.push(new m(i,v,e[L+1]._p3,e[L+1]._p4))):y.push(q));r._curves=y},ed.prototype.findPairs=function(p,Y){var N,P,C,s,W,M,A,L,f=this,Z=f._curves,j={},D=[];for(P=0,C=Z.length;C>P;P++)N=Z[P],s=N._p1,W=N._p2,M=N._p3,A=N._p4,!j[P]&&f._isSamePoint(s,p)&&(Y?D.push({point:s,r2:A}):D.push({point:s,c2:W})),f._isSamePoint(A,p)&&(L=Y?{point:A,r1:s}:{point:A,c1:M},C>P+1&&f._isSamePoint(Z[P+1]._p1,p)&&(Y?L.r2=Z[P+1]._p4:L.c2=Z[P+1]._p2,j[P+1]=!0),D.push(L));return D},ed.prototype.toHtShape=function(){var t=this,f=t._curves,U=[],O=[],G={x:1/0,y:1/0};return f.forEach(function(M){var r=M._p1,N=M._p2,E=M._p3,Y=M._p4;return t._isCloseEnough(r,G)||(U.push(1),O.push(r.clone())),G=Y,t._isCloseEnough(r,N)&&t._isCloseEnough(E,Y)?(U.push(2),O.push(Y.clone()),void 0):(U.push(4),O.push(N.clone(),E.clone(),Y.clone()),void 0)}),{segments:U,points:O}};var cf=Ql.Math.CubicBezier=function(K,x,T,l){var v=this;v._id=Ql.Math.CubicBezier._globalId++,v._p1=K,v._p2=x,v._p3=T,v._p4=l};cf._globalId=1,cf.prototype={},cf.prototype.constructor=cf,cf.prototype.toString=function(){return this._id},cf.prototype.intersectRect=function(b,r,j){var M=r/2,W=j/2,c=b.x,p=b.y,e=Ql.Math.Vector2,v=new e(-M+c,-W+p),n=new e(M+c,W+p),q=new e(n.x,v.y),Q=new e(v.x,n.y),$=this,V=$.intersectLine(v,q),J=$.intersectLine(q,n),O=$.intersectLine(n,Q),A=$.intersectLine(Q,v),g=V.concat(J).concat(O).concat(A);return g},cf.prototype.intersectLine=function(S,e){var D,G,f,V,m,w,_,o,M,p,C,a,n,b=this,E=S.clone().min(e),j=S.clone().max(e);V=b._p1,m=b._p2,w=b._p3,_=b._p4,D=V.clone().multiplyScalar(-1),G=m.clone().multiplyScalar(3),f=w.clone().multiplyScalar(-3),C=D.add(G).add(f).add(_),D=V.clone().multiplyScalar(3),G=m.clone().multiplyScalar(-6),f=w.clone().multiplyScalar(3),p=D.add(G).add(f),D=V.clone().multiplyScalar(-3),G=m.clone().multiplyScalar(3),M=D.add(G),o=V.clone(),n=new Ql.Math.Vector2(S.y-e.y,e.x-S.x),a=S.x*e.y-e.x*S.y;for(var q=b.getRoots(n.dot(C),n.dot(p),n.dot(M),n.dot(o)+a),R=new Array,u=0,l=q.length;l>u;u++){var y=q[u];if(!(0>y||y>1)){var x=V.clone().lerp(m,y),F=m.clone().lerp(w,y),A=w.clone().lerp(_,y),B=x.lerp(F,y),K=F.lerp(A,y),H=B.lerp(K,y);H.t=y,S.x==e.x?E.y<=H.y&&H.y<=j.y&&R.push(H):S.y==e.y?E.x<=H.x&&H.x<=j.x&&R.push(H):H.x>=E.x&&H.y>=E.y&&H.x<=j.x&&H.y<=j.y&&R.push(H)}}return R},cf.prototype.solveTForPoint=function(A){var L,U,G,l,Z=this;L=Z._p1.x-A.x,U=Z._p2.x-A.x,G=Z._p3.x-A.x,l=Z._p4.x-A.x;for(var W=Z.getRoots(l-3*G+3*U-L,3*G-6*U+3*L,3*U-3*L,L),D=r,q=1/0,w=0,N=W.length;N>w;w++){var b=W[w];if(!(0>b||b>1)){var C=Z._p1.clone().lerp(Z._p2,b),T=Z._p2.clone().lerp(Z._p3,b),Y=Z._p3.clone().lerp(Z._p4,b),z=C.lerp(T,b),F=T.lerp(Y,b),Q=z.lerp(F,b);Q.t=b;var B=Math.abs(Q.y-A.y);q>B&&(q=B,D=Q)}}return D},cf.prototype.getPointAt=function(S){var $=this,y=$._p1,q=$._p2,r=$._p3,z=$._p4,L=y.clone().lerp(q,S),w=q.clone().lerp(r,S),D=r.clone().lerp(z,S),o=L.lerp(w,S),t=w.lerp(D,S);return o.lerp(t,S)},cf.prototype.getRoots=function(w,U,v,o){var l,g,B,J,Q,Z=new Array;if(Math.abs(w)<1e-6){var l=U,g=v/l,B=o/l,J=g*g-4*B;if(J>0){var Q=Math.sqrt(J);Z.push(.5*(-g+Q)),Z.push(.5*(-g-Q))}else 0==J&&Z.push(.5*-g)}U/=w,v/=w,o/=w,l=(3*v-U*U)/3,g=(2*U*U*U-9*v*U+27*o)/27;var m=U/3,z=g*g/4+l*l*l/27,I=g/2;if(Math.abs(z)<=1e-6&&(z=0),z>0){var R,t,Q=Math.sqrt(z);R=-I+Q,t=R>=0?Math.pow(R,1/3):-Math.pow(-R,1/3),R=-I-Q,R>=0?t+=Math.pow(R,1/3):t-=Math.pow(-R,1/3),Z.push(t-m)}else if(0>z){var $=Math.sqrt(-l/3),a=Math.atan2(Math.sqrt(-z),-I)/3,k=Math.cos(a),f=Math.sin(a),K=Math.sqrt(3);Z.push(2*$*k-m),Z.push(-$*(k+K*f)-m),Z.push(-$*(k-K*f)-m)}else{var R;R=I>=0?-Math.pow(I,1/3):Math.pow(-I,1/3),Z.push(2*R-m),Z.push(-R-m)}return Z},cf.prototype._70I=function(){var U=this;return U._p1.distanceToSquared(U._p2)<1e-10&&U._p3.distanceToSquared(U._p4)<1e-10},cf.prototype.insertKnot=function(y){var S=this,K=S._p1,D=S._p2,u=S._p3,a=S._p4,i=K.clone().lerp(D,y),o=D.clone().lerp(u,y),V=u.clone().lerp(a,y),z=i.clone().lerp(o,y),j=o.clone().lerp(V,y),n=z.clone().lerp(j,y);return S._70I()?(K.clone().lerp(a,y),[new Ql.Math.CubicBezier(K,K.clone(),n.clone(),n),new Ql.Math.CubicBezier(n,n.clone(),a.clone(),a)]):[new Ql.Math.CubicBezier(K,i,z,n),new Ql.Math.CubicBezier(n,j,V,a)]};var Gj=u.Default.getInternal().ui().EdgeUI,sf={_47O:function(h){var t=this,M=sf.getBackups()._47O;Ql.inEdit(t.gv)||M.call(t,h)}};Ql.Inject.registAsModule(sf,Gj);var jk=u.Default.getInternal().ui().NodeUI,Um={_47O:function(S){var $=this,y=Um.getBackups()._47O;Ql.inEdit($.gv)||y.call($,S)},getSelectWidth:function(){var O=this,p=O.gv,Z=O._data;if(p.isEditable(Z)&&Ql.inEdit(p))return 0;var B=Um.getBackup("getSelectWidth");return B.call(O)}};Ql.Inject.registAsModule(Um,jk);var fq=u.graph.GraphView,Bi={_editPointSize:function(){var d=u.Default.isTouchable,X=Ql.getStyle("pointSize");return X[d?0:1]}(),isPointEditable:function(r){var K=this;if(Ql.inEdit(K))return K._pointEditableFunc?K._pointEditableFunc(r):!0;var y=Bi.getBackup("isPointEditable");y.call(K,r)},isEditable:function(v){var m,N=this,A=Bi.getBackup("isEditable");if(m=v instanceof Ql.Group?!0:A.call(N,v),!Ql.inEdit(N))return m;if(!(v instanceof u.Edge))return m;if(!v.s("2d.editable"))return!1;var W=N.getEditableFunc();return W?W(v):!0},_42:function(u,d){var z=this,k=Bi.getBackups()._42;if(k.call(z,u,d),Ql.inEdit(z)){var f=z.getEditInteractor();f.drawImpl()}}};Ql.Inject.registAsModule(Bi,fq);var Vl=u.Default.getInternal().ui().ShapeUI,Kr={_47O:function(a){var u=this,h=Kr.getBackups()._47O;Ql.inEdit(u.gv)||h.call(u,a)}};Ql.Inject.registAsModule(Kr,Vl);var jh=u.graph.DefaultInteractor,im={handle_mousewheel:function(p){var I=this,V=im.getBackup("handle_mousewheel");Ql.inEdit(I.gv)||V.call(I,p)}};Ql.Inject.registAsModule(im,jh);var rs=u.graph.MoveInteractor,js={_calcShift:function(F,c){var g=this,I=js.getBackup("_calcShift"),G=g.gv;if(!Ql.inEdit(G))return I.call(g,F,c);var K=G.getEditInteractor(),t=K.getSubModule("Move").calcShift(F,c,g);return t||I.call(g,F,c)},clear:function(F){var v=this,M=js.getBackup("clear");M.call(v,F);var U=v.gv;if(Ql.inEdit(U)){var Q=U.getEditInteractor();Q.getSubModule("Move").clear(F)}}};Ql.Inject.registAsModule(js,rs);var Ak=Ql.Rect=function(s){this.catalog="Rect",this._interactor=s};Ak.prototype={},Ak.prototype.constructor=Ak,Ak.prototype.gatherInfo=function(f,E){var y=this;if(1===E.length){var B=E[0];return B instanceof u.Shape&&B._70I()?y.gatherLine(f,B):nh(B,f)?!1:y.gatherSingleTarget(f,B)}return E.length>1?y.gatherMultiTargets(f,E):!1},Ak.prototype.gatherSingleTarget=function(m,y){if(y.getCorners){var d,k=this,w=k.info;k.target=y,d=k.screenInfo={};var D=y.getCorners();w.LT=new Ql.Math.Vector2(D[0]),w.LB=new Ql.Math.Vector2(D[1]),w.RB=new Ql.Math.Vector2(D[2]),w.RT=new Ql.Math.Vector2(D[3]),w.T=w.LT.clone().add(w.RT).divideScalar(2),w.B=w.LB.clone().add(w.RB).divideScalar(2),w.L=w.LT.clone().add(w.LB).divideScalar(2),w.R=w.RT.clone().add(w.RB).divideScalar(2);for(var U in w)d[U]=Ql.toScreenPosition(m,w[U]);var B=k._interactor,Z=B.getStyle("checkSize"),H=function(T,M,o){var r=M.clone().sub(T).setLength(-Z),g=o.clone().sub(T).setLength(-Z),k=r.add(g).add(T);return k};return d.rotLT=H(d.LT,d.RT,d.LB),d.rotLB=H(d.LB,d.LT,d.RB),d.rotRB=H(d.RB,d.LB,d.RT),d.rotRT=H(d.RT,d.LT,d.RB),d.rotT=d.rotLT.clone().add(d.rotRT).divideScalar(2),d.rotB=d.rotLB.clone().add(d.rotRB).divideScalar(2),d.rotL=d.rotLT.clone().add(d.rotLB).divideScalar(2),d.rotR=d.rotRT.clone().add(d.rotRB).divideScalar(2),d.rotation=y.getRotation(),k.gatherConnectInfo(),!0}},Ak.prototype.gatherConnectInfo=function(){var r=this,I=r.target,A=r._interactor,j=r.screenInfo,$=A.gv;if($.isConnectActionVisible(I)&&A.getStyle("connectGuideVisible")){var T;I.s&&(T=I.s("connectGuideShift")),T||(T=A.getStyle("connectGuideShift"));var p=I.getAnchor(),Z=I.getSize(),H=I.toGlobal({x:Z.width*(T[0]-p.x),y:Z.height*(T[1]-p.y)});H=Ql.toScreenPosition($,H),j.P1?H.add(j.P2.clone().sub(j.P1).setLength(T[2])):(H.add(j.RT.clone().sub(j.LT).setLength(T[2])),H.add(j.LB.clone().sub(j.LT).setLength(T[3]))),j.connect=H}},Ak.prototype.gatherMultiTargets=function(f,_){var C=Ql.Group.findOrCreateGroup(_);if(!C)return!1;var I=this;return I.editing&&"rotate"!==I.editing.mode||C.calcInfo(),I.gatherSingleTarget(f,C)},Ak.prototype.gatherLine=function(g,w){this.target=w;var G=this.screenInfo={},x=w.getPoints(),B=Ql.getDataMatrix(w);return G.P1=Ql.toScreenPosition(g,B.apply(x.get(0))),G.P2=Ql.toScreenPosition(g,B.apply(x.get(1))),this.gatherConnectInfo(),!0},Ak.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ak.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ak.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ak.prototype.check=function(Q,x,Z){if(u.Default.isLeftButton(x)){var o=this;if(o.editing=null,o.tipInfo=null,o.screenInfo){var O=o.target,a=Q.isEditable(O),d=o.screenInfo;if(a&&d.connect){var r=o._checkConnect(Z);if(r)return r}if(d.P1)return o._checkLine(Z);var C,B,L,s=null,S=o._interactor,h=S.getStyle("checkSize");if(a&&Q.isRectEditable(O))for(B=0;B<Ql.Rect.ResizeKeys.length;B++)if(L=Ql.Rect.ResizeKeys[B],Ql.checkHit(Z,d[L],h)){s=L,C="resize";break}if(!s&&a&&Q.isRotationEditable(O)){var w=S.getStyle("rotateCheckSize");for(B=0;B<Ql.Rect.RotateKeys.length;B++)if(L=Ql.Rect.RotateKeys[B],Ql.checkHit(Z,d[L],w)){s=L,C="rotate";break}}if(!s)return S.setCursor("default"),void 0;if("rotate"===C){var J,n=Q.lp(x);if(O instanceof Ql.Group){var f=S.getStyle("groupRotateModeKey");"string"==typeof f&&(f=[f]);for(var I=!1,M=0,K=f.length;K>M;M++)if(x[f[M]]){I=!0;break}var G=S.getStyle("groupRotateModeDefault");J=I?"batch"===G?"block":"batch":G}var b="batch"===J?O.getAnchor2():O.getPosition(),v=Math.atan2(n.y-b.y,n.x-b.x);S._setRotateCursor(v),o.editing={mode:C,key:s,pos:b,flipY:O.getScale().y<0,rotation:O.getRotation(),hitRot:v},J&&(o.editing.groupRotateMode=J)}else{var q=Ql.Rect.ResizeKeys.indexOf(s),Y=Ql.Rect.ResizeDirection[q],P=Math.cos(O.getRotation()),j=Math.sin(O.getRotation()),R=Y.x*Math.sign(O.getScale().x),p=Y.y*Math.sign(O.getScale().y),_=Math.atan2(-j*R-P*p,P*R-j*p),k=(Math.round(_/(Math.PI/4))+8)%8,m=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][k];this._interactor.setCursor(m);var E=O.getWidth(),N=O.getHeight(),g=O.getAnchor();o.editing={mode:C,key:s,rect:{x:-E*g.x,y:-N*g.y,width:E,height:N},anchor:g,matrix:O.getMatrix()}}return s}}},Ak.prototype._checkLine=function(i){var F=this;F.screenInfo;var u,l=F._interactor.getStyle("checkSize");if(Ql.checkHit(i,F.screenInfo.P1,l))u="P1";else{if(!Ql.checkHit(i,F.screenInfo.P2,l))return this._interactor.setCursor("default"),void 0;u="P2"}return F.editing={mode:"line",key:u},u},Ak.prototype._checkConnect=function(g){var W=this,Z=W.screenInfo,V=W._interactor,M=V.getStyle("connectGuideIntersectSize"),i=Z.connect,S=g.x,N=i.x;if(N>S&&M>N-S&&Math.abs(i.y-g.y)<M||S>=N&&Ql.checkHit(g,i,M)){var y="connect",f=v.getConnectAction(V.gv);if(W.editing={mode:y},f&&f.delete)if(W.target instanceof Ql.Group){var J=!0;V.gv.sm().getSelection().each(function(D){f.delete.visible.call(null,V.gv,D)||(J=!1)}),W.editing.hasDeleteAction=J}else f.delete.visible.call(null,V.gv,W.target)&&(W.editing.hasDeleteAction=!0);return V.setCursor("default"),y}},Ak.prototype._fireEditEvent=function(O,l){var o=this._interactor,H=this.editing;if(H){var w=H.mode;w="rotate"===w?"Rotation":"connect"===w?"Connection":w[0].toUpperCase()+w.slice(1),o.fi({kind:O+"Edit"+w,event:l})}},Ak.prototype.startEdit=function(I,x){I.startDragging(x);var o=this;o._interactor.fi({kind:"prepareEdit",event:x});var S=o.editing,Q=o.target;if(S){if(o._fireEditEvent("begin",x),"rotate"===S.mode)return S.groupRotateMode&&Q.beginRotate(S),void 0;if("connect"!==S.mode)("line"===S.mode||Q&&0===Q.getRotation())&&(o._inSmartGuide=!0,o._interactor.rectGuide.gatherRects());else if(S.hasDeleteAction){var W=I.gv,K=o._interactor.getStyle("connectGuideGarbageShift");S.garbageInfo={x:W.getWidth()*K[0]+K[2],y:W.getHeight()*K[1]+K[3],size:o._interactor.getStyle("connectGuideGarbageIntersectsize")},I._42()}}},Ak.prototype._46O=function(Z){var i,N=this,T=N.editing;if(T){if("connect"===T.mode&&!T.canceled&&!T.deleted)try{T.garbageInfo&&T.garbageInfo.hover?v.doDeleteConnectionAction(N._interactor.gv,N.target):v.doConnectAction(N._interactor.gv,N.target,T.target)}catch(W){console.error(W)}i=N.editing.groupRotateMode,N._fireEditEvent("end",Z),N.editing=null}N.tipInfo=null,N._inSmartGuide&&(N._interactor.rectGuide.clear(),N._inSmartGuide=!1),i&&N.target&&N.target.endRotate()},Ak.prototype.handleNormalStateDelete=function(){var C=this,l=C.editing;if(l&&"connect"===l.mode&&!l.canceled&&!l.deleted){if(l.garbageInfo){try{v.doDeleteConnectionAction(C._interactor.gv,C.target)}catch(e){console.error(e)}l.garbageInfo=null}return l.cursorPos=null,l.targetCorners=null,l.deleted=!0,C._interactor._42(),!0}},Ak.prototype.handleNormalStateKeyDown=function(O){var H=this,r=H.editing;return!r||"connect"!==r.mode||r.canceled||r.deleted?void 0:u.Default.isEsc(O)?(r.cursorPos=null,r.targetCorners=null,r.canceled=!0,H._interactor._42(),!0):void 0},Ak.prototype.handleEdit=function(F,e){var G=this,O=G.editing;if(O){var U,f,I,l,S,v=G.target,o=O.key,D=O.mode,L=F.lp(e),m=G._interactor;if("connect"===D){if(O.canceled)return;if(O.deleted)return;O.cursorPos=m._getLogicalPoint(e);var c=O.garbageInfo;return c&&Ql.checkHit(O.cursorPos,c,c.size)?(c.hover=!0,O.target=null,O.targetCorners=null):(c&&(c.hover=!1),O.target=F.getDataAt(L,function(m){return F.isSelectable(m)?Cp(m)?!0:!1:!1})||null,O.targetCorners=Ql.getTargetCornersOnScreen(F,O.target)),m._42(),void 0}if("rotate"===D){var J,$,V=O.pos,i=Math.atan2(L.y-V.y,L.x-V.x);if(O.groupRotateMode?$=i-O.hitRot:(J=i-O.hitRot,$=O.rotation+J),$%=2*Math.PI,0>$&&($+=2*Math.PI),!u.Default.isCtrlDown(e)){var B,r;Nh(e)?(B=m.getStyle("shiftRotateRound"),r=B/2):(B=m.getStyle("rotateRound"),r=m.getStyle("rotateSensitivity")),$=Ql.roundTo($,B,r)}O.groupRotateMode?(J=$-(O.lastRotation||0),0!==J&&(v.addRotation(J,O.groupRotateMode),O.lastRotation=$)):v.setRotation($),m._setRotateCursor(i),$>Math.PI&&($-=2*Math.PI);var A=180*($/Math.PI);A=A.toFixed(2),U=""+A+""}else if("resize"===D){var Y=O.rect;I=Y.x,l=Y.y;var X,C=Y.width,k=Y.height,y=O.anchor,z=O.matrix,s=v.s&&v.s("keepAspectRatio")||m.getStyle("keepAspectRatio");Nh(e)&&(s=!s);var H=G._unionPointMode1,j=G._unionPointMode2;if(G._inSmartGuide&&!u.Default.isCtrlDown(e)&&!s){var n;"L"===o||"R"===o?n="x":("T"===o||"B"===o)&&(n="y"),G._adsorbedToClosest(L,n),S=!0}X=z.tfi(L);var T;"LT"===o?(Y=H(X,{x:I+C,y:l+k},C,k,s),T=9):"T"===o?(Y=j({x:I,y:X.y},{x:I+C,y:l+k},C,k,s,"v"),T=1):"RT"===o?(Y=H(X,{x:I,y:l+k},C,k,s),T=33):"L"===o?(Y=j({x:X.x,y:l},{x:I+C,y:l+k},C,k,s,"h"),T=8):"R"===o?(Y=j({x:I,y:l},{x:X.x,y:l+k},C,k,s,"h"),T=32):"LB"===o?(Y=H(X,{x:I+C,y:l},C,k,s),T=12):"B"===o?(Y=j({x:I,y:l},{x:I+C,y:X.y},C,k,s,"v"),T=4):"RB"===o&&(Y=H(X,{x:I,y:l},C,k,s),T=36);var q=z.tf(Y.x+Y.width*y.x,Y.y+Y.height*y.y);v.setPosition(q),v.setSize(Y.width,Y.height),S&&(f=v.getRect(),m.rectGuide.gatherLines({node:v,x:f.x,y:f.y,w:f.width,h:f.height},n,T)),U=""+Math.round(Y.width)+" * "+Math.round(Y.height)}else if("line"===D){if(Nh(e)){var w=v.getPoints(),M="P1"===o?w.get(1):w.get(0),b={x:L.x-M.x,y:L.y-M.y},W=m.getStyle("shiftLineRotateRound"),g=G._shiftDirList;if(!g||G._shiftRotateRound!==W){G._shiftRotateRound=W,G._shiftDirList=g=[];for(var R=0;R<Math.PI;R+=W)g.push({x:Q(R),y:h(R)})}for(var E,x=0,t=0,K=g.length;K>t;t++){var _=g[t],d=_.x*b.x+_.y*b.y;Math.abs(d)>Math.abs(x)&&(x=d,E=_)}L={x:M.x+E.x*x,y:M.y+E.y*x},m.rectGuide.clear()}else G._inSmartGuide&&!u.Default.isCtrlDown(e)&&(G._adsorbedToClosest(L),S=!0);var N=Ql.getDataMatrix(v).applyInverse(L);v.setPoint("P1"===o?0:1,N,!0);var P=v.getPoints(),Z=P.get(0),a=P.get(1);I=Z.x-a.x,l=Z.y-a.y,U=" "+Math.round(Math.sqrt(I*I+l*l))+" ",S&&(f=v.getRect(),m.rectGuide.gatherLines({node:v,x:f.x,y:f.y,w:f.width,h:f.height}))}if(U){var p=u.Default.getLogicalPoint(e,m._canvas);p.x+=Ql.Icons.TipShiftX,p.y+=Ql.Icons.TipShiftY,G.tipInfo={helperPos:p,text:U,size:U.length}}G._fireEditEvent("between",e)}},Ak.prototype._unionPointMode1=function(S,X,y,e,P){if(P&&y&&e){var j=S.x-X.x,R=S.y-X.y;Math.abs(j*e)<Math.abs(R*y)?(R=Math.sign(R)*Math.abs(j*e/y),S.y=X.y+R):(j=Math.sign(j)*Math.abs(R*y/e),S.x=X.x+j)}return u.Default.unionPoint(S,X)},Ak.prototype._unionPointMode2=function(P,O,E,n,h,D){var t=u.Default.unionPoint(P,O);if(h&&E&&n){var U;"v"===D?(U=t.x+t.width/2,t.width=E*t.height/n,t.x=U-t.width/2):(U=t.y+t.height/2,t.height=n*t.width/E,t.y=U-t.height/2)}return t},Ak.prototype._adsorbedToClosest=function(H,i){var v=this,g=v._interactor,X=g.rectGuide.findClosest(H,i),r=g.gridGuide.findClosest(H,i),C=1/0,n=1/0;X&&(isFinite(X.x)&&(C=X.x),isFinite(X.y)&&(n=X.y)),r&&(isFinite(r.x)&&Math.abs(r.x)<Math.abs(C)&&(C=r.x),isFinite(r.y)&&Math.abs(r.y)<Math.abs(n)&&(n=r.y)),isFinite(C)&&(H.x+=C),isFinite(n)&&(H.y+=n)},Ak.prototype._42=function(g,_,v){var p=this;p.info={},p.screenInfo=null;var h=p._interactor;if(!h.editDetail&&p.gatherInfo(_,v)){var H=p.editing,w=H?H.groupRotateMode:null,k=p.screenInfo;"block"!==w&&(k.P1?Ql.Icons.DrawIcon(h,g,Ql.Icons.Line,k):Ql.Icons.DrawIcon(h,g,Ql.Icons.Rect,k),k.connect&&(Ql.Icons.DrawIcon(h,g,Ql.Icons.ConnectGuide,{rotation:k.rotation,connect:k.connect,cursorPos:H?H.cursorPos:null}),H&&(H.targetCorners&&Ql.Icons.DrawIcon(h,g,Ql.Icons.NodeHoverGuide,H.targetCorners),H.garbageInfo&&Ql.Icons.DrawIcon(h,g,Ql.Icons.ConnectGuideGarbage,H.garbageInfo))),p.tipInfo&&Ql.Icons.DrawIcon(h,g,Ql.Icons.TipHelper,p.tipInfo)),p.target instanceof Ql.Group&&p.target._42(h,g,_)}};var Lk=Ql.Anchor=function(H){this.catalog="Anchor",this._interactor=H};Lk.prototype={},Lk.prototype.constructor=Lk,Lk.prototype.gatherInfo=function(d,U){var Q=this;if(1===U.length){var I=U[0];if(!I.getAnchor)return;if(I instanceof u.Shape&&I._70I())return;if(nh(I,d))return;return Q.gatherSingleTarget(d,U[0])}return U.length>1?Q.gatherMultiTargets(d,U):!1},Lk.prototype.gatherSingleTarget=function(a,c){var C=this;return C.info.POS=c.getPosition(),C.screenInfo.POS=Ql.toScreenPosition(a,C.info.POS),C.target=c,!0},Lk.prototype.gatherMultiTargets=function(w,I){var H=this,y=Ql.Group.findOrCreateGroup(I);return y?(H.screenInfo.POS=Ql.toScreenPosition(w,y.getAnchor2()),H.target=y,!0):!1},Lk.prototype.isVisible=function(){var d=this,i=d._interactor;if(i.getStyle("anchorVisible")===!1)return!1;var D=d.target;if(D){if(this.editing)return!0;var T=D.getAnchor(),s=i.getStyle("anchorOutsideVisibleThreshold");if(T.x<-s||T.x>1+s||T.y<-s||T.y>1+s)return!0;var C=D.getSize(),I=D.getScale(),x=Math.min(Math.abs(C.width*I.x),Math.abs(C.height*I.y));if(x*i.gv._zoom<i.getStyle("anchorHideThreshold"))return!1}return!0},Lk.prototype.check=function(g,i,a){if(u.Default.isLeftButton(i)){var q=this,Z=q._interactor;if(q.isVisible()&&Z.getStyle("anchorMovable")!==!1){q.editing=null,q.tipInfo=null;var j=q.target;if(j&&g.isAnchorEditable(j)&&g.isEditable(j)){var L;if(q.screenInfo&&(L=q.screenInfo.POS)&&Ql.checkHit(a,new Ql.Math.Vector2(L),Z.getStyle("checkSize"))){if(j instanceof Ql.Group)return q.editing={},!0;var w=j.getWidth(),O=j.getHeight(),l=j.getAnchor();return q.editing={rect:{x:-w*l.x,y:-O*l.y,width:w,height:O},anchor:l,matrix:j.getMatrix()},!0}}}}},Lk.prototype.startEdit=function(k,F){k.startDragging(F),k.fi({kind:"beginEditAnchor",event:F})},Lk.prototype._46O=function(M){var w=this;w.editing&&(w.editing=null,w._interactor.fi({kind:"endEditAnchor",event:M})),w.tipInfo=null},Lk.prototype.handleEdit=function(a,w){var G=this,n=G.target;if(n){var E=G.editing;if(E){var V=a.lp(w),j=G._interactor;if(n instanceof Ql.Group)return n.setAnchor2(V),j._42(),void 0;var O=E.matrix,d=O.tfi(V),y=E.rect,F=(d.x-y.x)/y.width,Y=(d.y-y.y)/y.height;if(!u.Default.isCtrlDown(w)){var T=j.getStyle("anchorRound"),N=j.getStyle("anchorSensitivity");F=Ql.roundTo(F,T,N),Y=Ql.roundTo(Y,T,N)}n.setAnchor(F,Y,!0);var R=u.Default.getLogicalPoint(w,j._canvas);R.x+=Ql.Icons.TipShiftX,R.y+=Ql.Icons.TipShiftY;var b=""+F.toFixed(2)+", "+Y.toFixed(2);G.tipInfo={helperPos:R,text:b,size:b.length},j.fi({kind:"betweenEditAnchor",event:w})}}},Lk.prototype._42=function(V,K,p){var l=this;l.info={},l.screenInfo={};var m=l._interactor;m.editDetail||l.gatherInfo(K,p)&&l.isVisible()&&(Ql.Icons.DrawIcon(m,V,Ql.Icons.Anchor,l.screenInfo),l.tipInfo&&Ql.Icons.DrawIcon(m,V,Ql.Icons.TipHelper,l.tipInfo))};var ed=Ql.Curve=function(N){this.catalog="Curve",this._interactor=N};ed.prototype={},ed.prototype.constructor=ed,m.defineProperties(ed.prototype,{activing:{get:function(){return this._activing},set:function(U){var s=this;if(U)s._activing=new Ql.CurveActiving(this,U);else{var r=s._activing;r&&r.dispose(),s._activing=null}}}}),ed.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},ed.prototype.setUp=function(){var m=this,Q=m._interactor;Q&&Q.gv.mp(m._onGraphviewPropertyChanged,m)},ed.prototype._onGraphviewPropertyChanged=function(c){("zoom"===c.property||"translateX"===c.property||"translateY"===c.property)&&this._handleDataChanged()},ed.prototype.tearDown=function(){var C=this,T=C._interactor;T&&T.gv.ump(C._onGraphviewPropertyChanged,C)},ed.prototype.canEnterEditDetailMode=function(){var H=this,X=H._interactor,D=X._getValidSelection();if(1===D.length){var S=D[0],L=S instanceof u.Edge;if(S instanceof u.Shape||L){if(L){var G=S.s("edge.type");if(G&&"points"!==G)return}var d=X.gv;if(d.isPointEditable(S)&&d.isEditable(S))return H.target=S,!0}}},ed.prototype.preHandleScroll=function(){var e=this.editing;return e&&e.inEdit?!0:void 0},ed.prototype.getCurrentSelectintStatus=function(){var G=this;if(G.activing&&!G.activing.selections){if(G.activing.status!=r)return G.activing.status;var M=function(W){var k=G.activing.status;G.activing.status=W,G._interactor.fp("shapePointStatus",k,W)},p=Ql.Curve.PointType,m=G.activing.point,U=G.activing.pairs;if(!U||1!==U.length)return M(p.Mirrored);var w=U[0],X=w.c1&&w.c1.isNearEnough(m),B=w.c2&&w.c2.isNearEnough(m);if(!w.c1||!w.c2)return X||B?M(p.Straight):M(p.Disconnected);if(X&&B)return M(p.Straight);if(X||B)return M(p.Asymmetric);var n=w.c1.clone().sub(m),h=w.c2.clone().sub(m);return Math.abs(n.x*h.y-n.y*h.x)>1e-5||n.x*h.x>0?M(p.Disconnected):Math.abs(n.length()-h.length())>1e-5?M(p.Asymmetric):M(p.Mirrored)}},ed.prototype.handle_keydown=function(Z){var e=this;if(e._interactor.editDetail){var E=Ql.Curve.PointType;"1"===Z.key?e._setCurrentSelectionStatus(E.Straight):"2"===Z.key?e._setCurrentSelectionStatus(E.Mirrored):"3"===Z.key?e._setCurrentSelectionStatus(E.Disconnected):"4"===Z.key&&e._setCurrentSelectionStatus(E.Asymmetric)}},ed.prototype.setCurrentSelectionStatus=function(j){var V=this,v=V._interactor;if(v){var H=v.gv;H.dm().beginTransaction(),this._setCurrentSelectionStatus(j),H.dm().endTransaction()}},ed.prototype._setCurrentSelectionStatus=function(K){var S=this,D=S.activing;if(D){var p=S.getCurrentSelectintStatus();if(null!==p&&p!==K){D.status=K;var H=S.activing.point,n=S.activing.pairs;if(n&&1===n.length){var P=n[0],Y=S.screenInfo.curve,s=Ql.Curve.PointType,k=function(){S._writeToHt(),S._interactor.fp("shapePointStatus",p,K)};if(K===s.Straight)return Y.moveCtrlPoint(P,H,"c1"),Y.moveCtrlPoint(P,H,"c2"),k(),void 0;if(p===s.Straight){var X=Y.findPairs(H,!0),c=X[0],$=c.r1||H,y=c.r2||H,M=y.clone().sub($).multiplyScalar(.25);return Y.moveCtrlPoint(P,H.clone().sub(M),"c1"),Y.moveCtrlPoint(P,H.clone().add(M),"c2"),k(),void 0}var T=P.c1,u=P.c2;if(T&&u){if(K===s.Mirrored)return Y.moveCtrlPoint(P,H.clone().multiplyScalar(2).sub(u),"c1"),k(),void 0;if(K===s.Asymmetric&&p===s.Disconnected){var x=T.clone().sub(H).length(),M=H.clone().sub(u).setLength(x).add(H);return Y.moveCtrlPoint(P,M,"c1"),k(),void 0}}D._firePointChange(),S._interactor.fp("shapePointStatus",p,K)}}}},ed.prototype._handleDataChanged=function(E){var j=this;if(j.screenInfo&&j.target){var q=j._interactor;j.gatherSingleTarget(q.gv,j.target,!0),j.check(q.gv,null,E?q._getLogicalPoint(E):new Ql.Math.Vector2(q._lastClientPoint)),q._42()}},ed.prototype.gatherSingleTarget=function(d,C,K){var o,c,M=this;M.screenInfo&&M.screenInfo.curve&&(c=M.screenInfo.curve._curves);var f=M.editing;o=f?M.screenInfo:M.screenInfo={};var q,x,L=C instanceof u.Edge;L?(q=C.s("edge.segments"),x=C.s("edge.points")||new u.List):(q=C._58O,x=C._59O),o.S=q;var W,T=o.P=[],y=Ql.getDataMatrix(C);if(C instanceof u.Polyline&&(W=C.getElevation()||0,o.E=[]),x.each(function(n){o.E&&o.E.push(n.e||W),n=y.apply(n);var S=Ql.toScreenPosition(d,n);T.push(S.x,S.y)}),L){var r=Ql.toScreenPosition(d,C._lastSourcePoint),n=Ql.toScreenPosition(d,C._lastTargetPoint);T.splice(0,0,r.x,r.y),T.push(n.x,n.y)}if(!o.S||!o.S.size()){o.S=new u.List,o.S.add(1);for(var I=0;I<T.length/2-1;I++)o.S.add(2)}if((!f||K)&&M.convertToCubicBezier(c),M.activing&&(K||!M.editing||"realPoint"===M.editing.type)){var $=o.curve.findPairs(M.activing.point);M.activing.pairs=$}L&&"points"!==C.s("edge.type")&&M._writeToHt()},ed.prototype._convertToNewPoint=function(w,K,n){var F,M,v;for(F=0,M=K.length;M>F;F++){if(v=K[F],v._p1.isNearEnough(w))return v._p1;if(v._p4.isNearEnough(w))return v._p4}if(n)for(F=0,M=Math.min(n.length,M);M>F;F++){if(v=n[F],v._p1===w)return K[F]._p1;if(v._p4===w)return K[F]._p4}},ed.prototype.convertToCubicBezier=function(r){var o,U,V=this,$=new Ql.Math.Curve,Q=V.screenInfo;if($.createFromHtShape(Q.P,Q.S,Q.E),Q.curve=$,V.activing){var e=$._curves;if(o=V.activing.point,U=V._convertToNewPoint(o,e,r),U&&(V.activing.point=U),V.activing.selections){var S=-1,Z=V.activing.selections;Z.forEach(function(D){S++,U=V._convertToNewPoint(D,e,r),U&&(Z[S]=U)})}}},ed.prototype.check=function(A,R,K){if(!R||u.Default.isLeftButton(R)){var T=this;if(T._interactor.setCursor("default"),T.editing=null,T.highlight=null,T.tipInfo=null,T.screenInfo){if(Nf())return T._interactor._42(),!0;if(T._checkEditCtrlPoint(K))return T._interactor._42(),!0;if(T._checkEditRealPoint(K))return T._interactor._42(),!0;if(T._checkEditElevation(K))return T._interactor._42(),!0;var B=T.screenInfo.curve,M=B.checkPoint(K,T._interactor.getStyle("curveIntersectSize"));if(M){var w=T.highlight={};w.type="insertKnot",w.bezier=M.bezier,w.point=M.intersection}return T._interactor._42(),!0}}},ed.prototype._checkEditRealPoint=function(i){var H,d,j,q,N,x,E=this,n=E.screenInfo.curve._curves,J=E._interactor.getStyle("curvePointIntersectSize"),I=1/0;for(J*=J,j=0,q=n.length;q>j;j++)H=n[j],N=H._p1,x=i.distanceToSquared(N),I>x&&(I=x,d=N),N=H._p4,x=i.distanceToSquared(N),I>x&&(I=x,d=N);if(I>J)return!1;var T=E.highlight={};return T.type="changeRealPoint",T.point=d,E.editing={type:"realPoint",point:d,shiftGuide:{point:d.clone(),dir:"x",limit:0}},E._interactor.setCursor("crosshair"),!0},ed.prototype._checkEditElevation=function(Z){var E=this;if(!E._interactor.getStyle("curveElevationVisible"))return!1;var b=E.activing;if(!b)return!1;var l=b.getCurrentEditingPoint();if(!l)return!1;var D=E._interactor,Q=D.getStyle("curveElevationGuideShift"),X=D.getStyle("curveElevationIntersectSize"),k=Z.distanceToSquared({x:l.x+Q[0],y:l.y+Q[1]});if(!(k>X*X)){var p=E.highlight={};p.type="elevation";var i=new Ql.Math.Vector2(Z.x,Z.y,l.e);return E.editing={type:"elevation",startPoint:i},E._interactor.setCursor("crosshair"),!0}},ed.prototype._checkEditCtrlPoint=function(x){var d=this;if(d.activing&&!d.activing.selections){var A=d.getCurrentSelectintStatus();if(A!==Ql.Curve.PointType.Straight){var B=d.activing.pairs;if(B){var F=d._interactor.getStyle("curvePointIntersectSize");
F*=F;var M,Q,W,l,f,u,U,D,b,g=1/0;for(U=0,b=B.length;b>U;U++)for(l=B[U],D=0;2>D;D++)f=0===D?"c1":"c2",l[f]&&(u=x.distanceToSquared(l[f]),g>u&&(g=u,M=l,Q=U,W=f));if(g>F)return!1;d.activing.hlpair=M,d.activing.hltype=W;var H=d.highlight={};return H.type="changeCtrlPoint",H.point=M[W],d.editing={type:"ctrlPoint",pair:M,pairId:Q,ctrlType:W,direction:M[W].clone().sub(d.activing.point).normalize()},d._interactor.setCursor("crosshair"),!0}}}},ed.prototype.startEdit=function(U,e){U.startDragging(e);var Z=this;Z.highlight&&"insertKnot"===Z.highlight.type&&(Z.insertKnot(),Z.gatherSingleTarget(Z._interactor.gv,Z.target),Z.activing=null,Z._checkEditRealPoint(Z._interactor._getLogicalPoint(e)));var b=Z._activing;if(b){var H=Z.editing?Z.editing.type:null;"ctrlPoint"===H?b.editingCtrl={pairId:Z.editing.pairId,type:b.hltype}:"realPoint"===H&&(b.editingCtrl=!1)}var j=Z.highlight,n=u.Default.isCtrlDown(e);if(!j||Nf()){var $=Z._interactor.gv;if(!$.setFocus(e)||$._scrolling)return;return $.isPannable()&&Pr(e)&&!n&&(Z._pan={tx:$.tx(),ty:$.ty()},U.fi({kind:"beginPan",event:e})),void 0}if("changeRealPoint"===j.type){var O,x=Z.activing?Z.activing.point:null,L=Z.activing?Z.activing.selections:null;if(n&&Z.activing)x===j.point?(L?(Z.activing={point:L[0]},L.length>1&&(L.splice(0,1),Z.activing.selections=L)):Z.activing=null,Z.editing=null):L&&(O=L.indexOf(j.point))>=0?(L.length>1?L.splice(O,1):delete Z.activing.selections,Z.editing=null):L?(L.push(x),Z.activing={point:j.point,selections:L}):Z.activing={point:j.point,selections:[x]};else if(L)x===j.point||((O=L.indexOf(j.point))>=0?(L.splice(O,1,x),Z.activing={point:j.point,selections:L}):Z.activing={point:j.point});else{var d;x===j.point&&(d=Z.activing.status),Z.activing={point:j.point},d&&(Z.activing.status=d)}U.fi({kind:"beginEditPoint",event:e})}},ed.prototype.insertKnot=function(){var i=this,N=i.highlight,t=i.screenInfo.curve;t.insertKnot(N.bezier,N.point.t),i._writeToHt()},ed.prototype._writeToHt=function(){var B,q,F,T,C=this,V=C.screenInfo.curve,y=V.toHtShape(),J=y.points,K=[],o=y.segments,z=C._interactor.gv,e=C.target,c=e instanceof u.Edge,Y=Ql.getDataMatrix(e).invert();T=e instanceof u.Polyline,T&&(F=e.getElevation());for(var f=0,U=J.length;U>f;f++)B=J[f],q=Ql.toWorldPosition(z,B),q=Y.apply(q),B.e!=r&&B.e!==F&&(q.e=B.e),K.push(q);if(e._writing=!0,c){e.s("edge.type","points"),e.setStyle("edge.segments",o),e.setStyle("edge.points",K.slice(1,K.length-1)),e.setStyle("edge.source.offset.x",0),e.setStyle("edge.source.offset.y",0),e.setStyle("edge.target.offset.x",0),e.setStyle("edge.target.offset.y",0);var D=C._nextChangeEdgeHost;delete C._nextChangeEdgeHost,D&&("source"===D.type?e.setSource(D.host):e.setTarget(D.host)),C._writeEdgeHostAnchor("source",K[0]),C._writeEdgeHostAnchor("target",K[K.length-1])}else K.length?(e.setSegments(o),e.setPoints(K,!0)):e.removeFromDataModel();delete e._writing},ed.prototype._writeEdgeHostAnchor=function(L,V){var f=this,C=f.target,H=f._calcHostAnchor(C,L,V);C.s("edge."+L+".anchor.x",H.x),C.s("edge."+L+".anchor.y",H.y)},ed.prototype._calcHostAnchor=function(B,c,w,Q){Q||(Q="source"===c?B.getSource():B.getTarget());var T=Q.getRotation(),J=Q.getAnchor(),N=this._interactor.gv;if(nh(Q,N)&&(T=0),T){var I=Q.getMatrix(),p=I.tfi(w),j=Q.getSize();return{x:p.x/j.width+J.x,y:p.y/j.height+J.y}}var K=lb(N,Q),_={x:(w.x-K.x)/K.width,y:(w.y-K.y)/K.height};return _},ed.prototype._handlePanning=function(M){var y=this,a=y._pan;if(a){a.started=!0;var q=y._interactor,x=q.gv,T=q._lastClientPoint,p=vq(M);x.setTranslate(a.tx+p.x-T.x,a.ty+p.y-T.y),y.gatherSingleTarget(q.gv,y.target),q._42(),q.fi({kind:"betweenPan",event:M})}},ed.prototype.handleEdit=function(e,L){var a=this,k=a.editing;if(a._pan)return a._handlePanning(L),void 0;if(k){k.inEdit=!0;var G,M,z,S=a._interactor._getLogicalPoint(L),p=u.Default.isCtrlDown(L),F=u.Default.isShiftDown(L),Z=k.type,$=a.activing;if(a._guideInfo=null,"ctrlPoint"===Z&&F){var l=a.editing.direction.clone();G=$.point;var i=l.dot(S.clone().sub(G));S=l.setLength(i).add(G)}else if("ctrlPoint"===Z||"realPoint"===Z){var l;if("realPoint"===Z&&F){var x=a.editing.shiftGuide;M=x.point;var E=Math.abs(S.x-M.x),U=Math.abs(S.y-M.y);E>U&&E>x.limit&&"y"===x.dir&&(x.dir="x"),U>E&&U>x.limit&&"x"===x.dir&&(x.dir="y"),l=x.dir,"x"===l?(S.y=M.y,x.limit=Math.max(x.limit,E)):"y"===l&&(S.x=M.x,x.limit=Math.max(x.limit,U))}var C=a._isEditEdgeSourceTarget();if(C){var t=a._editEdgeSourceTarget(C,S,p);t&&(z=t.tipText)}else if(!p){var V=a._guidingToEdit(S,l),J="realPoint"===Z?a._interactor.gridGuide.findClosest(S,l,!0):null,W=1/0,n=1/0;J&&(J.x&&(W=J.x),J.y&&(n=J.y));var N=!1;V&&(V.xList&&(Math.abs(V.x)<=Math.abs(W)?(N=!0,W=V.x):delete V.xList),V.yList&&(Math.abs(V.y)<=Math.abs(n)?(N=!0,n=V.y):delete V.yList),N&&(a._guideInfo=V)),isFinite(W)&&(S.x+=W),isFinite(n)&&(S.y+=n),N&&(V.v=S)}}var H=a.screenInfo.curve;if("realPoint"===k.type){G=k.point,G.e!==r&&(S.e=G.e),H.moveRealPoint(G,S),k.point=S,a.highlight.point=S;var Y=$.status,X=$.selections;if(a.activing={point:S,status:Y},X){var y=S.clone().sub(G),K=0;X.forEach(function(p){var z=p.clone().add(y);H.moveRealPoint(p,z),X[K++]=z}),a.activing.selections=X}}else if("ctrlPoint"===k.type){var I=$.pairs,T=I[k.pairId];H.moveCtrlPoint(T,S,k.ctrlType);var w=$.status,s=Ql.Curve.PointType;if((w===s.Mirrored||w===s.Asymmetric)&&T.c1&&T.c2){var G=new Ql.Math.Vector2($.point),R="c1"===k.ctrlType?"c2":"c1";if(w===Ql.Curve.PointType.Mirrored)H.moveCtrlPoint(T,G.clone().multiplyScalar(2).sub(S),R);else if(w===s.Asymmetric){var i=T[R].clone().sub(G).length(),f=G.clone().sub(T[k.ctrlType]).setLength(i).add(G);isNaN(f.x)||H.moveCtrlPoint(T,f,R)}}$._firePointChange()}else if("elevation"===k.type){M=k.startPoint;var A=M.e+(M.y-S.y)/e._zoom;a._setCurrentPointImpl("e",A),$._firePointChange(),z="E: "+Ql.toFixed(A)}var B=u.Default.getLogicalPoint(L,a._interactor._canvas);if(B.x+=Ql.Icons.TipShiftX,B.y+=Ql.Icons.TipShiftY,!z){var d=Ql.toWorldPosition(e,S);z=""+Ql.toFixed(d.x)+", "+Ql.toFixed(d.y)}a.tipInfo={helperPos:B,text:z,size:z.length},a._writeToHt(),a._interactor.fi({kind:"betweenEditPoint",event:L})}},ed.prototype._setCurrentPointImpl=function(I,v){var Z=this,R=Z._activing;if(!R)return!1;var K=Z.target;if(!K)return!1;var M=R.getCurrentEditingPoint();if(!M)return!1;var P=R.editingCtrl;if(!P)var u=M.clone();if("e"===I)M.e=v;else{var V;if("x"===I||"y"===I){var T=R._lastFirePoint;V="x"===I?{x:v,y:T?T.y:0}:{x:T?T.x:0,y:v}}else"object"==typeof I?(V=I,I.e!==r&&(M.e=I.e)):(V={x:arguments[0],y:arguments[1]},arguments[2]!==r&&(M.e=arguments[2]));var U=Ql.getDataMatrix(K);V=Ql.toScreenPosition(Z._interactor.gv,U.apply(V)),M.x=V.x,M.y=V.y}if(!P){var d=u.multiplyScalar(-1).add(M);M.e&&u.e&&(d.e=M.e-u.e),Z.screenInfo.curve.moveCtrlDueToRealPointMovement(M,d)}return!0},ed.prototype.setCurrentPoint=function(N,f){return this._setCurrentPointImpl(N,f)?(this._writeToHt(),!0):!1},ed.prototype._isEditEdgeSourceTarget=function(){var x=this,J=x.target;if(!(J instanceof u.Edge))return!1;var M=x.editing.point,W=x.screenInfo.curve._curves;return M===W[0]._p1?"source":M===W[W.length-1]._p4?"target":!1},ed.prototype._editEdgeSourceTarget=function(c,Q,J){var g,d=this,z=d.target;if(g="source"===c?z.getSource():z.getTarget()){var L=d._interactor.gv,M=Ql.toWorldPosition(L,Q),v=d._calcHostAnchor(z,c,M,g);if(!J){var C=d._interactor.getStyle("anchorRound"),R=d._interactor.getStyle("anchorSensitivity");v.x=Ql.roundTo(v.x,C,R),v.y=Ql.roundTo(v.y,C,R)}if(d._interactor.getStyle("edgeHostDetectPerFrame")||v.x<0||v.x>1||v.y<0||v.y>1){var h=L.getDataAt(M,function(d){return L.isSelectable(d)?Cp(d)?!0:!1:!1});if(h){var E=d._calcHostAnchor(z,c,M,h);g=h,d._nextChangeEdgeHost={type:c,host:h},v=E,J||(v.x=Ql.roundTo(v.x,C,R),v.y=Ql.roundTo(v.y,C,R))}}if(!J){var x=Fb(L,g,0,0,0,v.x,v.y),n=Ql.toScreenPosition(L,x);Q.x=n.x,Q.y=n.y}return d._edgeHostGuideInfo=Ql.getTargetCornersOnScreen(L,g),{host:g,anchor:v,tipText:""+v.x.toFixed(2)+", "+v.y.toFixed(2)}}},ed.prototype._guidingToEdit=function(V,U){var b,n,i=this;if(b=i.screenInfo.curve){n=b._curves;var J,$,q,u,p,x,T,I,w=1/0,k=1/0,e=[];for(i.editing&&"realPoint"===i.editing.type&&(I=i.editing.point),p=0,x=2*n.length;x>p;p++)T=n[Math.floor(p/2)][p%2?"_p4":"_p1"],e.indexOf(T)>=0||(e.push(T),I&&I===T||(q=T.x-V.x,u=T.y-V.y,Math.abs(q)<Math.abs(w)?(w=q,J=[T]):q===w&&J.push(T),Math.abs(u)<Math.abs(k)?(k=u,$=[T]):u===k&&$.push(T)));var C=i._interactor.getStyle("smartGuideSensitivity");if((Math.abs(w)>C||"y"===U)&&(J=null),(Math.abs(k)>C||"x"===U)&&($=null),J||$){var c=!1,A={};if(J&&(c=!0,A.xList=J,A.x=w),$&&(c=!0,A.yList=$,A.y=k),c)return A}}},ed.prototype._46O=function(O){var R=this;R.editing&&(R.editing=null,R._interactor.fi({kind:"endEditPoint",event:O})),R._guideInfo=null,R._edgeHostGuideInfo=null,R._pan&&(R._pan=null,R._interactor.fi({kind:"endPan",event:O})),R.tipInfo=null},ed.prototype._canDeletePoint=function(Y,R){var i=this.target;if(!(i instanceof u.Edge))return!0;var T=Y._curves[0],e=Y._curves[Y._curves.length-1];return T._p1===R||e._p4===R?!1:!0},ed.prototype.handleDelete=function(){var B=this;if(B.activing&&B.screenInfo){var F=u.Default.isShiftDown(),N=B.screenInfo.curve;B._canDeletePoint(N,B.activing.point)&&N.deleteRealPoint(B.activing.point,F),B.activing.selections&&B.activing.selections.forEach(function(U){B._canDeletePoint(N,U)&&N.deleteRealPoint(U,F)}),B.activing=null,delete B.editing,delete B.tipInfo,delete B._pan,B._writeToHt(),B._interactor.fp("deleteShapePoint",!1,!0)}},ed.prototype.handleDoubleClick=function(M){var D=this,T=D._interactor._getLogicalPoint(M);if(D.screenInfo&&D._checkEditRealPoint(T)){var o=D.getCurrentSelectintStatus(),G=Ql.Curve.PointType;return o=o===G.Mirrored?G.Straight:G.Mirrored,D._setCurrentSelectionStatus(o),D._interactor._42(),!0}},ed.prototype._drawHighlight=function(_){var T=this,L=T.highlight;if(L){var v=L.bezier,n=T._interactor;v&&Ql.Icons.DrawIcon(n,_,Ql.Icons.ShapeHighlightCurve,[v._p1.x,v._p1.y,v._p2.x,v._p2.y,v._p3.x,v._p3.y,v._p4.x,v._p4.y]);var M=L.point;M&&"insertKnot"===L.type&&Ql.Icons.DrawIcon(n,_,Ql.Icons.ShapeHighlighPoint,M)}},ed.prototype._drawGuide=function(L){var y=this,o=y._guideInfo;if(o){var C,t,Z,O,l=o.v;for(C=0;2>C;C++)if(O=0===C?o.xList:o.yList)for(t=0,Z=O.length;Z>t;t++)Ql.Icons.DrawIcon(y._interactor,L,Ql.Icons.ShapeGuideLine,[l.x,l.y,O[t].x,O[t].y])}},ed.prototype._drawCurrentPoint=function(M){var $=this;if($.activing){var q=$.activing,P=$.getCurrentSelectintStatus(),R=$._interactor;if(P!==Ql.Curve.PointType.Straight){var x=q.pairs;q.hlpair,q.hltype;var O=q.selections,Z=q.editingCtrl;if(x&&!O){var z,s,c;for(s=0,c=x.length;c>s;s++)z=x[s],Z&&s===Z.pairId&&z[Z.type]?Ql.Icons.DrawIcon(R,M,Ql.Icons.ShapeActivingCtrl,{point:z.point,c1:z.c1,c2:z.c2,hl:Z.type}):Ql.Icons.DrawIcon(R,M,Ql.Icons.ShapeActivingCtrl,z)}}Ql.Icons.DrawIcon(R,M,Ql.Icons.ShapeHighlighRealPoint,$.activing.point),O&&O.forEach(function(Z){Ql.Icons.DrawIcon(R,M,Ql.Icons.ShapeHighlighRealPoint,Z)})}},ed.prototype.clear=function(){var A=this;A.editing=null,A._guideInfo=null,A.activing=null,A.highlight=null},ed.prototype._42=function(h){var v=this;v.info={},v.editing||(v.screenInfo=null);var N=v._interactor;if(!N.editDetail)return v.clear(),void 0;if(!v.target||!v._interactor.gv.isSelected(v.target)||!v._interactor.gv.isVisible(v.target))return N.editDetail=!1,v.clear(),void 0;if(v.gatherSingleTarget(N.gv,v.target),Ql.Icons.DrawIcon(N,h,Ql.Icons.ShapeBgCurve,v.screenInfo),v._drawHighlight(h),v._drawCurrentPoint(h),v._getRealPoint().forEach(function(w){Ql.Icons.DrawIcon(N,h,Ql.Icons.ShapePoint,w)}),v._drawGuide(h),v.tipInfo&&Ql.Icons.DrawIcon(N,h,Ql.Icons.TipHelper,v.tipInfo),v._edgeHostGuideInfo&&Ql.Icons.DrawIcon(N,h,Ql.Icons.NodeHoverGuide,v._edgeHostGuideInfo),v._interactor.getStyle("curveElevationVisible")&&v.target instanceof u.Polyline&&v.activing){var W=v.activing.getCurrentEditingPoint();W&&Ql.Icons.DrawIcon(N,h,Ql.Icons.EdgeElevationGuide,W)}},ed.prototype._getRealPoint=function(){var g,I=this.screenInfo,Z=I.P,T=I.S,O=-1,E=[],h=-1,W=T.length;return T.each(function(S){h++;var A=1;if(3===S)A=2;else if(4===S)A=3;else if(5===S)return;O+=A,g=h+1>=W?!0:1===T.get(h+1)?!0:!1,E.push({point:{x:Z[2*O],y:Z[2*O+1]},isEnd:g})}),E};var ug=Ql.MoveHelper=function(g){var A=this;A.catalog="Move",A._interactor=g};ug.prototype={},ug.prototype.constructor=ug,ug.prototype.calcShift=function(e,O,o){var E,N,D=this,H=D._interactor.gv,c=H.lp(O);if("beginMove"===e&&D._gatherGridInfo(o._lastLogicalPoint||c),E=D._target){var I=E.downPosition;if(I){var F=D._interactor.getStyle("moveSensitivity")/H._zoom;if(I.distanceTo(c)<F)return{x:0,y:0};delete E.downPosition}var B;N=u.Default.isShiftDown(O),N&&(c=D._dealShiftDown(c),B=E.shiftGuide.dir);var l,n=E.rawPos={x:E.pos.x+c.x-E.lp.x,y:E.pos.y+c.y-E.lp.y};if(u.Default.isCtrlDown(O)){if(l=D._calcShiftByAddon(),D._target.node instanceof Ql.Group){var r=D._target.node;r._position.x+=l.x,r._position.y+=l.y}return l}for(var C,y=E.x+n.x,R=E.y+n.y,Y={x:y,y:R},G={x:y+E.w/2,y:R+E.h/2},J={x:y+E.w,y:R+E.h},h=D._interactor.rectGuide,w=D._interactor.gridGuide,P=[h.findClosest(Y,B),h.findClosest(G,B),h.findClosest(J,B),w.findClosest(Y,B),w.findClosest(G,B),w.findClosest(J,B)],Q=1/0,M=1/0,A=0,p=P.length;p>A;A++)C=P[A],C&&(y=C.x,R=C.y,isFinite(y)&&Math.abs(y)<Math.abs(Q)&&(Q=y),isFinite(R)&&Math.abs(R)<Math.abs(M)&&(M=R));if(isFinite(Q)||(Q=0),isFinite(M)||(M=0),l=D._calcShiftByAddon(Q,M),D._target.node instanceof Ql.Group){var r=D._target.node;r._position.x+=l.x,r._position.y+=l.y}var d=E.node;if(!nh(d,H)){var U=n.x+Q,f=n.y+M;D._interactor.rectGuide.gatherLines({node:d,x:E.x+U,y:E.y+f,w:E.w,h:E.h},B)}return l}},ug.prototype._calcShiftByAddon=function(n,C){var F=this._target,W=F.rawPos,T=F.node.getPosition();return n=n||0,C=C||0,{x:W.x-T.x+n,y:W.y-T.y+C}},ug.prototype._dealShiftDown=function(M){var N=this,e=N._target.shiftGuide,F=N._target.lp,u=Math.abs(M.x-F.x),b=Math.abs(M.y-F.y);u>b&&u>e.limit&&"y"===e.dir&&(e.dir="x"),b>u&&b>e.limit&&"x"===e.dir&&(e.dir="y");var G=e.dir;return"x"===G?(M.y=F.y,e.limit=Math.max(e.limit,u)):"y"===G&&(M.x=F.x,e.limit=Math.max(e.limit,b)),M},ug.prototype._gatherGridInfo=function(_){var V,j=this,t=j._interactor,B=t._getValidSelection();if(1===B.length){if(V=B[0],!V.getRect)return j._target=null,void 0}else if(V=Ql.Group.findOrCreateGroup(B),!V)return j._target=null,void 0;var K=V.getPosition(),A=V.getRect();j._target={node:V,x:A.x-K.x,y:A.y-K.y,w:A.width,h:A.height,lp:{x:_.x,y:_.y},pos:{x:K.x,y:K.y},shiftGuide:{dir:"x",limit:0},downPosition:new Ql.Math.Vector2(_)},t.rectGuide.gatherRects()},ug.prototype.clear=function(){var D=this;D._interactor.rectGuide.clear(),D._interactor._42()};var or="directional",Eq="point",Wl="spot",cs="light.color",tm=function(O,m){Ai(m)&&Vq.test(m)?up(O,m):vl(m)&&m.modelType?Uo(O,m):Bn[O]=m},Zb=function(u){if(vl(u))return u;var O=Bn[u];return u&&O===r&&Vq.test(u)&&(Ym&&Ym[u]||up(u,u)),O};xj(v,{graph3dViewAttributes:C,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:I/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:un,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:I/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:tm,getShape3dModel:Zb,createMatrix:function(W,p){ij(W)||(W=[W]);for(var o=W.length-1;o>=0;o--){var Y=W[o];p=$i(Y.mat,Y.s3,Y.r3,Y.rotationMode,Y.t3,p)}return p},transformVec:function(h,T){return mg(h,T)},createBoxModel:function(){return{vs:Yd,ns:cp,uv:qc,is:kr}},createRoundRectModel:function(f,B){return kq.roundRect(f,B)},createStarModel:function(T,p){return kq.star(T,p)},createRectModel:function(B,X){return kq.rect(B,X)},createTriangleModel:function(W,r){return kq.triangle(W,r)},createRightTriangleModel:function(E,d){return kq.rightTriangle(E,d)},createParallelogramModel:function(P,$){return kq.parallelogram(P,$)},createTrapezoidModel:function(r,l){return kq.trapezoid(r,l)},createSmoothSphereModel:function(A,d,f,p,U,C,n){return Nn(new Er(A,d,f,p,U,C,n))},createSphereModel:function(y,Z,z,j,A,m){return y?Tk(y,Z,z,j,A,m):v.createSmoothSphereModel()},createSmoothConeModel:function(H,d,v,J,X){return Cn(H,d,v,J,X)},createConeModel:function(e,n,X,O,d,D){return e?Tf(e,n,X,O,d,D):Cn(D)},createSmoothCylinderModel:function(P,L,y,W,R,_,$,v){return Nn(new Jj(P,L,y,W,R,_,$,v))},createCylinderModel:function(L,b,a,G,r,Y,I){return L?qn(L,b,a,G,r,Y,I):zp(Y,I)},createSmoothTorusModel:function(s,E,n,p,K,L){return Nn(new Jo(s,E,n,p,K,L))},createTorusModel:function(m,d,B,V,b,q,c){return m?Qd(m,d,B,V,b,q,c):Cc(q,c)},createExtrusionModel:function(X,s,_,I,S,J,z,M){return zm(X,s,_,I,S,J,z,M)},createSmoothRingModel:function(I,n,x,m,d,W){for(var _=[],D=0;D<I.length-1;D+=2)_.push({x:I[D],y:I[D+1]});for(I=kk(_,n,x)[0],_=[],D=0;D<I.length;D++){var u=I[D];_.push(new kj(u.x,0,u.y))}return Nn(new od(_,W,m,d))},createTextGeometry:function(x,W){return Nn(new dh(x,W))},loadFontFace:function(D,J){v.xhrLoad(D,function(w){if(!w)return J();var Q;try{Q=JSON.parse(w)}catch(Y){Q=JSON.parse(w.substring(65,w.length-2))}Ah.loadFace(Q),J&&J(Q.familyName.toLowerCase())},J?null:{sync:!0})},createRingModel:function(b,P,e,M,q,k,X,r,p,i){for(var W=[],g=0;g<b.length-1;g+=2)W.push({x:b[g],y:b[g+1]});k=k||v.shapeSide,X=X||0,r=r||k;var D,U,n,T,O,j,m,w,S,$,g,N,R,l,o,c,s,K,u=[],F=[],H=p?[]:C,V=p?[]:C,B=i?[]:C,Z=i?[]:C,a=M?[]:C,y=M?[]:C,z=q?[]:C,I=q?[]:C,b=kk(W,P,e),J=Cl(b),A=0,Y=2*Math.PI/k;return b.forEach(function(L){if(n=L.length,n>1){if(T=L[0],M)for(j=T.x,w=T.y,g=X;r>g;g++)N=g+1,R=g*Y,l=N*Y,o=h(R),c=Q(R),s=h(l),K=Q(l),a.push(o*j,w,-c*j,s*j,w,-K*j,0,w,0),y.push(.5-.5*o,.5-.5*c,.5-.5*s,.5-.5*K,.5,.5);for($=0;n>$;$++){for(O=L[$],j=T.x,m=O.x,w=T.y,S=O.y,D=A/J,A+=Xo(T,O),U=A/J,g=X;r>g;g++)N=g+1,R=g*Y,l=N*Y,o=h(R),c=Q(R),s=h(l),K=Q(l),u.push(o*m,S,-c*m,s*m,S,-K*m,o*j,w,-c*j,s*m,S,-K*m,s*j,w,-K*j,o*j,w,-c*j),F.push(g/k,U,N/k,U,g/k,D,N/k,U,N/k,D,g/k,D),p&&g===X&&(H.push(0,w,0,0,S,0,o*m,S,-c*m,o*m,S,-c*m,o*j,w,-c*j,0,w,0),V.push(0,.5-w,0,.5-S,2*m,.5-S,2*m,.5-S,2*j,.5-w,0,.5-w)),i&&N===r&&(B.push(0,w,0,s*m,S,-K*m,0,S,0,s*m,S,-K*m,0,w,0,s*j,w,-K*j),Z.push(1,.5-w,1-2*m,.5-S,1,.5-S,1-2*m,.5-S,1,.5-w,1-2*j,.5-w));T=O}if(q)for(j=T.x,w=T.y,g=X;r>g;g++)N=g+1,R=g*Y,l=N*Y,o=h(R),c=Q(R),s=h(l),K=Q(l),z.push(s*j,w,-K*j,o*j,w,-c*j,0,w,0),I.push(.5-.5*s,.5+.5*K,.5-.5*o,.5+.5*c,.5,.5)}}),{vs:u,uv:F,bottom_vs:z,bottom_uv:I,top_vs:a,top_uv:y,from_vs:H,from_uv:V,to_vs:B,to_uv:Z}}},!0),xj(w,{"3d.move.mode":r,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":r,"edge.gradient.color":r,"edge.source.t3":r,"edge.target.t3":r,"light.type":Eq,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":I/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Sf,"wf.short":!1,"wf.mat":r,"wf.geometry":!1,batch:r,"transparent.mask":!1,brightness:r,"select.brightness":.7,"repeat.uv.length":r,alphaTest:.4,"label.face":Nb,"label.t3":r,"label.r3":r,"label.texture.scale":2,"label.rotationMode":Cg,"label.light":!1,"label.blend":r,"label.reverse.flip":!1,"label.reverse.color":Gk,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Nb,"label2.t3":r,"label2.r3":r,"label2.texture.scale":2,"label2.rotationMode":Cg,"label2.light":!1,"label2.blend":r,"label2.reverse.flip":!1,"label2.reverse.color":Gk,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Nb,"note.t3":r,"note.r3":r,"note.texture.scale":2,"note.rotationMode":Cg,"note.light":!1,"note.blend":r,"note.reverse.flip":!1,"note.reverse.color":Gk,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Nb,"note2.t3":r,"note2.r3":r,"note2.texture.scale":2,"note2.rotationMode":Cg,"note2.light":!1,"note2.blend":r,"note2.reverse.flip":!1,"note2.reverse.color":Gk,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:r,"shape3d.color":Pc,"shape3d.top.color":r,"shape3d.bottom.color":r,"shape3d.from.color":r,"shape3d.to.color":r,"shape3d.image":r,"shape3d.top.image":r,"shape3d.bottom.image":r,"shape3d.from.image":r,"shape3d.to.image":r,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":r,"shape3d.side.to":r,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":r,"shape3d.opacity":r,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Gk,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":r,"shape3d.uv.scale":r,"shape3d.top.uv.offset":r,"shape3d.top.uv.scale":r,"shape3d.bottom.uv.offset":r,"shape3d.bottom.uv.scale":r,"shape3d.from.uv.offset":r,"shape3d.from.uv.scale":r,"shape3d.to.uv.offset":r,"shape3d.to.uv.scale":r,"shape3d.top.cap":r,"shape3d.bottom.cap":r,"shape3d.start.angle":0,"shape3d.sweep.angle":R,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":r,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Pc,"all.image":r,"all.blend":r,"all.opacity":r,"all.reverse.flip":!1,"all.reverse.color":Gk,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":r,"all.uv.offset":r,"all.uv.scale":r,"all.discard.selectable":!0,mat:r,"left.mat":r,"right.mat":r,"top.mat":r,"bottom.mat":r,"front.mat":r,"back.mat":r},!0);var lj,Nd=!1,Uj=[0,0,0,0],qs={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:en,2:lg,3:al,4:rb,5:Nb,6:Eg}},af=function($,u,L,e){if(u.getFaceVisible($,L)){Pi(u,yk($,u.getFaceMat($,L)||u.getMat($)));var J=u._26I;u.getFaceReverseCull($,L)?J.enable(J.CULL_FACE):J.disable(J.CULL_FACE),pi(J,u._prg.uFixPickReverseColor,qs[L]),Vi(J),_k(J,e,6),Bj(J),tp(u)}},rf=function(U){return U instanceof Tj},Vd=function(f){return[f.x,f.e||0,f.y]},Hb=function(R,g,N){for(var g=Jn(g),Z=g[0],e=g[1],u=g[2];N--;)R.push(Z,e,u)},op=function(q,S,V){for(var S=Jn(S),P=S[0],p=S[1],g=S[2],T=S[3];V--;)q.push(P,p,g,T)},Up=function(H,C,F){if(C)for(var O,P,G,L=C[0],X=C[1],Z=C[2],D=C[4],a=C[5],Q=C[6],_=C[8],U=C[9],E=C[10],o=C[12],u=C[13],A=C[14],h=F.length,k=0,k=0;h>k;k+=3)O=F[k],P=F[k+1],G=F[k+2],H.push(L*O+D*P+_*G+o,X*O+a*P+U*G+u,Z*O+Q*P+E*G+A);else km(H,F)},Sr=function(n,z){var r=z.s("light.intensity"),q=Jn(z.s(cs)),Y=q[0],G=q[1],h=q[2];1!==r&&(Y*=r,G*=r,h*=r),n.push(Y,G,h,z.s("light.disabled")?1:0)},Do=function(N,E,s){pi(E,s.uHeadlightRange,N._headlightRange);var F=N._headlightIntensity,X=Jn(N._headlightColor);1!==F&&(X=[X[0]*F,X[1]*F,X[2]*F]),pi(E,s.uHeadlightColor,[X[0],X[1],X[2],N._headlightDisabled?1:0]);var D=N._59O,S=N._spots,V=N._dirs;if(D.length){var e=[],O=[],v=[];D.forEach(function(I){Sr(e,I),km(O,N._transformPointToViewSpace(I.p3())),v.push(I.s("light.range"))}),E.uniform4fv(s.uPointColor,e),E.uniform1fv(s.uPointRange,v),E.uniform3fv(s.uPointPosition,O)}if(S.length){var A=[],L=[],x=[],y=[],Y=[],P=[];S.forEach(function(H){Sr(A,H),km(L,N._transformPointToViewSpace(H.p3())),km(Y,N._transformDirectionToViewSpace(H.p3(),H.s("light.center"))),x.push(H.s("light.range")),y.push(h(H.s("light.angle")/2)),P.push(H.s("light.exponent"))}),E.uniform4fv(s.uSpotColor,A),E.uniform1fv(s.uSpotRange,x),E.uniform1fv(s.uSpotAngle,y),E.uniform1fv(s.uSpotExponent,P),E.uniform3fv(s.uSpotPosition,L),E.uniform3fv(s.uSpotDirection,Y)}if(V.length){var K=[],c=[];V.forEach(function(i){Sr(K,i),km(c,N._transformDirectionToViewSpace(i.p3()))}),E.uniform4fv(s.uDirColor,K),E.uniform3fv(s.uDirDirection,c)}},pm=function(R){return R>0&&0===(R-1&R)},qk=function(r){return r=F(0,x(I,r)),r=F(eg,x(I-eg,r))},Mf=function(){return.05+E()/2},Dm=function(M,G,j,V){var a,i=M.getEye();return M.isOrtho()?(a=Xl(M.getCenter(),i),a[0]+=V[0],a[1]+=V[1],a[2]+=V[2]):a=i,sb(G,j,V,a)},sb=function(o,b,q,I){var l=Kc(o,b),Z=Xl(I,q,!0),_=Kc(Z,b);if(M(_)<eg)return C;var J=(l-Kc(q,b))/_;return[q[0]+Z[0]*J,q[1]+Z[1]*J,q[2]+Z[2]*J]},nd=function(p,w){return{x:2*p.x-w.x,y:2*p.y-w.y}},Bg=function(r,e,k,l){var S,R;if(!r)return S=W(e.y-k.y,k.x-e.x),{x:e.x+l*Q(S),y:e.y+l*h(S)};if(!k)return S=W(r.y-e.y,e.x-r.x),{x:e.x+l*Q(S),y:e.y+l*h(S)};var Y=Xl([r.x,r.y,0],[e.x,e.y,0],!0),O=Xl([k.x,k.y,0],[e.x,e.y,0],!0),s=-(Y[0]+O[0])/2,q=-(Y[1]+O[1])/2,o=c(s*s+q*q);if(eg>o)return S=W(r.y-e.y,e.x-r.x),{x:e.x+l*Q(S),y:e.y+l*h(S)};var I=r.x-e.x,N=r.y-e.y,v=k.x-e.x,u=k.y-e.y,K=c(I*I+N*N),$=c(v*v+u*u);S=T(Kc(Y,O))/2,R=Y[1]*O[0]-Y[0]*O[1]>0?-1:1,s/=o,q/=o;var U=l/Q(S),n=F(K,$)/h(S);o=Math.min(U,n);var Z={x:e.x+R*o*s,y:e.y+R*o*q};return k.b&&U>$/h(S)&&(Z.adjust=!0),Z},xi=function(u){var r=u[1],V=u[2],l=u[3],R=u[6],_=u[7],K=u[11];u[1]=u[4],u[2]=u[8],u[3]=u[12],u[4]=r,u[6]=u[9],u[7]=u[13],u[8]=V,u[9]=R,u[11]=u[14],u[12]=l,u[13]=_,u[14]=K},yc=function(x){var V=x[0],E=x[1],l=x[2],X=x[3],r=x[4],z=x[5],i=x[6],k=x[7],U=x[8],Z=x[9],J=x[10],t=x[11],h=x[12],n=x[13],P=x[14],F=x[15],m=V*z-E*r,s=V*i-l*r,d=V*k-X*r,q=E*i-l*z,o=E*k-X*z,I=l*k-X*i,p=U*n-Z*h,j=U*P-J*h,$=U*F-t*h,u=Z*P-J*n,K=Z*F-t*n,N=J*F-t*P,_=m*N-s*K+d*u+q*$-o*j+I*p;return _?(_=1/_,x[0]=(z*N-i*K+k*u)*_,x[1]=(l*K-E*N-X*u)*_,x[2]=(n*I-P*o+F*q)*_,x[3]=(J*o-Z*I-t*q)*_,x[4]=(i*$-r*N-k*j)*_,x[5]=(V*N-l*$+X*j)*_,x[6]=(P*d-h*I-F*s)*_,x[7]=(U*I-J*d+t*s)*_,x[8]=(r*K-z*$+k*p)*_,x[9]=(E*$-V*K-X*p)*_,x[10]=(h*o-n*d+F*m)*_,x[11]=(Z*d-U*o-t*m)*_,x[12]=(z*j-r*u-i*p)*_,x[13]=(V*u-E*j+l*p)*_,x[14]=(n*s-h*q-P*m)*_,x[15]=(U*q-Z*s+J*m)*_,void 0):C},fb=function(T,r){if(r){var h=r[0],H=r[1],M=r[2];T[12]=T[0]*h+T[4]*H+T[8]*M+T[12],T[13]=T[1]*h+T[5]*H+T[9]*M+T[13],T[14]=T[2]*h+T[6]*H+T[10]*M+T[14],T[15]=T[3]*h+T[7]*H+T[11]*M+T[15]}},Gn=function(T,p){if(p){var q=p[0],y=p[1],$=p[2];T[0]=T[0]*q,T[1]=T[1]*q,T[2]=T[2]*q,T[3]=T[3]*q,T[4]=T[4]*y,T[5]=T[5]*y,T[6]=T[6]*y,T[7]=T[7]*y,T[8]=T[8]*$,T[9]=T[9]*$,T[10]=T[10]*$,T[11]=T[11]*$}},zh=function(B,f,D){var V=f[0],T=f[1],r=f[2],t=f[3],H=f[4],u=f[5],F=f[6],n=f[7],p=f[8],i=f[9],N=f[10],O=f[11],L=f[12],y=f[13],A=f[14],J=f[15],b=D[0],S=D[1],s=D[2],g=D[3];return B[0]=b*V+S*H+s*p+g*L,B[1]=b*T+S*u+s*i+g*y,B[2]=b*r+S*F+s*N+g*A,B[3]=b*t+S*n+s*O+g*J,b=D[4],S=D[5],s=D[6],g=D[7],B[4]=b*V+S*H+s*p+g*L,B[5]=b*T+S*u+s*i+g*y,B[6]=b*r+S*F+s*N+g*A,B[7]=b*t+S*n+s*O+g*J,b=D[8],S=D[9],s=D[10],g=D[11],B[8]=b*V+S*H+s*p+g*L,B[9]=b*T+S*u+s*i+g*y,B[10]=b*r+S*F+s*N+g*A,B[11]=b*t+S*n+s*O+g*J,b=D[12],S=D[13],s=D[14],g=D[15],B[12]=b*V+S*H+s*p+g*L,B[13]=b*T+S*u+s*i+g*y,B[14]=b*r+S*F+s*N+g*A,B[15]=b*t+S*n+s*O+g*J,B},ye=function(h,p,I,S){var r,e,l,B,U,u,m,P,K,k,G=p[0],f=p[1],d=p[2],T=S[0],i=S[1],v=S[2],w=I[0],N=I[1],E=I[2];return M(G-w)<eg&&M(f-N)<eg&&M(d-E)<eg?gd(h):(m=G-w,P=f-N,K=d-E,k=1/c(m*m+P*P+K*K),m*=k,P*=k,K*=k,r=i*K-v*P,e=v*m-T*K,l=T*P-i*m,k=c(r*r+e*e+l*l),k?(k=1/k,r*=k,e*=k,l*=k):(r=0,e=0,l=0),B=P*l-K*e,U=K*r-m*l,u=m*e-P*r,k=c(B*B+U*U+u*u),k?(k=1/k,B*=k,U*=k,u*=k):(B=0,U=0,u=0),h[0]=r,h[1]=B,h[2]=m,h[3]=0,h[4]=e,h[5]=U,h[6]=P,h[7]=0,h[8]=l,h[9]=u,h[10]=K,h[11]=0,h[12]=-(r*G+e*f+l*d),h[13]=-(B*G+U*f+u*d),h[14]=-(m*G+P*f+K*d),h[15]=1,h)},Ob=function(E,t,e,I,N){var M=1/o(t/2),$=1/(I-N);return E[0]=M/e,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=M,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=(N+I)*$,E[11]=-1,E[12]=0,E[13]=0,E[14]=2*N*I*$,E[15]=0,E},Ok=function(h,r,K,U,e,z,V){var $=1/(r-K),B=1/(U-e),G=1/(z-V);return h[0]=-2*$,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*B,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*G,h[11]=0,h[12]=(r+K)*$,h[13]=(e+U)*B,h[14]=(V+z)*G,h[15]=1,h},Fd=function(o,x){var j=x[0],Z=x[1],p=x[2],$=x[3],n=j*j+Z*Z+p*p+$*$,v=n?1/n:0;return o[0]=-j*v,o[1]=-Z*v,o[2]=-p*v,o[3]=$*v,o},qj=function(F,_){var Y=_[0]+_[5]+_[10],W=0;return Y>0?(W=2*Math.sqrt(Y+1),F[3]=.25*W,F[0]=(_[6]-_[9])/W,F[1]=(_[8]-_[2])/W,F[2]=(_[1]-_[4])/W):_[0]>_[5]&_[0]>_[10]?(W=2*Math.sqrt(1+_[0]-_[5]-_[10]),F[3]=(_[6]-_[9])/W,F[0]=.25*W,F[1]=(_[1]+_[4])/W,F[2]=(_[8]+_[2])/W):_[5]>_[10]?(W=2*Math.sqrt(1+_[5]-_[0]-_[10]),F[3]=(_[8]-_[2])/W,F[0]=(_[1]+_[4])/W,F[1]=.25*W,F[2]=(_[6]+_[9])/W):(W=2*Math.sqrt(1+_[10]-_[0]-_[5]),F[3]=(_[1]-_[4])/W,F[0]=(_[8]+_[2])/W,F[1]=(_[6]+_[9])/W,F[2]=.25*W),F},ff=function(B,f,m){var G=f[0],o=f[1],H=f[2],s=f[3],$=G+G,u=o+o,j=H+H,E=G*$,l=G*u,h=G*j,F=o*u,p=o*j,W=H*j,C=s*$,R=s*u,x=s*j;return B[0]=1-(F+W),B[1]=l+x,B[2]=h-R,B[3]=0,B[4]=l-x,B[5]=1-(E+W),B[6]=p+C,B[7]=0,B[8]=h+R,B[9]=p-C,B[10]=1-(E+F),B[11]=0,B[12]=m[0],B[13]=m[1],B[14]=m[2],B[15]=1,B},Zg=function(){var w=[0,0,0],v=[0,0,0],H=[0,0,0],W=function(W,r,q){W[0]=r[1]*q[2]-r[2]*q[1],W[1]=r[2]*q[0]-r[0]*q[2],W[2]=r[0]*q[1]-r[1]*q[0]},R=function(D){return D[0]*D[0]+D[1]*D[1]+D[2]*D[2]},s=function(g){var a=Math.sqrt(R(g));g[0]/=a,g[1]/=a,g[2]/=a},Q=function(u,L,T){u[0]=L[0]-T[0],u[1]=L[1]-T[1],u[2]=L[2]-T[2]};return function(A,U,C){var X=mb();return Q(H,A,U),0===R(H)&&(H[2]=1),s(H),W(w,C,H),0===R(w)&&(1===Math.abs(C[2])?H[0]+=1e-4:H[2]+=1e-4,s(H),W(w,C,H)),s(w),W(v,H,w),X[0]=w[0],X[4]=v[0],X[8]=H[0],X[1]=w[1],X[5]=v[1],X[9]=H[1],X[2]=w[2],X[6]=v[2],X[10]=H[2],X}}(),Ei=function(h,L){if(h.vr.enable){var G=h.vr.getViewMatrix(L);if(G)return G}return ye(L?L:mb(),h._eye,h._center,h._up)},Qr=function(O){if(O.vr.enable){var w=O.vr.getProjectMatrix();if(w)return w}var W=O.getAspect(),e=O._near,D=O._far,F=mb();if(O._ortho){var b=O._orthoWidth/2,S=b/W;Ok(F,-b,b,-S,S,e,D)}else Ob(F,O._fovy,W,e,D);return F},uj=function(k,Y){if(!k)return C;var H=0,I=1,u=2,J=[],n=0,z=k.length,A=z/3;if(Y){for(;z>n;n++)J[n]=0;for(n=0;n<Y.length;n+=3){var f=[],M=[],U=[];f[H]=k[3*Y[n+1]+H]-k[3*Y[n]+H],f[I]=k[3*Y[n+1]+I]-k[3*Y[n]+I],f[u]=k[3*Y[n+1]+u]-k[3*Y[n]+u],M[H]=k[3*Y[n+2]+H]-k[3*Y[n+1]+H],M[I]=k[3*Y[n+2]+I]-k[3*Y[n+1]+I],M[u]=k[3*Y[n+2]+u]-k[3*Y[n+1]+u],U[H]=f[I]*M[u]-f[u]*M[I],U[I]=f[u]*M[H]-f[H]*M[u],U[u]=f[H]*M[I]-f[I]*M[H];for(var O=0;3>O;O++)J[3*Y[n+O]+H]+=U[H],J[3*Y[n+O]+I]+=U[I],J[3*Y[n+O]+u]+=U[u]}}else for(n=0;A>n;n+=3){var f=[],M=[],U=[];f[H]=k[3*(n+1)+H]-k[3*n+H],f[I]=k[3*(n+1)+I]-k[3*n+I],f[u]=k[3*(n+1)+u]-k[3*n+u],M[H]=k[3*(n+2)+H]-k[3*(n+1)+H],M[I]=k[3*(n+2)+I]-k[3*(n+1)+I],M[u]=k[3*(n+2)+u]-k[3*(n+1)+u],U[H]=f[I]*M[u]-f[u]*M[I],U[I]=f[u]*M[H]-f[H]*M[u],U[u]=f[H]*M[I]-f[I]*M[H];for(var O=0;3>O;O++)J[3*(n+O)+H]=U[H],J[3*(n+O)+I]=U[I],J[3*(n+O)+u]=U[u]}for(n=0;z>n;n+=3){var D=[];D[H]=J[n+H],D[I]=J[n+I],D[u]=J[n+u];var Q=c(D[H]*D[H]+D[I]*D[I]+D[u]*D[u]);0===Q&&(Q=eg),D[H]=D[H]/Q,D[I]=D[I]/Q,D[u]=D[u]/Q,J[n+H]=D[H],J[n+I]=D[I],J[n+u]=D[u]}return new me(J)},Oe=function(z,l,r,y){if(r||(r=z.createTexture()),l){var Y=z.TEXTURE_2D,d=z.REPEAT,H=z.CLAMP_TO_EDGE,U=z.TEXTURE_MIN_FILTER;y!==z.NEAREST&&(y=z.LINEAR),Wj(z,r),z.texImage2D(Y,0,z.RGBA,z.RGBA,z.UNSIGNED_BYTE,l),he(z,z.TEXTURE_MAG_FILTER,y);var w=l.naturalWidth||l.width,u=l.naturalHeight||l.height;pm(w)&&pm(u)&&!l.clampToEdge?(he(z,z.TEXTURE_WRAP_S,d),he(z,z.TEXTURE_WRAP_T,d),he(z,U,z.LINEAR_MIPMAP_LINEAR),z.generateMipmap(Y)):(he(z,z.TEXTURE_WRAP_S,H),he(z,z.TEXTURE_WRAP_T,H),he(z,U,y)),Wj(z,C)}return r},on=function(E,$){var T=new Uint8Array(3);return $=$||E.createTexture(),Wj(E,$),he(E,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.RGB,1,1,0,E.RGB,E.UNSIGNED_BYTE,T),$},pe=function(_){_._26I&&_._prg&&(_._26I.deleteProgram(_._prg),_._prg=C)},di=function(c,l,N,X){var G=c.createShader(N);return c.shaderSource(G,X),c.compileShader(G),c.attachShader(l,G),G
},Tn=function(p){return p.createBuffer()},Wj=function(m,j){m.bindTexture(m.TEXTURE_2D,j)},Pn=function(q,e){q.bindFramebuffer(q.FRAMEBUFFER,e)},he=function(C,y,S){C.texParameteri(C.TEXTURE_2D,y,S)},Mq=function(J,A){J.enable(J.POLYGON_OFFSET_FILL),J.polygonOffset(A[0],A[1])},wd=function(j){j.disable(j.POLYGON_OFFSET_FILL)},Fe=function(l,J){if(J){var J=Jn(J);l.clearColor(J[0],J[1],J[2],J[3])}},Rb=function(c,n){pi(c,n.uFix,!0),Kn(c,n.aNormal)},em=function(A,P){pi(A,P.uFix,!1),cm(A,P.aNormal)},ce=function(n,a,u,v,S,e,H,f){n._picking||(u?(pi(n,a.uBlend,!0),pi(n,a.uBlendColor,u)):pi(n,a.uBlend,!1),pi(n,a.uLight,v==C?!0:v),gl(S)&&1!==S&&pi(n,a.uPartOpacity,S),pi(n,a.uReverseFlip,e==C?!1:e),pi(n,a.uFixPickReverseColor,H||Gk)),f?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE)},_d=function(Q,i){Q._picking||pi(Q,i.uPartOpacity,1)},Vi=function(H,R,C,Q,A,z,j,t,c){if(!C)return H.activeTexture(H.TEXTURE0),Wj(H,H._emptyTexture),H.activeTexture(H.TEXTURE1),Wj(H,H._emptyBlendTexture),void 0;pi(H,R.uTexture,!0),pi(H,R.uDiscardSelectable,Yi(Q)?Q:!0),cm(H,R.aUv),$m(H,A,z,R.aUv,2),c?(pi(H,R.uBlendTexture,!0),H.activeTexture(H.TEXTURE1),Wj(H,c),H.uniform1i(R.uBlendSampler,1)):(pi(H,R.uBlendTexture,!1),H.activeTexture(H.TEXTURE1),Wj(H,H._emptyBlendTexture)),H.activeTexture(H.TEXTURE0),Wj(H,C),H.uniform1i(R.uSampler,0);var r=[0,0,1,1];j&&(r[0]=j[0],r[1]=j[1]),t&&(r[2]=t[0],r[3]=t[1]),pi(H,R.uOffsetScale,r)},Bj=function(n,H,f){n.activeTexture(n.TEXTURE0),Wj(n,C),n.activeTexture(n.TEXTURE1),Wj(n,C),f&&(Kn(n,H.aUv),pi(n,H.uTexture,!1),pi(n,H.uBlendTexture,!1))},Zq=function(I,K,O,Q,n,D){!O||d||L||I.lineWidth(O),Q&&!I._picking&&pi(I,K.uFixPickReverseColor,Q),n&&$m(I,n,D,K.aPosition)},We=function(X,N,i,j){lj&&(j=X[lj]),X.drawArrays(j==C?X.TRIANGLES:j,N,i);var J=X._renderInfo;J&&(J.calls++,J.vertices+=i,(j==C||j===X.TRIANGLES)&&(J.faces+=i/3),j===X.LINES&&(J.lines+=i/2))},_k=function(I,O,Q,o){lj&&(o=I[lj]),I.drawElements(o==C?I.TRIANGLES:o,Q,I.UNSIGNED_SHORT,O==C?0:2*O);var d=I._renderInfo;d&&(d.calls++,d.vertices+=Q,(o==C||o===I.TRIANGLES)&&(d.faces+=Q/3),o===I.LINES&&(d.lines+=Q/2))},qi=function(v,E,L,d,S){var Y=v.ARRAY_BUFFER;v.bindBuffer(Y,E),L&&v.bufferData(Y,L,v.STATIC_DRAW),d!=C&&v.vertexAttribPointer(d,S?S:3,v.FLOAT,!1,0,0)},$m=function(L,M,U,T,r){return U?(ml(L,L.ARRAY_BUFFER,M,U),T!=C&&L.vertexAttribPointer(T,r?r:3,L.FLOAT,!1,0,0),void 0):qi(L,M,U,T,r)},To=function(c,S,o){var F=c.ELEMENT_ARRAY_BUFFER;c.bindBuffer(F,S),o&&c.bufferData(F,o,c.STATIC_DRAW)},zs=function(g,v,w){ml(g,g.ELEMENT_ARRAY_BUFFER,v,w)},ml=function(A,j,s,V){var d=V._bufId;d||(d=V._bufId=u.Math.generateIncreasingID());var s,q=A._bufPool;(s=q[d])&&s._buf?A.bindBuffer(j,s._buf):(s=q[d]={_buf:Tn(A)},A.bindBuffer(j,s._buf),A.bufferData(j,V,A.STATIC_DRAW)),s._fid=A._renderInfo.frame},pi=function(t,n,E){if(E!=C&&n!=C){E=Jn(E);var W=E.length;3===W?t.uniform3fv(n,E):4===W?t.uniform4fv(n,E):16===W?t.uniformMatrix4fv(n,!1,E):Yi(E)?t.uniform1i(n,E?1:0):2===W?t.uniform2fv(n,E):t.uniform1f(n,E)}},cm=function(W,M){M!=C&&M>=0&&W.enableVertexAttribArray(M)},Kn=function(P,K){K!=C&&K>=0&&P.disableVertexAttribArray(K)},tp=function(W,O){var m=W.getGL(),a=W._prg;W._7O=W._8O.pop(),O&&(pi(m,a.uMVMatrix,W._7O),W._6O=O,pi(m,a.uNMatrix,O))},wq=function(w,I){return I||(I=mb()),sn(I,w),yc(I),xi(I),I},Pi=function(M,o){var q=M.getGL(),P=M._prg,b=M._7O;o&&(M._8O.push(Me(b)),zh(b,b,o),M._7O=b),pi(q,P.uMVMatrix,b),pi(q,P.uNMatrix,wq(b,M._6O))},pj=function(t,u,l,g,U,E){if(l){if(g){var G=l.value++,d=2147483648|G,y=[(255&d>>16)/255,(255&d>>8)/255,(255&d)/255,(255&d>>24)/255];l[G]={data:U,part:E}}else y=Uj;return pi(t,u.uFixPickReverseColor,y),y}},il=function(){var t={center:function(P,O,f,n,v){var S=-O[1]/2,b={x:-O[0]/2,y:S,width:O[0],height:O[1]},_=vh(P,b,f);return[_.x+n,-_.y-v,Mf()]},front:function(u,i,L,H,$){var f=-i[1]/2,t={x:-i[0]/2,y:f,width:i[0],height:i[1]},I=vh(u,t,L);return[I.x+H,-I.y-$,i[2]/2+Mf()]},back:function(_,Z,t,f,p){var V=-Z[0]/2,G=-Z[1]/2,e={x:V,y:G,width:Z[0],height:Z[1]},s=vh(_,e,t);return[-s.x-f,-s.y-p,-Z[2]/2-Mf()]},left:function(u,h,L,X,_){var T=-h[1]/2,s={x:-h[2]/2,y:T,width:h[2],height:h[1]},d=vh(u,s,L);return[-h[0]/2-Mf(),-d.y-_,d.x+X]},right:function(g,N,W,w,D){var J=-N[2]/2,L=-N[1]/2,E={x:J,y:L,width:N[2],height:N[1]},h=vh(g,E,W);return[N[0]/2+Mf(),-h.y-D,-h.x-w]},top:function(a,W,q,d,L){var T={x:-W[0]/2,y:-W[2]/2,width:W[0],height:W[2]},O=vh(a,T,q);return[O.x+d,W[1]/2+Mf(),O.y+L]},bottom:function(Q,k,u,q,p){var n=-k[2]/2,l={x:-k[0]/2,y:n,width:k[0],height:k[2]},J=vh(Q,l,u);return[J.x+q,-k[1]/2-Mf(),-J.y-p]}};return function(r,H,K,k,h,n){return t[k](r,H,K,h||0,n||0)}}(),vf=function(g,H,N,D,o,d,K,b,Y,F){if(o&&(H[0]+=o[0],H[1]+=o[1],H[2]+=o[2]),fb(g,N),b){var a=mb();if(El(a,Y,F),mg(H,a),fb(g,H),g.auto=b,g.pos=mg([0,0,0],g),d){var j=g.mat2=mb();El(j,d,K)}}else El(g,Y,F),fb(g,H),D===en?rc(g,-f):D===lg?rc(g,f):D===al?dj(g,-f):D===rb?dj(g,f):D===Eg&&rc(g,I),El(g,d,K);return g},vk=function(f,G){var B=G.auto,v=G.mat2,q=f.gv;if(B){var _,e=mb(),C=[0,0,0,0];_="string"==typeof B?[B.indexOf("x")<0?q._eye[0]:q._center[0],B.indexOf("y")<0?q._eye[1]:q._center[1],B.indexOf("z")<0?q._eye[2]:q._center[2]]:q._eye,qj(C,ye(mb(),_,q._center,q._up)),ff(e,Fd(C,C),G.pos),v&&zh(e,e,v),Pi(q,e)}else Pi(q,G)},Ec=function(f,o,Q,D,I){var B=f.s,V=f.gv,m=V.getGL(),M=V._prg,n=V._buffer,Z=V._1O;Oe(m,tf,Z),vk(f,Q),ce(m,M,B(o+".blend"),B(o+".light"),B(o+".opacity"),B(o+".reverse.flip"),B(o+".reverse.color"),B(o+".reverse.cull")),Vi(m,M,Z,I,n.uv,nm),$m(m,n.vs,D,M.aPosition),$m(m,n.ns,Hg,M.aNormal),zs(m,n.is,zq),_k(m,0,zq.length),Bj(m,M,Z),_d(m,M),tp(V)},no=function(E,R,T){var C=E.gv,q=E.data,Z=E[R]={blend:C.getBodyColor(q)||C.getFaceBlend(q,R),light:C.getFaceLight(q,R),color:C.getFaceColor(q,R),opacity:C.getFaceOpacity(q,R),transparent:C.getFaceTransparent(q,R),reverseFlip:C.getFaceReverseFlip(q,R),reverseColor:C.getFaceReverseColor(q,R),reverseCull:C.getFaceReverseCull(q,R),texture:C.getFaceImage(q,R),blendTexture:C.getFaceBlendImage(q,R),discardSelectable:C.getFaceDiscardSelectable(q,R)};if("csg"!==R){Z.uv=C.getFaceUv(q,R)||T&&T[R+"Uv"],Z.uvScale=C.getFaceUvScale(q,R)||T&&T[R+"UvScale"],Z.uvOffset=C.getFaceUvOffset(q,R)||T&&T[R+"UvOffset"];var v=C.getFaceMat(q,R);v&&(Z.mat=yk(q,v))}return Z},Ug=function(T,G,f,y,g){if(y){if(!g(y.transparent))return;var C=T.data,R=T.gv,r=R._buffer,i=R.getTexture(y.texture,C),O=R.getTexture(y.blendTexture,C);Vi(G,f,i,y.discardSelectable,r.uv,y.tuv,y.uvOffset,y.uvScale,O),ce(G,f,y.blend,y.light,y.opacity,y.reverseFlip,y.reverseColor,y.reverseCull),pi(G,f.uDiffuse,y.color),$m(G,r.vs,y.vs,f.aPosition),$m(G,r.ns,y.ns,f.aNormal),We(G,0,y.vs.length/3),_d(G,f),Bj(G,f,i)}},uq=function(q,m,p,w,y,k){var M,A,T,R,c,f,$,n,E,V,X,l=[w-m,y-p],G=q?q.length:0;for(T=0;G>T;T++){for(R=2,M=q[T],c=M[0],f=M[1];R+1<M.length;){if($=M[R],n=M[R+1],A=Fp(m,p,w,y,c,f,$,n,!0)){E=[$-c,n-f],V=Xo(E),E[0]/=V,E[1]/=V,V=Kc(l,E),V=V>0?k:-k,X=[E[0]*V,E[1]*V];break}c=$,f=n,R+=2}if(X)break}if(X)for(w=m+X[0],y=p+X[1],T=0;G>T;T++)for(R=2,M=q[T],c=M[0],f=M[1];R+1<M.length;){if($=M[R],n=M[R+1],A=Fp(m,p,w,y,c,f,$,n,!0))return[0,0];c=$,f=n,R+=2}return X?X:[w-m,y-p]},Wn=u.graph3d={},Bk=function(T,U,x){rh(H+".graph3d."+T,U,x)},Hn="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",gs="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";xj(v,{setBatchInfo:function(Q,b){He[Q]=b},getBatchInfo:function(x){return He[x]}},!0);var le=[1,1,1],Df=[1,0,0,0,0,1,0,1,1,1,1,0],Wq=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Kd=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],yg=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Rd=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Oc=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],lm=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Lb=function(O,V){nk(O,V,"_batchModelMap","_batchIndexMap"),Ji(O,V,"_wireframeModelMap","_wireframeIndexMap"),Ji(O,V,"_polylineModelMap","_polylineIndexMap"),Ji(O,V,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ji(O,V,"_polylineModelMapSwap","_polylineIndexMapSwap")},nk=function(N,b,U,Q){if(!b)return N[U]={},N[Q]={},void 0;var $=b._id,f=N[Q],g=f[$];if(g){var W=N[U],H=g.batch,z=W[H],r=z.ds,s=g.index;if(z.invalidate=!0,delete f[$],r.splice(s,1),ci(r))return delete W[H],void 0;for(var h=g.begin,O=g.size,P=3*h,t=3*O,X=4*h,x=4*O,j=z.vs,p=z.ps,d=z.uv,J=z.cs,Z=z.bs,n=z.rs,v=z.ns,G=z.ls;s<r.length;s++)g=f[r[s]._id],g.index--,g.begin-=O;j.splice(P,t),p.splice(X,x),d&&d.splice(2*h,2*O),J&&J.splice(X,x),Z&&Z.splice(P,t),n&&n.splice(h,O),v&&v.splice(P,t),G&&G.splice(h,O)}},Ji=nk,Xq=function(s,$,Y,l){if(!l)return C;var f=$[l];if(!f){var O=He[l]||Vf,k=O.image?[]:C;f=$[l]={vs:[],ns:[],uv:k,cs:k?C:O.color?C:[],bs:O.blend?[]:C,ps:[],rs:O.brightness?[]:C,ds:[]}}return f.invalidate=!0,s[Y._id]={index:f.ds.length,begin:f.vs.length/3,batch:l},f.ds.push(Y),f},Ee=function(Z,$){return $!=C&&1!==$?[Z[0]*$,Z[1]*$,Z[2]*$,Z[3]]:Z},Pd=function(X,n,a){var m=X.getBrightness(n),T=Jn(a.color||"white"),v=T[3]<1,N=Math.ceil(a.width)||1,c=(v?"T":"O")+N,y=X._wireframeIndexMap,G=X._wireframeModelMap,E=G[c];E||(E=G[c]={vs:[],cs:[],ps:[],ds:[],T:v,W:N});var Y,U=X.getData3dUI(n),i=Rg(U);if(a.geometry){if(!i)return;if(Y=oe(i),!Y)return}else Y=a.short?Tm:Yl;E.invalidate=!0;var p=E.vs,z=E.cs,g=E.ds,K=y[n._id]={index:g.length,begin:p.length/3,batch:c};g.push(n);var J=yk(n,a.mat),I=U._calcAnchorMat(n);I&&zh(J,J,I),Up(p,J,Y);var s=K.size=p.length/3-K.begin;op(z,Ee(T,m),s)},Hp=function(p,G,z,V,x,R,e,X,c){var Y=p.getBrightness(G);Y==C&&(Y=1);var g=Ee(Jn(V),Y),t=g[3]<1;R=Math.ceil(R)||1;var b=(t?"T":"O")+R;if(e){var W=e[0],r=(e[1]||W)+W;b+="-"+W+"-"+r,c&&(b+="-"+Lo(c)+"-"+Y,c=Ee(Jn(c),Y))}var H=p._polylineIndexMap,q=p._polylineModelMap,F=q[b];F||(F=q[b]={vs:[],cs:[],ps:[],ds:[],ls:e?[]:C,T:t,W:R},e&&(F.D=W,F.G=r,F.A=c)),F.invalidate=!0;var T,B=F.vs,O=F.cs,o=F.ds,I=F.ls,h=H[G._id]={index:o.length,begin:B.length/3,batch:b};o.push(G),km(B,z);var k,U=h.size=B.length/3-h.begin,n=z.length,$=0,v=[];if(e||x)for(T=0;n>T;T+=6)k=Xo([z[T],z[T+1],z[T+2]],[z[T+3],z[T+4],z[T+5]]),v.push(k),$+=k;if($&&x){var w,u=Ee(Jn(x),Y),A=[u[0]-g[0],u[1]-g[1],u[2]-g[2],u[3]-g[3]],D=0;for(T=0;n>T;T+=6)w=D/$,op(O,[g[0]+A[0]*w,g[1]+A[1]*w,g[2]+A[2]*w,g[3]+A[3]*w],1),D+=v[T/6],w=D/$,op(O,[g[0]+A[0]*w,g[1]+A[1]*w,g[2]+A[2]*w,g[3]+A[3]*w],1)}else op(O,g,U);if(e)for(D=X||0,T=0;n>T;T+=6)I.push(D),D+=v[T/6],I.push(D)},Op=function(B,d,P){if(d)for(var e=4*d.begin,E=P[d.batch].ps,k=0;k<d.size;k++)E[e++]=B[0],E[e++]=B[1],E[e++]=B[2],E[e++]=B[3]},xr=function(U,F){var H=F+["32"],$=U[F],l=U[H];$?l&&l.length===$.length?(l.set($),l._bufId=null):U[H]=new me($):delete U[H]},si=function(T,u,l,o,e,n,y,C,v){if(ij(l))l.forEach(function(w){si(T,u,w,o,e,n,y,C,v)});else if(Ai(l))si(T,u,Rg(o,l),o,e,n,y,C,v);else if(vl(l)){var K,t=Gb(l.mat,u,T),L=Gb(l.s3,u,T),F=Gb(l.t3,u,T),f=Gb(l.r3,u,T);if((L||f||F||t)&&(K=$i(t,L,f,Gb(l.rotationMode,u,T),F),n.push(K)),l.shape3d)si(T,u,l.shape3d,o,e,n,y,C,l);else{var Y=o.s;v=v||Vf;var p=n[0],N=n.length,_=Y("shape3d.color",l.color,v.color);if(e||(e=Y("shape3d.blend",l.blend,v.blend)),N>1){p=Me(p);for(var $=1;N>$;$++)zh(p,p,n[$])}l.vs&&Y(Zd,l.visible,v.visible)&&Ub(p,y,C,l.vs,l.uv,l.is,e,_),l.top_vs&&Y(te,l.topVisible,v.topVisible)&&Ub(p,y,C,l.top_vs,l.top_uv,l.top_is,e,Y("shape3d.top.color",l.topColor,v.topColor)||_),l.bottom_vs&&Y(Fm,l.bottomVisible,v.bottomVisible)&&Ub(p,y,C,l.bottom_vs,l.bottom_uv,l.bottom_is,e,Y("shape3d.bottom.color",l.bottomColor,v.bottomColor)||_),l.from_vs&&Y(Yb,l.fromVisible,v.fromVisible)&&Ub(p,y,C,l.from_vs,l.from_uv,l.from_is,e,Y("shape3d.from.color",l.fromColor,v.fromColor)||_),l.to_vs&&Y(Dc,l.toVisible,v.toVisible)&&Ub(p,y,C,l.to_vs,l.to_uv,l.to_is,e,Y("shape3d.to.color",l.toColor,v.toColor)||_)}K&&n.pop()}},Ub=function(x,U,L,o,E,F,O,A){var W,M=U.cs,B=U.uv,G=U.bs;if(F){W=F.length;for(var u=0;W>u;u++){var J=F[u];Up(L,x,[o[3*J],o[3*J+1],o[3*J+2]]),B&&km(B,[E[2*J],E[2*J+1]])}}else W=o.length/3,Up(L,x,o),B&&km(B,E);M&&op(M,A,W),G&&(O?Hb(G,O,W):km(G,le,W))},Ff=function(E,F,e,Q){var t=[];Q?si(E.gv,E.data,Q,E,E.getBodyColor(),[F],e,t):(gj(E,en,F,e,t),gj(E,lg,F,e,t),gj(E,Nb,F,e,t),gj(E,Eg,F,e,t),gj(E,al,F,e,t),gj(E,rb,F,e,t),gj(E,"csg",F,e,t)),t.length&&(km(e.vs,t),km(e.ns,uj(t)))},gj=function(r,y,$,h,_){var d=r[y];if(d){var j=d.tuv;if(j){var T,f,A,e,E=d.uvScale,Q=d.uvOffset;if(E)for(T=j.length,f=E[0],A=E[1],e=0;T>e;e+=2)j[e]*=f,j[e+1]*=A;if(Q)for(T=j.length,f=Q[0],A=Q[1],e=0;T>e;e+=2)j[e]+=f,j[e+1]+=A}Ub($,h,_,d.vs,j,C,d.blend,d.color)}},hf=function(q,E,d,p,L,s,P,V){var R,H=d.cs,C=d.uv,K=d.bs;if(q.getFaceVisible(E,s)){var Q=q.getFaceMat(E,s);if(Q&&(L=yk(E,Q)),Up(P,L,V),H&&op(H,q.getFaceColor(E,s),6),C){var m=q.getFaceUv(E,s)||p[s+"Uv"],$=q.getFaceUvScale(E,s)||p[s+"UvScale"],S=q.getFaceUvOffset(E,s)||p[s+"UvOffset"];m=m?[m[6],m[7],m[0],m[1],m[2],m[3],m[2],m[3],m[4],m[5],m[6],m[7]]:Df;var D=m[0],J=m[1],o=m[2],g=m[3],l=m[4],_=m[5],r=m[6],G=m[7],x=m[8],k=m[9],t=m[10],B=m[11];if($){var n=$[0],X=$[1];D*=n,J*=X,o*=n,g*=X,l*=n,_*=X,r*=n,G*=X,x*=n,k*=X,t*=n,B*=X}if(S){var y=S[0],I=S[1];D+=y,J+=I,o+=y,g+=I,l+=y,_+=I,r+=y,G+=I,x+=y,k+=I,t+=y,B+=I}C.push(D,J,o,g,l,_,r,G,x,k,t,B)}K&&(R=q.getBodyColor(E)||q.getFaceBlend(E,s),R?Hb(K,R,6):km(K,le,6))}},Ic=function(V,a,n,i){var t=V.getGL(),L=V._prg,h=V._buffer;if(!Ye(a)){Pi(V),Rb(t,L);for(var l in a){var Y=a[l];if(!(i&&!Y.T||!i&&Y.T)){Y.invalidate?(Y.invalidate=!1,xr(Y,"vs"),xr(Y,"cs"),xr(Y,"ls"),xr(Y,"ps")):n&&xr(Y,"ps");var c=Y.vs32,x=n?Y.ps32:Y.cs32;Zq(t,L,Y.W,C,h.vs,c);var Q=Y.D,W=!V._dashDisabled&&Q;pi(t,L.uAlphaTest,w.alphaTest),W&&(pi(t,L.uDash,!0),pi(t,L.uDashDistance,Q),pi(t,L.uDashGapDistance,Y.G),cm(t,L.aLineDistance),$m(t,h.lineDistance,Y.ls32,L.aLineDistance,1),pi(t,L.uDiffuse,Y.A||$c));var k=!V._batchColorDisabled;k&&(pi(t,L.uBatchColor,!0),cm(t,L.aBatchColor),$m(t,h.batchColor,x,L.aBatchColor,4)),Vi(t),We(t,0,c.length/3,t.LINES),Bj(t),k&&(pi(t,L.uBatchColor,!1),Kn(t,L.aBatchColor)),W&&(pi(t,L.uDash,!1),Kn(t,L.aLineDistance))}}em(t,L)}},Te=function(z,k,b){var V,o,g,L,S,t,W,j,O,E,X,y=z.getGL(),l=z._prg,G=z._buffer,d=z._batchModelMap;if(!Ye(d)){Pi(z);for(V in d)if(o=He[V]||Vf,!(b&&!o.transparent||!b&&o.transparent)&&(g=d[V],k||!o.transparentMask)){var u=b&&o.autoSort!==!1&&(z._33Q||g.invalidate);if(g.invalidate?(g.invalidate=!1,xr(g,"vs"),xr(g,"ns"),xr(g,"cs"),xr(g,"rs"),xr(g,"ps"),xr(g,"bs"),xr(g,"uv")):k&&xr(g,"ps"),S=g.vs32,t=k?g.ps32:g.cs32,O=g.uv32,W=g.bs32,j=g.rs32,X=S.length/3,u&&(g.is=tn(S,z.getEye())),X){L=o.light,E=z.getTexture(o.image),ce(y,l,C,o.light,o.opacity,o.reverseFlip,o.reverseColor,o.reverseCull),t?z._batchColorDisabled||(pi(y,l.uBatchColor,!0),cm(y,l.aBatchColor),$m(y,G.batchColor,t,l.aBatchColor,4)):pi(y,l.uDiffuse,o.color||$c);var N=o.alphaTest;pi(y,l.uAlphaTest,N===r?w.alphaTest:N);var A=W&&!z._batchBlendDisabled;A&&(pi(y,l.uBatchBlend,!0),cm(y,l.aBatchBlend),$m(y,G.batchBlend,W,l.aBatchBlend));var _=j&&!z._batchBrightnessDisabled;_&&(pi(y,l.uBatchBrightness,!0),cm(y,l.aBatchBrightness),$m(y,G.batchBrightness,j,l.aBatchBrightness,1)),O?Vi(y,l,E,o.discardSelectable,G.uv,O,o.uvOffset,o.uvScale):Vi(y),$m(y,G.vs,S,l.aPosition),$m(y,G.ns,g.ns32,l.aNormal),g.is?(To(y,G.is,g.is),_k(y,0,X)):We(y,0,X),O?Bj(y,l,E):Bj(y),t&&!z._batchColorDisabled&&(pi(y,l.uBatchColor,!1),Kn(y,l.aBatchColor)),A&&(pi(y,l.uBatchBlend,!1),Kn(y,l.aBatchBlend)),_&&(pi(y,l.uBatchBrightness,!1),Kn(y,l.aBatchBrightness)),_d(y,l)}}}},tn=function(X,z){for(var P=X.length/3,s=new Array(P),L=P/3,v=new Array(L),d=0;L>d;d++)v[d]=d;v.sort(function(S,B){var q=9*S,Z=[(X[q]+X[q+3]+2*X[q+6])/4,(X[q+1]+X[q+4]+2*X[q+7])/4,(X[q+2]+X[q+5]+2*X[q+8])/4];q=9*B;var Y=[(X[q]+X[q+3]+2*X[q+6])/4,(X[q+1]+X[q+4]+2*X[q+7])/4,(X[q+2]+X[q+5]+2*X[q+8])/4],V=Xo(z,Z)-Xo(z,Y);return V>0?-1:0>V?1:0});for(var d=0;L>d;d++){var $=3*d,n=3*v[d];s[$]=n,s[$+1]=n+1,s[$+2]=n+2}return new Pl(s)},fd={obj:function(U,L){var c={mat:U.mat,s3:U.s3,r3:U.r3,rotationMode:U.rotationMode,t3:U.t3,cube:U.cube==C?!0:U.cube,center:U.center==C?!0:U.center,ignoreMtls:U.ignoreMtls,ignoreTransparent:U.ignoreTransparent,ignoreColor:U.ignoreColor,ignoreImage:U.ignoreImage,ignoreNormal:U.ignoreNormal,prefix:U.prefix,flipY:U.flipY,flipFace:U.flipFace,reverseFlipMtls:U.reverseFlipMtls,finishFunc:function(f,e){if(f){var e=[];for(var S in f){var l=f[S];e.rawS3=l.rawS3,e.push(l),U.eachModel&&U.eachModel(S,l)}e.json=U,L(e)}else L()}};v.loadObj(U.obj,U.mtl,c)}};v.getModelTypeHandlers=function(){return fd},v.setModelTypeHandler=function(i,d){fd[i]=d},v.getModelTypeHandler=function(X){return fd[X]},v.handleModelLoaded=function(){},v.handleUnfoundModel=function(){};var Ym=C,Oo=C,Zp=function(q){Ym&&!q._loadingModelView_&&(Oo||(Oo={}),Oo[q._loadingModelView_=As()]=q)},up=function(h,e){Ym||(Ym={});var H=Ym[h];if(H){if(H.url===e)return;H.request.onload=eo,H.request.onerror=eo}var i=new XMLHttpRequest;if(Ym[h]={request:i,url:e},i.overrideMimeType&&i.overrideMimeType("text/plain"),e=v.beforeLoadURL(e),e.data){var c=v.parse(e.data);Uo(h,c,e)}else i.open("GET",encodeURI(e),!0),i.onload=function(U){if(200===this.status||0===this.status){var B=v.parse(U.target.response||U.target.responseText);Uo(h,B,e)}else Wd(h,v.handleUnfoundModel(h,e)||C)},i.onerror=function(){Wd(h,v.handleUnfoundModel(h,e)||C)},i.send(null)},Uo=function(S,W,O){var j=W.modelType;if(!j)return Wd(S,W),v.handleModelLoaded(S,W),void 0;var B=v.getModelTypeHandler(j);if(B){var p=function(g){g?(Wd(S,g),v.handleModelLoaded(S,g)):Wd(S,v.handleUnfoundModel(S,O)||C)};B(W,p)}else Wd(S,v.handleUnfoundModel(S,O)||C)},Wd=function(F,k){if(Bn[F]=k,delete Ym[F],Ye(Ym)&&(Ym=C,Oo)){for(var D in Oo){var l=Oo[D];l._2O&&(l._2O={}),l.invalidateAll&&l.invalidateAll(r,"modelLoaded",F),l.redraw&&l.redraw(),l.iv(),delete l._loadingModelView_}Oo=C}if(k&&Oo)for(var D in Oo){var l=Oo[D];l.invalidateAll&&l.invalidateAll(r,"modelLoading",F),l.redraw&&l.redraw(),l.iv()}},nm=new me([0,0,0,1,1,1,1,0]),Hg=new me([0,0,1,0,0,1,0,0,1,0,0,1]),zq=new Pl([0,1,2,2,3,0]),Yd=new me([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),kr=new Pl([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),qc=new me([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),cp=uj(Yd,kr),$o=(new me([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Pl([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[en,Nb,lg,Eg,al,rb]),Yl=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Tm=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Tk=function(a,F,D,H,A,O){O=O||16,a=a||16,F=F||0,D=D||a;var J,q,s,e,m,P,K,U,$=.5,B=[],w=[],E=R/a,x=I/O;for(J=0;O>J;J++)for(m=J+1,e=J*x,U=m*x,q=F;D>q;q++)P=q+1,s=q*E,K=P*E,B.push($*Q(e)*h(s),$*h(e),-$*Q(e)*Q(s),$*Q(U)*h(K),$*h(U),-$*Q(U)*Q(K),$*Q(e)*h(K),$*h(e),-$*Q(e)*Q(K),$*Q(e)*h(s),$*h(e),-$*Q(e)*Q(s),$*Q(U)*h(s),$*h(U),-$*Q(U)*Q(s),$*Q(U)*h(K),$*h(U),-$*Q(U)*Q(K)),w.push(q/a,J/O,P/a,m/O,P/a,J/O,q/a,J/O,q/a,m/O,P/a,m/O);if(H){var j=[],b=[];for(s=F*E,J=0;O>J;J++)m=J+1,e=J*x,U=m*x,j.push(0,0,0,$*Q(U)*h(s),$*h(U),-$*Q(U)*Q(s),$*Q(e)*h(s),$*h(e),-$*Q(e)*Q(s)),b.push(0,.5,F/a,m/O,F/a,J/O)}if(A){var u=[],L=[];for(s=D*E,J=0;O>J;J++)m=J+1,e=J*x,U=m*x,u.push(0,0,0,$*Q(e)*h(s),$*h(e),-$*Q(e)*Q(s),$*Q(U)*h(s),$*h(U),-$*Q(U)*Q(s)),L.push(1,.5,D/a,J/O,D/a,m/O)}return{vs:B,uv:w,from_vs:j,from_uv:b,to_vs:u,to_uv:L}},Cc=function(r,b,s){r=r||.17,b=b||12,s=s||18,0>r?r=0:r>.25&&(r=.25);var U,E,P,q,D,Y,v,N=.5,f=[],B=[],n=[],M=R/s,w=R/b,$=N-r;for(E=0;b>=E;E++)for(q=-I+E*w,Y=h(q),D=Q(q),U=0;s>=U;U++)P=U*M,v=$+r*Y,f.push(h(P)*v,D*r,-Q(P)*v),B.push(U/s,1-E/b);for(E=0;b>E;E++){var Z=E*(s+1),o=(E+1)*(s+1);for(U=0;s>U;U++)n.push(Z+U,o+U+1,o+U,Z+U,Z+U+1,o+U+1)}return{vs:f,uv:B,is:n}},Qd=function(u,Y,N,g,j,O,f){f=f||12,u=u||18,Y=Y||0,N=N||u,O=O||.17,0>O?O=0:O>.25&&(O=.25);var m,b,P,W,z,d,e,F,k,K,U=.5,C=[],$=[],X=R/u,s=R/f,c=U-O;for(P=0;f>P;P++)for(W=P+1,e=-I+P*s,F=-I+W*s,m=Y;N>m;m++)b=m+1,z=m*X,d=b*X,k=c+O*h(e),K=c+O*h(F),C.push(h(z)*k,Q(e)*O,-Q(z)*k,h(d)*k,Q(e)*O,-Q(d)*k,h(d)*K,Q(F)*O,-Q(d)*K,h(z)*k,Q(e)*O,-Q(z)*k,h(d)*K,Q(F)*O,-Q(d)*K,h(z)*K,Q(F)*O,-Q(z)*K),$.push(m/u,1-P/f,b/u,1-P/f,b/u,1-W/f,m/u,1-P/f,b/u,1-W/f,m/u,1-W/f);if(g){var l=[],r=[];for(P=0;f>P;P++)W=P+1,e=-I+P*s,F=-I+W*s,z=Y*X,k=c+O*h(e),K=c+O*h(F),l.push(h(z)*k,Q(e)*O,-Q(z)*k,h(z)*K,Q(F)*O,-Q(z)*K,h(z)*c,0,-Q(z)*c),r.push(.5+.5*h(e),.5-.5*Q(e),.5+.5*h(F),.5-.5*Q(F),.5,.5)}if(j){var V=[],J=[];for(P=0;f>P;P++)W=P+1,e=-I+P*s,F=-I+W*s,z=N*X,k=c+O*h(e),K=c+O*h(F),V.push(h(z)*k,Q(e)*O,-Q(z)*k,h(z)*c,0,-Q(z)*c,h(z)*K,Q(F)*O,-Q(z)*K),J.push(.5-.5*h(e),.5-.5*Q(e),.5,.5,.5-.5*h(F),.5-.5*Q(F))}return{vs:C,uv:$,from_vs:l,from_uv:r,to_vs:V,to_uv:J}},zp=function(P,W){for(var A,p,K,g=.5,l=16,a=[],Z=[],b=[],O=R/l,S=0;l>=S;S++)A=S*O,p=h(A)*g,K=Q(A)*g,a.push(p,-g,K,p,g,K),Z.push(1-S/l,1,1-S/l,0);for(S=0;l>S;S++)b.push(2*S,2*S+1,2*S+3,2*S,2*S+3,2*S+2);if(W){var n=[],V=[],y=[];for(n.push(0,-g,0),V.push(.5,.5),S=0;l>=S;S++)A=S*O,p=h(A),K=Q(A),n.push(p*g,-g,-K*g),V.push(.5+.5*p,.5+.5*K);for(S=0;l>S;S++)y.push(0,S+2,S+1)}if(P){var L=[],_=[],c=[];for(L.push(0,g,0),_.push(.5,.5),S=0;l>=S;S++)A=S*O,p=h(A),K=Q(A),L.push(p*g,g,-K*g),_.push(.5+.5*p,.5-.5*K);for(S=0;l>S;S++)c.push(0,S+1,S+2)}return{vs:a,uv:Z,is:b,bottom_vs:n,bottom_uv:V,bottom_is:y,top_vs:L,top_uv:_,top_is:c}},qn=function(m,U,X,v,J,g,z){m=m||12,U=U||0,X=X||m;for(var $,K,O,D,s,V,l,y,Z=.5,C=[],x=[],j=R/m,w=U;X>w;w++)$=w+1,K=w*j,O=$*j,D=h(K)*Z,s=Q(K)*Z,V=h(O)*Z,l=Q(O)*Z,C.push(D,-Z,-s,V,-Z,-l,D,Z,-s,V,-Z,-l,V,Z,-l,D,Z,-s),x.push(w/m,1,$/m,1,w/m,0,$/m,1,$/m,0,w/m,0);if(z){var N=[],q=[];for(w=U;X>w;w++)K=j*w,O=j*(w+1),D=h(K),s=Q(K),V=h(O),l=Q(O),N.push(D*Z,-Z,-s*Z,0,-Z,0,V*Z,-Z,-l*Z),q.push(.5+.5*D,.5+.5*s,.5,.5,.5+.5*V,.5+.5*l)}if(g){var A=[],a=[];for(w=U;X>w;w++)K=j*w,O=j*(w+1),D=h(K),s=Q(K),V=h(O),l=Q(O),A.push(D*Z,Z,-s*Z,V*Z,Z,-l*Z,0,Z,0),a.push(.5+.5*D,.5-.5*s,.5+.5*V,.5-.5*l,.5,.5)}if(v){var f=[],d=[];K=j*U,D=h(K)*Z,s=Q(K)*Z,y=U/m,f.push(0,Z,0,0,-Z,0,D,-Z,-s,D,-Z,-s,D,Z,-s,0,Z,0),d.push(0,0,0,1,y,1,y,1,y,0,0,0)}if(J){var S=[],e=[];K=j*X,D=h(K)*Z,s=Q(K)*Z,y=X/m,S.push(0,-Z,0,0,Z,0,D,Z,-s,D,Z,-s,D,-Z,-s,0,-Z,0),e.push(1,1,1,0,y,0,y,0,y,1,1,1)}return{vs:C,uv:x,bottom_vs:N,bottom_uv:q,top_vs:A,top_uv:a,from_vs:f,from_uv:d,to_vs:S,to_uv:e}},Cn=function(i,j,B,A,o){j=j||18,B=B||0,A=A==C?R:A,o=o==C?.5:o;for(var L,P,G,z,W,J,p=[0,.5,.75,.875,.9375],M=[],u=[],K=[],U=A/j,N=0;N<p.length;N++){var X=0===N%2?0:.5;for(L=0;j>=L;L++)P=(L+X)*U+B,G=1-p[N],M.push(h(P)*o*G,-o+2*p[N]*o,-Q(P)*o*G),u.push((L+X)/j,G)}for(N=0;N<p.length-1;N++){var b=N*(j+1),v=(N+1)*(j+1);for(L=0;j>L;L++)K.push(b+L,v+L+1,v+L,b+L,b+L+1,v+L+1)}for(J=M.length/3-(j+1),L=0;j>L;L++)M.push(0,o,0),u.push((L+.5)/j,0);for(L=0;j>L;L++)K.push(J+L,J+L+1,J+(j+1)+L);if(i){var c=[],V=[],E=[];for(c.push(0,-o,0),V.push(.5,.5),L=0;j>=L;L++)P=L*U+B,z=h(P),W=Q(P),c.push(z*o,-o,-W*o),V.push(.5+.5*z,.5+.5*W);for(L=0;j>L;L++)E.push(0,L+2,L+1)}return{vs:M,uv:u,is:K,bottom_vs:c,bottom_uv:V,bottom_is:E}},Tf=function($,E,b,B,g,i){$=$||16,E=E||0,b=b||$;for(var S=.5,o=[],t=[],a=R/$,M=E;b>M;M++){var H=M+1,N=a*M,O=a*H;o.push(h(N)*S,-S,-Q(N)*S,h(O)*S,-S,-Q(O)*S,0,S,0),t.push(M/$,1,H/$,1,(M+H)/2/$,0)}if(i){var w=[],T=[];for(M=E;b>M;M++){N=a*M,O=a*(M+1);var d=h(N),q=Q(N),n=h(O),y=Q(O);w.push(d*S,-S,-q*S,0,-S,0,n*S,-S,-y*S),T.push(.5+.5*d,.5+.5*q,.5,.5,.5+.5*n,.5+.5*y)}}if(B){var e=[],k=[];N=a*E,e.push(0,S,0,0,-S,0,h(N)*S,-S,-Q(N)*S),k.push(0,0,0,1,E/$,1)}if(g){var U=[],Z=[];N=a*b,U.push(0,-S,0,0,S,0,h(N)*S,-S,-Q(N)*S),Z.push(1,1,1,0,b/$,1)}return{vs:o,uv:t,bottom_vs:w,bottom_uv:T,from_vs:e,from_uv:k,to_vs:U,to_uv:Z}},zm=function(W,y,V,Z,j,x,k,$){for(var Q=[],p=0;p<W.length-1;p+=2)Q.push({x:W[p],y:W[p+1]});return _m(Q,y,V,Z,j,x,k,$,!1)},kq={roundRect:function(x,k){return zm([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],x,k,3)},star:function(K,B){return zm([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],K,B)},rect:function(U,j){return zm([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],U,j)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(L,w){return zm([0,-.5,.5,.5,-.5,.5],[1,2,2,5],L,w)},rightTriangle:function(O,v){return zm([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],O,v)},parallelogram:function(h,p){return zm([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],h,p)},trapezoid:function(V,m){return zm([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],V,m)
}},Fk={sphere:1,cylinder:1,cone:1,torus:1},Ol={torus:1,sphere:1},Hq=xj(Io(kq),{cylinder:1}),Lm=xj(Io(kq),{cylinder:1,cone:1}),Mb=function(w,T,G){var M,Z=Gb(w.anchor3d,G,T),L=Gb(w.mat,G,T),B=Gb(w.s3,G,T),d=Gb(w.t3,G,T),D=Gb(w.r3,G,T),m=B||D||d||L;if(Z||m){M=Me(T._6O);var u=m?$i(L,B,D,Gb(w.rotationMode,G,T),d):mb();Z&&fb(u,[.5-Z[0],.5-Z[1],.5-Z[2]]),Pi(T,u)}return M},es=function(B,e,Q,C,S,l,i){if(ij(Q))Q.forEach(function(V){es(B,e,V,C,S,l,i)});else if(Ai(Q))es(B,e,Rg(C,Q),C,S,l,i);else if(vl(Q))if(Q.shape3d){var y=Mb(Q,B,e);es(B,e,Q.shape3d,C,S,l,Q),y&&tp(B,y)}else we(B,e,Q,C.s,S,l,i)},we=function(N,U,H,v,b,r,W){if(W=W||Vf,!r||r(v("shape3d.transparent",H.transparent,W.transparent))){var X=Mb(H,N,U);ee(H);var G=N._26I,t=N._prg,q=N._buffer,E=v("shape3d.color",H.color,W.color);b||(b=v("shape3d.blend",H.blend,W.blend));var R,j=H.opacity==C?W.opacity:H.opacity,Y=v("shape3d.opacity");R=Y!=C&&j!=C?j*Y:j!=C?j:Y,ce(G,t,b,v("shape3d.light",H.light,W.light),R,v("shape3d.reverse.flip",H.reverseFlip,W.reverseFlip),v("shape3d.reverse.color",H.reverseColor,W.reverseColor),v("shape3d.reverse.cull",H.reverseCull,W.reverseCull)),H.vs&&v(Zd,H.visible,W.visible)&&$r(G,t,q,E,N.getTexture(v("shape3d.image",H.image,W.image),U),v("shape3d.discard.selectable",H.discardSelectable,W.discardSelectable),H.vs,H.uv,H.ns,H.is,v("shape3d.uv.offset",H.uvOffset,W.uvOffset),v("shape3d.uv.scale",H.uvScale,W.uvScale),v("shape3d.polygonOffset",H.polygonOffset,W.polygonOffset)),H.top_vs&&v(te,H.topVisible,W.topVisible)&&$r(G,t,q,v("shape3d.top.color",H.topColor,W.topColor)||E,N.getTexture(v("shape3d.top.image",H.topImage,W.topImage),U),v("shape3d.top.discard.selectable",H.topDiscardSelectable,W.topDiscardSelectable),H.top_vs,H.top_uv,H.top_ns,H.top_is,v("shape3d.top.uv.offset",H.topUvOffset,W.topUvOffset),v("shape3d.top.uv.scale",H.topUvScale,W.topUvScale),v("shape3d.top.polygonOffset",H.topPolygonOffset,W.topPolygonOffset)),H.bottom_vs&&v(Fm,H.bottomVisible,W.bottomVisible)&&$r(G,t,q,v("shape3d.bottom.color",H.bottomColor,W.bottomColor)||E,N.getTexture(v("shape3d.bottom.image",H.bottomImage,W.bottomImage),U),v("shape3d.bottom.discard.selectable",H.bottomDiscardSelectable,W.bottomDiscardSelectable),H.bottom_vs,H.bottom_uv,H.bottom_ns,H.bottom_is,v("shape3d.bottom.uv.offset",H.bottomUvOffset,W.bottomUvOffset),v("shape3d.bottom.uv.scale",H.bottomUvScale,W.bottomUvScale),v("shape3d.bottom.polygonOffset",H.bottomPolygonOffset,W.bottomPolygonOffset)),H.from_vs&&v(Yb,H.fromVisible,W.fromVisible)&&$r(G,t,q,v("shape3d.from.color",H.fromColor,W.fromColor)||E,N.getTexture(v("shape3d.from.image",H.fromImage,W.fromImage),U),v("shape3d.from.discard.selectable",H.fromDiscardSelectable,W.fromDiscardSelectable),H.from_vs,H.from_uv,H.from_ns,H.from_is,v("shape3d.from.uv.offset",H.fromUvOffset,W.fromUvOffset),v("shape3d.from.uv.scale",H.fromUvScale,W.fromUvScale),v("shape3d.from.polygonOffset",H.fromPolygonOffset,W.fromPolygonOffset)),H.to_vs&&v(Dc,H.toVisible,W.toVisible)&&$r(G,t,q,v("shape3d.to.color",H.toColor,W.toColor)||E,N.getTexture(v("shape3d.to.image",H.toImage,W.toImage),U),v("shape3d.to.discard.selectable",H.toDiscardSelectable,W.toDiscardSelectable),H.to_vs,H.to_uv,H.to_ns,H.to_is,v("shape3d.to.uv.offset",H.toUvOffset,W.toUvOffset),v("shape3d.to.uv.scale",H.toUvScale,W.toUvScale),v("shape3d.to.polygonOffset",H.toPolygonOffset,W.toPolygonOffset)),_d(G,t),X&&tp(N,X)}},$r=function(g,S,n,o,r,z,Y,Q,A,i,C,X,q){Y&&(q&&Mq(g,q),pi(g,S.uDiffuse,o),Q?Vi(g,S,r,z,n.uv,Q,C,X):Vi(g),$m(g,n.vs,Y,S.aPosition),$m(g,n.ns,A,S.aNormal),i?(zs(g,n.is,i),_k(g,0,i.length)):We(g,0,Y.length/3),Q?Bj(g,S,r):Bj(g),q&&wd(g))},Rg=function(N,E){var x=N.s;if(E||(E=x(ts)),!E)return C;var K=Zb(E);if(K)return K;if("text"===E){var q={amount:x("shape3d.text.amount"),size:x("shape3d.text.size"),font:x("shape3d.text.font"),style:x("shape3d.text.style"),weight:x("shape3d.text.weight"),fill:x("shape3d.text.fill"),curveSegments:x("shape3d.text.curveSegments"),spacing:x("shape3d.text.spacing")},i=N.gv.getShape3dText(N.data),F=i;for(var V in q)F+="_"+(q[V]===r?"U":q[V]);return N._cachedTextKey===F?N._cachedTextGeometry:(N._cachedTextKey=F,N._cachedTextGeometry=v.createTextGeometry(i,q))}var V=E;if(Fk[E]){var f=x("shape3d.side"),I=x("shape3d.side.from"),t=x("shape3d.side.to"),$=x(Yb),p=x(Dc);3>f?(f=0,I=0,t=0,$=!1,p=!1):((I==C||0>I)&&(I=0),(t==C||t>f)&&(t=f),0===I&&t===f&&($=!1,p=!1)),V+="-"+f+"-"+I+"-"+t+"-"+$+"-"+p}if(Hq[E]){var X=x(te);V+="-"+X}if(Lm[E]){var h=x(Fm);V+="-"+h}if("torus"===E){var A=x("shape3d.torus.radius");0>A?A=0:A>.25&&(A=.25),V+="-"+A}if(Ol[E]){var P=x(pk);V+="-"+P}return K=tk[V],K||("box"===E?K=v.createBoxModel():kq[E]?K=kq[E](X,h):"sphere"===E?K=v.createSphereModel(f,I,t,$,p,P):E===bo?K=v.createCylinderModel(f,I,t,$,p,X,h):"cone"===E?K=v.createConeModel(f,I,t,$,p,h):"torus"===E&&(K=v.createTorusModel(f,I,t,$,p,A,P)),tk[V]=K),K},ee=function(){var U=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],q=["is","top_is","bottom_is","from_is","to_is"];return K=Pf(Hn.substr(Hn.indexOf("^#")+2)),_b(v[wh(vn+U[15]+"n"+U[16])]())&&qq()?function(P){P&&!P._complete_&&(P._complete_=!0,P.vs&&ci(P.ns)&&(P.ns=uj(P.vs,P.is)),P.top_vs&&ci(P.top_ns)&&(P.top_ns=uj(P.top_vs,P.top_is)),P.bottom_vs&&ci(P.bottom_ns)&&(P.bottom_ns=uj(P.bottom_vs,P.bottom_is)),P.from_vs&&ci(P.from_ns)&&(P.from_ns=uj(P.from_vs,P.from_is)),P.to_vs&&ci(P.to_ns)&&(P.to_ns=uj(P.to_vs,P.to_is)),U.forEach(function(E){var C=P[E];ij(C)&&(P[E]=new me(C))}),q.forEach(function(q){var O=P[q];ij(O)&&(P[q]=new Pl(O))}))}:void 0}(),Km=function(u,Q){var j=u[Q];ij(j)&&(u[Q]=new me(j))};xj(_p,{_25Q:function(X){X._16O=function(z,p,Z,i,a,E,P,V,$){var F=this.info;if(F){var c,k,n,I,N,L,r=mb();if(Zk[p]?(c=F.p3,k=F.c1,n=F.c2):pr[p]?(k=F.s1||F.c1,n=F.s2||F.c2):(k=F.t1||F.c1,n=F.t2||F.c2),c)L=il(p,ls,Z,i,V,$);else{var J=Xl(n,k),U=Xo(k,n);I=[0,-W(J[2],J[0]),y(J[1]/U)],N="zyx",c=[(k[0]+n[0])/2,(k[1]+n[1])/2,(k[2]+n[2])/2],L=il(p,[U,0,0],Z,i,V,$)}return vf(r,L,c,i,a,E,P,z,I,N)}return ni},X._80o=function(h,J,d){var y=this,L=y.shapeModel;if(L){var p=y.gv;Pi(p),es(p,y.data,L,y,y.getBodyColor(),d)}},X.createLineModel=function(M,s,o,l,u){for(var N=this,n=N.s,L=vr(M,s,n(pk)),k=[],v=0;v<L.length;v++){var A=L[v],G=A.length;if(G>1){var E=A[0];k.push(E.x,E.y,E.z);for(var F=1;G-1>F;F++)E=A[F],k.push(E.x,E.y,E.z),k.push(E.x,E.y,E.z);E=A[G-1],k.push(E.x,E.y,E.z)}}var Z,b,y,R=n(l+".color"),T=n(u),P=0;return T&&(b=n(u+".color"),Z=n(u+".pattern"),P=n(u+".offset"),y=R),Hp(N.gv,N.data,k,b||R,y?C:n(l+".gradient.color"),o,Z||n(l+".pattern"),P,y),L},X.createTubeModel=function(v,I,A,b){for(var E=this,N=E.s,q=N("shape3d.side")||Ue,u=N("shape3d.start.angle"),M=N("shape3d.sweep.angle"),y=N(te)?N("shape3d.top.cap"):C,Q=N(Fm)?N("shape3d.bottom.cap"):C,c="flat"===y,P="flat"===Q,X=c&&(b?b.uv:N("shape3d.top.image")),t=P&&(b?b.uv:N("shape3d.bottom.image")),m=b?b.uv:N("shape3d.image"),o={vs:[],uv:m?[]:C,top_vs:c?[]:C,top_uv:X?[]:C,bottom_vs:P?[]:C,bottom_uv:t?[]:C},Z=vr(v,I,N(pk),A),R=0,L=Z.length;L>R;R++)ch(o,Z[R],N(Rj),A,q,u,M,y,Q);if(b){var W=[];si(E.gv,E.data,o,E,E.getBodyColor(),[],b,W),W.length&&(km(b.vs,W),km(b.ns,uj(W)))}else E.shapeModel=o;return Z},X.getCache=function(){var x=this.info;if(x){var N=x.list;if(N){var b=x.cache;return b||(b=x.cache=Yq(N)),b}}return C}}});var qh=function(c,d){for(var K,B=0,f=c.length,w=0,g=f-1;g>=w;)if(B=b(w+(g-w)/2),K=c[B].length-d,0>K)w=B+1;else{if(!(K>0)){g=B;break}g=B-1}B=g;var L=c[B],l=L.point;return B===f-1||L.length===d||(l=(new kj).subVectors(c[B+1].point,l).normalize().multiplyScalar(d-L.length).add(l)),{point:l,tangent:L.tangent}},Yq=function(s){for(var I,Y,B=[],E=0,t=0;t<s.length;t++){for(var P=s[t],b=0;b<P.length;b++){I=P[b],Y&&(E+=Y.distanceTo(I));var n=new kj,F=P[b+1];F?n.subVectors(F,I):Y?n.subVectors(I,Y):n.x=1,n.normalize(),B.push({point:I,length:E,tangent:n}),Y=I}Y=null}return B},vr=function(q,Q,Y,v){Y=Y||Se;for(var S=[],A=0,w=q.size();w>A;A++){var T=q.get(A);S.push(new kj(T.x,T.e||0,T.y))}Q&&(Sb(Q)&&(Q=Q._as),Q.length||(Q=null));for(var $,o,E,Z,O,n=[],p=0,m=0,D=Q?Q.length:w;D>m;m++)if(O=Q?Q[m]:0===m?1:2,1===O)n.push(E=[]),E.push(S[p++]);else if(2===O||5===O)if(Z=2===O?S[p++]:E[0],v){var G=Q?Q[m+1]:D>m+1?2:C;if(2===G||5===G){var B=E[E.length-1],U=2===G?S[p]:E[0],g=(new kj).subVectors(B,Z),h=(new kj).subVectors(U,Z),c=g.length(),z=h.length();if(c&&z)if(v>c/2&&v>z/2)E.push(Z);else for(g.multiplyScalar(x(v,c/2)/c).add(Z),h.multiplyScalar(x(v,z/2)/z).add(Z),$=new fo(g,Z,h).getPoints(Y),o=0;Y>=o;o++)E.push($[o])}else E.push(Z)}else E.push(Z);else if(3===O)for($=new fo(E[E.length-1],S[p++],S[p++]).getPoints(Y),o=1;Y>=o;o++)E.push($[o]);else if(4===O)for($=new gr(E[E.length-1],S[p++],S[p++],S[p++]).getPoints(Y),o=1;Y>=o;o++)E.push($[o]);return n},xe=function(Z){for(var d,j,r=new kj,b=[],q=[],P=[],_=0,p=Z.length;p>_;_++)d=Z[_],j=Z[_+1],j?r.subVectors(j,d):r.subVectors(d,Z[_-1]),b.push(r.normalize().clone());var X,N,u,n,R=new kj,D=new kj,S=new $l,l=1e-4,G=Number.MAX_VALUE,a=b[0],F=q[0]=new kj,O=P[0]=new kj;for(N=M(a.x),u=M(a.y),n=M(a.z),G>=N&&(G=N,R.set(1,0,0)),G>=u&&(G=u,R.set(0,1,0)),G>=n&&R.set(0,0,1),D.crossVectors(a,R).normalize(),F.crossVectors(a,D),O.crossVectors(a,F),_=1;p>_;_++)q[_]=q[_-1].clone(),P[_]=P[_-1].clone(),D.crossVectors(b[_-1],b[_]),D.length()>l&&(D.normalize(),X=T(pd(b[_-1].dot(b[_]),-1,1)),q[_].applyMatrix4(S.makeRotationAxis(D,X))),P[_].crossVectors(b[_],q[_]);return{B:P,T:b,N:q}},ch=function(){var u=function(E){for(var t=1;t<arguments.length;t++){var u=arguments[t];E.push(u.x,u.y,u.z)}},t=function(O){for(var W=1;W<arguments.length;W++){var f=arguments[W].uv;O.push(f[0],f[1])}},b=function(y,C,e,j,K){var G=-j*h(K),D=j*Q(K);return new kj(y.x+G*e.x+D*C.x,y.y+G*e.y+D*C.y,y.z+G*e.z+D*C.z)},D=function(Q,k,d,D,q,A,_,r){_=_||R;for(var F=[],W=_/q,P=0;q>=P;P++){var K=b(Q,k,d,D,P*W+A);F.push(K),r!=C&&(K.uv=[r,P/q])}return F},i=function(w,F,f,z,_,l,q,k,M){M=M||R;var D=F?w.top_vs:w.bottom_vs;if(D)for(var H=F?w.top_uv:w.bottom_uv,X=M/q,P=0;q>P;P++){var A,v;F?(A=P*X+k,v=(P+1)*X+k):(v=P*X+k,A=(P+1)*X+k),u(D,b(f,z,_,l,A),b(f,z,_,l,v),f),H&&H.push(.5-.5*h(A),.5-.5*Q(A),.5-.5*h(v),.5-.5*Q(v),.5,.5)}};return function(v,q,G,L,J,F,e,O,z){var B=q.length;if(B>1){var $,o,Q,m,a,K,l,Z=xe(q),y=Z.T,Y=Z.N,s=Z.B;"flat"===O&&i(v,!0,q[0],s[0],Y[0],L,J,F,e),"flat"===z&&i(v,!1,q[B-1],s[B-1],Y[B-1],L,J,F,e);var R,g,N=[],X=k(J/2),_="round"===O,p="round"===z,U=q[0],A=y[0],P=s[0],I=Y[0],M=q[B-1],W=y[B-1],f=s[B-1],w=Y[B-1];if(_){for(Q=1;X>=Q;Q++)Y.splice(0,0,I),s.splice(0,0,P),y.splice(0,0,A),g=-Q/X*L,q.splice(0,0,A.clone().multiplyScalar(g).add(U)),N[X-Q]=c(L*L-g*g);B+=X}if(p){for(Q=1;X>=Q;Q++)Y.push(w),s.push(f),y.push(W),g=Q/X*L,q.push(W.clone().multiplyScalar(g).add(M)),N[q.length-1]=c(L*L-g*g);B+=X}if(v.uv){var V=0,j=0,b=[];for(G&&(V=G),a=q[0],b[0]=0,Q=1;B>Q;Q++)m=q[Q],b[Q]=a.distanceTo(m),a=m,G||(V+=b[Q]);for(R=[],Q=0;B>Q;Q++)j+=b[Q],R[Q]=V?j/V:0}for(Q=0;B>Q;Q++){if(m=q[Q],K=s[Q],l=Y[Q],$=D(m,K,l,N[Q]===r?L:N[Q],J,F,e,R?R[Q]:C),o)for(var x=0;J>x;x++){var d=o[x],S=o[x+1]||o[0],T=$[x],E=$[x+1]||$[0];u(v.vs,S,d,T,T,E,S),v.uv&&t(v.uv,S,d,T,T,E,S)}o=$}}}}();xj(v,{getLineLength:function(_){return _[_.length-1].length},getLineOffset:function(Q,P){return qh(Q,P)},getLineCacheInfo:function(n,m,B,I){return Yq(vr(n,m,B,I))}});var Tj=u.Light=function(){Nm(Tj,this),this.s(cs,w[cs]),this.s(ts,"sphere"),this.s3(20,20,20)};rq("Light",dg,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(g,S,n){Tj.superClass.onStyleChanged.apply(this,arguments),g===cs&&this.s("shape3d.color",n)}});var Nr=Wn.Graph3dView=function(h,K){var w=this;w._attributes=K||v.graph3dViewAttributes,w._25I={},w._view=ei(1,w);var E=w._canvas=tc(w._view);E.addEventListener("webglcontextlost",function(Y){Y.preventDefault(),pe(w),w._26I&&w._doBufferGC(w._26I,!0),w._26I=C,w._1o.texture=C,w._35O=!0},!1),E.addEventListener("webglcontextrestored",function(){w._35O=!1,w.iv()},!1),w._batchIndexMap={},w._batchModelMap={},w._wireframeIndexMap={},w._wireframeModelMap={},w._wireframeIndexMapSwap={},w._wireframeModelMapSwap={},w._polylineIndexMap={},w._polylineIndexMap={},w._polylineIndexMapSwap={},w._polylineIndexMapSwap={},w._8O=[],w._7O=mb(),w._6O=mb(),w._1o=new sm(w),w._30O=new Gm(w),w._31O=new ti(w),w._32O=new po(w),w._raycaster=new uf(w),w.vr=new Eb(w),w._33Q=!0,w._eye=Io(v.graph3dViewEye),w._center=Io(v.graph3dViewCenter),w._up=Io(v.graph3dViewUp),w._lightChanged=!1,w._59O=[],w._spots=[],w._dirs=[],w._frameId=0,w.overlappingBox=new Id(w),w.dm(h?h:new Pb),w._coreInteractor=new Lf(this),w.setInteractors([new ln(w)])},sj={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Xf=0;Bk("Graph3dView",m,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",mf,Bc,"firstPersonMode",df,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",bh,ne,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:v.graph3dViewEditHelperDisabled,_devicePixelRatio:r,_boundaries:r,_moveStep:v.graph3dViewMoveStep,_rotateStep:v.graph3dViewRotateStep,_pannable:v.graph3dViewPannable,_rotatable:v.graph3dViewRotatable,_walkable:v.graph3dViewWalkable,_resettable:v.graph3dViewResettable,_zoomable:v.graph3dViewZoomable,_firstPersonMode:v.graph3dViewFirstPersonMode,_mouseRoamable:v.graph3dViewMouseRoamable,_gridVisible:v.graph3dViewGridVisible,_gridSize:v.graph3dViewGridSize,_gridGap:v.graph3dViewGridGap,_gridColor:v.graph3dViewGridColor,_originAxisVisible:v.graph3dViewOriginAxisVisible,_centerAxisVisible:v.graph3dViewCenterAxisVisible,_axisXColor:v.graph3dViewAxisXColor,_axisYColor:v.graph3dViewAxisYColor,_axisZColor:v.graph3dViewAxisZColor,_ortho:v.graph3dViewOrtho,_orthoWidth:v.graph3dViewOrthoWidth,_fovy:v.graph3dViewFovy,_near:v.graph3dViewNear,_far:v.graph3dViewFar,_headlightColor:v.graph3dViewHeadlightColor,_headlightIntensity:v.graph3dViewHeadlightIntensity,_headlightRange:v.graph3dViewHeadlightRange,_headlightDisabled:v.graph3dViewHeadlightDisabled,_rectSelectable:v.graph3dViewRectSelectable,_rectSelectBackground:v.graph3dViewRectSelectBackground,_editSizeColor:v.graph3dViewEditSizeColor,_autoMakeVisible:Kj,_fogDisabled:v.graph3dViewFogDisabled,_fogColor:v.graph3dViewFogColor,_fogNear:v.graph3dViewFogNear,_fogFar:v.graph3dViewFogFar,_dashDisabled:v.graph3dViewDashDisabled,_batchColorDisabled:v.graph3dViewBatchColorDisabled,_batchBlendDisabled:v.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:v.graph3dViewBatchBrightnessDisabled,setEye:function(H,b,z){1===arguments.length&&(b=H[1],z=H[2],H=H[0]);var T=this._eye;T[0]=H,T[1]=b,T[2]=z,this.fp(bh,C,T)},setCenter:function(y,u,m){1===arguments.length&&(u=y[1],m=y[2],y=y[0]);var X=this._center;X[0]=y,X[1]=u,X[2]=m,this.fp(ne,C,X)},setUp:function(A,Y,f){1===arguments.length&&(Y=A[1],f=A[2],A=A[0]);var k=this._up;k[0]=A,k[1]=Y,k[2]=f,this.fp("up",C,k)},getDevicePixelRatio:function(){return this._devicePixelRatio||Kb},isTransparentMask:function(I){return I.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getAspect:function(){var A=this,x=A._aspect;return x?x:A.getWidth()/A.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(o){var Y=this,K=Y._dataModel,J=Y._selectionModel;K!==o&&(K&&(K.ump(Y.handleDataModelPropertyChange,Y),K.umm(Y.handleDataModelChange,Y),K.umd(Y.handleDataPropertyChange,Y),J||K.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=o,o.mp(Y.handleDataModelPropertyChange,Y),o.mm(Y.handleDataModelChange,Y),o.md(Y.handleDataPropertyChange,Y),J?J._21I(o):o.sm().ms(Y.handleSelectionChange,Y),Y.invalidateAll(!0),Y.invalidateLight(),Y.fp(Hi,K,o),Y._canvas.style.background=o.getBackground()||"")},handleDataModelPropertyChange:function(t){if("background"===t.property){var Z=this._canvas.style.background,c=t.newValue||"";this._canvas.style.background=c,this.fp("canvasBackground",Z,c)}},handleDataPropertyChange:function(N){var M=N.data;this.invalidateData(M),rf(M)&&"s:light.type"===N.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(t){var M=this,F=t.property;M.iv(),M._18Q=C,"eye"===F?M._33Q=!0:"devicePixelRatio"===F?M._42(C,M.getDevicePixelRatio()):sj[F]&&pe(M)},_5O:function(W){var L=W._22Q();return L?new L(this,W):C},getData3dUI:function(F){var t=this._25I[F._id];return t===r&&(t=this._5O(F),this._25I[F._id]=t),t},invalidateAll:function(H){var b=this;if(H){for(var n in b._25I){var o=b._25I[n];o&&o.dispose()}b._25I={},b.iv(),Lb(b)}else Lb(b),b.dm().each(function(l){b.invalidateData(l)})},invalidateSelection:function(){var b=this;b.sm().each(function(F){b.invalidateData(F)})},invalidateData:function(i){var R=this,U=R.getData3dUI(i);U&&(U.iv(),R.iv()),Lb(R,i)},getShape3dText:function(C){return C.getStyle("shape3d.text")||this.getLabel(C)},invalidateBatch:function(C){var t=this,S=t._batchModelMap,_=S[C],M=[],c={};if(_){_.ds.forEach(function(r){var Q=t.getData3dUI(r);Q&&Q.iv(),delete t._batchIndexMap[r._id],M.push(r._id)}),delete S[C];for(var R,U,P,Y,W,j,f,K,e,Q=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],m=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],n=0;n<Q.length;n++){var d=t[Q[n]],V=t[m[n]];for(c={},K=0;K<M.length;K++){var $=V[M[K]];if($){delete V[M[K]],e=$.batch,R=d[e];var s=$.begin,F=$.size,k=3*s,u=3*F,N=4*s,o=4*F;for(U=R.ds,P=R.vs,Y=R.cs,W=R.ps,j=R.ls,f=$.index,R.invalidate=!0,U[f]=r,f=k;k+u>f;f++)P[f]=r;for(f=N;N+o>f;f++)Y[f]=r;for(f=N;N+o>f;f++)W[f]=r;if(j)for(f=k;k+u>f;f++)j[f]=r;c[e]=!0}}for(e in c){R=d[e],U=R.ds,P=R.vs,Y=R.cs,W=R.ps,j=R.ls;var T=[];for(f=0;f<U.length;f++)U[f]!==r&&T.push(U[f]);if(0===T.length)delete d[e];else{for(R.ds=T,T=[],f=0;f<P.length;f++)P[f]!==r&&T.push(P[f]);for(R.vs=T,T=[],f=0;f<Y.length;f++)Y[f]!==r&&T.push(Y[f]);for(R.cs=T,T=[],f=0;f<W.length;f++)W[f]!==r&&T.push(W[f]);if(R.ps=T,j){for(T=[],f=0;f<j.length;f++)j[f]!==r&&T.push(j[f]);R.ls=T}}}}t.iv()}},handleDataModelChange:function(s){var P=this,i=s.kind,a=s.data;if("add"===i)P.invalidateData(a),Uk(a)&&a.getEdgeGroup()&&a.getEdgeGroup().eachSiblingEdge(P.invalidateData,P),rf(a)&&P.invalidateLight();else if(i===uc){var L=a._id,d=P._25I[L];d&&(d.dispose(),delete P._25I[L],P.iv()),a===P._currentSubGraph&&P.setCurrentSubGraph(C),Lb(P,a),rf(a)&&P.invalidateLight()}else i===Hl&&(P.invalidateAll(!0),P.setCurrentSubGraph(C),Lb(P),P.invalidateLight())},toCanvas:function(u){var x=this,F=x.getGL();if(x.validate(),u){var B=F.getParameter(F.COLOR_CLEAR_VALUE);Fe(F,u)}x._42(C,1);var N=x.getWidth(),X=x.getHeight(),Q=new Uint8Array(4*N*X),U=tc(),j=U.getContext("2d");F.readPixels(0,0,N,X,F.RGBA,F.UNSIGNED_BYTE,Q),Rn(U,N,X,1);for(var m=j.getImageData(0,0,N,X),h=m.data,J=0;J<h.length;J+=4){var w=J/4,E=b(w/N),p=w-E*N;w=4*((X-1-E)*N+p),h[w]=Q[J],h[w+1]=Q[J+1],h[w+2]=Q[J+2],h[w+3]=Q[J+3]}return j.putImageData(m,0,0),u&&Fe(F,B),x._42(C,x.getDevicePixelRatio()),U},toDataURL:function(j,F){var v=this,x=v.getGL();if(v.validate(),j){var $=x.getParameter(x.COLOR_CLEAR_VALUE);Fe(x,j)}v._42(C,1);var b=v._canvas.toDataURL(F||"image/png",1);return j&&Fe(x,$),v._42(C,v.getDevicePixelRatio()),b},getGL:function(){var $=this,P=$._26I,J=$._prg;if(!P)try{$._2O={},P=$._26I=$._canvas.getContext("webgl",$._attributes)||$._canvas.getContext("experimental-webgl",$._attributes),P._emptyTexture=on(P),P._emptyBlendTexture=on(P),P._bufPool={},P._id=++Xf,$._buffer={vs:Tn(P),ns:Tn(P),is:Tn(P),uv:Tn(P),batchColor:Tn(P),batchBlend:Tn(P),batchBrightness:Tn(P),lineDistance:Tn(P)},$._1O=Oe(P);var v=$._cube={vs:Tn(P),ns:Tn(P),is:Tn(P),uv:Tn(P)};qi(P,v.vs,Yd),qi(P,v.ns,cp),qi(P,v.uv,qc),To(P,v.is,kr)}catch(b){}if(P&&!J){if(J=$._prg=P.createProgram(),!J)return C;var F=$._dirs.length,y=$._spots.length,w=$._59O.length,N=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];F&&N.push("uDirColor","uDirDirection"),y&&N.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),w&&N.push("uPointColor","uPointRange","uPointPosition"),Fe(P,[0,0,0,0]),P.clearDepth(1),P.enable(P.DEPTH_TEST),P.depthFunc(P.LEQUAL),P.enable(P.BLEND),P.blendFuncSeparate(P.SRC_ALPHA,P.ONE_MINUS_SRC_ALPHA,P.ONE,P.ONE_MINUS_SRC_ALPHA),Nd||(Hn=Pf(Hn.substring(0,Hn.indexOf("^#"))),gs=Pf(gs),Nd=!0);var m=["#define MAX_DIR "+F,"#define MAX_SPOT "+y,"#define MAX_POINT "+w,$._fogDisabled?"":"#define FOG",$._dashDisabled?"":"#define DASH",$._batchColorDisabled?"":"#define BATCHCOLOR",$._batchBlendDisabled?"":"#define BATCHBLEND",$._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),Y=di(P,J,P.VERTEX_SHADER,Hn.replace("PREFIX",m)),O=di(P,J,P.FRAGMENT_SHADER,gs.replace("PREFIX",m));d?N.push("aPosition"):(J.aPosition=0,P.bindAttribLocation(J,0,"aPosition")),P.linkProgram(J),N.forEach(function(h){J[h]=/^u/.test(h)?P.getUniformLocation(J,h):P.getAttribLocation(J,h)}),P.useProgram(J),P.deleteShader(Y),P.deleteShader(O)}return P},getBrightness:function(u){var A=u.s("brightness"),X=this.isSelected(u)?u.s("select.brightness"):C;return A==C?X:X==C?A:A*X},getWireframe:function(V){var n=V.s("wf.visible"),U=V.s("wf.width");return n===!0||U>0&&"selected"===n&&this.isSelected(V)?{color:V.s("wf.color"),width:U,"short":V.s("wf.short"),mat:V.s("wf.mat")}:void 0},_transformPointToViewSpace:function(m){var P=[m[0],m[1],m[2]];return mg(P,this._viewMatrix),P},_transformDirectionToViewSpace:function(E,m){var i=[E[0],E[1],E[2]];mg(i,this._viewMatrix);var D=m?[m[0],m[1],m[2]]:[0,0,0];mg(D,this._viewMatrix);var B=D[0]-i[0],u=D[1]-i[1],L=D[2]-i[2],_=Math.sqrt(B*B+u*u+L*L);return _?[B/_,u/_,L/_]:[B,u,L]},getWireframeGeometry:function(k){return k.s("wf.geometry")?{color:k.s("wf.color"),width:k.s("wf.width"),mat:k.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(V){return V.s("body.color")},getMat:function(O){return O.getMat?O.getMat():O.s("mat")},getFaceMat:function(N,Y){return N.getFaceMat?N.getFaceMat(Y):N.s(Y+".mat")},getFaceBlend:function(W,R){return W.s(R+".blend")||W.s("all.blend")},getFaceColor:function(X,j){return X.s(j+".color")||X.s("all.color")},getFaceImage:function($,J){return $.s(J+".image")||$.s("all.image")},getFaceBlendImage:function(W,j){return W.s(j+".blend.image")||W.s("all.blend.image")},getFaceDiscardSelectable:function(s,X){var m=s.s(X+".discard.selectable");return m==C?s.s("all.discard.selectable"):m},getFaceUv:function(N,l){return N.s(l+".uv")||N.s("all.uv")},getFaceUvOffset:function(k,K){return k.s(K+".uv.offset")||k.s("all.uv.offset")},getFaceUvScale:function(q,S){return q.s(S+".uv.scale")||q.s("all.uv.scale")},getFaceLight:function(b,I){var e=b.s(I+".light");return e==C?b.s("all.light"):e},getFaceVisible:function(V,k){var c=V.s(k+".visible");return c==C?V.s("all.visible"):c},getFaceOpacity:function(z,K){var c=z.s(K+".opacity");return c==C?z.s("all.opacity"):c},getFaceTransparent:function(U,W){var y=U.s(W+".transparent");return y==C?U.s("all.transparent"):y},getFaceReverseColor:function(u,O){return u.s(O+".reverse.color")||u.s("all.reverse.color")},getFaceReverseFlip:function(W,M){var t=W.s(M+".reverse.flip");return t==C?W.s("all.reverse.flip"):t},getFaceReverseCull:function(t,z){var D=t.s(z+".reverse.cull");return D==C?t.s("all.reverse.cull"):D},getTextureMap:function(){return this._2O},deleteTexture:function(E){var m=this,H=m._2O[E];H&&(delete m._2O[E],m.getGL().deleteTexture(H))},invalidateShape3dCachedImage:function($){var G=this.getData3dUI($);G.invalidateCachedTexture(this.getGL())},isInteractive:function(N){return N.s("interactive")},getTexture:function(D,O){if(!D)return C;var o=this,a=o.getGL(),s=o._2O[D];if(!s){var L=Sg(D);if(L)if(L.tagName){if(L.dynamic)return Oe(a,L,o._1O);s=o._2O[D]=Oe(a,L)}else{var S,i=O&&O.s("shape3d.image.cache")&&!o.isInteractive(O),_=o.vr.isPresenting();if(_&&(O._textureUpdateFrame===a._renderInfo.frame?i=!0:O._textureUpdateFrame=a._renderInfo.frame),i&&(S=o.getData3dUI(O),s=S.getCachedTexture()),!s){var U=O&&O.s("shape3d.fixSizeOnScreen"),u=U?a.NEAREST:a.LINEAR;if(!U&&O&&O.s("shape3d.vector.dynamic")&&(S||(S=o.getData3dUI(O)),U=S.getVectorDynamicSize())){var n=o.getDevicePixelRatio();U[0]*=n,U[1]*=n}var z=O&&O.s("shape3d.texture.scale")||1,v=U&&U[0]>0?U[0]:z*Ml(L,O),M=U&&U[1]>0?U[1]:z*Zj(L,O);if(v>=1&&M>=1){var J=kg(v,M);if(!S&&O&&(S=o.getData3dUI(O)),S&&S.interactiveInfo){var r=S.interactiveInfo[D]={};J.interactiveInfo=r.bodyInfo={compInfos:[],matrix:new Co,rect:{x:0,y:0,width:v,height:M}}}er(J,L,0,0,v,M,O,o),J.interactiveInfo&&(J.interactiveInfo=null),J.restore(),(i||_)&&Yg(L,O)?(s=Oe(a,tf,null,u),S.setCachedTexture(s),tf=null):s=Oe(a,tf,o._1O,u)}}}}return s},redraw:function(){this.iv()},validateImpl:function(){var u=this;if(u._lightChanged){u._lightChanged=!1;var Y=[],a=[],v=[];u.dm().each(function(N){if(rf(N)){var y=N.s("light.type");y===Eq?Y.push(N):y===Wl?a.push(N):y===or&&v.push(N)}}),(Y.length!==u._59O.length||a.length!==u._spots.length||v.length!==u._dirs.length)&&pe(u),u._59O=Y,u._spots=a,u._dirs=v}u._42(),u._1o.iv()},getRenderInfo:function(){var W=this.getGL();return W?W._renderInfo:void 0},showDebugTip:function(){var G=this,x=G._debugDiv;if(!x){x=G._debugDiv=p.createElement("div"),x.style.position="absolute",x.style.overflow="hidden",x.style.backgroundColor="white",x.style.color="black";var b=G.getView();G._79O?b.insertBefore(x,G._79O):b.appendChild(x),G._debugTipTimerId=setInterval(function(){var s=G.getRenderInfo();if(s){var a=G.getGL()._validBufCount||0,V="Draw Calls: "+s.calls+"<br/>"+"Vertices: "+s.vertices+"<br/>"+"Faces: "+s.faces+"<br/>"+"Lines: "+s.lines+"<br/>"+"Buffer Count: "+a;x.innerHTML=V}},10)}},hideDebugTip:function(){var F=this,B=F._debugDiv;B&&(delete F._debugDiv,cancelAnimationFrame(F._debugTipTimerId),delete F._debugTipTimerId,F.getView().removeChild(B))},_42:function(V,v){var i=this;if(!i._35O&&(!qe||Dk(qe))){var d,P;V&&(V instanceof dg?P=V:d=V);var J=i._canvas,S=i.getGL(),g=i._prg;if(S){var O=i.getWidth(),f=i.getHeight();v?V||Rn(J,O,f,v):(v=i.getDevicePixelRatio(),V||O===J.clientWidth&&f===J.clientHeight||Rn(J,O,f,v)),S.clear(S.COLOR_BUFFER_BIT),S._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:V?i._frameId:++i._frameId};var r=function(){if(i.overlappingBox.clear(),i._81O=C,S.clear(S.DEPTH_BUFFER_BIT),pi(S,g.uBrightness,1),pi(S,g.uOpacity,1),pi(S,g.uPartOpacity,1),S._picking=!!V,pi(S,g.uPick,!!V),pi(S,g.uTexture,!1),pi(S,g.uBlendTexture,!1),pi(S,g.uAlphaTest,w.alphaTest),pi(S,g.uTransparent,!1),pi(S,g.uFix,!1),pi(S,g.uBatchColor,!1),pi(S,g.uBatchBlend,!1),pi(S,g.uBatchBrightness,!1),pi(S,g.uPMatrix,i._projectMatrix=Qr(i)),pi(S,g.uViewMatrix,Ei(i,i._7O)),i._viewMatrix=Me(i._7O),V||(Do(i,S,g),i._fogDisabled||(pi(S,g.uFogColor,i._fogColor),pi(S,g.uFogNear,i._fogNear),pi(S,g.uFogFar,i._fogFar))),cm(S,g.aPosition),cm(S,g.aNormal),Kn(S,g.aUv),Kn(S,g.aBatchColor),Kn(S,g.aBatchBlend),Kn(S,g.aBatchBrightness),Kn(S,g.aLineDistance),P){var v=S.getParameter(S.COLOR_CLEAR_VALUE);S.clearColor(0,0,0,0),S.disable(S.BLEND),Kn(S,g.aNormal),qi(S,i._cube.vs,C,g.aPosition),To(S,i._cube.is),af(P,i,en,0),af(P,i,Nb,6),af(P,i,lg,12),af(P,i,Eg,18),af(P,i,al,24),af(P,i,rb,30),cm(S,g.aNormal),Fe(S,v)}else if(d){d.value=2;var v=S.getParameter(S.COLOR_CLEAR_VALUE);S.clearColor(0,0,0,0),S.disable(S.BLEND),i._95I(S,g,d),Te(i,d),Ic(i,i._polylineModelMap,d),Ic(i,i._wireframeModelMap,d),pi(S,g.uTransparent,!0),i._95I(S,g,d,!0),Te(i,d,!0),Ic(i,i._polylineModelMap,d,!0),Ic(i,i._wireframeModelMap,d,!0),pi(S,g.uTransparent,!1),S.clear(S.DEPTH_BUFFER_BIT),i._swapLineMap(),i._95I(S,g,d,!1,!0),Ic(i,i._polylineModelMap,d),Ic(i,i._wireframeModelMap,d),i._swapLineMap(),S.disable(S.DEPTH_TEST),i._30O._42(S,g,d),S.enable(S.DEPTH_TEST),Fe(S,v)}else S.disable(S.BLEND),i.drawSky(S,g),i._31O._42(S,g),i._95I(S,g),Te(i),Ic(i,i._polylineModelMap),Ic(i,i._wireframeModelMap),S.enable(S.BLEND),pi(S,g.uTransparent,!0),S.depthMask(!1),i._95I(S,g,C,!0),Te(i,C,!0),Ic(i,i._polylineModelMap,C,!0),Ic(i,i._wireframeModelMap,C,!0),S.depthMask(!0),pi(S,g.uTransparent,!1),S.clear(S.DEPTH_BUFFER_BIT),i._swapLineMap(),i._95I(S,g,C,!1,!0),Ic(i,i._polylineModelMap),Ic(i,i._wireframeModelMap),i._swapLineMap(),S.disable(S.DEPTH_TEST),S.disable(S.BLEND),i._32O._42(S,g),i._30O._42(S,g),S.enable(S.DEPTH_TEST);qi(S,C),To(S,C)},F=!1,a=O*v,X=f*v,m=i.vr;m.enable&&m._42(S,a,X,r)&&(F=!0);var h=i.envRenderer;h&&h.enable&&h._42(S,a,X,r)&&(F=!0),F||(S.viewport(0,0,O*v,f*v),r()),i._33Q=!1,i._doBufferGC(S)}}},setBufferGCInterval:function(U){this._bufferGCInterval=U},_doBufferGC:function(Q,p){var M,W,b=Q._bufPool,H=0,r=0,n=Q._renderInfo.frame,E=this._bufferGCInterval||10;for(M in b)H++,W=b[M],W&&(p||n-W._fid>E?(Q.deleteBuffer(W._buf),W._buf=null,b[M]=null):r++);if(H/2>r&&H>128){var q={};for(M in b)b[M]&&(q[M]=b[M]);Q._bufPool=q}Q._validBufCount=r},_swapLineMap:function(){var Z=this;G=Z._polylineModelMap,Z._polylineModelMap=Z._polylineModelMapSwap,Z._polylineModelMapSwap=G,G=Z._wireframeModelMap,Z._wireframeModelMap=Z._wireframeModelMapSwap,Z._wireframeModelMapSwap=G,G=Z._polylineIndexMap,Z._polylineIndexMap=Z._polylineIndexMapSwap,Z._polylineIndexMapSwap=G,G=Z._wireframeIndexMap,Z._wireframeIndexMap=Z._wireframeIndexMapSwap,Z._wireframeIndexMapSwap=G},_updateSkyBoxPosition:function(d){if(this._skyBox&&d&&"eye"===d.property){var _=d.newValue;this._skyBox.p3(_[0],_[1],_[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(b){var n=this._skyBox;n&&this._skyBoxStyleMap&&(n.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null),this._skyBox=b,this.ump(this._updateSkyBoxPosition,this),b&&(b.dm()&&b.dm().remove(b),this._skyBoxStyleMap=u.Default.clone(b.getStyleMap()),b.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition({property:"eye",newValue:this.getEye()})),this.fp("skyBox",n,b)},drawSky:function(m,H,Y){var d=this,k=d._skyBox;if(k){var G=d._headlightIntensity,x=Jn(d._headlightColor),H=d._prg;1!==G&&(x=[x[0]*G,x[1]*G,x[2]*G]),pi(m,H.uHeadlightColor,[x[0],x[1],x[2],1]);var n=d.getData3dUI(k);n&&n._42(m,H,Y,function(){return!0}),m.clear(m.DEPTH_BUFFER_BIT),pi(m,H.uHeadlightColor,[x[0],x[1],x[2],d._headlightDisabled?1:0])}},_95I:function(t,G,O,Y,x){function C(y){if(!!y.s("shape3d.alwaysOnTop")==!!x&&N.isVisible(y)&&(!B||n)){if(!O&&N.isTransparentMask(y))return;var _=N.getData3dUI(y);_&&_._42(t,G,O,W)}}var N=this,W=function(K){return Y?K:!K};N.sky&&t.clear(t.DEPTH_BUFFER_BIT),N.dm().each(C)},getLogicalPoint:function(k){return Al(k,this._canvas)},isRectOverlapping:function(t){var Q=this.getData3dUI(t);return Q._rectOverlapping},getHitFaceInfo:function(L){L.target&&(L=this.lp(L));var K=this.getDataInfoAt(L);if(K){var u=this._1o.face(K.data,om(L.x,L.y));if(u)return{data:K.data,face:u}
}return C},unproject:function(r,s){var b=this,p=b.getWidth(),y=b.getHeight(),K=r.target?b.lp(r):r,m=K.x-p/2,S=K.y-y/2,_=2*(m/p),q=2*(-1*S/y);s=s||0;var l=mb(),E=Qr(b),i=Ei(b);zh(l,E,i),yc(l);var T=Yn([_,q,s,1],l);return[T[0]/T[3],T[1]/T[3],T[2]/T[3]]},getDataAt:function(Q){var v=this.getDataInfoAt(Q);return v?v.data:C},getDataInfoAt:function(D,K){return D.target&&(D=this.lp(D)),this._1o.get(om(D.x,D.y,K),!0)},getDatasInRect:function(X){return this._1o.get(X)},setEditable:function(f){var r=this,Q=r._editable;r._editable=f,this.fp(Hc,Q,f)},isEditable:function(n){var T=this;return T._editable?Cp(n)?n.s("3d.editable")?T._editableFunc?T._editableFunc(n):!0:!1:!1:!1},isSelectable:function(V){return V.s("3d.selectable")&&this.sm().isSelectable(V)},isMovable:function(h){var W=this;return Uk(h)&&h.getStyle(yq)!==lk?!1:h.s("3d.movable")?W._movableFunc?W._movableFunc(h):!0:!1},isSizeEditable:function(r){return Cp(r)?this._sizeEditableFunc?this._sizeEditableFunc(r):!0:!1},isRotationEditable:function(f){return Cp(f)&&f.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(f):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(V){this.setZoom(wp,V)},zoomOut:function(u){this.setZoom(1/wp,u)},setZoom:function(g,L){if(1!==g){var q=this;if(q._ortho)return q.setOrthoZoom(g,L),void 0;q._14o&&q._14o.stop(!0);var d=1/g,z=q._eye,N=q._center,X=N[0]+(z[0]-N[0])*d-z[0],f=N[1]+(z[1]-N[1])*d-z[1],l=N[2]+(z[2]-N[2])*d-z[2];if(!(Xo(z,N)<q._moveStep&&1>d)){if(L=_r(L)){var n=Io(z);return L.action=function(_){q.fi({kind:q._zooming?"betweenZoom":"beginZoom"}),q._zooming=1,z[0]=n[0]+X*_,z[1]=n[1]+f*_,z[2]=n[2]+l*_,q.fp(bh,C,z)},L._37o=function(){delete q._14o,delete q._zooming,q.fi({kind:"endZoom"}),q.onZoomEnded()},q._14o=zk(L)}z[0]+=X,z[1]+=f,z[2]+=l,q.fp(bh,C,z)}}},setOrthoZoom:function(p,T){if(1!==p){var c=this;c._14o&&c._14o.stop(!0);var n=c._orthoWidth,O=n/p-n;if(!(n<c._moveStep&&p>1))return(T=_r(T))?(T.action=function(f){c.fi({kind:c._zooming?"betweenZoom":"beginZoom"}),c._zooming=1,c.setOrthoWidth(n+O*f)},T._37o=function(){delete c._14o,delete c._zooming,c.fi({kind:"endZoom"}),c.onZoomEnded()},c._14o=zk(T)):(c.setOrthoWidth(n/p),void 0)}},getPositionInfo:function(R){var G=this,b=G._eye,A=G._center,Y=G.getAspect(),t=R?Kc(Xl(A,b,!0),Xl(R,b)):Xo(b,A);if(G._ortho){var q=G._orthoWidth;return{length:t,height:q/Y,width:q}}var p=2*o(G._fovy/2)*t;return{length:t,height:p,width:p*Y}},getCenterInfo:function(){var b=this;return b._81O||(b._81O=b.getPositionInfo()),Io(b._81O)},rotate:function(D,G,$,p){var g=this;if(D||G){p==C&&(p=g._firstPersonMode),g._88O&&g._88O.stop(!0);var t=g._center,k=g._eye,i=g.getCenterInfo().length,F=p?t:k,d=p?k:t,l=Xl(F,d),K=W(l[0],l[2]),n=W(c(l[0]*l[0]+l[2]*l[2]),l[1]),I=p?ne:bh;return p&&(G=-G),($=_r($))?($.action=function(k){g.fi({kind:g._rotating?"betweenRotate":"beginRotate"}),g._rotating=1;var X=K+D*k,o=n+G*k;o=qk(o),l[0]=i*Q(o)*Q(X),l[1]=i*h(o),l[2]=i*Q(o)*h(X),F[0]=d[0]+l[0],F[1]=d[1]+l[1],F[2]=d[2]+l[2],g.fp(I,C,F)},$._37o=function(){delete g._88O,delete g._rotating,g.fi({kind:"endRotate"}),g.onRotateEnded()},g._88O=zk($)):(K+=D,n+=G,n=qk(n),l[0]=i*Q(n)*Q(K),l[1]=i*h(n),l[2]=i*Q(n)*h(K),F[0]=d[0]+l[0],F[1]=d[1]+l[1],F[2]=d[2]+l[2],g.fp(I,C,F),void 0)}},pan:function(V,K,R,A){if(V||K){var J=this;A==C&&(A=J._firstPersonMode),J._89O&&J._89O.stop(!0);var p=Ei(J),E=[p[0]*V,p[4]*V,p[8]*V],k=[p[1]*K,p[5]*K,p[9]*K],P=E[0]+k[0],s=E[1]+k[1],Z=E[2]+k[2],q=J._center,G=J._eye;if(A){var e=uq(J.getBoundaries(),G[0],G[2],G[0]+P,G[2]+Z,c(P*P+Z*Z));P=e[0],Z=e[1]}if(R=_r(R)){var N=Io(G),l=Io(q);return R.action=function(b){J.fi({kind:J._panning?"betweenPan":"beginPan"}),J._panning=1,q[0]=l[0]+P*b,q[1]=l[1]+s*b,q[2]=l[2]+Z*b,G[0]=N[0]+P*b,G[1]=N[1]+s*b,G[2]=N[2]+Z*b,J.fp(bh,C,G),J.fp(ne,C,q)},R._37o=function(){delete J._89O,delete J._panning,J.fi({kind:"endPan"}),J.onPanEnded()},J._89O=zk(R)}q[0]+=P,q[1]+=s,q[2]+=Z,G[0]+=P,G[1]+=s,G[2]+=Z,J.fp(bh,C,G),J.fp(ne,C,q)}},walk:function(V,f,o){if(V){var J=this;o==C&&(o=J._firstPersonMode),J._90O&&J._90O.stop(!0);var s=J._center,S=J._eye,w=Xl(s,S,!0);if(o){var T=uq(J.getBoundaries(),S[0],S[2],S[0]+w[0]*V,S[2]+w[2]*V,M(V));if(V=Xo(T),!V)return;w=[T[0]/V,0,T[1]/V]}if(f=_r(f)){var b=Io(S),G=Io(s);return f.action=function(Y){J.fi({kind:J._walking?"betweenWalk":"beginWalk"}),J._walking=1;var l=V*Y;S[0]=b[0]+w[0]*l,S[1]=b[1]+w[1]*l,S[2]=b[2]+w[2]*l,s[0]=G[0]+w[0]*l,s[1]=G[1]+w[1]*l,s[2]=G[2]+w[2]*l,J.fp(bh,C,S),J.fp(ne,C,s)},f._37o=function(){delete J._90O,delete J._walking,J.fi({kind:"endWalk"}),J.onWalkEnded()},J._90O=zk(f)}S[0]+=w[0]*V,S[1]+=w[1]*V,S[2]+=w[2]*V,s[0]+=w[0]*V,s[1]+=w[1]*V,s[2]+=w[2]*V,J.fp(bh,C,S),J.fp(ne,C,s)}},handleScroll:function(a,z){a.preventDefault();var T=this,h=T._moveStep;T.isFirstPersonMode()?T.isPannable()&&T.pan(0,z>0?h:-h):T.isZoomable()&&T.setZoom(0>z?1/Xp:Xp)},handlePinch:function(n,c){this.isZoomable()&&this.setZoom(c>n?1/se:se)},reset:function(){this.setCenter(v.graph3dViewCenter),this.setEye(v.graph3dViewEye),this.setUp(v.graph3dViewUp)},moveSelection:function(g,i,u){var H=this;H.dm().beginTransaction(),wr(this.sm().toSelection(this.isMovable,this),g,i,u),H.dm().endTransaction()},getMoveMode:function(b,n){var e=n.s("3d.move.mode");if(e)return e;var X="88",J="89",C="90";return Nh(b)||yp[X]&&yp[J]&&yp[C]?"xyz":yp[X]&&yp[J]?"xy":yp[X]&&yp[C]?"xz":yp[J]&&yp[C]?"yz":yp[X]?"x":yp[J]?"y":yp[C]?"z":"xz"},handleTick:function(){var P=this,D=!1,i=P._moveStep,k=i,d=!1,t=!0,n=P._rotateStep*(t?-1:1);if(P.isWalkable()||(k=0),P.isPannable()||(i=0),P.isRotatable()||(n=0),P._32Q){var S=(de()-P._32Q)/50;k*=S,i*=S,n*=S}P._31Q&&(ge(P._31Q),delete P._31Q,delete P._32Q),os()&&(D=!0,P.pan(-i,0,d,t)),Rc()&&(D=!0,P.pan(i,0,d,t)),Sj()&&(D=!0,Nh()?P.pan(0,i,d,t):P.walk(k,d,t)),Sl()&&(D=!0,Nh()?P.pan(0,-i,d,t):P.walk(-k,d,t)),Ab()&&(D=!0,P.rotate(-n,0,d,t)),Cj()&&(D=!0,P.rotate(n,0,d,t)),Ad()&&(D=!0,P.rotate(0,-n/2,d,t)),hk()&&(D=!0,P.rotate(0,n/2,d,t)),D&&(P._32Q=de(),P._31Q=pp(P.handleTick,P))},handleKeyDown:function(R){var Y=this;!md(R)&&Vb[R.keyCode]?Y.handleTick():_q(R)?Y.selectAll():ud(R)?Y.handleDelete(R):Nf(R)&&this.isResettable()&&Y.reset()},checkDoubleClickOnNote:function(D,G,J){var U=this;if(J===Qb){if(G.s("note.toggleable"))return G.s(Dl,!G.s(Dl)),U.fi({kind:"toggleNote",event:D,data:G,part:J}),!0}else if(J===kb&&G.s("note2.toggleable"))return G.s(xd,!G.s(xd)),U.fi({kind:"toggleNote2",event:D,data:G,part:J}),!0;return!1},checkDoubleClickOnRotation:function(k,l,o){return o===yf?(l.setRotationX(0),!0):o===Ij?(l.setRotationY(0),!0):o===yr?(l.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(y){var t=this;if(t.isOrtho())return t.getWidth()/t.getOrthoWidth();var J=t.getCenter(),r=t.getHeight(),c=t.getEye(),i=[J[0]-c[0],J[1]-c[1],J[2]-c[2]],Q=[y[0]-c[0],y[1]-c[1],y[2]-c[2]],T=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),n=1/Math.tan(t.getFovy()/2);return r*T*n/(Q[0]*i[0]+Q[1]*i[1]+Q[2]*i[2])},inViewSpace:function(U){var v,I=this,Q=I._transformPointToViewSpace(U),D=I.getAspect(),$=I.getNear(),h=I.getFar();return-Q[2]<$||-Q[2]>h?!1:I.isOrtho()?(v=I.getOrthoWidth()/2,Math.abs(Q[0])<=v&&Math.abs(Q[1]*D)<=v):(v=Math.sqrt(Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2])*Math.tan(I.getFovy()/2),Math.abs(Q[1]<=v)&&Math.abs(Q[0])<=v*D)},toViewPosition:function(k){var P=this,l=P.getWidth()/2,n=P.getHeight()/2,G=P._18Q;return G&&G._wh===l/n||(G=Qr(P),P._18Q=zh(G,G,Ei(P)),P._18Q._wh=l/n),k=Yn([k[0],k[1],k[2],1],G),{x:l+l*k[0]/k[3],y:n-n*k[1]/k[3]}},getHitPosition:function(Q,w,R){var h=this,i=h.getWidth(),r=h.getHeight(),g=Q.target?h.lp(Q):Q,N=g.x-i/2,S=g.y-r/2,P=h.getCenterInfo(),p=Ei(h);w=w?w:[0,0,0],R=R?R:[0,1,0],N=N/i*P.width,S=-1*S/r*P.height;var y=[p[0]*N,p[4]*N,p[8]*N],x=[p[1]*S,p[5]*S,p[9]*S],H=[y[0]+x[0],y[1]+x[1],y[2]+x[2]],D=h.getCenter(),C=Dm(h,w,R,[H[0]+D[0],H[1]+D[1],H[2]+D[2]]);return C?C:[0,0,0]},intersectObject:function(X,$){return this._raycaster.intersectObject(X,$)},intersectObjects:function(u,j,J){return this._raycaster.intersectObjects(u,j,J)},getLineLength:function(s){this.validate();var R=this.getData3dUI(s);if(R&&R.getCache){var M=R.getCache();if(M)return M[M.length-1].length}return 0},getLineOffset:function(p,e){var l=this.getData3dUI(p);if(l&&l.getCache){var d=l.getCache();if(d)return qh(d,e)}return C},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function o(M,C,e){q.fromArray(yk(e,C.getMat(e)));var j=e.getAnchor3d();M.push((new cl).set(0-j.x,0-j.y,0-j.z).applyMatrix4(q)),M.push((new cl).set(0-j.x,0-j.y,1-j.z).applyMatrix4(q)),M.push((new cl).set(0-j.x,1-j.y,0-j.z).applyMatrix4(q)),M.push((new cl).set(0-j.x,1-j.y,1-j.z).applyMatrix4(q)),M.push((new cl).set(1-j.x,0-j.y,0-j.z).applyMatrix4(q)),M.push((new cl).set(1-j.x,0-j.y,1-j.z).applyMatrix4(q)),M.push((new cl).set(1-j.x,1-j.y,0-j.z).applyMatrix4(q)),M.push((new cl).set(1-j.x,1-j.y,1-j.z).applyMatrix4(q))}var G=new cl,n=new cl,f=new cl,e=new cl,q=new Bq,R=new u.Math.Quaternion,H=new Pj;return function(y,U,q){var c=this;if(q!==r)U={animation:U,ratio:q};else{var k=typeof U;("boolean"===k||"object"===k&&U.duration)&&(U={animation:U})}U=U||{},G.fromArray(c.getEye()),n.fromArray(c.getCenter());var g,W,B=[],F=U.center,T=U.distance===r;if(F&&f.fromArray(F),y instanceof u.Node)F||f.fromArray(y.p3()),T&&(o(B,c,y),g=B.length);else{if(y||(y=c.dm().getDatas()),!y.length)return;if((T||!F)&&(B=[],y.forEach(function(q){o(B,c,q)}),g=B.length),!F){for(f.set(0,0,0),W=0;g>W;W++)f.add(B[W]);f.multiplyScalar(1/g)}}if(c.setCenter(f.x,f.y,f.z),e.subVectors(G,n),U.direction||U.worldDirection){!U.worldDirection&&y instanceof u.Node?R.setFromEuler(H.set(y.r3(),y.getRotationMode(),!0)):R.set(0,0,0,1);var N=e.length();e.fromArray(U.worldDirection||U.direction).applyQuaternion(R).setLength(N)}if(T){for(var M,b,I,j,w,V=c.getNear(),Y=10,q=U.ratio||.8;Y--;){for(c._eye[0]=e.x+f.x,c._eye[1]=e.y+f.y,c._eye[2]=e.z+f.z,M=Qr(c),zh(M,M,Ei(c)),j=!0,w=-1/0,W=0;g>W;W++){if(I=B[W],b=Yn([I.x,I.y,I.z,1],M),b[3]<V&&Y){e.multiplyScalar(2),j=!1;break}w=Math.max(w,Math.max(Math.abs(b[0]),Math.abs(b[1]))/q-b[3])}if(j)break}e.setLength(w+e.length()).add(f)}else e.setLength(U.distance).add(f);c._flyAnim&&c._flyAnim.stop(!0);var D=_r(U.animation);if(D){c.setEye(G.x,G.y,G.z),c.setCenter(n.x,n.y,n.z);var O=(new cl).subVectors(e,G),S=(new cl).subVectors(f,n),s=new cl,A=new cl;return D.action=function(e){s.copy(G).addScaledVector(O,e),A.copy(n).addScaledVector(S,e),c.setCenter(A.x,A.y,A.z),c.setEye(s.x,s.y,s.z)},D._37o=function(){delete c._flyAnim},{lastEye:G,lastCenter:n,eye:e,center:f,animation:c._flyAnim=zk(D)}}return c.setEye(e.x,e.y,e.z),{lastEye:G,lastCenter:n,eye:e,center:f}}}()}),Wn.RenderEnv=function(D){this.gv=D,this.enable=!1},m.defineProperties(Wn.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(O){this._debugOn=O,this.capture&&this.capture()}}}),m.assign(Wn.RenderEnv.prototype,{renderEnvToCube:function(I,S,f,e){var m=this,V=m.gv;if(!I||!S||!f)return m.enable=!1,m._42=null,void 0;m.enable=!0;var G=Math.floor(e/I*S),H=V.getGL(),K=m._renderTargets;K?K.length<f&&(K=m._renderTargets=K.concat(new Array(f-K.length))):K=m._renderTargets=new Array(f);for(var j=0;f>j;j++)K[j]?K[j].setSize(H,e,G):K[j]=new Wn.RenderTarget(V,H,e,G);var A=!1;m.capture=function(){A=!0,V._42(),A=!1};var U=new cl,E=new cl,r=new cl,T=new cl,Q=(new cl).setY(0),q=2*Math.PI/f,d=I/2/Math.tan(Math.PI/f),Y=2*Math.atan2(S/2,d),b=I/S;m._42=function($,J,v,I){var u=m._debugOn;if(!A&&!u)return!1;U.copy(V.getEye()),T.copy(V.getCenter()).sub(U);var L=Math.atan2(T.z,T.x),W=V.getNear(),x=V.getFovy(),Z=V.getAspect();E.copy(V.getCenter());for(var p,n=0;f>n;n++)if(p=K[n],Q.setZ(Math.cos(L)).setX(Math.sin(L)).multiplyScalar(d),L-=q,r.addVectors(U,Q),V.setNear(d),V.setCenter([r.x,r.y,r.z]),V.setFovy(Y),V.setAspect(b),u){var z=Math.round(J/f);$.viewport(z*n,0,z,v),I()}else Pn($,p.frame),$.viewport(0,0,p.width,p.height),$.clear($.COLOR_BUFFER_BIT),I(),Pn($,C),p.assureTexture();return V.setNear(W),V.setCenter([E.x,E.y,E.z]),V.setFovy(x),V.setAspect(Z),!0},m.capture()},getTextureInfo:function(E){var C=this._renderTargets;if(!C)return null;var e=this._renderTargets[E];return e?{index:E,texture:e.texture,textureName:e.uuid}:null}}),m.assign(Wn.Graph3dView.prototype,{renderEnvToCube:function(e,y,n,r){var Q=this;Q.envRenderer||(Q.envRenderer=new Wn.RenderEnv(Q)),Q.envRenderer.renderEnvToCube(e,y,n,r)}}),Wn.RenderTarget=function(P,q,r,k){var S=this;S.uuid=u.Math.generateUUID(),S.gv=P,S.init(P,q),S.setSize(q,r,k)},m.assign(Wn.RenderTarget.prototype,{init:function(z,n){var P=this,V=P.texture=n.createTexture();n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,V),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.bindTexture(n.TEXTURE_2D,null),P.render=n.createRenderbuffer(),P.frame=n.createFramebuffer(),z._2O[P.uuid]=V},assureTexture:function(){var u=this,M=u.uuid,l=u.gv._2O;l[M]||(l[M]=u.texture)},setSize:function(D,n,z){var P=this;if(P.width!==n||P.height!==z){var Y=D.RGBA,Z=D.TEXTURE_2D,i=D.RENDERBUFFER,X=D.FRAMEBUFFER;Wj(D,P.texture),D.texImage2D(Z,0,Y,n,z,0,Y,D.UNSIGNED_BYTE,C),he(D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.bindRenderbuffer(i,P.render),D.renderbufferStorage(i,D.DEPTH_COMPONENT16,n,z),Pn(D,P.frame),D.framebufferTexture2D(X,D.COLOR_ATTACHMENT0,Z,P.texture,0),D.framebufferRenderbuffer(X,D.DEPTH_ATTACHMENT,i,P.render),Wj(D,C),D.bindRenderbuffer(i,C),Pn(D,C),P.width=n,P.height=z}},toCanvas:function(){var i=this,N=i.gv.getGL();N.bindFramebuffer(N.FRAMEBUFFER,i.frame);var c=i.width,V=i.height,P=new Uint8Array(4*c*V);N.readPixels(0,0,c,V,N.RGBA,N.UNSIGNED_BYTE,P),N.bindFramebuffer(N.FRAMEBUFFER,null);var Y=p.createElement("canvas");Y.width=c,Y.height=V;var f=Y.getContext("2d"),y=f.createImageData(c,V);return y.data.set(P),f.putImageData(y,0,0),Y}});var Nc=Wn.Interactor=function(U){this.gv=U};Bk("Interactor",m,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var ln=Wn.DefaultInteractor=function(O){Nm(ln,this,[O])};Bk("DefaultInteractor",Nc,{handle_contextmenu:function(G){Ib(G)},handle_mousewheel:function(A){this.gv.handleScroll(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(u){2===u.axis&&this.gv.handleScroll(u,-u.detail)},handle_keydown:function(U){this.gv.handleKeyDown(U)},handle_mousedown:function(Q){this.handle_touchstart(Q)},handle_touchstart:function(m){Ib(m);var F=this,U=F.gv,S=Pr(m),I=U.getDataInfoAt(m),x=I?I.data:C,Y=I?I.part:C,d=U.sm(),V=ok(m),o=vm(m);U.setFocus(m)&&(F._62O=C,F._57I=C,x?md(m)?d.co(x)?d.rs(x):d.as(x):d.co(x)||d.ss(x):S&&(md(m)?U.isRectSelectable()&&(F._62O=xb):F._57I=vq(m)),F._31Q&&(ge(F._31Q),delete F._31Q,delete F._32Q),F._62O||(U.isFirstPersonMode()&&(Nh(m)||o>2?F._62O="pan":U.isMouseRoamable()||_n?(F._62O="roaming",F.foward=V&&Pr(m),F._32Q=de(),F._31Q=pp(F.tick,F)):S||(F._62O="roaming")),F._62O||(S&&V&&No[Y]?(F._62O=Y,F.p3=x.p3()):S&&V&&Cp(x)&&U.isSelected(x)?U.isMovable(x)?(F._62O="move",F.p3=x.p3(),F.movedata=x):U.isInteractive(x)&&(F._62O="none"):_n&&(o>2?F._62O="pan":2===o&&(F.dist=An(m),F._62O="pinch")))),F.point=U.lp(m),qf(F,m),co(m)?U.handleDoubleClick(m,x,Y):U.handleClick(m,x,Y))},tick:function(){var j=this,l=j.gv,v=l._moveStep;j.point&&l.isWalkable()&&(j._32Q&&(v*=(de()-j._32Q)/50),l.walk(j.foward?v:-v),j._32Q=de(),j._31Q=pp(j.tick,j))},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(d){var x=this._57I;x&&(Xo(x,vq(d))<=1&&this.gv.sm().cs(),this._57I=C)},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(b){var G,f,S=this,H=S.gv,h=S._62O,o=S.point,x=H.dm(),Z=H.lp(b),L=Z.x-o.x,V=Z.y-o.y,k=H.getWidth(),s=H.getHeight();if(k&&s){var P=-R*L/k,n=-R*V/s;if("roaming"===h)S.rotate(b,P/2,n/2);else if(h===yf||h===Ij||h===yr)H._86O||x.beginTransaction(),H.fi({kind:H._86O?"betweenEditRotation":"beginEditRotation",event:b}),H._86O=1,H.sm().each(function(k){if(Cp(k)&&H.isRotationEditable(k)){var $=M(P)>M(n)?P:n;h===yf?k.setRotationX(k.getRotationX()+$):h===Ij?k.setRotationY(k.getRotationY()+$):h===yr&&k.setRotationZ(k.getRotationZ()+$)}});else if("move"===h||No[h]){h===ng||h===aq||h===hq?(H._87O||x.beginTransaction(),H.fi({kind:H._87O?"betweenEditScale":"beginEditScale",event:b}),H._87O=1):(H._moving||x.beginTransaction(),H.fi({kind:H._moving?"betweenMove":"beginMove",event:b}),H._moving=1);var T,m=S.p3,B=H.getPositionInfo(m),c=Ei(H);T=h===yb?"x":h===og?"y":h===is?"z":h===ng?"sx":h===aq?"sy":h===hq?"sz":H.getMoveMode(b,S.movedata),L=L/k*B.width,V=-1*V/s*B.height;var d,w,F=[c[0]*L,c[4]*L,c[8]*L],Q=[c[1]*V,c[5]*V,c[9]*V],e=F[0]+Q[0],K=F[1]+Q[1],N=F[2]+Q[2],O=[m[0]+e,m[1]+K,m[2]+N],j=Xl(H.getEye(),O,!0);if("xyz"===T?(d=O,H.moveSelection(e,K,N)):"xz"===T?(d=Dm(H,m,[0,1,0],O),d&&H.moveSelection(d[0]-m[0],0,d[2]-m[2])):"xy"===T?(d=Dm(H,m,[0,0,1],O),d&&H.moveSelection(d[0]-m[0],d[1]-m[1],0)):"yz"===T?(d=Dm(H,m,[1,0,0],O),d&&H.moveSelection(0,d[1]-m[1],d[2]-m[2])):"x"===T||"sx"===T?(j[0]=0,d=Dm(H,m,j,O),d&&(w=d[0]-m[0],"x"===T?H.moveSelection(w,0,0):H.sm().each(function(v){Cp(v)&&H.isSizeEditable(v)&&(G=v.getScaleX()+w/100,f=G/v.getScaleX(),v.setScaleX(G),Nh(b)&&(v.setScaleY(v.getScaleY()*f),v.setScaleTall(v.getScaleTall()*f)))}))):"y"===T||"sy"===T?(j[1]=0,d=Dm(H,m,j,O),d&&(w=d[1]-m[1],"y"===T?H.moveSelection(0,w,0):H.sm().each(function(S){Cp(S)&&H.isSizeEditable(S)&&(G=S.getScaleTall()+w/100,f=G/S.getScaleTall(),S.setScaleTall(G),Nh(b)&&(S.setScaleY(S.getScaleY()*f),S.setScaleX(S.getScaleX()*f)))}))):("z"===T||"sz"===T)&&(j[2]=0,d=Dm(H,m,j,O),d&&(w=d[2]-m[2],"z"===T?H.moveSelection(0,0,w):H.sm().each(function(q){Cp(q)&&H.isSizeEditable(q)&&(G=q.getScaleY()+w/100,f=G/q.getScaleY(),q.setScaleY(G),Nh(b)&&(q.setScaleX(q.getScaleX()*f),q.setScaleTall(q.getScaleTall()*f)))}))),!d)return;S.p3=d}else if(h===xb){var A=S.div;A||(A=S.div=gh(),Ap(S.getView(),A),A.op=o,A.style.background=H.getRectSelectBackground()),H.fi({kind:H._rectSelecting?"betweenRectSelect":"beginRectSelect",event:b}),H._rectSelecting=1,A.rect=xo(A.op,Z),re(A,A.rect)}else if("pinch"===h&&2===vm(b)){H.fi({kind:H._pinching?"betweenPinch":"beginPinch",event:b}),H._pinching=1;var w=An(b);H.handlePinch(w,S.dist),S.dist=w}else"pan"===h||Nh(b)?S.pan(b,L,V):"none"===h||H.isFirstPersonMode()||(Pr(b)?S.rotate(b,P,n):(S.pan(b,L,0),H.isWalkable()&&(H.fi({kind:H._walking?"betweenWalk":"beginWalk",event:b}),H._walking=1,H.walk(V/H.getHeight()*H.getCenterInfo().height))));S.point=Z}},pan:function(k,e,A){var a=this.gv;if(a.isPannable()){var M=a.getWidth(),i=a.getHeight();if(!M||!i)return;var o=a.getCenterInfo(),s=e/M*o.width,C=-1*A/i*o.height;a.fi({kind:a._panning?"betweenPan":"beginPan",event:k}),a._panning=1,a.pan(-s,-C)}},rotate:function(H,j,m){var F=this.gv;F.isRotatable()&&(F.fi({kind:F._rotating?"betweenRotate":"beginRotate",event:H}),F._rotating=1,F.rotate(j,m))},handleWindowMouseUp:function(h){this.handleWindowTouchEnd(h)},handleWindowTouchEnd:function(I){var J=this,s=J.gv,v=s.dm(),U=J.div;if(U){var H=s.getDatasInRect(U.rect);if(!H.isEmpty()){var l=s.sm(),b=l.toSelection();H.each(function(v){l.co(v)?b.remove(v):b.add(v)}),l.ss(b)}ks(U)}s._moving&&(delete s._moving,s.fi({kind:"endMove",event:I}),s.onMoveEnded(),v.endTransaction()),s._panning&&(delete s._panning,s.fi({kind:"endPan",event:I}),s.onPanEnded()),s._rotating&&(delete s._rotating,s.fi({kind:"endRotate",event:I}),s.onRotateEnded()),s._86O&&(delete s._86O,s.fi({kind:"endEditRotation",event:I}),v.endTransaction()),s._87O&&(delete s._87O,s.fi({kind:"endEditScale",event:I}),v.endTransaction()),s._pinching&&(delete s._pinching,s.fi({kind:"endPinch",event:I}),s.onPinchEnded()),s._rectSelecting&&(delete s._rectSelecting,s.fi({kind:"endRectSelect",event:I}),s.onRectSelectEnded()),s._walking&&(delete s._walking,s.fi({kind:"endWalk",event:I}),s.onWalkEnded()),J.dist=J.point=J._62O=J.p3=J.movedata=J.div=J._57I=J._32Q=J._31Q=J.foward=C}});var Cd=Wn.MapInteractor=function(X){Nm(Cd,this,[X]),this._minPhi=0,this._maxPhi=5*I/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Bk("MapInteractor",Nc,{handle_contextmenu:function(E){Ib(E)},handle_mousewheel:function(l){this.gv.handleScroll(l,l.wheelDelta/40)},handle_DOMMouseScroll:function(H){2===H.axis&&this.gv.handleScroll(H,-H.detail)},handle_keydown:function(x){this.gv.handleKeyDown(x)},handle_mousedown:function(j){this.handle_touchstart(j)},handle_touchstart:function(E){Ib(E);var $=this,K=$.gv;if(K.setFocus(E)){K.lp(E);var g=K.getDataInfoAt(E),H=g?g.data:C,e=g?g.part:C;if(!H||!K.isInteractive(H)){var y=$.editing={point:K.lp(E)};_n?y.touch=!0:(y.touch=!1,y.pan=Pr(E)),qf($,E)}co(E)?K.handleDoubleClick(E,H,e):K.handleClick(E,H,e)}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(){},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(W){var G=this,S=G.gv,i=G.editing;if(i){var P=S.lp(W),g=i.point,x=P.x-g.x,o=P.y-g.y;if(!i.moved){if(Math.abs(x)<G.threshold&&Math.abs(o)<G.threshold&&!(W.touches&&W.touches.length>1))return;i.moved=!0}if(i.point=P,i.touch){var K=W.touches.length;if(2!==K)G.pan(W,x,o);else{if(1>=K)return;var F=W.touches,v={x:F[0].clientX,y:F[0].clientY},E={x:F[1].clientX,y:F[1].clientY},s={x:E.x-v.x,y:E.y-v.y},U=i.lastCenter,l=Math.atan2(s.y,s.x),p=i.theta,j=0;p==C?p=i.theta=l:(j=l-p,i.thetaStarted||Math.abs(j)>G.touchRotateThreshold?(i.thetaStarted=!0,i.theta=l):j=0);var A=I*(v.y+E.y)/2/S.getHeight(),t=i.phi,n=0;t==C?t=i.phi=A:(n=A-t,i.phiStarted||Math.abs(n)>G.touchRotateThreshold?(i.phiStarted=!0,i.phi=A):n=0);var e,B=Math.sqrt(s.x*s.x+s.y*s.y),d=i.vlen;if(d){var O=v.x-U.x,$=v.y-U.y,y=E.x-U.x,Z=E.y-U.y,V=Math.sqrt(O*O+$*$),T=Math.sqrt(y*y+Z*Z),w=d/2,f=G._sign2(V-w),u=G._sign2(T-w);0>f*u||0===f&&0===u?(e=1,i.vlen=B):(e||(e=B/d),i.scaleStarted||Math.abs(e-1)>G.touchScaleThreshold?(i.vlen=B,i.scaleStarted=!0):e=1)}else d=i.vlen=B,e=1;1!==e&&S.setZoom(e),(n||j)&&G.rotate(W,j,-n),i.lastCenter={x:(E.x+v.x)/2,y:(E.y+v.y)/2}}}else if(i.pan)G.pan(W,x,o);else{var c=S.getWidth(),q=S.getHeight();if(!c||!q)return;var Y=-R*x/c,a=-R*o/q;G.rotate(W,Y,a)}}},_sign2:function(f){return Math.abs(f)<this._touchScaleCheckAccuracy?0:f>0?1:-1},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(H){var E=this,l=E.editing;if(E.editing=null,l){var u=E.gv;if(!l.moved&&l.pan){var h=u.getDataAt(H);h?u.sm().setSelection([h]):u.sm().clearSelection()}else u._panning=null,u._rotating=null,u.fi({kind:l.pan?"endPan":"endRotate",event:H})}},pan:function(P,w,x){var _=this,r=_.gv;if(r.isPannable()){var Q=r.getWidth(),Z=r.getHeight();if(Q&&Z){var m=r.getCenterInfo(),V=-w/Q*m.width,R=1*x/Z*m.height;r.fi({kind:r._panning?"betweenPan":"beginPan",event:P}),r._panning=1;var H=_.keepHorizon,q=_.editing.touch;if((q&&P.touches&&P.touches.length>1||!q&&Nh(P))&&(H=!H),!H)return r.pan(V,R);if(V||R){var M=Ei(r),B=[M[0]*V,M[4]*V,M[8]*V],X=[M[1],0,M[9]],b=Math.sqrt(X[0]*X[0]+X[2]*X[2]);b&&(X=[X[0]/b*R,0,X[2]/b*R]);var J=B[0]+X[0],n=B[1]+X[1],o=B[2]+X[2],h=r._center,v=r._eye;h[0]+=J,h[1]+=n,h[2]+=o,v[0]+=J,v[1]+=n,v[2]+=o,r.fp(bh,C,v),r.fp(ne,C,h)}}}},rotate:function(A,Q,n){var h=this,S=h.gv;if(S.isRotatable()){var M=S._center,j=S._eye,Y=Xl(j,M),I=W(c(Y[0]*Y[0]+Y[2]*Y[2]),Y[1]),N=I+n;N=Math.max(h.minPhi,Math.min(h.maxPhi,N)),n=N-I,S.fi({kind:S._rotating?"betweenRotate":"beginRotate",event:A}),S._rotating=1,S.rotate(Q,n)}}}),m.defineProperties(Cd.prototype,{minPhi:{get:function(){return this._minPhi},set:function(H){this._minPhi=H}},maxPhi:{get:function(){return this._maxPhi},set:function(x){this._maxPhi=x}},keepHorizon:{get:function(){return this._keepHorizon},set:function(x){this._keepHorizon=x}},threshold:{get:function(){return this._threshold},set:function(R){this._threshold=R}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(J){this._touchScaleThreshold=J}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(g){this._touchRotateThreshold=g}}});var sm=function(r){this.gv=r};rh(sm,m,{_iv:!0,iv:function(){this._iv=!0},face:function(H,f){var j=this,L=j.gv.getGL();if(!L||!Cp(H))return C;var T=f.x,g=f.width,w=f.height,B=j.height-f.y-w,Q=b(g/2),i=new Uint8Array(4*g*w),u=0;for(j.iv(),j.validate(H),Pn(L,j.frame),L.readPixels(T,B,g,w,L.RGBA,L.UNSIGNED_BYTE,i),Pn(L,C),j.iv();Q>=u;u++)for(var z=Q-u,d=Q+u,A=z;d>=A;A++)for(var I=z;d>=I;I++)if(A===z||A===d||I===z||I===d){var a=qs.m[i[4*(A*g+I)]];if(a)return a}},get:function(E,G){this.validate();var W=this,j=W.gv.getGL();if(!j)return C;var P,q,w=E.x,M=E.width,h=E.height,x=W.height-E.y-h,A=b(M/2),U=new Uint8Array(4*M*h),$=0,d=U.length,N=G?C:new Oh,p=G?C:{};if(Pn(j,W.frame),j.readPixels(w,x,M,h,j.RGBA,j.UNSIGNED_BYTE,U),Pn(j,C),G){for(;A>=$;$++)for(var F=A-$,l=A+$,s=F;l>=s;s++)for(var O=F;l>=O;O++)if((s===F||s===l||O===F||O===l)&&(P=W.info(U,4*(s*M+O))))return P}else for(;d>$;$+=4)P=W.info(U,$),P&&(q=P.data,p[q._id]||(N.add(q),p[q._id]=q));return N},info:function(c,R){return this.colorMap[(c[R]<<16)+(c[R+1]<<8)+c[R+2]+((127&c[R+3])<<24)]},validate:function(S){var j=this,N=j.gv,M=N.getGL();if(M){var L=N.getWidth(),g=N.getHeight(),a=M.RGBA,u=M.TEXTURE_2D,r=M.RENDERBUFFER,d=M.FRAMEBUFFER;j.texture||(j.texture=Oe(M),j.render=M.createRenderbuffer(),j.frame=M.createFramebuffer()),(j.width!==L||j.height!==g)&&(Wj(M,j.texture),M.texImage2D(u,0,a,L,g,0,a,M.UNSIGNED_BYTE,C),he(M,M.TEXTURE_MIN_FILTER,M.LINEAR),M.bindRenderbuffer(r,j.render),M.renderbufferStorage(r,M.DEPTH_COMPONENT16,L,g),Pn(M,j.frame),M.framebufferTexture2D(d,M.COLOR_ATTACHMENT0,u,j.texture,0),M.framebufferRenderbuffer(d,M.DEPTH_ATTACHMENT,r,j.render),Wj(M,C),M.bindRenderbuffer(r,C),Pn(M,C),j.width=L,j.height=g),j._iv&&(j._iv=!1,Pn(M,j.frame),N._42(S||(j.colorMap={}),1),Pn(M,C))}}});var ti=function(s){this.gv=s};rh(ti,m,{gap:0,size:0,_42:function(h,S){var K=this,x=K.gv,n=x._gridGap,T=x._gridSize;if(x._gridVisible){if(K.gap!==n||K.size!==T){for(var f=[],e=x._gridSize/2,Q=n*e,D=0;2*e+1>D;D++){var U=6*D,l=6*(2*e+1)+U;f[U]=-Q,f[U+1]=0,f[U+2]=-Q+D*n,f[U+3]=Q,f[U+4]=0,f[U+5]=-Q+D*n,f[l]=-Q+D*n,f[l+1]=0,f[l+2]=-Q,f[l+3]=-Q+D*n,f[l+4]=0,f[l+5]=Q}K.vs=new me(f),K.gap=n,K.size=T}Pi(x),Rb(h,S),Vi(h),Zq(h,S,1,x._gridColor,x._buffer.vs,K.vs),We(h,0,K.vs.length/3,h.LINES),Bj(h),em(h,S)}else K.vs=K.gap=K.size=C}});var po=function(D){this.gv=D};rh(po,m,{_42:function(L,O){var a=this.gv,s=a._buffer.vs,l=a._axisXColor,q=a._axisYColor,A=a._axisZColor,U=a._originAxisVisible,M=a._centerAxisVisible;if(U||M){var V=d?L.TRIANGLES:L.TRIANGLE_FAN,$=L.LINES;if(Pi(a),Rb(L,O),Vi(L),U){var k=a.getCenterInfo(),K=x(k.width,k.height)/5,e=.8*K,R=.05*K;Zq(L,O,1.5,l,s,new me([0,0,0,K,0,0,e,R,0,e,0,R,e,-R,0,e,0,-R,e,R,0,0,0,0,0,K,0,R,e,0,0,e,R,-R,e,0,0,e,-R,R,e,0,0,0,0,0,0,K,R,0,e,0,R,e,-R,0,e,0,-R,e,R,0,e])),We(L,0,2,$),We(L,1,6,V),Zq(L,O,C,q),We(L,7,2,$),We(L,8,6,V),Zq(L,O,C,A),We(L,14,2,$),We(L,15,6,V)}if(M){var u=a._center,S=u[0],i=u[1],h=u[2],k=a.getPositionInfo(u);K=x(k.width,k.height)/20,Zq(L,O,1.5,l,s,new me([S,i,h,S+K,i,h,S,i,h,S,i+K,h,S,i,h,S,i,h+K])),We(L,0,2,$),Zq(L,O,C,q),We(L,2,2,$),Zq(L,O,C,A),We(L,4,2,$)}Bj(L),em(L,O)}}});var Gm=function(S){this.gv=S},yb="edit_tx",og="edit_ty",is="edit_tz",yf="edit_rx",Ij="edit_ry",yr="edit_rz",ng="edit_sx",aq="edit_sy",hq="edit_sz",No={};No[yb]=1,No[og]=1,No[is]=1,No[yf]=1,No[Ij]=1,No[yr]=1,No[ng]=1,No[aq]=1,No[hq]=1,rh(Gm,m,{_42:function(K,q,O){var c=this,C=c.gv,u=C.sm().ld();if(C.isEditable(u)&&!C.isEditHelperDisabled()&&Cp(u)&&(!C.isFirstPersonMode()||!C.isMouseRoamable()&&!_n)){Pi(C);var l,B,f=C.isMovable(u),y=C.isRotationEditable(u),j=C.isSizeEditable(u),R=C._axisXColor,J=C._axisYColor,U=C._axisZColor,b=C._editSizeColor,Z=u.p3(),L=Xo(C.getEye(),Z)/10,P=L/(O?5:10),E=.7*L,Y=.4*E,x=Z[0],o=Z[1],S=Z[2];l=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],f&&c._17O(K,q,u,O,yb,R,l,[x,o-P,S,x+E,o-P,S,x+E,o,S,x+E,o,S,x,o,S,x,o-P,S,x,o-P,S+P,x+E,o-P,S+P,x+E,o-P,S,x+E,o-P,S,x,o-P,S,x,o-P,S+P]),B=x+E,j&&c._17O(K,q,u,O,ng,b,l,[B,o-P,S,B+Y,o-P,S,B+Y,o,S,B+Y,o,S,B,o,S,B,o-P,S,B,o-P,S+P,B+Y,o-P,S+P,B+Y,o-P,S,B+Y,o-P,S,B,o-P,S,B,o-P,S+P]),B+=Y,y&&c._17O(K,q,u,O,yf,R,l,[B,o-P,S,B+Y,o-P,S,B+Y,o,S,B+Y,o,S,B,o,S,B,o-P,S,B,o-P,S+P,B+Y,o-P,S+P,B+Y,o-P,S,B+Y,o-P,S,B,o-P,S,B,o-P,S+P]),l=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],f&&c._17O(K,q,u,O,og,J,l,[x,o,S,x,o+E,S,x-P,o+E,S,x-P,o+E,S,x-P,o,S,x,o,S,x,o,S,x,o,S-P,x,o+E,S-P,x,o+E,S-P,x,o+E,S,x,o,S]),B=o+E,j&&c._17O(K,q,u,O,aq,b,l,[x,B,S,x,B+Y,S,x-P,B+Y,S,x-P,B+Y,S,x-P,B,S,x,B,S,x,B,S,x,B,S-P,x,B+Y,S-P,x,B+Y,S-P,x,B+Y,S,x,B,S]),B+=Y,y&&c._17O(K,q,u,O,Ij,J,l,[x,B,S,x,B+Y,S,x-P,B+Y,S,x-P,B+Y,S,x-P,B,S,x,B,S,x,B,S,x,B,S-P,x,B+Y,S-P,x,B+Y,S-P,x,B+Y,S,x,B,S]),l=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],f&&c._17O(K,q,u,O,is,U,l,[x,o,S,x,o,S+E,x,o-P,S+E,x,o-P,S+E,x,o-P,S,x,o,S,x,o-P,S,x-P,o-P,S,x-P,o-P,S+E,x-P,o-P,S+E,x,o-P,S+E,x,o-P,S]),B=S+E,j&&c._17O(K,q,u,O,hq,b,l,[x,o,B,x,o,B+Y,x,o-P,B+Y,x,o-P,B+Y,x,o-P,B,x,o,B,x,o-P,B,x-P,o-P,B,x-P,o-P,B+Y,x-P,o-P,B+Y,x,o-P,B+Y,x,o-P,B]),B+=Y,y&&c._17O(K,q,u,O,yr,U,l,[x,o,B,x,o,B+Y,x,o-P,B+Y,x,o-P,B+Y,x,o-P,B,x,o,B,x,o-P,B,x-P,o-P,B,x-P,o-P,B+Y,x-P,o-P,B+Y,x,o-P,B+Y,x,o-P,B])}},_17O:function(e,Y,y,t,G,u,$,j){var Q=this.gv._buffer;pj(e,Y,t,!0,y,G),ce(e,Y,C,!0,C,!0,C,!1),pi(e,Y.uDiffuse,u),qi(e,Q.vs,new me(j),Y.aPosition),qi(e,Q.ns,new me($),Y.aNormal),Vi(e),We(e,0,12),Bj(e),_d(e,Y)}});var uf=u.Raycaster=function(i){this.gv=i};rq("Raycaster",m,{intersect:function(H){var s=this,h=s.gv,C=h.getDataAt(H);return C?s.intersectObject(H,C):null},intersectObjects:function(Q,Z,L){var H,q,j,X,v=this,S=1/0,$=Q.origin||(new cl).fromArray(v.gv.getEye());return Z.forEach(function(h){L&&L(h)===!1||h.s("intersect")!==!1&&(H=v.intersectObject(Q,h),H&&(q=$.distanceToSquared(H.world),S>q&&(j=h,X=H,S=q)))}),{data:j,intersect:X}},intersectObject:function(z,m){if(z instanceof ko)return this._intersectObjectImpl(z,m);var F,G,t=this,N=t.gv;G=N.unproject(z);var $=N.getEye();N.isOrtho()?(F=Xl(N.getCenter(),$),F[0]+=F[0],F[1]+=F[1],F[2]+=F[2]):F=$,F=new cl(F);var n=new cl(G).sub(F).normalize(),H=new u.Math.Ray(F,n);return t._intersectObjectImpl(H,m)},_intersectObjectImpl:function(){function w(){var I=new cl;return I.subVectors(V,m),G.subVectors(t,m),I.cross(G).normalize(),I}function M(c,X,a,x,m,j,_){return wn.barycoordFromPoint(c,X,a,x,S),m.multiplyScalar(S.x),j.multiplyScalar(S.y),_.multiplyScalar(S.z),m.add(j).add(_),m.clone()}var r=new Bq,n=new Bq,j=new ko,q=new cl,d=new cl,I=new cl,Y=new cl,F=new cl,t=new cl,m=new cl,V=new cl,J=new xh,s=new xh,W=new xh,G=new cl,$={vs:Yd,is:kr,uv:qc},S=new cl;return function(k,O){var C=this.gv.getData3dUI(O),y=O.mat||C.mat;if(y){r.fromArray(y),n.getInverse(r),j.copy(k).applyMatrix4(n);var L,g,R="body",l=C.shapeModel;if(l||(l=Rg(C)),l||(O instanceof u.Node&&!(O instanceof u.Shape)?(L=!0,l=$):(g=!0,l=[C.left,C.front,C.right,C.back,C.top,C.bottom])),!l)return console.log("Can not find shape model."),null;ij(l)||(l=[l]);var o,f,c,P,T,B,U,e,v,A,z,S,D,b,h=1/0,K=["","top_","bottom_"],H=!1;for(o=0,f=l.length;f>o;o++)if(S=l[o])for(c=0,P=K.length;P>c;c++)if(D=K[c],U=S[D+"vs"],e=S[D+"is"],v=S[D+"uv"]||S[D+"tuv"],U){if(b=S[D+"boundingBox"]){if(!j.intersectBox(b))continue}else S[D+"boundingBox"]=b=new u.Math.Box3;for(T=0,B=e?e.length:U.length/3;B>T;T+=3)e?(d.fromArray(U,3*e[T]),I.fromArray(U,3*e[T+1]),Y.fromArray(U,3*e[T+2])):(d.fromArray(U,3*T),I.fromArray(U,3*(T+1)),Y.fromArray(U,3*(T+2))),b.expandByPoint(d),b.expandByPoint(I),b.expandByPoint(Y),A=j.intersectTriangle(d,I,Y,!1,q),A&&(z=j.origin.distanceTo(A),h>z&&(h=z,F.copy(A),t.copy(d),m.copy(I),V.copy(Y),""!==D?R=D.slice(0,-1):L?R=$o[Math.floor(T/6)]:g&&(R=$o[o]),v&&(H=!0,e?(J.fromArray(v,2*e[T]),s.fromArray(v,2*e[T+1]),W.fromArray(v,2*e[T+2])):(J.fromArray(v,2*T),s.fromArray(v,2*(T+1)),W.fromArray(v,2*(T+2))))))
}if(!isFinite(h))return null;var Q,N=F.clone().applyMatrix4(r);H&&(Q=M(F,t,m,V,J,s,W));var a=w(t,m,V),X=w(t.applyMatrix4(r),m.applyMatrix4(r),V.applyMatrix4(r)),p=j.direction.dot(a);return p>0&&(a.multiplyScalar(-1),X.multiplyScalar(-1)),{world:N,local:F.clone(),worldNormal:X,normal:a,uv:Q,part:R}}}}()});var jg=function(s,j){this.gv=s,this.s=function(k,h,A){return h==C&&(h=A),h==C?j.getStyle(k):Gb(h,j,s)},this.data=j};rh(jg,m,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(u,A,h,B){var J=this,T=J.data;if(!(T instanceof vi)){var i,V,o,Q,s,n,L,b=J.gv,m=T._id,w=J.s("shape3d.alwaysOnTop")?null:J.s("batch"),d=b._batchIndexMap,k=b._batchModelMap,l=b.isSelectable(T),X=b.getBrightness(T),W=X!=C&&1!==X;if(J.needValidate(u)){if(o=Xq(d,k,T,w),J.validate(o,w?He[w]||Vf:C),o&&(Q=d[m],s=Q.size=o.vs.length/3-Q.begin,L=o.rs))for(X=W?X:1,n=0;s>n;n++)L.push(X);if(Cp(T)){var p=b.getWireframeGeometry(T);if(p)Pd(b,T,p);else{var H=b.getWireframe(T);H&&Pd(b,T,H)}}J.labelInfo=J.label2Info=J.noteInfo=J.note2Info=J._38o=C,J._24O(Xh,"getLabel"),J._24O(be,"getLabel2"),J._26O(Qb,"getNote"),J._26O(kb,"getNote2"),J._15O(),J.interactiveInfo=b.isInteractive(T)?{}:C,J._iv=!1}W&&pi(u,A.uBrightness,X),pi(u,A.uAlphaTest,J.s("alphaTest")),V=pj(u,A,h,l,T,zc),V&&(Op(V,d[m],k),Op(V,b._polylineIndexMap[m],b._polylineModelMap),Op(V,b._wireframeIndexMap[m],b._wireframeModelMap)),d[m]||J._80o(u,A,B),b.isLabelVisible(T)&&((i=J.labelInfo)&&(pj(u,A,h,l,T,Xh),J._28O(i,Xh,B)),(i=J.label2Info)&&(pj(u,A,h,l,T,be),J._28O(i,be,B))),b.isNoteVisible(T)&&((i=J.noteInfo)&&(pj(u,A,h,l,T,Qb),J._29O(i,Qb,B)),(i=J.note2Info)&&(pj(u,A,h,l,T,kb),J._29O(i,kb,B))),(i=J._38o)&&J._99O(u,A,i,h,l,B),W&&pi(u,A.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ni},_80o:function(){},dispose:function(){},_calcAnchorMat:function(r){if(r.hasOwnProperty("_anchor")||r.hasOwnProperty("_anchorElevation")){var N=r.getAnchor3d(),B={x:N.x-.5,y:N.y-.5,z:N.z-.5},U=mb();return fb(U,[-B.x,-B.y,-B.z]),U}},getBodyColor:function(n){var A=this.data,Z=this.gv.getBodyColor(A);return Z?Z:n?A.getStyle(n):C},_24O:function(l,z){var Y=this,O=Y.data,N=Y.gv,M=Y.s,J=N[z](O);if(J!=C){var i=M(l+".scale"),n=M(l+".max"),v=Y[l+"Info"]={label:J,textureScale:M(l+".texture.scale"),color:N[z+"Color"](O),font:M(l+".font"),align:M(l+".align"),background:N[z+"Background"](O)},V=v.rect=Uf(v,J);n>0&&n<V.width&&(v.labelWidth=V.width,V.width=n),V.x=V.y=0,V.width*=i,V.height*=i,v.mat=Y._16O(M(l+".autorotate"),M(l+".position"),V,M(l+".face"),M(l+".t3"),M(l+".r3"),M(l+".rotationMode"));var R=V.width/2,s=V.height/2;v.vs=new me([-R,s,0,-R,-s,0,R,-s,0,R,s,0]),V.width/=i,V.height/=i}},_26O:function(S,W){var z=this,I=z.data,n=z.gv,$=z.s,c=n[W](I);if(c!=C){var g=$(S+".scale"),P=this[S+"Info"]={note:c,textureScale:$(S+".texture.scale"),expanded:$(S+".expanded"),font:$(S+".font"),color:$(S+".color"),align:$(S+".align"),borderWidth:$(S+".border.width"),borderColor:$(S+".border.color"),background:n[W+"Background"](I)};if(P.expanded){var X=$(S+".max"),V=Uf(P,c);V.width+=6,V.height+=2,X>0&&X<V.width&&(P.labelWidth=V.width,V.width=X);var K={x:-V.width/2,y:-8-V.height,width:V.width,height:V.height+8}}else K={x:-6,y:-18,width:12,height:18};P.mat=z._16O($(S+".autorotate"),$(S+".position"),C,$(S+".face"),$(S+".t3"),$(S+".r3"),$(S+".rotationMode")),P.rect=K,1!==g&&(K=Io(K),K.x*=g,K.height*=g,K.y=-K.height,K.width*=g);var y=K.x,x=K.y,h=K.width,Y=K.height;P.vs=new me([y,-x,0,y,-x-Y,0,y+h,-x-Y,0,y+h,-x,0])}},_28O:function(T,j,I){if(I(this.s(j+".transparent"))){var P=T.rect,w=T.textureScale,q=P.width*w,X=P.height*w;if(q>=1&&X>=1){var $=kg(q,X);1!==w&&($.translate($,P.x,P.y),$.scale(w,w),$.translate($,-P.x,-P.y)),mj($,T),$.restore(),Ec(this,j,T.mat,T.vs,!0)}}},_29O:function(G,D,P){if(P(this.s(D+".transparent"))){var v=G.rect,u=G.textureScale,n=v.x,Q=v.y,O=v.width*u,$=v.height*u;if(O>=1&&$>=1){v.x=v.y=0;var C=kg(O,$);1!==u&&C.scale(u,u),_c(C,G),C.restore(),v.x=n,v.y=Q,Ec(this,D,G.mat,G.vs,!1)}}},_99O:function(r,p,G,s,a,l){if(G){var O=this,n=O.gv,W=O.data,D=n._buffer,T=n._1O,S=G.icons;for(var K in S){var J=S[K],I=G.rects[K];if(I&&l(Gb(J.transparent,W,n))){pj(r,p,s,a,W,K);var Z=Gb(J.shape3d,W,n),P=Z?[Z]:Gb(J.names,W,n),g=P?P.length:0,v=Gb(J.textureScale,W,n)||1,y=Gb(J.light,W,n);y==C&&(y=Z?!0:!1),ce(r,p,Gb(J.blend,W,n),y,Gb(J.opacity,W,n),Gb(J.reverseFlip,W,n),Gb(J.reverseColor,W,n),Gb(J.reverseCull,W,n));for(var i=0;g>i;i++){var z=P[i],Q=I[i];if(vk(O,Q.mat),Z)es(n,W,Rg(O,Z),O);else{var $=Sg(z);if($){var q=Q.width*v,w=Q.height*v;if(q>=1&&w>=1){var N=kg(q,w);_e(N,$,Gb(J.stretch,W,n),0,0,q,w,W,n),N.restore(),Oe(r,tf,T),Vi(r,p,T,Gb(J.discardSelectable,W,n),D.uv,nm),qi(r,D.vs,Q.vs,p.aPosition),$m(r,D.ns,Hg,p.aNormal),zs(r,D.is,zq),_k(r,0,zq.length),Bj(r,p,T)}}}tp(n)}_d(r,p)}}}}});var Yh=function(F,y){Nm(Yh,this,[F,y])};rh(Yh,jg,{_16O:function(S,p,B,H,G,W,x,E,Z){var Y=this.data,A=Y.getFinalScale3d(),O=il(p,A,B,H,E,Z);if(Y.hasOwnProperty("_anchor")||Y.hasOwnProperty("_anchorElevation")){var r=Y.getAnchor3d();O[0]-=(r.x-.5)*A[0],O[1]-=(r.y-.5)*A[1],O[2]-=(r.z-.5)*A[2]}return vf(mb(),O,Y.p3(),H,G,W,x,S,Y.getFinalRotation3d(),Y.getRotationMode())},clear:function(){var k=this;k.faceMat=k.mat=k.shapeModel=k.left=k.right=k.front=k.back=k.top=k.bottom=k.csg=C},needValidate:function(k){if(this._iv)return this._validateFrameId=k._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var Q=k._renderInfo.frame;if(this._validateFrameId!==Q)return this._validateFrameId=Q,!0}return!1},validate:function(f,z){var a=this,n=a.gv,e=a.data,u=Rg(a);a._updateAutoRotation(),a._updateFixSize2d(),a._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ji(n,e,"_wireframeModelMap","_wireframeIndexMap"),Ji(n,e,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var X=yk(e,n.getMat(e),u?a.s("shape3d.scaleable"):!0),c=a._calcAnchorMat(e);if(c&&zh(X,X,c),e.mat=X,a.clear(),f){var d=[];u?si(n,e,u,a,a.getBodyColor(),[X],f,d):(hf(n,e,f,z,X,en,d,Wq),hf(n,e,f,z,X,lg,d,Kd),hf(n,e,f,z,X,al,d,yg),hf(n,e,f,z,X,rb,d,Rd),hf(n,e,f,z,X,Nb,d,Oc),hf(n,e,f,z,X,Eg,d,lm)),d.length&&(km(f.vs,d),km(f.ns,uj(d)))}else a.mat=X,(a.shapeModel=u)||(a._cubeUvs=null,a.vf(en,0),a.vf(lg,16),a.vf(Nb,8),a.vf(Eg,24),a.vf(al,32),a.vf(rb,40))},_updateAutoRotation:function(){var Z=new Pj;return function(){var N=this,E=N.data,A=N.s("shape3d.autorotate");if(!A)return E._dynamicRotation&&delete E._dynamicRotation,void 0;var U,X=N.gv;U="string"==typeof A?[A.indexOf("x")<0?X._eye[0]:X._center[0],A.indexOf("y")<0?X._eye[1]:X._center[1],A.indexOf("z")<0?X._eye[2]:X._center[2]]:X._eye;var V=X._center,M=E.p3(),k=Zg([M[0]+U[0]-V[0],M[1]+U[1]-V[1],M[2]+U[2]-V[2]],M,X._up),l=E.r3();Z.set(0,0,0,E.getRotationMode(),!0).setFromRotationMatrix(k),Math.abs(l[0]-Z.x)<1e-5&&Math.abs(l[1]-Z.y)<1e-5&&Math.abs(l[2]-Z.z)<1e-5||(E._dynamicRotation=[Z.x,Z.y,Z.z])}}(),_updateFixSize2d:function(){var s=this,i=s.data,l=s.s("shape3d.fixSizeOnScreen");if(!l)return i._dynamicScale3d&&delete i._dynamicScale3d,void 0;var c=s.gv;i.getFinalScale3d();var o=yk(i,c.getMat(i)),j=mg([0,0,0],o),M=c.toViewPosition(j);if(!isNaN(M.x)&&!isNaN(M.y)){var y=mg([1,0,0],o),G=c.toViewPosition(y),d=mg([0,1,0],o),J=c.toViewPosition(d),b=G.x-M.x,r=J.y-M.y,p=i._dynamicScale3d||[1,1,1],f=Sg(i.s("shape3d.image")),x=l[0]>0?l[0]:f?Ml(f,s):20,O=l[1]>0?l[1]:f?Zj(f,s):20,T=Math.abs(b/x),X=Math.abs(r/O);Math.abs(T-1)<.001&&Math.abs(X-1)<.001||(i._dynamicScale3d=[p[0]/T,p[1]/X,p[2]])}},_updateOverlapping:function(){var e=this,k=e.s("hide.overlapping.group");if(!k)return e._rectOverlapping&&(e._rectOverlapping=r),void 0;var C,f,T,g=e.gv,P=e.data,c=yk(P,g.getMat(P)),$=1/0,y=1/0,q=-1/0,x=-1/0,Y=P.getAnchor3d(),a=Y.x,B=Y.y,E=Y.z;for(C=0;8>C;C++){if(f=mg([(C>>2)-a,(1&C>>1)-B,(1&C)-E],c),T=g.toViewPosition(f),isNaN(T.x)||isNaN(T.y))return;$=Math.min($,T.x),q=Math.max(q,T.x),y=Math.min(y,T.y),x=Math.max(x,T.y)}var Q={x:$,y:y,w:q-$,h:x-y};e._rectOverlapping=g.overlappingBox.isOverlapping(k,Q)},getVectorDynamicSize:function(){var I,e=this,F=e.s("shape3d"),g=e.data;if("billboard"===F||"plane"===F||(I=g._currentCubeElementId)!=C){var S,v,G=e.gv,L=yk(g,G.getMat(g)),r=function(c,t){var N=G.toViewPosition(mg(c,L)),H=G.toViewPosition(mg(t,L)),r=N.x-H.x,u=N.y-H.y;return Math.min(2048,Math.sqrt(r*r+u*u))};if("billboard"===F)S=r([-.5,0,0],[.5,0,0]),v=r([0,-.5,0],[0,.5,0]);else if("plane"===F)S=r([-.5,0,0],[.5,0,0]),v=r([0,0,-.5],[0,0,.5]);else if(g._currentCubeElementId!=C){var y=3*kr[I+1],p=3*kr[I],m=3*kr[I+2];S=r([Yd[y],Yd[y+1],Yd[y+2]],[Yd[m],Yd[m+1],Yd[m+2]]),v=r([Yd[y],Yd[y+1],Yd[y+2]],[Yd[p],Yd[p+1],Yd[p+2]])}return[S,v]}},getCachedTexture:function(){var W=this,e=W.data,v=e._currentCubeElementId;return v!=C?W._cubeCachedImage?W._cubeCachedImage[v]:null:W._shape3dCachedImage},setCachedTexture:function(T){var M=this,W=M.data,I=W._currentCubeElementId;if(I!=C){if(!M._cubeCachedImage)return M._cubeCachedImage={};M._cubeCachedImage[I]=T}else M._shape3dCachedImage=T},invalidateCachedTexture:function(N){var v,w,U,V=this;if((U=V._shape3dCachedImage)&&(N.deleteTexture(U),V._shape3dCachedImage=null),w=V._cubeCachedImage){for(v in w)N.deleteTexture(w[v]);V._cubeCachedImage=null}},vf:function(L,v){var w=this;if(w.gv.getFaceVisible(w.data,L)){var X=no(w,L);X.mat&&(w.faceMat=!0);var p=X.uv;if(p){var k=w._cubeUvs;k||(k=w._cubeUvs=new me([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var B=0;8>B;B++)k[v+B]=p[B]}return X}},_80o:function(q,L,T){var w=this;if(w._rectOverlapping)return!0;var S=w.gv,d=w.data,b=S._cube,j=w.shapeModel;Pi(S,w.mat),j?es(S,d,j,w,w.getBodyColor(),T):(qi(q,b.vs,C,L.aPosition),qi(q,b.ns,C,L.aNormal),To(q,b.is),w._18O(q,L,w.left,0,T),w._18O(q,L,w.front,6,T),w._18O(q,L,w.right,12,T),w._18O(q,L,w.back,18,T),w._18O(q,L,w.top,24,T),w._18O(q,L,w.bottom,30,T)),tp(S),w.faceMat&&(w._18O(q,L,w.left,0,T,!0),w._18O(q,L,w.front,6,T,!0),w._18O(q,L,w.right,12,T,!0),w._18O(q,L,w.back,18,T,!0),w._18O(q,L,w.top,24,T,!0),w._18O(q,L,w.bottom,30,T,!0))},_18O:function(Q,i,L,p,E,s){if(L){if(!E(L.transparent))return;if(s&&!L.mat||!s&&L.mat)return;s&&Pi(this.gv,L.mat);var o=this,v=o.data;v._currentCubeElementId=p;var P=o.gv,n=P.getTexture(L.texture,v),j=L.uv,B=L.uvScale,V=L.uvOffset,F=L.discardSelectable;n?j?Vi(Q,i,n,F,P._buffer.uv,o._cubeUvs,V,B):Vi(Q,i,n,F,P._cube.uv,C,V,B):Vi(Q),ce(Q,i,L.blend,L.light,L.opacity,L.reverseFlip,L.reverseColor,L.reverseCull),pi(Q,i.uDiffuse,L.color),_k(Q,p,6),_d(Q,i),Bj(Q,i,n),s&&tp(P),v._currentCubeElementId=null}}});var ek=function($,j){Nm(ek,this,[$,j])};rh(ek,jg,{_25Q:1,validate:function(M){var l=this,L=l.gv,t=l.data,Y=l.s,N=Y("edge.width"),z=t._40I,j=t._41I;if(l.shapeModel=l.info=C,z&&j){var y,H,f,D,k,o,I,m,Q,h,Z=t.isLooped(),p=Y(yq),F=v.getEdgeType(p);if(F){var B=F(t,ir(l,L,t,Z,p),L,l._19Q);if(!B.points||B.points.isEmpty())return;o=l.info={},I=B.segments,k=B.points,m=k.size();for(var q=z.getElevation(),w=j.getElevation(),i=0;m>i;i++){var G=k.get(i);G.e==C&&(G.e=q+(w-q)*i/(m-1))}Q=Vd(k.get(0)),h=Vd(k.get(m-1));var X=m%2;0===X?(o.c1=Vd(k.get(m/2-1)),o.c2=Vd(k.get(m/2))):o.p3=Vd(k.get((m-X)/2)),o.s1=Q,o.s2=Vd(k.get(1)),o.t1=Vd(k.get(m-2)),o.t2=h}else{k=new Oh,o=l.info={};var e=Y("edge.offset"),a=Y("edge.center"),K=Y("edge.source.t3"),d=Y("edge.target.t3"),u=z.p3(),T=j.p3();if(K&&(u[0]+=K[0],u[1]+=K[1],u[2]+=K[2]),d&&(T[0]+=d[0],T[1]+=d[1],T[2]+=d[2]),p===lk){I=Y("edge.segments");var V=o.points=Y(Am)||ac;if(m=V.size()){Q=Vd(V.get(0)),h=Vd(V.get(m-1)),!a&&e&&(f=Xl(Q,u,!0),e=x(e,Xo(u,Q)),u=[u[0]+f[0]*e,u[1]+f[1]*e,u[2]+f[2]*e],f=Xl(T,h,!0),e=x(e,Xo(h,T)),T=[T[0]-f[0]*e,T[1]-f[1]*e,T[2]-f[2]*e]);var X=m%2;0===X?(y=Vd(V.get(m/2-1)),H=Vd(V.get(m/2))):o.p3=Vd(V.get((m-X)/2)),o.s1=u,o.s2=Q,o.t1=h,o.t2=T}else!a&&e&&(f=Xl(T,u,!0),D=Xo(u,T),e=dr(e,D),u=[u[0]+f[0]*e,u[1]+f[1]*e,u[2]+f[2]*e],T=[T[0]-f[0]*e,T[1]-f[1]*e,T[2]-f[2]*e]),y=u,H=T;k.add({x:u[0],y:u[2],e:u[1]}),k.addAll(V),k.add({x:T[0],y:T[2],e:T[1]})}else{var g=ir(l,L,t,Z,p);if(l._19Q||(g=-g),Z){var R=u[0],U=u[1],A=u[2],n=z.getTall()/2+g;y=[R-g,U+n,A],H=[R+g,U+n,A],k.add({x:R-g,y:A,e:U}),k.add({x:R-g,y:A,e:U+n}),k.add({x:R+g,y:A,e:U+n}),k.add({x:R+g,y:A,e:U})}else{f=Xl(T,u,!0),D=Xo(u,T);var W={x:u[0],y:u[2]},E={x:T[0],y:T[2]},S=Bg(C,W,E,g),P=S.x-W.x,J=S.y-W.y;e=dr(e,D),f[0]*=e,f[1]*=e,f[2]*=e,y=[u[0]+f[0]+P,u[1]+f[1],u[2]+f[2]+J],H=[T[0]-f[0]+P,T[1]-f[1],T[2]-f[2]+J],a?(k.add({x:u[0],y:u[2],e:u[1]}),k.add({x:y[0],y:y[2],e:y[1]}),k.add({x:H[0],y:H[2],e:H[1]}),k.add({x:T[0],y:T[2],e:T[1]})):(k.add({x:y[0],y:y[2],e:y[1]}),k.add({x:H[0],y:H[2],e:H[1]}))}}o.c1=y,o.c2=H}o.list=Y(ts)===bo?l.createTubeModel(k,I,N/2,M):l.createLineModel(k,I,N,"edge","edge.dash")}}});var Ni=function(O,b){Nm(Ni,this,[O,b])};rh(Ni,Yh,{_80o:function(Q,n,z){var A=this,a=A.gv,H=A.shapeModel;Pi(a,A.mat),H?es(a,A.data,H,A,A.getBodyColor(),z):(Ug(A,Q,n,A.left,z),Ug(A,Q,n,A.front,z),Ug(A,Q,n,A.right,z),Ug(A,Q,n,A.back,z),Ug(A,Q,n,A.top,z),Ug(A,Q,n,A.bottom,z)),tp(a)},validate:function(E,e){var A,U,u=this,$=u.s,b=u.data,w=b.p3(),K=b._thickness/2,B=b.isClosePath(),z=b.getPoints(),J=b.getSegments(),H=$(pk),V=E&&E.uv;if(u.clear(),0>K)U=u.shapeModel=_m(z,J,$(te),$(Fm),H,$(Rj),b.getTall(),b.getShapeElevation(),B),$(Zd)?$("shape3d.image")||delete U.uv:(delete U.vs,delete U.ns,delete U.uv),$("shape3d.top.image")||delete U.top_uv,$("shape3d.bottom.image")||delete U.bottom_uv;else if($(ts)===bo)A=kk(z,J,H,B),U=u.shapeModel={vs:[]},$("shape3d.image")&&(U.uv=[],U.sum=$(Rj)||Cl(A)||1,U.len=0),$(te)&&!B&&(U.top_vs=[],$("shape3d.top.image")&&(U.top_uv=[])),$(Fm)&&!B&&(U.bottom_vs=[],$("shape3d.bottom.image")&&(U.bottom_uv=[])),u._12O(A,K);else{var t,f,N,q,O,h,o,L,G,W;if(A=kk(z,J,H,B),O=u.vf(Nb,V,!1,e),K&&(h=u.vf(Eg,V,!1,e),o=B?C:u.vf(en,V,!1,e),L=B?C:u.vf(lg,V,!1,e),G=u.vf(al,V,!1,e),W=u.vf(rb,V,!1,e)),K){for(var c=0,Z=A.length;Z>c;c++)A[c]=u._tryRemoveBezierPoints(A[c],K);u._12O(A,K)}else O&&A.forEach(function(c){if(q=c.length,q>0)for(t=c[0],N=1;q>N;N++)f=c[N],u.addV(O.vs,t,f),t=f});u._20Q(A),E||(O&&(O.ns=uj(O.vs),Km(O,"vs"),Km(O,_f)),K&&(h&&(h.ns=uj(h.vs),Km(h,"vs"),Km(h,_f)),o&&(o.ns=uj(o.vs),Km(o,"vs"),Km(o,_f)),L&&(L.ns=uj(L.vs),Km(L,"vs"),Km(L,_f)),G&&(G.ns=uj(G.vs),Km(G,"vs"),Km(G,_f)),W&&(W.ns=uj(W.vs),Km(W,"vs"),Km(W,_f))))}var X=u.mat=mb();fb(X,w),El(X,b.getFinalRotation3d(),b.getRotationMode());var Q=b.getScale3d(),n=b._dynamicScale3d;n&&(Q[0]*=n[0],Q[1]*=n[1],Q[2]*=n[2]),Gn(X,Q),fb(X,Po(w)),E&&(Ff(u,X,E,U),u.clear())},_20Q:function(r){var w,K,f,l,P,j,h,I=this,E=I.front,F=I.back,N=I.top,T=I.bottom,k=E?E.tuv:C,A=F?F.tuv:C,J=N?N.tuv:C,o=T?T.tuv:C,n=0;(k||A||J||o)&&(w=I.s(Rj)||Cl(r)||1,r.forEach(function(Z){if(K=Z.length,K>0)for(j=Z[0],f=1;K>f;f++)h=Z[f],l=n/w,n+=Xo(j,h),P=n/w,I._14O(E,l,P),I._14O(F,1-P,1-l),I._14O(N,l,P),I._14O(T,l,P),j=h}))},_14O:function(b,P,J){if(b){var $=b.uv,B=b.tuv;if(B){if($)var G=$[0]+($[6]-$[0])*P,r=$[1]+($[7]-$[1])*P,N=$[2]+($[4]-$[2])*P,v=$[3]+($[5]-$[3])*P,d=$[2]+($[4]-$[2])*J,F=$[3]+($[5]-$[3])*J,w=$[0]+($[6]-$[0])*J,R=$[1]+($[7]-$[1])*J;else G=P,r=0,N=P,v=1,d=J,F=1,w=J,R=0;B.push(N,v,d,F,w,R,w,R,G,r,N,v)}}},_13O:function(Z){var O=Z.uv,y=Z.tuv;y&&(O?y.push(O[2],O[3],O[4],O[5],O[6],O[7],O[6],O[7],O[0],O[1],O[2],O[3]):y.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(W,A){var s=W.length;if(4>s)return W;var X,d,c,D,u,w,S=!1,H=function(X){return W[X]},C=function(B){return W[s-1-B]};for(u=0;1>=u;u++)for(w=u?C:H,d=w(0),c=w(1),X=2;s-1>X;X++)if(D=w(X),!D.remove)if(D.b){var B=Bg(d,c,D,A);B.adjust?(D.remove=!0,S=!0):(d=c,c=D)}else d=c,c=D;if(!S)return W;var M=[];for(X=0;s>X;X++)W[X].remove||M.push(W[X]);return M},_12O:function(F,R){var h,j,o,I,H,$=this;F.forEach(function(t){if(H=t.length,H>0)for(h={p:t[0],n:!0},I=1;H>I;I++)j=t[I],o=H-1>I?t[I+1]:C,$.addPoint(h,j,o,R,t)})},addPoint:function(W,x,Q,t,T){var q,Z,E,s,K,S,f,l,h,d=this,p=W.p,P=W.f,u=W.b,e=d.s("shape3d.side")||Ue,V=d.s("shape3d.start.angle"),R=d.s("shape3d.sweep.angle"),Y=d.shapeModel,N=d.data.isClosePath();if(W.n&&(W.n=!1,P=N&&T.length>2?Bg(T[T.length-2],p,x,t):Bg(C,p,x,t),u=nd(p,P),Y?Y.top_vs&&d._10O(u,P,e,V,R,Y.top_vs,Y.top_uv):(q=d.left)&&(d.addV(q.vs,u,P),d._13O(q))),Z=Q?Bg(p,x,Q,t):N&&T.length>2?Bg(p,x,T[1],t):Bg(p,x,C,t),E=nd(x,Z),Y){var k,I,o=Y.vs,G=Y.uv,v=Y.sum;for(G&&(k=Y.len/v,Y.len+=Xo(p,x),I=Y.len/v),S=d._9O(u,P,e,V,R),f=d._9O(E,Z,e,V,R),l=0;e>l;l++)h=l+1,km(o,S[h]),km(o,f[l]),km(o,S[l]),km(o,f[l]),km(o,S[h]),km(o,f[h]),G&&(s=l/e,K=h/e,G.push(k,K,I,s,k,s,I,s,k,K,I,K));!Q&&Y.bottom_vs&&d._10O(E,Z,e,V,R,Y.bottom_vs,Y.bottom_uv,!0)}else!Q&&(q=d.right)&&(d.addV(q.vs,Z,E),d._13O(q)),(q=d.front)&&d.addV(q.vs,P,Z),(q=d.back)&&d.addV(q.vs,E,u),(q=d.top)&&d.addH(q.vs,P,Z,E,u,!0),(q=d.bottom)&&d.addH(q.vs,u,E,Z,P);W.p=x,W.f=Z,W.b=E},_10O:function(a,z,G,X,U,Z,u,x){var k,P,H=this,J=H.data,_=H._9O(a,z,G,X,U),A=(a.x+z.x)/2,D=(a.y+z.y)/2,e=J.getShapeElevation(),o=0;for(o=0;G>o;o++)x?(km(Z,_[o]),km(Z,_[o+1])):(km(Z,_[o+1]),km(Z,_[o])),km(Z,[A,e,D]),u&&(x?(k=R*(o+1)/G+X,P=R*o/G+X):(k=R*o/G+X,P=R*(o+1)/G+X),u.push(.5-.5*h(P),.5-.5*Q(P),.5-.5*h(k),.5-.5*Q(k),.5,.5))},_9O:function(K,A,N,e,V){var x,y,W=this,l=W.data,S=[],U=(K.x+A.x)/2,_=(K.y+A.y)/2,O=l.getTall()/2,Z=l.getShapeElevation(),r=0;for(V=V||R;N>=r;r++)x=V*r/N+e,y=h(x),S.push([U+(K.x-U)*y,Z+O*Q(x),_+(K.y-_)*y]);return S},addV:function(C,W,J){var j=W.x,A=W.y,h=J.x,t=J.y,a=this.data,o=a.getShapeElevation(),H=a.getTall()/2;C.push(j,o-H,A,h,o-H,t,h,o+H,t,h,o+H,t,j,o+H,A,j,o-H,A)},addH:function(y,F,T,u,m,x){var g=this.data,z=g.getTall()/2,N=g.getShapeElevation()+(x?z:-z);y.push(F.x,N,F.y,T.x,N,T.y,u.x,N,u.y,u.x,N,u.y,m.x,N,m.y,F.x,N,F.y)},vf:function(B,G,z,U){var o,T=this,X=T.gv.getFaceVisible(T.data,B);return(z||X)&&(o=no(T,B,U),o.vs=[],o.tuv=X&&(o.texture||G)?[]:C,o.visible=X),o}});var Gh=function(b,d){Nm(Gh,this,[b,d])};rh(Gh,jg,{_25Q:1,validate:function(D){var g=this,h=g.data,L=g.s,H=h.getPoints(),q=H.size();if(g.shapeModel=g.info=C,q>1){var t=g.info={},M=h.getSegments(),W=h.getThickness(),E=Vd(H.get(0)),R=Vd(H.get(q-1)),d=q%2;0===d?(t.c1=Vd(H.get(q/2-1)),t.c2=Vd(H.get(q/2))):t.p3=Vd(H.get((q-d)/2)),t.s1=E,t.s2=Vd(H.get(1)),t.t1=Vd(H.get(q-2)),t.t2=R,t.list=L(ts)===bo?g.createTubeModel(H,M,W/2,D):g.createLineModel(H,M,W,"shape.border","shape.dash")}var Y=h.p3(),s=g.mat=mb();fb(s,Y),El(s,h.getFinalRotation3d(),h.getRotationMode());var N=h.getScale3d(),k=h._dynamicScale3d;k&&(N[0]*=k[0],N[1]*=k[1],N[2]*=k[2]),Gn(s,N),fb(s,Po(Y))},_80o:function(Y,a,P){var Q=this,X=Q.shapeModel;if(X){var L=Q.gv;Pi(L,Q.mat),es(L,Q.data,X,Q,Q.getBodyColor(),P),tp(L)}}});var Eb=u.graph3d.VR=function(w){var D=this;D.gv=w,D._controllers=[],D.switch=new Zi(D),D._enable=!1,D._defaultCallLater=u.Default.callLater,"undefined"!=typeof N&&"VRFrameData"in N&&(D._frameData=new N.VRFrameData),D.measureOflength=1,D.eyesOffset=[0,0,0],D._orientation=new u.Math.Quaternion,D._lastHeadPose=[0,0,0],D._offsetToBeAdd=[0,0,0]};rh(Eb,m,{ms_fire:!0,_42:function(k,d,r,j){var h=this,m=h.gv;if(h._deviceInAction){var t=h._device;if(t){var Z=h._measureOflength;t.depthNear=m.getNear()*Z,t.depthFar=m.getFar()*Z;var c=h._offsetToBeAdd;if(h.eyesOffset[0]+=c[0],h.eyesOffset[1]+=c[1],h.eyesOffset[2]+=c[2],c[0]=0,c[1]=0,c[2]=0,t.isPresenting===!1)return h._controllers.forEach(function(b){b&&b.update()}),m.iv(),!1;var v=h._frameData;t.getFrameData(v);var B=v.pose.position;return B&&(m.setEye(h.toViewPosition(B)),h._orientation.fromArray(v.pose.orientation)),h._controllers.forEach(function(R){R&&R.update()}),k.viewport(0,0,d/2,r),h._viewMatrix=h._copyViewMatrix(v.leftViewMatrix),h._projectMatrix=h._copyProjectMatrix(v.leftProjectionMatrix),j(),k.viewport(d/2,0,d/2,r),h._viewMatrix=h._copyViewMatrix(v.rightViewMatrix),h._projectMatrix=h._copyProjectMatrix(v.rightProjectionMatrix),j(),h._lastViewMatrix=h._viewMatrix,h._lastProjectMatrix=h._projectMatrix,h._viewMatrix=null,h._projectMatrix=null,h.submitFrame(),!0}}},onVRDisplayPresentChange:function(){var D=this.isPresenting();this._injectGraphView(D),this.fp("present",!D,D)},getOrientation:function(){return this._orientation},addController:function(t){t=t||0;var x=this,P=x.getController(t);return P?P:(P=new Tr(x,t),x._controllers.push(P),P)},getController:function(P){P=P||0;for(var L=this._controllers,x=0,f=L.length;f>x;x++)if(L[x]&&L[x].id===P)return L[x];return null},removeController:function(J){J=J||0;for(var u=this._controllers,h=0,A=u.length;A>h;h++)if(u[h]&&u[h].id===J)return u.splice(h,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(G,U){var N=this,l=N._scaleFactor,$=N._eyesOffset,g=N._lastHeadPose;return g[0]=G[0]*l,g[1]=G[1]*l,g[2]=G[2]*l,U?(U[0]=g[0]+$[0],U[1]=g[1]+$[1],U[2]=g[2]+$[2],U):[g[0]+$[0],g[1]+$[1],g[2]+$[2]]},addEyesOffset:function(B,F,K){var L=this._offsetToBeAdd;L[0]+=B,L[1]+=F,L[2]+=K},_copyViewMatrix:function(o){var s=this.dup(o),J=this._scaleFactor;s[12]*=J,s[13]*=J,s[14]*=J;var j=this._eyesOffset;if(j&&(j[0]||j[1]||j[2])){var B=j[0],$=j[1],h=j[2];s[12]-=s[0]*B+s[4]*$+s[8]*h,s[13]-=s[1]*B+s[5]*$+s[9]*h,s[14]-=s[2]*B+s[6]*$+s[10]*h}return s},shutdown:function(){var I=this._device;I&&I.isPresenting&&I.exitPresent()},isPresenting:function(){var U=this._device;return U&&U.isPresenting},_copyProjectMatrix:function(E){var y=this.dup(E),Q=this._scaleFactor;return y[14]*=Q,y},dup:function(v,X){for(var k=v.length,n=X||new Array(k);k--;)n[k]=v[k];return n},getViewMatrix:function(p){var s=this._viewMatrix;return s?this.dup(s,p):void 0},getProjectMatrix:function(){var S=this._projectMatrix;return S?this.dup(S):void 0},submitFrame:function(){var Z=this;if(Z._enable&&Z._deviceInAction){var s=Z._device;s&&s.isPresenting&&(s.submitFrame(),Z.gv.iv())}},intersectWorld:function(W){var Q=this.gv;return Q.intersectObjects(W,Q.dm().getDatas())},setDevice:function(i){var O=this;O._device=i},_injectGraphView:function(){var B,K,b;return function(D){var R=this.gv;if(!D)return B&&(R.getWidth=B,R.getHeight=K,R.getDevicePixelRatio=b),void 0;var n=this._device,k=n.getEyeParameters("left"),M=k.renderWidth,q=k.renderHeight;B=R.getWidth,K=R.getHeight,b=R.getDevicePixelRatio,R.getWidth=function(){return 2*M},R.getHeight=function(){return q},R.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(b){var Q=this;if(!b)return pp=u.Default.callLater=Q._defaultCallLater,void 0;var Q=this;pp=u.Default.callLater=function(x,w,m,W){var r=Q._device;return r&&r.isPresenting?W?i(function(){pp(x,w,m)},W):r.requestAnimationFrame(function(){Q._deviceInAction=!0,x.apply(w,m),Q._deviceInAction=!1}):Q._defaultCallLater(x,w,m,m)}}}),m.defineProperties(Eb.prototype,{enable:{get:function(){return this._enable},set:function(f){var z=this;z._enable!==f&&(z._enable=f,f?(z.switch.showButton(),z._injectCallLaterFunc(!0)):(z.shutdown(),z.switch.hideButton(),z._injectCallLaterFunc(!1)),z.fp("enable",!f,f))}},measureOflength:{get:function(){return this._measureOflength},set:function(W){this._measureOflength=W;var K=this._scaleFactor=1/W;this._controllers.forEach(function(D){D&&D._setScaleFactor(K)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(C){this._eyesOffset=C}},controllerModel:{get:function(){return this._controllerModel},set:function(o){var q;"object"==typeof o?(q=o.mtl,o=o.obj):(q=o+".mtl",o+=".obj");var E=this,d=E._controllerModel;d&&d.obj===o&&d.mtl===q||(d=E._controllerModel={obj:o,mtl:q},v.loadObj(o,q,{finishFunc:function(z,T){E._controllerModel===d&&v.setShape3dModel("vrControllerModel",T)}}))}},interactive:{get:function(){return!!this._interactive},set:function(T){!!T!=!!this._interactive&&(this._interactive=T,T&&this.addController(0),this.gv.getCoreInteractor().enableVR(T))}}});var Tr=function(y,m){function R($){var j=navigator.getGamepads&&navigator.getGamepads();if(j)for(var p=0,u=0,I=j.length;I>p;p++){var M=j[p];if(M){var w=M.id;if("OpenVR Gamepad"===w||"OpenVR Controller"===w||0===w.indexOf("Oculus Touch")||0===w.indexOf("Spatial Controller")){if(u===$)return M;u++}}}}function j(P,$,I){return Math.abs(P[0]-$[0])<I&&Math.abs(P[1]-$[1])<I&&Math.abs(P[2]-$[2])<I?!0:!1}var B=this;B.vr=y,B.id=m;var z,i,h=[0,0],H=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],A=new dg;A.s("shape3d","vrControllerModel"),A.isController=!0,A.s("intersect",!1),B.getGamepad=function(){return i},B.getButtonState=function(U){H.forEach(function(l){return l.id===U?l.pressed:void 0})},B.getNode=function(){return A};var P=.003;B.setRotationEpsilon=function(C){P=C};var b=5e-4,$=b;B.setPositionEpsilon=function(T){b=T,$=T*B.vr._scaleFactor},B._setScaleFactor=function(i){A.s3(i,i,i),$=b*i},B._setScaleFactor(B.vr._scaleFactor);var q,Y=new fr,p=new Bq,L=[0,0,0],Q=[0,0,0],k=new Pj,U=new cl,K=new ko;B.getRay=function(){return q?(K.origin.fromArray(L),K.direction.copy(U),q=!1,K):K},B.update=function(){if(z=i,i=R(m),z!=i&&console.log("gamepad changed",i),!i||i.pose===r)return i=null,A.s("3d.visible",!1),void 0;if(v.getShape3dModel("vrControllerModel")){A.dm()||y.gv.dm().add(A),A.s("3d.visible",!0);var S=i.pose;if(null!==S){S.position&&(B.vr.toViewPosition(S.position,L),j(A.p3(),L,$)||(q=!0,A.p3(L))),S.orientation&&(Y.fromArray(S.orientation),U.set(0,0,-1).applyQuaternion(Y).normalize(),p.makeRotationFromQuaternion(Y),k.set(0,0,0,A.getRotationMode(),!0).setFromRotationMatrix(p),Q[0]=k.x,Q[1]=k.y,Q[2]=k.z,j(A.r3(),Q,P)||(q=!0,A.r3(Q))),q&&y.fp("gamepad.pose",null,{position:L,rotation:Q,id:m});var O=i.axes;(h[0]!==O[0]||h[1]!==O[1])&&(h=[O[0],O[1]],y.fp("gamepad.axes",null,{id:m,axes:h}));var f,s,l,a,w=i.buttons;for(f=0,s=w.length;s>f;f++)l=w[f],a=l.pressed,a!==H[f].pressed&&(H[f].pressed=a,y.fp("gamepad.button."+H[f].id,null,{id:m,_62O:a?"down":"up"}))}}}},Zi=function(r){this.vr=r,this._button=null};rh(Zi,m,{showButton:function(){var M=this.assureButton();if(!M.parentNode){var f=this.vr.gv,e=f.getView();f._79O?e.insertBefore(M,f._79O):e.appendChild(M)}},hideButton:function(){var m=this._button;m&&m.parentNode&&m.parentNode.removeChild(m)},assureButton:function(){var Q=this._button;return Q?Q:this._button=this.createButton(this.vr.gv)},createButton:function(a){function W(z,C){z.textContent=C&&C.isPresenting?" VR ":" VR "}function C(B){r.style.display="",r.style.cursor="pointer",r.style.left="calc(50% - 50px)",r.style.width="100px",W(r,B),r.onmouseenter=function(){r.style.opacity="1.0"},r.onmouseleave=function(){r.style.opacity="0.5"},r.onclick=function(){B.isPresenting?B.exitPresent():B.requestPresent([{source:a.getCanvas()}])},a.vr.setDevice(B)}function P(){r.style.display="",r.style.cursor="auto",r.style.left="calc(50% - 75px)",r.style.width="150px",W(r,null),r.onmouseenter=null,r.onmouseleave=null,r.onclick=null,a.vr.setDevice(null)}function s(u){u.style.position="absolute",u.style.bottom="20px",u.style.padding="12px 6px",u.style.border="1px solid #fff",u.style.borderRadius="4px",u.style.color="#000",u.style.font="normal 13px sans-serif",u.style.textAlign="center",u.style.opacity="0.5",u.style.outline="none",u.style.zIndex="999"}if("getVRDisplays"in navigator){var r=this._button=p.createElement("button");return r.style.display="none",s(r),N.addEventListener("vrdisplayconnect",function(K){C(K.display)},!1),N.addEventListener("vrdisplaydisconnect",function(){P()},!1),N.addEventListener("vrdisplaypresentchange",function(x){W(r,x.display),a.vr.onVRDisplayPresentChange()},!1),navigator.getVRDisplays().then(function(E){E.length>0?C(E[0]):P()}),r}var n=p.createElement("a");return n.href="https://webvr.info",n.innerHTML=" webvr",n.style.left="calc(50% - 90px)",n.style.width="180px",n.style.textDecoration="none",s(n),n}}),m.defineProperties(Zi.prototype,{}),xj(v,{accordionViewExpandIcon:vb(Qo),accordionViewCollapseIcon:vb(Qo,!0),accordionViewLabelColor:qp,accordionViewLabelFont:kn,accordionViewTitleBackground:hb,accordionViewSelectBackground:Sf,accordionViewSelectWidth:3,accordionViewSeparatorColor:r,splitViewDividerSize:1,splitViewDividerBackground:hb,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Om,rect:[2,2,12,12],background:Qo}]},propertyViewLabelColor:ib,propertyViewLabelSelectColor:qp,propertyViewLabelFont:kn,propertyViewExpandIcon:vb(ws),propertyViewCollapseIcon:vb(ws,!0),propertyViewBackground:pn,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:rn,propertyViewColumnLineColor:rn,propertyViewSelectBackground:Sf,listViewLabelColor:ib,listViewLabelSelectColor:qp,listViewLabelFont:kn,listViewRowLineVisible:!1,listViewRowLineColor:rn,listViewSelectBackground:Sf,treeViewLabelColor:ib,treeViewLabelSelectColor:qp,treeViewLabelFont:kn,treeViewExpandIcon:vb(gf),treeViewCollapseIcon:vb(gf,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:rn,treeViewSelectBackground:Sf,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ib,tableViewLabelSelectColor:qp,tableViewLabelFont:kn,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:rn,tableViewColumnLineColor:rn,tableViewSelectBackground:Sf,treeTableViewLabelColor:ib,treeTableViewLabelSelectColor:qp,treeTableViewLabelFont:kn,treeTableViewExpandIcon:vb(gf),treeTableViewCollapseIcon:vb(gf,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:rn,treeTableViewColumnLineColor:rn,treeTableViewSelectBackground:Sf,tableHeaderLabelColor:ib,tableHeaderLabelFont:kn,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:nn,tableHeaderBackground:pn,tableHeaderMoveBackground:xc,tableHeaderInsertColor:Sf,tableHeaderSortDescIcon:Fj(ws,!0),tableHeaderSortAscIcon:Fj(ws),tabViewTabGap:1,tabViewLabelColor:qp,tabViewLabelFont:kn,tabViewTabBackground:hb,tabViewSelectWidth:3,tabViewSelectBackground:Sf,tabViewMoveBackground:xc,tabViewInsertColor:Sf,toolbarLabelColor:ib,toolbarLabelSelectColor:qp,toolbarLabelFont:kn,toolbarBackground:pn,toolbarSelectBackground:Sf,toolbarItemGap:8,toolbarSeparatorColor:Bo},!0);var wf={translateX:1,sortColumn:1},wj={sortable:1,sortOrder:1,sortFunc:1},xk={focusData:1},Eo={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},pc={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Dp=function(K,M){M.add(K),K.hasChildren()&&K.eachChild(function(n){Dp(n,M)})},us=function(H,I,D,P,y,f,h,i,o,U,T){var u,M=D.getValueType(U),z=D.getAlign(U);if(D.getEnumValues(U)){var m=D.toEnumLabel(I,U),w=ms||0,b=0,G=f,d=v.getTextSize(P,m).width;return u=Sg(D.toEnumIcon(I,U)),u&&(b=f+ms/2,"center"===z?b+=(i-(w+d))/2:"right"===z&&(b=b+i-(w+d)),Zl(H,u,b,h+o/2,U,T),G=b+ms/2),m!=C&&(u?hs(H,m,P,y,G,h,i-(G-f),o):hs(H,m,P,y,f,h,i,o,z)),void 0}return I=D.formatValue(I),I!=C?M===$e?(Qh(H,f,h,i,o,I),void 0):M===Ef||!M&&Yi(I)?(u=Sg(I?to:Db),Zl(H,u,f+i/2,h+o/2,U,T),void 0):(hs(H,I,P,y,f,h,i,o,z),void 0):void 0},ho=function(w,d){var o=d.view,y=as(w),N=d.column||d.property;o.getDataModel().beginTransaction(),d.editor=w,w.info=d,o.setCurrentEditor(w),o.getView().insertBefore(y,o._79O),re(w,d.editorRect),w.setFocus?w.setFocus():Je(w),w.commitValue=function(x,p){w._17Q&&(w=w._17Q),p||o.setValue(d.data,N,w.getValue?w.getValue():w.value),w.close&&w.close(),ks(y)},N.onEditorCreated&&N.onEditorCreated(d)},uk=function(B,s,L,h,k){var E=fm(B,L),W=s.value,$=s.view,j=k.getValueType(s.data);return E.onblur=E.onchange=function(){$.endEditing()},"input"===B?(W=k.formatValue(W),W!=C&&(E.value=W),E.onkeydown=function(h){Zh(h)?$.endEditing():Rp(h)&&$.endEditing(!0)},(j===vn||j===jr)&&E.addEventListener(pg,v.numberListener,!1)):B===xb&&h.forEach(function(K){var o=p.createElement("option");o.innerHTML=k.toEnumLabel(K),o.value=K,k.isEnumEqual(W,K)&&(o.selected=!0),Ap(E,o)}),ho(E,s),E},tq=u.widget={},Sh=function(n,o,z){rh(H+".widget."+n,o,z)};xj(_p,{ms_value:function(C){C.getValue=function(K){var F=this.getItemById(K),E=F.element;return Ai(E)?E:E?E.getValue?E.getValue():E.value:F.selected},C.setValue=function($,U){var g=this.getItemById($);if(g){var D=g.element;D&&!Ai(D)?D.setValue?D.setValue(U):D.value=U:Yi(U)?(g.selected=U,this.iv()):(g.element=U,this.iv())}},C.v=function(x,Q){var m=this;if(2===arguments.length)m.setValue(x,Q);else{if(!vl(x))return m.getValue(x);
for(var R in x)m.setValue(R,x[R])}return m}},_46o:function(Q){Q._icon=C,Q._accessType=C,Q._valueType=C,Q._editable=!1,Q._batchEditable=!0,Q._align=en,Q._nullable=!0,Q._emptiable=!1,Q.setParent=bc,Q.formatValue=function(d){var U=this,N=U._valueType;return U.getEnumValues()?U.toEnumLabel(d):N===Ef?!!d:d!=C&&N===vn?t(d):d},Q.setEnum=function(M,t,S,o,K,Z,F){var k=this;M&&!ij(M)&&M.values&&(o=M.editable,S=M.icons,t=M.labels,K=M.strict,Z=M.maxHeight,F=M.dropDownWidth,M=M.values),Sb(M)&&(M=M._as),Sb(t)&&(t=t._as),Sb(S)&&(S=S._as),k._enumValues=M,k._enumLabels=t,k._enumIcons=S,k._enumEditable=o,k._enumStrict=K==C?!0:K,k._enumMaxHeight=Z,k._enumDropDownWidth=F,M&&M.length&&gl(M[0])&&(k._valueType=jr),k.fp("enum",!1,!0)},Q.getEnumDropDownWidth=function(){return this._enumDropDownWidth},Q.getEnumMaxHeight=function(){return this._enumMaxHeight},Q.isEnumEditable=function(){return this._enumEditable},Q.getEnumValues=function(){return this._enumValues},Q.getEnumLabels=function(){return this._enumLabels},Q.getEnumIcons=function(){return this._enumIcons},Q.isEnumStrict=function(){return this._enumStrict},Q.isEnumEqual=function(O,J){return this._enumStrict?O===J:O==J},Q.toEnumLabel=function(J,l){var m=this,B=m.getEnumValues(l),F=m.getEnumLabels(l);if(B&&F)for(var _=0;_<B.length;_++)if(m.isEnumEqual(J,B[_]))return F[_];return J},Q.toEnumIcon=function(w,l){var a=this,k=a.getEnumValues(l),p=a.getEnumIcons(l);if(k&&p)for(var U=0;U<k.length;U++)if(a.isEnumEqual(w,k[U]))return p[U];return r}},_45o:function(b){b._87o=function(F,J,$,S,C,B){if(F){var j=this,A=j._90I,g=gh(1);j._columnLineVisible&&(C-=1),j._rowLineVisible&&(B-=1),0>=C||0>=B||(j._90I||(A=j._90I={}),A[J]||(A[J]=new Oh),re(g,j.tx()+$,j.ty()+S,C,B),Ap(g,F),j._view.insertBefore(g,j._79O),F.onParentAdded&&F.onParentAdded(g),A[J].add(g))}},b._76o=function(){var p=this,z=p._90I;if(z){for(var S in z)z[S].each(function(F){ks(F)});delete p._90I}},b._77o=function(V){var $=this;if($._90I){var Q=$._90I[V];Q&&(Q.each(function(F){ks(F)}),delete $._90I[V])}}},_47o:function(Q){Q.getValue=function(Z,m){return m.getValue?m.getValue(Z,m,this):Ul(Z,m.getAccessType(),m.getName())},Q.setValue=function(p,k,O){if(k.isEmptiable(p)||""!==O||(O=r),k.isNullable(p)||O!=C){var U=this,T=k.getName(p),M=k.getAccessType(p),l=k.getValueType(p);l===vn&&Ai(O)?O=Z(O):l===jr&&Ai(O)?O=parseFloat(O):l===Ef&&Ai(O)&&(O="true"===O),U._batchEditable&&k._batchEditable&&U.isSelected(p)?U.sm().each(function(v){k.setValue?k.setValue(v,k,O,U):_o(v,M,T,O)}):k.setValue?k.setValue(p,k,O,U):_o(p,M,T,O)}},Q.setCurrentEditor=function(Z){this.endEditing(),this._currentEditor=Z,this.redraw()},Q.isEditing=function(I,n){var z=this,m=z._currentEditor;if(!m)return!1;if(n){var Z=m.info;return Z?(Z.column||Z.property)===n&&Z.data===I:!1}return!0},Q.endEditing=function(y){var b=this,M=b._currentEditor;M&&(delete b._currentEditor,M.commitValue&&M.commitValue(M.info,y),b.redraw(),b.getDataModel().endTransaction())},Q.beginEditing=function(j){this.endEditing();var I=this,A=j.column||j.property;if(A.beginEditing)A.beginEditing(j);else{var Y=j.data,h=j.value,p=I.getSelectBackground(Y),L=A.getEnumValues(Y),d=A.getSlider(Y),g=A.getColorPicker(Y);if(d){var k=fn(tq.Slider,d);return k.setValue(h),k.getView().onblur=function(){I.endEditing()},k.isInstant()&&(k.onValueChanged=function(){I.setValue(Y,A,k.getValue())}),ho(k,j),void 0}if(g||A.getValueType(Y)===$e){var M=fn(tq.ColorPicker,g);return M.setValue(h),M.onClosed=function(){I.endEditing()},M.isInstant()&&(M.onValueChanged=function(z,G){I.setValue(Y,A,G)}),ho(M,j),M.open(),void 0}if(L){if(tq.ComboBox){var B=new tq.ComboBox;B.setValue(h),B.setValues(L),B.setLabels(A.getEnumLabels(Y)),B.setIcons(A.getEnumIcons(Y)),B.setEditable(A.isEnumEditable(Y)),B.setStrict(A.isEnumStrict(Y)),B.setMaxHeight(A.getEnumMaxHeight(Y)),B.setDropDownWidth(A.getEnumDropDownWidth(Y)),B.onClosed=function(){I.endEditing()},ho(B,j),B.open()}else uk(xb,j,p,L,A);return}var w=A.getValueType(Y);if(w===Ef||Yi(h))return I.setValue(Y,A,!h),void 0;if(A.getItemEditor(Y)){var i=Vk(A.getItemEditor(Y)),f=new i(Y,A,I,j),$=f.getView();return $._17Q=f,f.setValue(h),gn($),ho($,j),f.editBeginning&&f.editBeginning(),void 0}uk("input",j,p,C,A)}}},_44o:function(d){d.init=function(i){var Q=this,G=Q.th=new zg(i),D=Q._view=ei(1,Q);Q.tv=Q._tableView=i,Ap(D,G.getView()),Ap(D,i.getView()),G.mp(function(O){O.property===$g&&Q.iv()}),Q.iv()},d.getTableView=function(){return this.tv},d.getTableHeader=function(){return this.th},d.getDataModel=function(){return this.tv.dm()},d.getColumnModel=function(){return this.tv.getColumnModel()},d.setColumns=function(x){this.tv.setColumns(x)},d.addColumns=function(f){this.tv.addColumns(f)},d.endEditing=function(){this.tv.endEditing()},d.validateImpl=function(){var v=this,Z=v.th,j=ld(Z),i={x:0,y:0,width:v.getWidth(),height:j};re(Z,i),i.y=j,i.height=F(0,v.getHeight()-j),re(v.tv,i)}},ms_vs:function(M){M._41o=function(){return this._29I.height<this._59I},M._43o=function(){var M=this;M._41o()&&(M._58I||(i(function(){M._94O()},kl),M.iv()),M._58I=new Date)},M._94O=function(){var K=this;if(K._58I){var l=new Date;l.getTime()-K._58I.getTime()>=kl?(delete K._58I,K.iv()):i(function(){K._94O()},kl)}},M._93I=function(){var n=this,y=n._27I;if(n._58I||!n._autoHideScrollBar){y||Ap(n._79O,y=n._27I=gh());var D=n._29I,e=D.height,r=n._59I,x=n.getScrollBarSize(),t=D.width-x-2,N=e*(-n.ty()/r),$=e*(e/r),X=y.style;r>e?(ao>$&&(N=N+$/2-ao/2,0>N&&(N=0),N+ao>e&&(N=e-ao),$=ao),X.visibility=gk,X.background=n.getScrollBarColor(),X.borderRadius=x/2+bi,re(y,t,N,x,$)):X.visibility=Cs}else y&&(y.style.visibility=Cs)}},ms_hs:function(d){d._40o=function(){return this._29I.width<this._91I},d._42o=function(){var f=this;f._40o()&&(f._95O||(i(function(){f._94I()},kl),f.iv()),f._95O=new Date)},d._94I=function(){var e=this;if(e._95O){var j=new Date;j.getTime()-e._95O.getTime()>=kl?(delete e._95O,e.iv()):i(function(){e._94I()},kl)}},d._92I=function(){var b=this,M=b._28I;if(b._95O||!b._autoHideScrollBar){M||Ap(b._79O,M=b._28I=gh());var e=b._29I,O=e.width,Q=b._91I,t=b.getScrollBarSize(),n=e.height-t-2,v=O*(-b.tx()/Q),W=O*(O/Q),V=M.style;Q>O?(ao>W&&(v=v+W/2-ao/2,0>v&&(v=0),v+ao>O&&(v=O-ao),W=ao),V.visibility=gk,V.background=b.getScrollBarColor(),V.borderRadius=t/2+bi,re(M,v,n,W,t)):V.visibility=Cs}else M&&(M.style.visibility=Cs)}}}),pq(to,Yf(16,16,[{type:Lg,rect:[1,1,14,14],background:Sf},{type:Tb,rect:[1,1,14,14],width:1,color:ef},{type:Dr,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),pq(Db,Yf(16,16,{type:Tb,rect:[1,1,14,14],width:1,color:ef})),pq(_i,Yf(16,16,[{type:Mh,rect:[2,2,12,12],borderWidth:1,borderColor:ef,background:"#FFF"},{type:Mh,rect:[4,4,8,8],background:Sf}])),pq(mo,Yf(16,16,{type:Mh,rect:[2,2,12,12],borderWidth:1,borderColor:ef})),_p._15Q=function(f){f._29I=Hk,f._59I=0,f._91I=0,f._5o=function(e){var m=this;m._30I=new Oh,m._rows=new Oh,m._rowMap={},m._31I=0,m._14I=0,m._view=ei(1,m),m._canvas=tc(m._view),Ap(m._view,m._79O=gh()),m.dm(e?e:new Pb)},f.getCheckIcon=function(_){var c=this.sm(),B=c.co(_);return c.sg()?Sg(B?_i:mo):Sg(B?to:Db)},f.checkData=function(G){var f=this.sm(),y=f.co(G);f.sg()&&y||(this._32o=1,y?f.rs(G):f.as(G),delete this._32o)},f.getDataAt=function(S){S.target&&(S=this.lp(S));var Q=b(S.y/this._rowHeight),K=this._rows;return 0>Q||Q>=K.size()?C:K.get(Q)},f.onDataDoubleClicked=function(){},f.onDataClicked=function(){},f.adjustTranslateX=function(){return 0},f.adjustTranslateY=function($){var B=this.getHeight()-this._59I;return B>$&&($=B),$>0?0:t($)},f.onPropertyChanged=function(I){var l=this,r=I.property;Eo[r]?l.ivm():xk[r]||l.redraw(),r===vc?l._42o():r===td&&l._43o()},f.getLabel=function(S){return S.toLabel()},f.getLabelFont=function(){return this._labelFont},f.getLabelColor=function(m){var Z=this;if(Z.isCheckMode()){if(Z._focusData===m)return Z._labelSelectColor}else if(Z.isSelected(m))return Z._labelSelectColor;return Z._labelColor},f.getStartRowIndex=function(){return this._31I},f.getEndRowIndex=function(){return this._14I},f.getRowDatas=function(){return this._rows},f.getRowIndex=function(o){return this._rowMap[o._id]},f.getRowSize=function(){return this._rows.size()},f.getViewRect=function(){return Io(this._29I)},f.isVisible=function(f){return this._visibleFunc?this._visibleFunc(f):!0},f.getCurrentSortFunc=function(){return this._sortFunc},f.setDataModel=function(J){var X=this,x=X._dataModel,f=X._selectionModel;x!==J&&(x&&(x.umm(X.handleDataModelChange,X),x.umd(X.handleDataPropertyChange,X),x.umh(X.handleHierarchyChange,X),f||x.sm().ums(X.handleSelectionChange,X)),X._dataModel=J,J.mm(X.handleDataModelChange,X),J.md(X.handleDataPropertyChange,X),J.mh(X.handleHierarchyChange,X),f?f._21I(J):J.sm().ms(X.handleSelectionChange,X),X.fp("dataModel",x,J))},f.validateModel=function(){var _=this;_._rows.clear(),_._rowMap={},_.buildChildren(_._dataModel._roots);var H=_._rows=_._rows.toList(_.isVisible,_),F=0,k=_.getCurrentSortFunc(),b=H.size();for(k&&H.sort(k);b>F;F++)_._rowMap[H.get(F)._id]=F},f.buildChildren=function(b){var m=this;b.each(function(x){m._rows.add(x),m.buildChildren(x._children)})},f.handleDataModelChange=function(){this.ivm()},f.handleDataPropertyChange=function(e){"parent"===e.property?this.ivm():this.invalidateData(e.data)},f.handleHierarchyChange=function(){this.ivm()},f.handleSelectionChange=function(p){p.datas.each(this.invalidateData,this),this.onSelectionChanged(p)},f.onSelectionChanged=function(U){var b=this,G=b.sm();!b.isAutoMakeVisible()||1!==G.size()||"set"!==U.kind&&"append"!==U.kind||b._32o||b.makeVisible(G.ld())},f.handleBackgroundClick=function(i){Pr(i)&&!this.isCheckMode()&&this.sm().cs()},f.makeVisible=function(H){H&&(this._23I=H,this.iv())},f.scrollToIndex=function(U){var N=this,y=N._29I,$=y.height,X=N._rowHeight,v=X*U;U>=0&&U<N._rows.size()&&$>0&&(v+X>y.y+$?N.ty(-v+$-X):v<y.y&&N.ty(-v))},f.autoScroll=function(O,Y){var s=this,j=s._rowHeight,h=j,g=j/4,p=s._29I,_=s.lp(O),y={x:s.tx(),y:s.ty()};return j>0&&p&&(_.x-p.x<h?s.translate(g,0):p.x+p.width-_.x<h&&s.translate(-g,0),_.y-p.y<h?s.translate(0,g):p.y+p.height-_.y<h&&s.translate(0,-g)),y.x=s.tx()-y.x,y.y=s.ty()-y.y,Y&&(Y.x+=y.x,Y.y+=y.y),y},f.getTopRowOrderSelection=function(){var q=this.sm().getTopSelection(),$={},P=new Oh;return q.each(function(y){$[y._id]=y}),this._rows.each(function(f){$[f._id]&&P.add(f)}),P},f.getRowOrderSelection=function(){var g=new Oh;return this._rows.each(function(V){this.isSelected(V)&&g.add(V)},this),g},f.ivm=function(){this.invalidateModel()},f.invalidateModel=function(){var V=this;V._96I||(V._96I=1,V._32I=1,delete V._24I),V.iv()},f.redraw=function(){var y=this;y._32I||(y._32I=1,delete y._24I,y.iv())},f.invalidateData=function(E){var f=this;_?f.redraw():f._32I||(f._24I||(f._24I={}),f._24I[E._id]=E,f.iv())},f.getFocusData=function(){return this._focusData},f.setFocusDataById=function(O){this.setFocusData(this.dm().getDataById(O))},f.setFocusData=function(x){var F=this,N=F._focusData;N!==x&&(F._focusData=x,F.fp("focusData",N,x),N&&F.invalidateData(N),x&&(F.invalidateData(x),F.isAutoMakeVisible()&&F.makeVisible(x)))},f.drawRowBackground=function(n,L,u,I,o,P,O){var w=this,J=w.isCheckMode();(L===w._focusData&&J||u&&!J)&&Qh(n,I,o,P,O,w.getSelectBackground(L))},f.drawData=function(h,x,K){var w=this,k=w._rowHeight,U=k*K,m=w._29I,q=m.x,R=m.width;h.save(),h.beginPath(),h.rect(q,U,R,k),h.clip(),w._87o(w.drawRow(h,x,w.isSelected(x),q,U,R,k),K,q,U,R,k),h.restore(),w._rowLineVisible&&Qh(h,q,U+k-1,R,1,w._rowLineColor)},f._12I=function(N){var G=this,f=G._31I,R=G._29I,I=R.x,P=R.y,l=R.width,E=R.height;for(N.beginPath(),N.rect(I,P,l,E),N.clip(),N.clearRect(I,P,l,E),G._76o(),G._93db(N);f<G._14I;f++)G.drawData(N,G._rows.get(f),f);G._92db(N)},f._13I=function(J){for(var r,m=this,V=m._rowHeight,E=m._29I,A=E.x,e=E.width,q=m._31I,W=m._30I;q<m._14I;q++)r=m._rows.get(q),m._24I[r._id]&&W.add({data:r,index:q});W.isEmpty()||(J.beginPath(),W.each(function(q){J.rect(A,q.index*V,e,V)}),J.clip(),W.each(function(h){J.clearRect(A,h.index*V,e,V)}),W.each(function(X){m._77o(X.index)}),m._93db(J),W.each(function(H){m.drawData(J,H.data,H.index)}),m._92db(J),W.clear())},f.validateImpl=function(){var H=this,w=H._canvas,A=H.getWidth(),a=H.getHeight(),q=H._rowHeight,F=H._32I;(A!==w.clientWidth||a!==w.clientHeight)&&(Rn(w,A,a),F=1);var t=B&&!n;H._96I&&!t&&H.validateModel();var $=H._29I,T={x:-H.tx(),y:-H.ty(),width:A,height:a},O=H._rows.size(),G=Tp(w),x=H._23I;F||eb(T,$)||(F=1),H._29I=T,H._59I=O*q,H._31I=b(T.y/q),H._14I=k((T.y+T.height)/q),H._31I<0&&(H._31I=0),H._14I>O&&(H._14I=O),H._99I&&F&&H._99I(),sg(G,H.tx(),H.ty(),1),F?H._12I(G):H._24I&&H._13I(G),H._93I(),H._92I(),G.restore(),H._32I=H._24I=H._96I=C,x&&(H.scrollToIndex(H.getRowIndex(x)),delete H._23I),H.tx(H.tx()),H.ty(H.ty())}},_p._48o=function(E){E._rootVisible=!0,E._rootData=C,E._35o=function(){this._expandMap={},this._levelMap={}},E.validateModel=function(){var C=this,V=C._rootData;C._rows.clear(),C._levelMap={},C._rowMap={},C._currentLevel=0,V?C._rootVisible?C.isVisible(V)&&C.buildData(V):C.buildChildren(V):C.buildChildren(),delete C._currentLevel},E.buildData=function(N){var V=this,_=N._id,s=V._rows;V._rowMap[_]=s.size(),s.add(N),V._levelMap[_]=V._currentLevel,V.isExpanded(N)&&(V._currentLevel++,V.buildChildren(N),V._currentLevel--)},E.buildChildren=function(R){var o=this,q=R?R._children:o._dataModel._roots,D=o.getCurrentSortFunc();D&&o.isChildrenSortable(R)?q.toList(o.isVisible,o).sort(D).each(o.buildData,o):q.each(function(d){o.isVisible(d)&&o.buildData(d)})},E.getLevel=function(R){return this._levelMap[R._id]},E.getToggleIcon=function(k){var L=this,s=L._loader,c=L._collapseIcon;return s&&!s.isLoaded(k)?c:k.hasChildren()?L.isExpanded(k)?L._expandIcon:c:C},E.isCheckMode=function(){return this._checkMode!=C},E.isChildrenSortable=function(){return!0},E.handleDataModelChange=function(N){var w=this;N.kind===uc?delete w._expandMap[N.data._id]:N.kind===Hl&&(w._expandMap={}),w.ivm()},E.toggle=function(j){var Y=this;Y.isExpanded(j)?Y.collapse(j):Y.expand(j)},E.isExpanded=function($){return 1===this._expandMap[$._id]},E.expand=function(N){var _=this,U=_._loader;_.isExpanded(N)||(U&&!U.isLoaded(N)&&U.load(N),_._expandMap[N._id]=1,_.ivm(),_.onExpanded(N))},E.onExpanded=function(){},E.collapse=function(T){var C=this;C.isExpanded(T)&&(delete C._expandMap[T._id],C.ivm(),C.onCollapsed(T))},E.onCollapsed=function(){},E.expandAll=function(o){if(o)this.expand(o),o.eachChild(function(p){this.expandAll(p)},this);else{var f=this;f._dataModel.each(function(A){A.hasChildren()&&(f._expandMap[A._id]=1)}),f.ivm()}},E.collapseAll=function(){this._expandMap={},this.ivm()},E.makeVisible=function(j){if(j){var l=this;if(!l._rootData||j.isDescendantOf(l._rootData)){for(var u=j._parent;u;)l.expand(u),u=u._parent;l._23I=j,l.iv()}}},E.checkData=function(X){var L,u=this,n=u._checkMode,o=u.sm(),b=o.co(X);if(!o.sg()||!b){if(u._32o=1,n===lr)b?o.rs(X):o.as(X);else if(n===jl)L=new Oh(X),L.addAll(X._children);else if("descendant"===n)L=new Oh,Dp(X,L);else if("all"===n&&(L=new Oh,Dp(X,L),!b))for(var C=X._parent;C;)L.add(C),C=C._parent;L&&(b?o.rs(L):o.as(L)),delete u._32o}},E._97I=function(D,q,C,O,y,I,Y){var B=this,i=B._indent,M=B._levelMap[q._id],v=B.getIconWidth(q),w=Sg(B.getToggleIcon(q));w?(O+=i*M,Zl(D,w,O+i/2,y+Y/2,q,B),O+=i):O+=i*(M+1),B._checkMode&&(Zl(D,B.getCheckIcon(q),O+i/2,y+Y/2,q,B),O+=i),B.drawIcon(D,q,O,y,v,Y),B.drawLabel(D,q,O+v,y,Y)}},_p._14Q=function(m){m.getIcon=function(A){return A.getIcon()},m.getIconWidth=function(Q){return this.getIcon(Q)?this._indent:0},m.drawIcon=function(g,J,d,C,O,T){if(O){var k=this,B=k.getBodyColor(J),P=Sg(k.getIcon(J),B);P&&(T-=k.isRowLineVisible()?1:0,_e(g,P,Ur,d,C,O,T,J,k,B),jc(g,k.getBorderColor(J),d,C,O,T))}},m.drawLabel=function(G,q,I,r,F){var Q=this;hs(G,Q.getLabel(q),Q.getLabelFont(q),Q.getLabelColor(q),I,r,0,F)}},_p._50o=function(H){H._98I=function(){var E=this,M=E._39o=new Pb;E._60I=new Oh,M.mm(E._17o,E),M.md(E._18o,E),M.mh(E._19o,E)},H.setColumns=function(U){this._39o.clear(),this.addColumns(U)},H.addColumns=function(x){var j=this._39o;x.forEach(function($){if(!($ instanceof li)){var Y=Vk($.className);$=fn(Y?Y:li,$)}j.add($)})},H.onColumnClicked=function(){},H.onCheckColumnClicked=function(){},H._3Q=function(Q){for(var $,u=0,M=this._60I,n=M.size();n>u;u++)if($=M.get(u),$.column===Q)return $;return C},H.getColumnAt=function(P){var w=this._4Q(P);return w?w.column:C},H._4Q=function(o){for(var v=this,O=o.target?v.lp(o).x:o.x,U=v._60I,c=0;c<U.size();c++){var t=U.get(c),n=t.startX;if(O>=n&&O<n+t.column.getWidth())return t}return C},H.getToolTip=function(l){var n=this,r=n.getDataAt(l),P=n.getColumnAt(l);return r&&P?P.getToolTip(r,n):C},H.adjustTranslateX=function(f){var G=this.getWidth()-this._91I;return G>f&&(f=G),f>0?0:t(f)},H._99I=function(){var x=this,G=x._29I,A=x._60I;A.clear(),x._91I=0,x._39o._roots.each(function(j){if(j.isVisible()){var T=x._91I+j.getWidth();x._91I<=G.x+G.width&&T>=G.x&&A.add({column:j,startX:x._91I}),x._91I=T}})},H.drawData=function(H,Y,p){var V=this,s=V._rowHeight,y=s*p,X=V.isSelected(Y),k=V._29I,x=k.x,A=k.width;V.drawRowBackground(H,Y,X,x,y,A,s),V._60I.each(function(B){var j=B.column,v=B.startX,e=j.getWidth();e>0&&!V.isEditing(Y,j)&&(H.save(),H.beginPath(),H.rect(v,y,e,s),H.clip(),V._87o(V.drawCell(H,Y,X,j,v,y,e,s),p,v,y,e,s),V._columnLineVisible&&Qh(H,v+e-1,y,1,s,V._columnLineColor),H.restore())}),V._rowLineVisible&&Qh(H,x,y+s-1,A,1,V._rowLineColor)},H.drawCell=function(B,p,W,t,h,E,V,o){var f=this;if(t.drawCell)return t.drawCell(B,p,W,t,h,E,V,o,f);var y=f.getValue(p,t);us(B,y,t,f.getLabelFont(p,t,y),f.getLabelColor(p,t,y),h,E,V,o,p,f)},H.getColumnModel=function(){return this._39o},H._17o=function(){this.redraw()},H._18o=function(i){var z=this;i.data===z._sortColumn&&wj[i.property]?z.ivm():(z._42o(),z.redraw())},H._19o=function(){this.redraw()},H.getCurrentSortFunc=function(){var g=this,v=g._sortColumn;if(v&&v.isSortable()){var S=v.getSortFunc(),Y=Cr===v.getSortOrder()?1:-1;return S||(S=Yc),function(J,t){return S.call(g,g.getValue(J,v),g.getValue(t,v),J,t)*Y}}return g._sortFunc},H.isCellEditable=function(u,r,C){return r.isEditable()&&this.isEditable()?r.isCellEditable?r.isCellEditable(u,r,C,this):!0:!1},H._37O=function(g,T){if(Pr(T))for(var E=this,v=E.lp(T),A=E._60I,r=E._rowHeight,L=E._29I,X=L.x,P=L.y,G=L.width,Q=L.height,t=0;t<A.size();t++){var o=A.get(t),F=o.startX,Z=o.column,a=Z.getWidth();if(Z!==E._31o&&Z!==E._4o&&v.x>=F&&v.x<F+a&&E.isCellEditable(g,Z,T)){var Y={x:F,y:E.getRowIndex(g)*r,width:a,height:r},u={x:Y.x+E.tx(),y:Y.y+E.ty(),width:Y.width,height:Y.height},w=0,O=0;return Y.x<X?w=Y.x-X:Y.x+Y.width>X+G&&(w=Y.x+Y.width-X-G),w&&(E.tx(E.tx()-w),u.x-=w),Y.y<P?O=Y.y-P:Y.y+r>P+Q&&(O=Y.y+r-P-Q),O&&(E.ty(E.ty()-O),u.y-=O),E.beginEditing({data:g,column:Z,value:E.getValue(g,Z),event:T,rect:Y,editorRect:u,view:E}),void 0}}}},tq.BaseItemEditor=function(N,z,Z,O){this._data=N,this._column=z,this._master=Z,this._editInfo=O},Sh("BaseItemEditor",m,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Hr=u.Tab=function(){Nm(Hr,this)};rq("Tab",ap,{ms_ac:["view","closable","disabled"],_icon:C,_closable:!1,_disabled:!1,setParent:bc});var li=u.Column=function(){Nm(li,this)};rq("Column",ap,{_46o:1,ms_ac:["accessType","valueType",gk,Hc,Ho,Qn,"align",$e,"sortOrder",Sq,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Cr,_sortFunc:C,_sortable:!0,_clickable:!0,setWidth:function(g){16>g&&(g=16);var A=this._width;this._width=g,this.fp(Qn,A,g)},getToolTip:function(H,a){return this.formatValue(a.getValue(H,this))}});var Yr=u.Property=function(){Nm(Yr,this)};rq("Property",ap,{_46o:1,ms_ac:["accessType","valueType",Hc,Ho,"categoryName",$e,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:C,getToolTip:function(z,S,W){var f=this;return S?f.formatValue(W.getValue(z,f)):W.getPropertyName(f)}}),tq.AccordionView=function(){var g=this;g._20o={},g._21o=new Oh,g._10o=C,g._9o=C,g._11o=C,g._view=ei(0,g),g.iv()},Sh("AccordionView",m,{ms_v:1,ms_fire:1,ms_ac:[bq,aj,"titleHeight",wo,Wk,"titleBackground","selectWidth",rk,"orientation","separatorColor"],_expandIcon:v.accordionViewExpandIcon,_collapseIcon:v.accordionViewCollapseIcon,_titleHeight:Tc,_labelColor:v.accordionViewLabelColor,_labelFont:v.accordionViewLabelFont,_titleBackground:v.accordionViewTitleBackground,_selectBackground:v.accordionViewSelectBackground,_selectWidth:v.accordionViewSelectWidth,_orientation:"v",_separatorColor:v.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(O,V,F,Q){var t=this,j=gh();if(t._20o[O])throw O+" already exists";j.onmousedown=Ib,j.style.cursor=rd,j.addEventListener(_n?dl:Hm,function(l){Ib(l)},!1),j.addEventListener(_n?Qc:hg,function(B){Ib(B),Pr(B)&&(t._10o===O?t.collapse():t.expand(O))},!1),Ap(t._view,j),t._20o[O]={content:V,div:j,canvas:tc(j),icon:Q},t._21o.add(O),F&&t.expand(O),t.iv()},remove:function(T){var I=this,N=I._20o[T];N&&(ks(N.div),delete I._20o[T],I._21o.remove(T),I.iv())},clear:function(){var W=this;W._21o.toArray().forEach(W.remove,W),W._20o={},W._21o.clear(),W.iv()},isExpanded:function(E){return this._10o===E},expand:function(a){var t=this;t._20o[a]&&t._10o!==a&&(t._10o=a,t.onExpanded(a),t.iv())},onExpanded:function(){},collapse:function(){var E=this;E._10o&&(E.onCollapsed(E._10o),delete E._10o,E.iv())},onCollapsed:function(){},initCanvas:function(l,I,c){Rn(l,I,c);var D=Tp(l);return sg(D,0,0,1),D.clearRect(0,0,I,c),D},drawTitle:function(G,l,W,O,b){var c=this,k=Sg(b.icon),R=c.isExpanded(l),a=c._titleHeight,U=c._titleBackground,V=c._selectWidth,M=c._separatorColor,e=Sg(R?c._expandIcon:c._collapseIcon),T=V+4;Qh(G,0,0,W,O,U),R&&V&&Qh(G,0,0,V,O,c._selectBackground),(R||c._21o.get(c._21o.size()-1)!==l)&&Qh(G,0,O-1,W,1,M?M:Lj(U)),k&&(Zl(G,k,T+Ml(k)/2,a/2),T+=Ml(k)+2),hs(G,l,c.getLabelFont(l),c.getLabelColor(l),T,0,0,a),e&&Zl(G,e,W-Ml(e)/2-4,a/2)},validateImpl:function(){var G=this,J=G._view,B=0,p=0,h=G.getWidth(),u=G.getHeight(),R=G._titleHeight,L=G._21o.size()*R,c=G._11o,U=G._9o;delete G._11o,delete G._9o,G._21o.each(function(e){var H,m,O=G._20o[e],S=O.content,T=G._10o===e;lq(G)?(re(O.div,B,0,R,u),H=G.initCanvas(O.canvas,R,u),of(H,0,u),Bh(H,-f),G.drawTitle(H,e,u,R,O),H.restore(),T?(m=F(0,h-L),S&&(G._11o=S,G._9o=as(S),re(S,B+R,0,m,u)),B+=R+m):B+=R):(re(O.div,0,p,h,R),H=G.initCanvas(O.canvas,h,R),G.drawTitle(H,e,h,R,O),H.restore(),T?(m=F(0,u-L),S&&(G._11o=S,G._9o=as(S),re(S,0,p+R,h,m)),p+=R+m):p+=R)});var K=G._9o;c&&c!==G._11o&&c.endEditing&&c.endEditing(),K&&K!==U&&Ap(J,K),U&&U!==K&&ks(U)}}),tq.SplitView=function(M,Y,p,n){var b=this,$=b._dividerDiv=gh(),m=b._60O=tc(),V=b._61O=tc(),F=m.style,G=V.style;b._view=ei(1,b),Ap(b._view,$),F.msTouchAction=Wc,F.pointerEvents=Wc,F.cursor=rd,G.msTouchAction=Wc,G.pointerEvents=Wc,G.cursor=rd,M&&b.setLeftView(M),Y&&b.setRightView(Y),p&&b.setOrientation(p),n!=C&&b.setPosition(n),b.setStatus(Td),new Bp(b)},Sh("SplitView",m,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:v.splitViewDividerSize,_dividerBackground:v.splitViewDividerBackground,_dragOpacity:v.splitViewDragOpacity,_toggleIcon:v.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(a,F){var S=this,r=S._position;isNaN(a)||(F||(S._82O=0>a?-1:a>1?1:0),S._position=a,S.fp(Aj,r,a))},getLeftView:function(){return this._leftView},setLeftView:function(S){var L=this,o=L._leftView,P=L._view;if(L._leftView!==S){if(o&&o!==L._rightView){var M=as(o);M.parentNode===P&&ks(M)}if(L._leftView=S,S){var x=as(S);x.parentNode!==P&&P.insertBefore(x,L._dividerDiv)}L.fp("leftView",o,S)}},getRightView:function(){return this._rightView},setRightView:function(n){var P=this,r=P._rightView,A=P._view;if(P._rightView!==n){if(r&&r!==P._leftView){var I=as(r);I.parentNode===A&&ks(I)}if(P._rightView=n,n){var F=as(n);F.parentNode!==A&&A.insertBefore(F,P._dividerDiv)}P.fp("rightView",r,n)}},validateImpl:function(){var G=this,L=G._draggable,Z=G._position,w=G.getWidth(),$=G.getHeight(),N=G._dividerSize,p=G._dividerBackground,J=_n?18:8,o=G._dividerDiv,h=G._82O,q=G._60O,C=G._61O,Q=G._toggleIcon,A=G._status,y=o.style,i=null,X=_n?20:4,r=Q.comps[0];N>=J||0===N?G._coverDiv&&(ks(G._coverDiv),delete G._coverDiv):G._coverDiv||(G._coverDiv=gh(),d&&(G._coverDiv.style.background=Qq),Ap(o,G._coverDiv)),G._togglable?q.parentNode||(Ap(o,q),Ap(o,C)):(ks(q),ks(C));var m=G._coverDiv,n=G._leftView,l=G._rightView;if(lq(G)){if(N>w&&(N=w),A===Td)if(1===h)var M=x(Z,w),V=F(0,w-N-M);else-1===h?(V=x(-Z,w),M=F(0,w-N-V)):(M=t((w-N)*Z),V=F(0,w-N-M));else"cl"===A?(M=0,V=F(0,w-N)):"cr"===A&&(V=0,M=F(0,w-N));n&&re(n,0,0,M,$),l&&re(l,M+N,0,V,$),re(o,M,0,N,$),G._22o=M,m&&(re(m,N/2-J/2,0,J,$),m.style.cursor=L?ul:""),o.style.cursor=L?ul:"";var K=o.clientHeight/2,g=o.clientWidth;Rn(q,g,g),re(q,0,K-g-X,g,g),i=Tp(q),sg(i,0,0,1),r.rotation=-f,er(i,Q,0,0,g,g),i.restore(),Rn(C,g,g),re(C,0,K+X,g,g),i=Tp(C),sg(i,0,0,1),r.rotation=f,er(i,Q,0,0,g,g),i.restore()}else{if(N>$&&(N=$),A===Td)if(1===h)var u=x(Z,$),E=F(0,$-N-u);else-1===h?(E=x(-Z,$),u=F(0,$-N-E)):(u=t(($-N)*Z),E=F(0,$-N-u));else"cl"===A?(u=0,E=F(0,$-N)):"cr"===A&&(E=0,u=F(0,$-N));n&&re(n,0,0,w,u),l&&re(l,0,u+N,w,E),re(o,0,u,w,N),G._22o=u,m&&(re(m,0,N/2-J/2,w,J),m.style.cursor=L?Sn:""),y.cursor=L?Sn:"";var e=o.clientWidth/2,g=o.clientHeight;Rn(q,g,g),re(q,e-g-X,0,g,g),i=Tp(q),sg(i,0,0,1),r.rotation=0,er(i,Q,0,0,g,g),i.restore(),Rn(C,g,g),re(C,e+X,0,g,g),i=Tp(C),sg(i,0,0,1),r.rotation=I,er(i,Q,0,0,g,g),i.restore()}y.background=p}});var Bp=function(v){this.sv=v,this.addListeners()};rh(Bp,m,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(U){var t=this,v=t.sv,C=v._dividerDiv,Q=v._60O,y=v._61O,W=v._status,g=U.target;if(g===Q)W===Td?v.setStatus("cl"):"cr"===W&&v.setStatus(Td);else if(g===y)W===Td?v.setStatus("cr"):"cl"===W&&v.setStatus(Td);else if(ok(U)&&(g===C||g===v._coverDiv)&&(Ib(U),v.isDraggable())){v.getLeftView(),v.getRightView();var Z=t.maskDiv=gh();if(Z.style.left=0,Z.style.top=0,Z.style.width=v.getWidth()+"px",Z.style.height=v.getHeight()+"px",v.getView().appendChild(Z),!v.isContinuousLayout()){var K=t.resizeDiv=gh();K.style.left=C.style.left,K.style.top=C.style.top,K.style.width=C.style.width,K.style.height=C.style.height,K.style.opacity=v.getDragOpacity(),K.style.background=v.getDividerBackground(),Ap(t.getView(),K)}t._lastAbsPosition=v._22o,t._86o=lq(v)?vq(U).x:vq(U).y,qf(t,U)}},handleWindowTouchMove:function(y){ok(y)&&this.update(y,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(p){var V=this;V.update(p,!0),V.sv.setStatus(Td),V.maskDiv&&ks(V.maskDiv),V.resizeDiv&&ks(V.resizeDiv),V.maskDiv=V.resizeDiv=C},handle_mousedown:function(J){Pr(J)&&this.handle_touchstart(J)},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},update:function(h,z){var i=this,w=i.sv,e=lq(w)?w.getWidth():w.getHeight(),J=w._dividerSize,N=i._lastAbsPosition-i._86o;lq(w)?(N+=vq(h).x,N>e-J&&(N=e-J),0>N&&(N=0),i.resizeDiv&&(i.resizeDiv.style.left=N+bi)):(N+=vq(h).y,N>e-J&&(N=e-J),0>N&&(N=0),i.resizeDiv&&(i.resizeDiv.style.top=N+bi)),z&&e!==J&&(1===w._82O?w.setPosition(N,1):-1===w._82O?w.setPosition(N-e+J,1):w.setPosition(N/(e-J),1))}}),tq.TabView=function(){var L=this,b=L._view=ei(1,L),x=L._91O=gh(1),G=L._tabModel=new Pb,X=G.sm(),D=L.invalidate;L._7o=new Oh,L._canvas=tc(x),Ap(b,x),Ap(b,L._92O=gh(1)),X.setSelectionMode(So),X.ms(L.handleSelectionChange,L),G.mm(D,L),G.md(D,L),G.mh(D,L),new jo(L),L.iv()},Sh("TabView",m,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",wo,Wk,"tabBackground","selectWidth",rk,"moveBackground","insertColor"],_tabPosition:al,_tabHeight:Tc,_tabGap:v.tabViewTabGap,_labelColor:v.tabViewLabelColor,_labelFont:v.tabViewLabelFont,_tabBackground:v.tabViewTabBackground,_selectWidth:v.tabViewSelectWidth,_selectBackground:v.tabViewSelectBackground,_moveBackground:v.tabViewMoveBackground,_insertColor:v.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(V,I,C){var U=new Hr,f=this._tabModel;return U.setName(V),U.setView(I),f.add(U),C&&f.sm().ss(U),U},getLabel:function(j){return j.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(g){this._23o=g,this.iv()},get:function(_){var k=this,j=k._tabModel;if(gl(_))return j._roots.get(_);if(Ai(_)){var H;return j.each(function(w){_===k.getLabel(w)&&(H=w)}),H}return _ instanceof Hr?_:C},select:function(t){this._tabModel.sm().ss(this.get(t))},remove:function(z){var Z=this;if(z=Z.get(z)){var H=Z._tabModel,y=H._roots.indexOf(z);Z._tabModel.remove(z),Z.selectByIndex(--y)}},getCurrentTab:function(){return this._8o},hideTabView:function(N,k){k.parentNode===this._92O&&(Ci(k)?(k.style.display=um,k._tab_=N):ks(k),zf())},showTabView:function(A,z){Ci(z)&&(z.style.display="block",z._tab_=A),z.parentNode!==this._92O&&(Ap(this._92O,z),zf())},_24o:function(){var T,S=this,A=S._8o,I=S._9o,u=S._tabModel.sm().ld();u&&(T=as(u.getView())),T!==I&&(I&&(A.getView()&&A.getView().endEditing&&A.getView().endEditing(),S.hideTabView(A,I)),T&&S.showTabView(u,T)),S._8o=u,S._9o=T,A!==u&&S.onTabChanged(A,u)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(z,J){this.selectByIndex(--J)},selectByIndex:function(S){var x=this,t=x._tabModel,X=t.size();if(X&&!t.sm().ld()){S==C&&(S=0),S>=X&&(S=X-1),0>S&&(S=0);for(var B=S;B>=0;B--){var n=x.get(B);if(!n.isDisabled())return x.select(n),n}for(B=S+1;X>B;B++)if(n=x.get(B),!n.isDisabled())return x.select(n),n}},getTabWidth:function(Z){var v=4,$=Sg(Z.getIcon());$&&(v+=Ml($,Z)+4);var x=this.getLabel(Z);return x&&(v+=On(this.getLabelFont(Z),x).width+4),Z.isClosable()&&(v+=10),v},drawTab:function(g,V,$,C,y,z,Y){var m,S=this,_=S._tabPosition,B=$+4,w=S._selectWidth,k=Sg(V.getIcon()),Q=V.isDisabled(),R=S.getLabelColor(V),e=S.getLabelFont(V),b=S.getLabel(V),U=S._selectBackground,l=_===en+"-vertical",u=_===lg+"-vertical";(l||u)&&(B=C+4),Q&&(g.globalAlpha=eq),Qh(g,$,C,y,z,Y),V===S._8o&&w&&(_===al?Qh(g,$,C+z-w,y,w,U):_===en?Qh(g,$+y-w,C,w,z,U):_===lg?Qh(g,$,C,w,z,U):l?Qh(g,$+y-w,C,w,z,U):u?Qh(g,$,C,w,z,U):Qh(g,$,C,y,w,U));var A=y/2;if(l&&(of(g,A,C+z/2),Bh(g,I),of(g,-A,-C-z/2)),k){var K=Zj(k,V),M=Ml(k,V);if(l||u){var n=$+y/2,p=B+K/2;of(g,n,p),Bh(g,f),of(g,-n,-p),Zl(g,k,$+y/2,B+K/2,V,S),of(g,n,p),Bh(g,-f),of(g,-n,-p),B+=K+4}else Zl(g,k,B+M/2,C+z/2,V,S),B+=M+4}return l||u?(of(g,y/2,B+y/2),Bh(g,f),of(g,-y/2,-B-y/2),hs(g,b,e,R,$,B,z,y),of(g,y/2,B+y/2),Bh(g,-f),of(g,-y/2,-B-y/2)):hs(g,b,e,R,B,C,y,z),l&&(of(g,A,C+z/2),Bh(g,-I),of(g,-A,-C-z/2)),V.isClosable()&&(m=u?{x:$+y-12,y:C+z-12,width:12,height:12}:{x:$+y-12,y:C+2,width:12,height:12},this.drawCloseIcon(V,g,R,m)),Q&&(g.globalAlpha=1),m},drawCloseIcon:function(D,k,O,z){var e=z.x,b=z.y;k.strokeStyle=O,k.lineWidth=1,k.beginPath(),k.moveTo(e+2,b+8),k.lineTo(e+8,b+2),k.moveTo(e+8,b+8),k.lineTo(e+2,b+2),k.stroke()},validateImpl:function(){var G=this;G._24o();var o,f=G._canvas,$=G._tabPosition,x=G._91O,P=G._92O,d=G._tabModel,b=G.getWidth(),u=G.getHeight(),A=G._tabHeight,H=G._7o,Q=G._tabGap,S=$===al,h=$===en,w=$===lg,V=$===en+"-vertical",T=$===lg+"-vertical",y=G._23o,l=0;if((h||w)&&d._roots.each(function(I){l=F(G.getTabWidth(I),l)}),S?(re(x,0,0,b,A),o={x:0,y:A,width:b,height:F(0,u-A)}):h?(re(x,0,0,l,u),o={x:l,y:0,width:F(0,b-l),height:u}):w?(re(x,b-l,0,l,u),o={x:0,y:0,width:F(0,b-l),height:u}):V?(re(x,0,0,A,u),o={x:A,y:0,width:F(0,b-A),height:u}):T?(re(x,b-A,0,A,u),o={x:0,y:0,width:F(0,b-A),height:u}):(re(x,0,u-A,b,A),o={x:0,y:0,width:b,height:F(0,u-A)}),re(P,o),V||T){G._9o&&(o.x=0,re(G._8o.getView(),o)),Rn(f,A,u);
var t=Tp(f),R=0;if(sg(t,0,G.ty(),1),t.clearRect(0,0,A,u),H.clear(),d._roots.each(function($){var _,r=G.getTabWidth($);y&&y.tab===$||(_=G.drawTab(t,$,0,R,A,r,G._tabBackground)),H.add({_75o:_,tab:$,startY:R,endY:R+r,height:r}),R+=r+Q}),G._23Q=F(0,R-Q),y){var Z=y.position;G.drawTab(t,y.tab,0,y.startY,A,y.height,G._moveBackground),Qh(t,0,Z,A,1,G._insertColor)}if(t.restore(),G._selectionChanged){G._selectionChanged=!1;for(var X=G.ty(),r=0;r<H.size();r++){var k=H.get(r);if(k.tab===G._8o){if(k.endY+X<0){G.ty(-k.startY);break}if(k.startY+X>u){G.ty(u-k.endY);break}}}}G.ty(G.ty())}else if(h||w){G._9o&&(o.x=0,re(G._8o.getView(),o)),Rn(f,l,u);var t=Tp(f),R=0;if(sg(t,0,G.ty(),1),t.clearRect(0,0,l,u),H.clear(),d._roots.each(function(J){var o;y&&y.tab===J||(o=G.drawTab(t,J,0,R,l,A,G._tabBackground)),H.add({_75o:o,tab:J,startY:R,endY:R+A,height:A}),R+=A+Q}),G._23Q=F(0,R-Q),y){var Z=y.position;G.drawTab(t,y.tab,0,y.startY,l,y.height,G._moveBackground),Qh(t,0,Z,l,1,G._insertColor)}if(t.restore(),G._selectionChanged){G._selectionChanged=!1;for(var X=G.ty(),r=0;r<H.size();r++){var k=H.get(r);if(k.tab===G._8o){if(k.endY+X<0){G.ty(-k.startY);break}if(k.startY+X>u){G.ty(u-k.endY);break}}}}G.ty(G.ty())}else{G._9o&&(o.y=0,re(G._8o.getView(),o)),Rn(f,b,A);var t=Tp(f),E=0;if(sg(t,G.tx(),0,1),t.clearRect(0,0,b,A),H.clear(),d._roots.each(function(B){var L,e=G.getTabWidth(B);y&&y.tab===B||(L=G.drawTab(t,B,E,0,e,A,G._tabBackground)),H.add({_75o:L,tab:B,startX:E,endX:E+e,width:e}),E+=e+Q}),G._64I=F(0,E-Q),y){var Z=y.position;G.drawTab(t,y.tab,y.startX,0,y.width,A,G._moveBackground),Cb(t,G._insertColor,Z,0,A)}if(t.restore(),G._selectionChanged){G._selectionChanged=!1;for(var z=G.tx(),r=0;r<H.size();r++){var k=H.get(r);if(k.tab===G._8o){if(k.endX+z<0){G.tx(-k.startX);break}if(k.startX+z>b){G.tx(b-k.endX);break}}}}G.tx(G.tx())}for(var j=[],B=P.children,r=0;r<B.length;r++){var i=B[r],N=i._tab_;N&&!d.contains(N)&&j.push(i)}j.forEach(function(c){P.removeChild(c)})}});var jo=function(V){this.tv=V,this.addListeners()};rh(jo,m,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(f){this.handleScroll(f,10*(f.wheelDelta/40))},handle_DOMMouseScroll:function(G){this.handleScroll(G,10*-G.detail)},handleScroll:function(U,L){Ib(U);var X=this.tv,N=X._tabPosition;!X._40o()||N!==al&&N!==rb||X.tx(this.tv.tx()+L),!X._41o()||N!==en&&N!==lg&&N!==en+"-vertical"&&N!==lg+"-vertical"||X.ty(this.tv.ty()+L)},_8Q:function(E){var t,f,D=this.tv,x=D._tabPosition,j=D._7o;if(x===al||x===rb){var q=D.lp(E).x;for(t=0;t<j.size();t++)if(f=j.get(t),f.startX<=q&&q<=f.endX)return f}else if(x===en||x===lg||x===en+"-vertical"||x===lg+"-vertical"){var V=D.lp(E).y;for(t=0;t<j.size();t++)if(f=j.get(t),f.startY<=V&&V<=f.endY)return f}return C},isClickable:function(v){var K=this.tv,B=K._tabPosition,t=this._73o=this._8Q(v);return!K._40o()||B!==al&&B!==rb?!K._41o()||B!==en&&B!==lg&&B!==en+"-vertical"&&B!==lg+"-vertical"?t&&(!t.tab.isDisabled()||K.isMovable()):!0:!0},handle_mousemove:function(Z){var g=this;Mc?g._74o=g._8Q(Z):g.getView().style.cursor=g.isClickable(Z)?rd:""},handle_mousedown:function(H){this.handle_mousemove(H),this.handle_touchstart(H)},handle_touchstart:function(v){var N=this,M=N.tv,z=M._tabPosition;Ib(v),Pr(v)&&N.isClickable(v)&&(z===al||z===rb?(N.x=vq(v).x,N.lp=M.lp(v),N.tx=M.tx()):(N.y=vq(v).y,N.lp=M.lp(v),N.ty=M.ty()),qf(N,v))},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(L){var N,t=this,d=t.tv,h=d._tabPosition,Z=t._73o;if(h===al||h===rb){if(N=vq(L).x-t.x,!t._25o&&!t.moving&&M(N)>2&&(d._40o()&&!md(L)?t._25o=1:Z&&d.isMovable()&&(t.moving=1)),t._25o)d.tx(t.tx+N);else if(t.moving){var W=t.lp.x+N,Q=d._tabGap/2;d._7o.each(function(_){var w=_.endX,p=W-_.startX<w-W;W>=_.startX&&w>=W&&d._7Q({tab:Z.tab,startX:Z.startX+N,width:Z.width,front:p,insertTab:_.tab,position:p?F(0,_.startX-Q):x(d._64I,w+Q)})})}}else if(N=vq(L).y-t.y,!t._25o&&!t.moving&&M(N)>2&&(d._41o()&&!md(L)?t._25o=1:Z&&d.isMovable()&&(t.moving=1)),t._25o)d.ty(t.ty+N);else if(t.moving){var V=t.lp.y+N,Q=d._tabGap/2;d._7o.each(function(L){var T=L.endY,A=V-L.startY<T-V;V>=L.startY&&T>=V&&d._7Q({tab:Z.tab,startY:Z.startY+N,height:Z.height,front:A,insertTab:L.tab,position:A?F(0,L.startY-Q):x(d._23Q,T+Q)})})}},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(){var R=this,p=R.tv,H=p._tabPosition,f=p.getTabModel(),h=f._roots,d=R._73o;if(R.moving){var z=p._23o;if(z&&z.insertTab!==z.tab){var b=z.tab,c=h.remove(b),S=h.indexOf(z.insertTab);S>=0&&(z.front||S++,S<=h.size()&&(h.add(b,S),f._38I(b,c,S)))}p._7Q(C),delete R.moving}else if(!R._25o&&d){b=d.tab;var J=R._74o;if(!J||J.tab===b)if(!b.isDisabled()&&Ng(d._75o,R.lp)){var m=function(){var c=h.indexOf(b);f.remove(b),p.onTabClosed(b,c)};p.onTabClosing(b,m)&&m()}else b.isDisabled()||p._8o===b||f.sm().ss(b)}R._25o=R._73o=R._74o=H===al||H===rb?R.x=R.lp=R.tx=C:R.y=R.lp=R.ty=C}}),tq.PropertyView=function(E){var I=this;I._view=ei(1,I),I._canvas=tc(I._view),Ap(I._view,I._79O=gh()),I._rows=new Oh,I._28o=new Oh,I._26o={},I._26Q={};var i=I._propertyModel=new Pb,Q=I.ivm;i.mm(Q,I),i.md(Q,I),i.mh(Q,I),I.dm(E?E:new Pb),new $d(I)},Sh("PropertyView",m,{ms_ac:[wo,Yp,Wk,Hc,Ho,"categorizable",Go,Sq,df,bq,aj,Qk,vp,$j,"selectRowIndex",rk,"background",Ro,Lr,mc,Ge,am],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Hk,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:ms,_background:v.propertyViewBackground,_expandIcon:v.propertyViewExpandIcon,_collapseIcon:v.propertyViewCollapseIcon,_scrollBarColor:Qg,_scrollBarSize:mk,_autoHideScrollBar:Vn,_selectBackground:v.propertyViewSelectBackground,_rowHeight:wk,_rowLineVisible:v.propertyViewRowLineVisible,_rowLineColor:v.propertyViewRowLineColor,_10I:.5,_columnLineVisible:v.propertyViewColumnLineVisible,_columnLineColor:v.propertyViewColumnLineColor,_labelColor:v.propertyViewLabelColor,_labelSelectColor:v.propertyViewLabelSelectColor,_labelFont:v.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(r){0>r&&(r=0),r>1&&(r=1);var e=this,a=e._10I;e._10I=r,e.fp("columnPosition",a,r)},getPropertyName:function(I){return I.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(f,M,c){return c===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(n,W){return W===this._selectRowIndex?this._labelSelectColor:n.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(V){var k=this.getHeight()-this._59I;return k>V&&(V=k),V>0?0:t(V)},isExpanded:function(Q){if(!Q)return!0;var n=this._26o[Q];return n?n.isExpanded:!(this._26Q[Q]===!1)},toggle:function(g){var y=this;y.isExpanded(g)?y.collapse(g):y.expand(g)},expandAll:function(){this.validate();for(var Z in this._26o)this.expand(Z)},expand:function(x){if(x&&x!==um){var p=this,X=p._26o[x];X&&!X.isExpanded&&(X.isExpanded=!0,p.onExpanded(x),p.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var T in this._26o)this.collapse(T)},collapse:function(i){if(i&&i!==um){var J=this,x=J._26o[i];x&&x.isExpanded&&(x.isExpanded=!1,J.onCollapsed(i),J.ivm())}},onCollapsed:function(){},getCategoryName:function(U){if(!this.isCategorizable())return um;var h=U.getCategoryName();return h?h:um},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(v){var V=this,A=V._dataModel;A!==v&&(A&&(A.umd(V.handlePropertyChange,V),V._selectionModel||A.sm().ums(V.handleSelectionChange,V)),V._dataModel=v,v.md(V.handlePropertyChange,V),V._selectionModel?V._selectionModel._21I(v):v.sm().ms(V.handleSelectionChange,V),V.fp(Hi,A,v))},isVisible:function($){return this._visibleFunc?this._visibleFunc($):!0},onPropertyChanged:function(y){var e=this,R=y.property;pc[R]?e.ivm():e.iv(),R===td&&e._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:ac},handlePropertyChange:function(g){this._27o===g.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var D=this;D._96I||(D.setSelectRowIndex(-1),D._96I=1,D.iv())},redraw:function(){this.iv()},validateModel:function(){var l=this,C=l._rows,u=l._28o,E={},K=new Oh,Q=l._27o;l.updateCurrentData(),Q!==l._27o&&l.endEditing(),C.clear(),u.clear(),l.getRawProperties().each(function(Q){if(l.isVisible(Q)){K.add(Q);var v=l.getCategoryName(Q);E[v]||(u.add(v,v===um?0:r),E[v]={isExpanded:l.isExpanded(v),properties:new Oh})}}),l._sortFunc&&K.sort(l._sortFunc);for(var h in l._26o)l._26Q[h]=l.isExpanded(h);l._26o=E,u.each(function(j){j!==um&&C.add(j);var W=E[j];W.isExpanded&&K.each(function(m){l.getCategoryName(m)===j&&(W.properties.add(m),C.add({property:m,data:l._27o}))},l)})},validateImpl:function(){var w=this;w._76o(),w._96I&&(w.validateModel(),delete w._96I);var q=w._canvas,V=w.getWidth(),f=w.getHeight(),u=-w.ty(),K=w._rowHeight,J=w._indent,i=V-J,Y=w._rows,n=Y.size(),l=w._9I=J+i*w._10I,j=w._59I=n*K;Rn(q,V,f),w._29I={x:0,y:u,width:V,height:f},w._31I=b(u/K),w._14I=k((u+f)/K),w._31I<0&&(w._31I=0),w._14I>n&&(w._14I=n);var U,Z=Tp(q),X=w._background;sg(Z,0,-u,1),Z.beginPath(),Z.rect(0,u,V,f),Z.clip(),Z.clearRect(0,u,V,f),w._93db(Z),X&&Qh(Z,0,0,J,j,X);for(var E=w._31I;E<w._14I;E++){var m=Y.get(E),u=K*E;if(Ai(m))X&&Qh(Z,J,u,i,K,X),U=Sg(w.isExpanded(m)?w._expandIcon:w._collapseIcon),U&&_e(Z,U,Ur,0,u,J,K),Z.save(),Z.beginPath(),Z.rect(J,u,i,K),Z.clip(),w.drawCategoryName(Z,m,E,J,u,i,K),Z.restore();else{var Q=m.property,$=m.data,U=Sg(Q.getIcon()),B=w._selectRowIndex===E?w.getSelectBackground():C;if(U&&_e(Z,U,Ur,0,u,J,K),B&&Qh(Z,J,u,i,K,B),Z.save(),Z.beginPath(),Z.rect(J,u,l-J,K),Z.clip(),w.drawPropertyName(Z,Q,E,J,u,l-J,K),Z.restore(),!w.isEditing($,Q)){var I=l+1,O=V-l-1;Z.save(),Z.beginPath(),Z.rect(I,u,O,K),Z.clip(),w._87o(w.drawPropertyValue(Z,Q,w.getValue($,Q),E,I,u,O,K,$),E,I,u,O,K),Z.restore()}}w._rowLineVisible&&Qh(Z,J,u+K-1,i,1,w._rowLineColor)}w._columnLineVisible&&(Qh(Z,l,0,1,j,w._columnLineColor),Qh(Z,V-1,0,1,j)),w._92db(Z),w._93I(),Z.restore(),w.ty(w.ty())},drawCategoryName:function(n,k,I,r,T,U,D){hs(n,k,this.getCategoryFont(k),this.getCategoryColor(k),r,T,U,D)},drawPropertyName:function(s,a,x,v,F,g,V){return a.drawPropertyName?(a.drawPropertyName(s,a,x,v,F,g,V,this),void 0):(hs(s,this.getPropertyName(a),this.getPropertyFont(a,x),this.getPropertyColor(a,x),v,F,g,V),void 0)},drawPropertyValue:function(P,U,p,$,w,I,K,D,Y){return U.drawPropertyValue?U.drawPropertyValue(P,U,p,$,w,I,K,D,Y,this):(us(P,p,U,this.getLabelFont(U,p,$),this.getLabelColor(U,p,$),w,I,K,D,Y,this),void 0)},isPropertyEditable:function(y){return y.isEditable()&&this.isEditable()},setProperties:function(y){this._propertyModel.clear(),this.addProperties(y)},addProperties:function(l){if(l){var O=this._propertyModel;l.forEach(function(t){if(!(t instanceof Yr)){var W=Vk(t.className);t=fn(W?W:Yr,t)}O.add(t)})}},getRowIndexAt:function(f){var y=this,U=b(y.lp(f).y/y._rowHeight);return U>=0&&U<y._rows.size()?U:-1},getPropertyAt:function(H){var p=this,l=p.getRowIndexAt(H);return l>=0?p._rows.get(l).property:C},getToolTip:function(M){var f=this,U=f.getPropertyAt(M),n=f._27o;return U&&n?U.getToolTip(n,f._9I<f.lp(M).x,f):C}});var $d=function(K){this.pv=K,this.addListeners()};rh($d,m,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(H){this.getView().style.cursor=H},clear:function(){var o=this;o._62O=o.cp=o.ty=o.p=C,o.setCursor(lr)},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(m){var d=this,i=d.pv;Ib(m),i.setFocus(m)&&(Pr(m)?(d.cp=vq(m),d.ty=i.ty(),d.p=i.getColumnPosition(),d.handle_touchmove(m)):i.setSelectRowIndex(i.getRowIndexAt(m)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(m){var d=this;if(d.cp&&!d._62O){var C=d.pv,x=C.lp(m),B=x.x,n=x.y,u=C._indent,h=C.getRowIndexAt(m),j=C._9I;if(h>=0){var s=C._rowHeight,O=s*h,V=C._rows.get(h),r=V.property;if(Ai(V))Sg(C.isExpanded(V)?C._expandIcon:C._collapseIcon)&&B>=0&&u>=B&&n>=O&&O+s>=n?C.toggle(V):co(m)&&C.toggle(V);else if(B>j&&C.isPropertyEditable(r,m)){var H={x:j+1,y:O,width:C.getWidth()-j-1,height:s},M={x:H.x+C.tx(),y:H.y+C.ty(),width:H.width,height:H.height},T=0,K=C._29I;H.y<K.y?T=H.y-K.y:H.y+s>K.y+K.height&&(T=H.y+s-K.y-K.height),T&&(C.ty(C.ty()-T),M.y-=T),C.beginEditing({data:V.data,property:r,value:C.getValue(V.data,r),event:m,rect:H,editorRect:M,view:C})}}C.setSelectRowIndex(h)}d.clear()},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(o){var t=this,C=t.pv,z=t.ty,b=t.cp,p=vq(o),K=t._62O;if("p"===K)C.setTranslateY(z+p.y-b.y);else if("c"===K){var P=C.getWidth()-C._indent;if(P>16){var i=t.p-(b.x-p.x)/P,l=16/P;l>i&&(i=l),i>1-l&&(i=1-l),C.setColumnPosition(i)}}else"s"===K&&C.setTranslateY(z+(b.y-p.y)*C._59I/C._29I.height)},handle_mousemove:function(l){this.handle_touchmove(l)},handle_touchmove:function(J){if(!Mc&&Pr(J)){var k=this,I=k.pv,Q=M(I.lp(J).x-I._9I)<=(_n?8:3);k.cp?k._62O||(Q?(k._62O="c",qf(k)):M(vq(J).y-k.cp.y)>=2&&(k._62O=k.isV(J)?"s":"p",qf(k))):(Q?k.setCursor(ul):k.setCursor(lr),k.isV(J)&&I._43o())}},isV:function(N){var S=this.pv,i=S._29I;return S._41o()&&i.x+i.width-S.lp(N).x<Oi},handle_mousewheel:function(G){this.handleScroll(G,G.wheelDelta/40)},handle_DOMMouseScroll:function(c){2===c.axis&&this.handleScroll(c,-c.detail)},handleScroll:function(B,$){var b=this.pv;Ib(B),b.endEditing(),b.translate(0,$*b.getRowHeight())},handle_keydown:function(W){var c=this.pv,B=c._rows.size(),R=c._selectRowIndex+(Ad(W)?-1:1);(Ad(W)||hk(W))&&(0>R&&(R=0),R>=B&&(R=B-1),c.setSelectRowIndex(R))}}),tq.ListView=function(D){this._5o(D),new jn(this)},Sh("ListView",m,{ms_ac:[wo,Yp,Wk,Ro,Go,Lr,mc,Sq,df,Qk,vp,$j,Bc,rk],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:ms,_rowHeight:wk,_rowLineVisible:v.listViewRowLineVisible,_rowLineColor:v.listViewRowLineColor,_scrollBarColor:Qg,_scrollBarSize:mk,_autoMakeVisible:Kj,_autoHideScrollBar:Vn,_selectBackground:v.listViewSelectBackground,_labelColor:v.listViewLabelColor,_labelSelectColor:v.listViewLabelSelectColor,_labelFont:v.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(y){var H=this,K=H._checkMode;H._checkMode=y,H.fp(cc,K,y)},drawRow:function(j,C,D,q,z,y,V){var p=this,w=0,R=p._indent,H=p.getIconWidth(C);p.drawRowBackground(j,C,D,q,z,y,V),p._checkMode&&(Zl(j,Sg(p.getCheckIcon(C)),w+R/2,z+V/2,C,p),w+=R),p.drawIcon(j,C,w,z,H,V),p.drawLabel(j,C,w+H,z,V)}});var jn=function(r){this.list=r,this._lastSelectDataTime=de(),this.addListeners()};rh(jn,m,{ms_listener:1,getView:function(){return this.list._view},clear:function(r){var O=this,d=O.list;r&&"d"===O._62O&&!O.dragCancel&&d.handleDragAndDrop(r,"end"),d.draggingData&&(d.draggingData=null,d.redraw()),O.dragCancel=O._62O=O._isV=O._isH=O.cp=O.tx=O.ty=C},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(y){var S=this,V=S.list;if(Ib(y),V.setFocus(y)){var F=V.getDataAt(y);S.cp=vq(y),S.tx=V.tx(),S.ty=V.ty(),Pr(y)?F&&V.handleDragAndDrop&&!S.isV(y)&&!S.isH(y)&&(V.draggingData=F,V.redraw(),V.handleDragAndDrop(y,"prepare")):(F&&S._33o(y,F),S.clear(y))}},handleWindowMouseUp:function(q){this.clear(q)},handleWindowTouchEnd:function(c){this.clear(c)},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(Q){var x=this,N=x.list;if(!x._isV&&!x._isH&&x.cp&&!x._62O){var y=N.getDataAt(Q);y?(N.isCheckMode()?x._34o(Q,y):x._33o(Q,y),co(Q)?N.onDataDoubleClicked(y,Q):N.onDataClicked(y,Q)):N.handleBackgroundClick(Q)}x.clear(Q)},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(o){var l=this,z=l.list,x=l._62O,T=l.tx,A=l.ty,V=l.cp,J=vq(o),k=z._29I;"p"===x?z.setTranslate(T+J.x-V.x,A+J.y-V.y):"v"===x?z.ty(A+(V.y-J.y)*z._59I/k.height):"h"===x?z.tx(T+(V.x-J.x)*z._91I/k.width):"d"===x&&(l.dragCancel||z.handleDragAndDrop(o,"between"))},handle_mousemove:function($){this.handle_touchmove($)},handle_touchmove:function(n){if(!Mc&&Pr(n)){var i=this,V=i.list;if(i._isV=i.isV(n),i._isH=i.isH(n),i.cp){if(!i._62O){if(Xo(vq(n),i.cp)<2)return;i._isV?i._62O="v":i._isH?i._62O="h":V.draggingData&&!this.dragCancel?(i._62O="d",V.handleDragAndDrop(n,"begin")):i._62O="p",i._62O&&"d"!==i._62O&&V.draggingData&&(V.draggingData=null,V.redraw()),qf(i)}}else i._isV&&V._43o(),i._isH&&V._42o()}},isV:function(D){var m=this.list,K=m._29I;return m._41o()&&K.x+K.width-m.lp(D).x<Oi},isH:function(J){var q=this.list,j=q._29I;return q._40o()&&j.y+j.height-q.lp(J).y<Oi},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40,j.wheelDelta!==j.wheelDeltaX)},handle_DOMMouseScroll:function(G){this.handleScroll(G,-G.detail,1)},handleScroll:function(J,s,v){var y=this.list;Ib(J),y.endEditing&&y.endEditing(),v&&y._41o()?y.translate(0,s*y.getRowHeight()):y._40o()&&y.translate(10*s,0)},handle_keydown:function(W){if(!v.isInput(W.target)){var O,q=this.list,G=q.sm(),l=q._rows,u=l.size();if(_q(W))q.selectAll();else if(ud(W))q.handleDelete&&q.handleDelete(W);else if(Rp(W))"d"!==this._62O||this.dragCancel||(q.handleDragAndDrop(W,"cancel"),this.dragCancel=!0);else if(Nf(W))q.isCheckMode()&&(O=q.getFocusData(),O&&q.checkData(O));else if(Ad(W)||hk(W)){var j=q.isCheckMode();if(O=j?q.getFocusData():G.ld()){var I=q.getRowIndex(O);I>=0&&(Ad(W)?0!==I&&(O=l.get(I-1),j?q.setFocusData(O):G.ss(O)):I!==u-1&&(O=l.get(I+1),j?q.setFocusData(O):G.ss(O)))}else u>0&&(O=l.get(0),j?q.setFocusData(O):G.ss(O))}}},_34o:function(Z,J){var $=this.list,t=$.lp(Z).x;return t>=0&&t<=$._indent?($.checkData(J),void 0):($.setFocusData(J),void 0)},_33o:function(z,Z){var p=this.list,E=p.sm(),f=E.ld();if(md(z))p.isSelected(Z)?E.rs(Z):E.as(Z);else if(Nh(z))if(f)for(var A=p.getRowIndex(f),P=p.getRowIndex(Z);A!==P;)A+=P>A?1:-1,E.as(p._rows.get(A));else E.ss(Z);else if(Pr(z)){var l=de();if(E.contains(Z)){var c=l-this._lastSelectDataTime;p.handleDataDoubleSelect&&c>500&&1500>c&&p.handleDataDoubleSelect(z,Z)}E.ss(Z),this._lastSelectDataTime=l}else E.contains(Z)||E.ss(Z)}}),tq.TreeView=function(N){var V=this;V._35o(),V._5o(N),new wi(V)},Sh("TreeView",m,{ms_ac:[wo,Yp,Wk,"rootVisible",cc,"rootData",Sq,df,Qk,vp,$j,Go,Ro,Lr,mc,bq,aj,Bc,rk,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:C,_indent:ms,_rowHeight:wk,_rowLineVisible:v.treeViewRowLineVisible,_rowLineColor:v.treeViewRowLineColor,_scrollBarColor:Qg,_scrollBarSize:mk,_autoHideScrollBar:Vn,_expandIcon:v.treeViewExpandIcon,_collapseIcon:v.treeViewCollapseIcon,_autoMakeVisible:Kj,_selectBackground:v.treeViewSelectBackground,_labelColor:v.treeViewLabelColor,_labelSelectColor:v.treeViewLabelSelectColor,_labelFont:v.treeViewLabelFont,_doubleClickToToggle:v.treeViewDoubleClickToToggle,drawRow:function(y,v,N,C,L,n,j){var h=this;h.drawRowBackground(y,v,N,C,L,n,j),h._97I(y,v,N,0,L,n,j)},isOnToggleIcon:function(V){var r=this.getDataAt(V);if(r){var P=this.getIndent(),C=this.lp(V).x;if(Sg(this.getToggleIcon(r))){var L=P*this.getLevel(r);if(C>=L&&L+P>=C)return!0}}return!1}});var wi=function($){Nm(wi,this,[$])};rh(wi,jn,{toggle:function(T,O,A,G){var U=this.list,g=U.lp(T).x;if(Sg(U.getToggleIcon(O))){var H=A*G;if(g>=H&&H+A>=g)return U.toggle(O),!0}return U.isDoubleClickToToggle()&&co(T)?(U.toggle(O),!0):!1},_34o:function($,g){var S=this.list,w=S.lp($).x,B=S._levelMap[g._id],z=S._indent,p=z*(B+1);return w>=p&&p+z>=w?(S.checkData(g),void 0):(this.toggle($,g,z,B)||S.setFocusData(g),void 0)},_33o:function(e,q){var f=this,t=f.list;f.toggle(e,q,t._indent,t.getLevel(q))||wi.superClass._33o.call(f,e,q)},handle_keydown:function(n){if(Ab(n)||Cj(n)){var t=this.list,D=t._rows,Q=t.isCheckMode(),T=t.sm(),X=Q?t.getFocusData():T.ld();X?X.hasChildren()&&(Ab(n)?t.collapse(X):t.expand(X)):D.size()>0&&(X=D.get(0),Q?t.setFocusData(X):T.ss(X))}else wi.superClass.handle_keydown.call(this,n)}});var Nl=tq.TableView=function(f){this._98I(),this._5o(f),new fs(this)};Sh("TableView",m,{ms_ac:[wo,Yp,Wk,"sortMode",Hc,Ho,Ro,Lr,mc,Ge,am,"sortColumn",Sq,df,Qk,vp,$j,Bc,rk],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:bj,_editable:!0,_batchEditable:!1,_rowHeight:wk,_rowLineVisible:v.tableViewRowLineVisible,_rowLineColor:v.tableViewRowLineColor,_columnLineVisible:v.tableViewColumnLineVisible,_columnLineColor:v.tableViewColumnLineColor,_scrollBarColor:Qg,_scrollBarSize:mk,_autoHideScrollBar:Vn,_autoMakeVisible:Kj,_selectBackground:v.tableViewSelectBackground,_labelColor:v.tableViewLabelColor,_labelSelectColor:v.tableViewLabelSelectColor,_labelFont:v.tableViewLabelFont,getCheckColumn:function(){var U=this;if(!U._31o){var E=U._31o=new li;E.setEditable(!0),E.setWidth(40),E.getValue=U.getCheckColumValue,E.drawCell=U.drawCheckColumnCell}return U._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(D){var K=this,o=K._39o,H=K.getCheckColumn();D!==K.isCheckMode()&&(D?o.add(H,0):o.remove(H),K.fp(cc,!D,D))},getCheckColumValue:function(A,B,w){return w.isSelected(A)},drawCheckColumnCell:function(q,u,Q,Z,O,s,t,A,D){Zl(q,D.getCheckIcon(u),O+t/2,s+A/2,u,D)}});var fs=function(w){Nm(fs,this,[w])};rh(fs,jn,{_34o:function(g,p){var J=this.list,s=J._31o;if(J.isCellEditable(p,s,g)){var e=J._3Q(s),A=J.lp(g).x;if(e&&A>=e.startX&&A<e.startX+s.getWidth())return J.checkData(p),void 0}J._37O(p,g),J.setFocusData(p)},_33o:function(k,l){this.list._37O(l,k),fs.superClass._33o.apply(this,arguments)}});var Uh=tq.TreeTableView=function(C){var H=this,e=H._4o=new li;H._35o(),H._98I(),H._5o(C),e.setDisplayName("Name"),e.setEditable(!0),e.setWidth(180),e.drawCell=Nj,e.getValue=sr,H._39o.add(e),new yi(H)},Nj=function(g,B,F,v,I,G,p,o,_){_._97I(g,B,F,I,G,p,o)},sr=function(t,$,n){return n.getLabel(t)};Sh("TreeTableView",m,{ms_ac:[wo,Yp,Wk,"sortMode",Hc,Ho,Go,cc,"rootData","rootVisible",Sq,df,"sortColumn",bq,aj,Qk,vp,$j,Bc,mc,Ro,Lr,Ge,am,rk,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:bj,_checkMode:C,_editable:!0,_batchEditable:!1,_indent:ms,_rowHeight:wk,_rowLineVisible:v.treeTableViewRowLineVisible,_rowLineColor:v.treeTableViewRowLineColor,_columnLineVisible:v.treeTableViewColumnLineVisible,_columnLineColor:v.treeTableViewColumnLineColor,_expandIcon:v.treeTableViewExpandIcon,_collapseIcon:v.treeTableViewCollapseIcon,_scrollBarColor:Qg,_scrollBarSize:mk,_autoHideScrollBar:Vn,_autoMakeVisible:Kj,_selectBackground:v.treeTableViewSelectBackground,_labelColor:v.treeTableViewLabelColor,_labelSelectColor:v.treeTableViewLabelSelectColor,_labelFont:v.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var yi=function(R){Nm(yi,this,[R])};rh(yi,jn,{_34o:function(R,e){var I=this.list,z=I._4o,T=I._3Q(z),q=I.lp(R).x;if(T){var U=I._indent,F=T.startX+U*I.getLevel(e);if(Sg(I.getToggleIcon(e))&&q>=F&&F+U>=q)return I.toggle(e),void 0;if(I.isCellEditable(e,z)&&(F+=U,q>=F&&F+U>=q))return I.checkData(e),void 0}I._37O(e,R),I.setFocusData(e)},_33o:function(i,J){var y=this.list,d=y.lp(i).x;if(Sg(y.getToggleIcon(J))){var g=y._3Q(y._4o);if(g){var D=y._indent,z=g.startX+D*y.getLevel(J);if(d>=z&&z+D>=d)return y.toggle(J),void 0}}y._37O(J,i),yi.superClass._33o.apply(this,arguments)}});var zg=tq.TableHeader=function(s){var l=this,C=l._view=ei(1,l),_=l._39o=s.getColumnModel(),F=l.iv;l.tv=l._tableView=s,l._60I=new Oh,l._canvas=tc(C),C.style.background=v.tableHeaderBackground||"",C.style.height=Ir+bi,_.mm(F,l),_.md(F,l),_.mh(F,l),s.mp(function(x){wf[x.property]&&l.iv()},l),new wc(l),l.iv()};Sh("TableHeader",m,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",wo,Wk,Go,"moveBackground","insertColor",Ge,am,"resizable","movable"],_checkIcon:Db,_movable:!0,_resizable:!0,_labelColor:v.tableHeaderLabelColor,_labelFont:v.tableHeaderLabelFont,_columnLineColor:v.tableHeaderColumnLineColor,_columnLineVisible:v.tableHeaderColumnLineVisible,_sortDescIcon:v.tableHeaderSortDescIcon,_sortAscIcon:v.tableHeaderSortAscIcon,_moveBackground:v.tableHeaderMoveBackground,_insertColor:v.tableHeaderInsertColor,_indent:ms,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(Z){return Z.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(E){return E.getColor()||this._labelColor},getLabelAlign:function(h){return h._align},onPropertyChanged:function(){this.iv()},_5Q:function(J){this._61I=J,this.iv()},getLogicalPoint:function(X){return Al(X,this._canvas,this.tv.tx())},validateImpl:function(){var Y=this,w=Y._canvas,M=Y.getWidth(),K=Y.getHeight(),X=Y.tv,V=Y._60I,m=Y._61I,F=-X.tx(),D=0;(M!==w.clientWidth||K!==w.clientHeight)&&Rn(w,M,K),V.clear(),Y._39o._roots.each(function(E){if(E.isVisible()){var J=D+E.getWidth();F+M>=D&&J>=F&&V.add({column:E,startX:D}),D=J}});var s=Tp(w);if(sg(s,-F,0,1),s.beginPath(),s.rect(F,0,M,K),s.clip(),s.clearRect(F,0,M,K),V.each(function(G){var p=G.column,j=G.startX,W=p.getWidth();W>0&&(s.save(),s.beginPath(),s.rect(j,0,W,K),s.clip(),m&&m.column===p||Y.drawColumn(s,p,j,0,W,K),Y._columnLineVisible&&Qh(s,j+W-1,0,1,K,Y._columnLineColor),s.restore())}),m){var p=m.column,D=m.startX,H=m.position,b=p.getWidth();s.save(),s.beginPath(),s.rect(D,0,b,K),s.clip(),s.fillStyle=Y._moveBackground,s.fill(),Y.drawColumn(s,p,D,0,b,K),s.restore(),Cb(s,Y._insertColor,H,0,K)}s.restore()},_6Q:function(_){var $=this.tv;return $._31o===_&&$.sm().getSelectionMode()===yl},drawColumn:function(h,G,d,E,Z,c){var H=this,x=H.tv,f=Sg(G.getIcon()),v=H.getLabelAlign(G);if(H._6Q(G)){var L=Sg(H._checkIcon);Zl(h,L,d+Z/2,E+c/2,G,H)}else{var K=H.getLabel(G),Q=H.getLabelFont(G),o=H.getLabelColor(G),l=On(Q,K).width,n=f?H._indent:0;v===en?(f&&_e(h,f,Ur,d,E,n,c),hs(h,K,Q,o,d+n,E,Z,c,en)):v===lg?(f&&_e(h,f,Ur,d+Z-l-n,E,n,c),hs(h,K,Q,o,d,E,Z,c,lg)):(f&&_e(h,f,Ur,d+(Z-l-n)/2,E,n,c),hs(h,K,Q,o,d+(Z-l+n)/2,E,0,c,en))}if(G.isSortable()&&x.getSortColumn()===G&&(f=Sg(G.getSortOrder()===Cr?H._sortAscIcon:H._sortDescIcon))){var q=Ml(f,G)/2+2;Zl(h,f,v===lg?d+q:d+Z-q,E+c/2,G,x)}}});var wc=function(T){var t=this;t.th=T,t.tv=T._tableView,t.addListeners()};rh(wc,m,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(z){this.getView().style.cursor=z},handle_mousemove:function(f){if(!Mc){var n=this;delete n._29o,n.setCursor(lr);for(var l=n.th,i=l._60I,C=l.lp(f).x,c=i.size()-1;c>=0;c--){var h=i.get(c),O=h.column,K=h.startX+O.getWidth();if(l.isResizable()&&M(K-C)<=(_n?10:3))return n._29o=h,n.setCursor(ul),void 0;C>h.startX&&K>C&&(n._29o=h),(O.isClickable()||O.isSortable()||l.isMovable()||n.tv.getCheckColumn&&O===n.tv.getCheckColumn())&&C>h.startX&&K>C&&n.setCursor(rd)}}},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(P){var k=this;Ib(P),k.tv.endEditing(),k.handle_mousemove(P),k._29o&&(k.x=vq(P).x,k.lx=k.th.lp(P).x,k.w=k._29o.column.getWidth(),qf(k,P))},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(m){var Y=this,t=Y.th,x=Y.getView().style.cursor,Q=Y._29o,r=vq(m).x-Y.x;if(Y.resizing||Y.moving||(x===ul?Y.resizing=1:t.isMovable()&&x===rd&&M(r)>2&&(Y.moving=1)),Y.resizing)Q.column.setWidth(Y.w+r);else if(Y.moving){var B=Y.lx+r;t._60I.each(function(k){var G=k.startX,w=G+k.column.getWidth();if(B>=G&&w>=B){var y={column:Q.column,startX:Q.startX+r,front:w-B>B-G,insertColumn:k.column};y.position=y.front?G:w,t._5Q(y)}})}},_16Q:function(r,K){var G=this,k=G.tv,Y=G.th,m=Y._checkIcon;if(Y._6Q(r)){var P=Sg(m),J=G.lx,q=r.getWidth(),T=Ml(P,r);if(J>=K+q/2-T&&K+q/2+T>=J){Y.setCheckIcon(m===to?Db:to);var f=k.sm(),v=k._rows;return m===to?f.rs(v):f.ss(v),k.onCheckColumnClicked(r),!0}}return!1},handleWindowMouseUp:function($){this.handleWindowTouchEnd($)},handleWindowTouchEnd:function(y){var b=this,J=b.tv,x=b.th,d=b._29o;if(b.moving){var Z=x._61I;if(Z&&Z.insertColumn!==Z.column){var M=Z.column,k=J.getColumnModel()._roots,E=k.remove(M),_=k.indexOf(Z.insertColumn);_>=0&&(Z.front||_++,_<=k.size()&&(k.add(M,_),J.getColumnModel()._38I(M,E,_)))}x._5Q(C),delete b.moving}else if(!b.resizing&&d){M=d.column;var j=x.lp(y).x,A=d.startX,I=!0;if(x.onColumnClicked){var G=x.onColumnClicked(M,y,A);G===!1&&(I=!1)}if(I&&j>=A&&j<=A+M.getWidth()&&!b._16Q(M,A)){if(M.isSortable()){var Y=J.getSortMode(),q=M.getSortOrder();Y===bj?J.getSortColumn()===M?(q===xs&&J.setSortColumn(C),M.setSortOrder(q===Cr?xs:Cr)):J.setSortColumn(M):"bistate"===Y&&(J.getSortColumn()===M?M.setSortOrder(q===Cr?xs:Cr):J.setSortColumn(M))}J.onColumnClicked(M,y,A)}}b._29o=b.resizing=b.x=b.lx=b.w=C}}),tq.TablePane=function(B){this.init(new Nl(B))},Sh("TablePane",m,{ms_v:1,_44o:1}),tq.TreeTablePane=function(O){this.init(new Uh(O))},Sh("TreeTablePane",m,{ms_v:1,_44o:1}),tq.Toolbar=function(W){var D=this,e=D._view=ei(1,D),E=e.style;E.background=v.toolbarBackground||"",E.height=Tc+bi,D._canvas=tc(e),D._30o=new Oh,D._90I=new Oh,D.setItems(W||[]),e.handleGroupSelectedChanged=function(V){if(V.isSelected()){var y=V.getGroupId();null!=y&&D._items.forEach(function(B){var F=B.element;F&&F!==V&&F.setSelected&&F.getGroupId&&F.getGroupId()===y&&F.setSelected(!1)})}},new Vr(D)},Sh("Toolbar",m,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Kk,wo,Wk,Yp,rk,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:v.toolbarLabelColor,_labelSelectColor:v.toolbarLabelSelectColor,_labelFont:v.toolbarLabelFont,_selectBackground:v.toolbarSelectBackground,_itemGap:v.toolbarItemGap,_separatorColor:v.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(A){var Y=this.getItemInfoAt(A);return Y?Y.item.toolTip:C},getLabelColor:function(L){return L&&L.selected&&L.type!==to&&L.type!==Dj?this._labelSelectColor:this._labelColor},onPropertyChanged:function(G){this.iv(),G.property===Kk&&this._items.forEach(function(g){$b(g)})},redraw:function(){this.iv()},addItem:function(b,Y){var D=this._items;Y==C?D.push(b):D.splice(Y,0,b),this.fp(Kk,C,D)},removeItem:function(S){if(S)for(var X=this._items,o=0;o<X.length;o++)S===X[o]&&(X.splice(o,1),this.fp(Kk,C,X))},removeItemById:function(G){if(G!=C)for(var S=this._items,k=0;k<S.length;k++)if(G===S[k].id){var w=S.splice(k,1)[0];return this.fp(Kk,C,S),w}},getItemById:function(f){if(f!=C)for(var K=this._items,J=0;J<K.length;J++){var Y=K[J];if(f===Y.id)return Y}},setItemVisible:function(Z,c){var Y=this.getItemById(Z);Y&&(Y.visible=c)},getItemInfos:function(){return this._30o},getItemInfoAt:function(d){var X=this,k=0,I=X._30o,h=X.lp(d),R=h.x,g=h.y;if(g>=0&&g<=X.getHeight())for(;k<I.size();k++){var m=I.get(k);if(m.startX<=R&&R<=m.endX)return m}return C},drawItem:function(s,l,R,N,M){if(l.visible===!1)return 0;if(bk(l.visible)&&!l.visible())return 0;var F=this,H=l.disabled;H&&(s.globalAlpha=eq);var y=F.drawItemImpl(s,l,R,N,M),I=F._itemGap;return H&&(s.globalAlpha=1),this._currentItem!==l||"separator"===l||l.separator===!0||l.unfocusable||jc(s,F._separatorColor,R-I/2,0,y+I,N),y},drawItemImpl:function(H,J,c,z,P){var j=this,x=j._view,v=j._itemGap,f=z/2,h=J.type,G=J.element,p=J.label;Ai(G)&&(p=G,G=C);var y,S=j.getLabelFont(J),$=j.getLabelColor(J),L=J.selected,g=Sg(J.icon),o=Ml(g,J),l=0,n=o+(p?On(S,p).width:0);if("separator"===J||J.separator===!0)return Cb(H,j._separatorColor,c,z/4,f),1;if(G){g&&Zl(H,g,c+o/2,f,J,j),hs(H,p,S,$,c+o,0,0,z);var q=as(G);P||j._90I.add(q),q.parentNode!==x&&Ap(x,q),G.iv&&G.iv(),G.validate&&G.validate();var V=q.getBoundingClientRect(),w=V.width,b=q.style;return gn(q),b.left=j.tx()+c+n+bi,b.top=(z-V.height)/2+bi,n+w}return h===Dj?y=Sg(L?_i:mo):h===to&&(y=Sg(L?to:Db)),y?(l=Ml(y,J),Zl(H,y,c+l/2,f,J,j),c+=l,n+=l):L&&Qh(H,c-v/2,0,n+v,z,j.getSelectBackground(J)),g&&Zl(H,g,c+o/2,f,J,j),hs(H,p,S,$,c+o,0,0,z),n
},validateImpl:function(){var Q=this,w=Q._canvas,l=Q.getWidth(),T=Q.getHeight(),G=Q._30o,D=Q._items;Rn(w,l,T);var q=Tp(w),s=Q._itemGap,H=s/2;sg(q,Q.tx(),0,1),q.clearRect(0,0,l,T);var z=Q._90I;Q._90I=new Oh,G.clear(),D.forEach(function(g){var N=Q.drawItem(q,g,H,T);G.add({item:g,startX:H,endX:H+N,width:N}),N&&(H+=N+s)}),z.each(function(R){Q._90I.contains(R)||ks(R)});var g=Q._64I;Q._64I=F(0,H),q.restore(),Q._stickToRight?(Q._65O=0,q=Tp(w),H=l-Q._64I+s,sg(q,0,0,1),q.clearRect(0,0,l,T),G.clear(),D.forEach(function(w){var J=Q.drawItem(q,w,H,T,!0);G.add({item:w,startX:H,endX:H+J,width:J}),J&&(H+=J+s)}),q.restore()):Q.tx(Q.tx()),g!==Q._64I&&Q.onSumWidthChanged(g,Q._64I)},onSumWidthChanged:function(){},handleClick:function(R,U){var x=this,A=R.type,k=R.action,Z=R.groupId,s=R.selected;R.disabled||(Z!=C?s||(R.selected=!0,this._items.forEach(function(e){e.groupId===Z&&R!==e&&(e.selected=!1)}),k&&R.action(R,x,U)):A===to||"toggle"===A?(R.selected=!s,k&&R.action(R,x,U)):k&&R.action(R,x,U)),zf(),x.iv()}});var Vr=function(K){this.tb=K,this.addListeners()};rh(Vr,m,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(I){this.handleScroll(I,10*(I.wheelDelta/40))},handle_DOMMouseScroll:function(Z){this.handleScroll(Z,10*-Z.detail)},handleScroll:function(e,U){Ib(e);var $=this.tb;$.isScrollable()&&!$._stickToRight&&($.tx($.tx()+U),hi())},handle_mousemove:function(l){var O=this;Mc||O.setItem(l)},handle_mouseout:function(T){var u=this;T.target===u.getView()?u.tb.setCurrentItem(C):u.handle_mousemove(T)},handle_mousedown:function(z){this.handle_mousemove(z),this.handle_touchstart(z)},handle_touchstart:function(l){var L=this,t=L.tb,S=l.target;Pr(l)&&(S===L.getView()||S===t._canvas)&&(Ib(l),t.setFocus(l)&&(this.setItem(l,!0),(t.isScrollable()||L.info&&!L.info.item.disabled)&&(L.x=vq(l).x,L.tx=t.tx(),qf(L,l))))},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(E){var D=this,f=D.tb;if(!f._stickToRight){var _=vq(E).x-D.x;!D._25o&&M(_)>2&&f.isScrollable()&&(D._25o=1),D._25o&&f.tx(D.tx+_)}},handleWindowMouseUp:function(h){this.handleWindowTouchEnd(h)},handleWindowTouchEnd:function(E){var s=this,e=s.tb,S=s.info,o=s.tb.getItemInfoAt(E);if(!s._25o&&S){var D=S.item;o&&o.item===D&&e.handleClick(D,E)}s._25o=s.x=s.tx=C,s.setItem()},setItem:function(c,d){var s=this,I=s.tb,q=s.info=c?I.getItemInfoAt(c):C,x=q?q.item:C;I.setCurrentItem(x),d&&x&&bk(x.onDown)&&x.onDown(c)}}),tq.BorderPane=function(){this._view=ei(1,this),this.iv()},Sh("BorderPane",m,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(Y,e){this._12o("leftView",Y),e!=C&&this.setLeftWidth(e)},getRightView:function(){return this._rightView},setRightView:function(r,f){this._12o("rightView",r),f!=C&&this.setRightWidth(f)},getTopView:function(){return this._topView},setTopView:function(f,_){this._12o("topView",f),_!=C&&this.setTopHeight(_)},getBottomView:function(){return this._bottomView},setBottomView:function(f,L){this._12o("bottomView",f),L!=C&&this.setBottomHeight(L)},getCenterView:function(){return this._centerView},setCenterView:function(J){this._12o("centerView",J)},_12o:function(i,h){var U=this,n="_"+i,g=U._view,C=U[n];C!==h&&(C&&(C.getView?ks(C.getView()):ks(C)),U[n]=h,h&&(h.getView?Ap(g,h.getView(),1):Ap(g,h,1)),U.fp(i,C,h))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var S=this,Q=S._topView,f=S._bottomView,x=S._leftView,Y=S._rightView,w=S._centerView,P=S.getWidth(),D=S.getHeight(),b=0,j=0,Z=P,u=D,_=0,U=0,g=0,A=0;Q&&(_=S._topHeight==C?ld(Q):S._topHeight,j=_),f&&(U=S._bottomHeight==C?ld(f):S._bottomHeight,u=D-U),x&&(g=S._leftWidth==C?tb(x):S._leftWidth,b=g),Y&&(A=S._rightWidth==C?tb(Y):S._rightWidth,Z=P-A);var y=F(0,Z-b),W=F(0,u-j);Q&&re(Q,0,0,P,_),f&&re(f,0,u,P,U),x&&re(x,0,j,g,W),Y&&re(Y,Z,j,A,W),w&&re(w,b,j,y,W)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);